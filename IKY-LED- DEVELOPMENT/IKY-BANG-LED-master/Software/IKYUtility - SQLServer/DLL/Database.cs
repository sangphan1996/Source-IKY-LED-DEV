using System;
using System.Data;
using System.Windows.Forms;
using System.Security.Cryptography;
using System.Configuration;
using System.Text;
using System.Resources;
using System.IO;
using System.Diagnostics;
using MDB;

namespace MedilinkDatabases
{
    public class Database
    {
        static int iPhanHe = 0;
        const int iNumRowPar = 500000;

        /// <summary>
        /// Oracle: ServiceName,Postgre: Host
        /// </summary>
        const string HOSTTAG = "Host";
        const string PORTTAG = "Port";

        /// <summary>
        /// Oracle: Tablespace, Postgre: Database
        /// </summary>
        const string DATABASETAG = "Database";
        const string USERTAG = "User";
        const string PASSWORDTAG = "Password";

        /// <summary>
        /// Oracle: user, Postgre: schema
        /// </summary>
        const string SCHEMATAG = "Schema";

        const string PASSWORDSYSTEMTAG = "PasswordSystem";
        const string USERLOGINTAG = "UserLogin";
        const string PASSWORDLOGINTAG = "PasswordLogin";

        #region Dược
        /// <summary>
        /// Oracle: ServiceName,Postgre: Host
        /// </summary>
        const string DUOCHOSTTAG = "DuocHost";
        const string DUOCPORTTAG = "DuocPort";

        /// <summary>
        /// Oracle: Tablespace, Postgre: Database
        /// </summary>
        const string DUOCDATABASETAG = "DuocDatabase";
        const string DUOCUSERTAG = "DuocUser";
        const string DUOCPASSWORDTAG = "DuocPassword";

        /// <summary>
        /// Oracle: user, Postgre: schema
        /// </summary>
        const string DUOCSCHEMATAG = "DuocSchema";

        const string DUOCPASSWORDSYSTEMTAG = "DuocPasswordSystem";
        const string DUOCUSERLOGINTAG = "DuocUserLogin";
        const string DUOCPASSWORDLOGINTAG = "DuocPasswordLogin";
        #endregion

        #region Viện phí
        /// <summary>
        /// Oracle: ServiceName,Postgre: Host
        /// </summary>
        const string VPHOSTTAG = "VPHost";
        const string VPPORTTAG = "VPPort";

        /// <summary>
        /// Oracle: Tablespace, Postgre: Database
        /// </summary>
        const string VPDATABASETAG = "VPDatabase";
        const string VPUSERTAG = "VPUser";
        const string VPPASSWORDTAG = "VPPassword";

        /// <summary>
        /// Oracle: user, Postgre: schema
        /// </summary>
        const string VPSCHEMATAG = "VPSchema";

        const string VPPASSWORDSYSTEMTAG = "VPPasswordSystem";
        const string VPUSERLOGINTAG = "VPUserLogin";
        const string VPPASSWORDLOGINTAG = "VPPasswordLogin";
        #endregion

        #region CDHA
        /// <summary>
        /// Oracle: ServiceName,Postgre: Host
        /// </summary>
        const string CDHAHOSTTAG = "CDHAHost";
        const string CDHAPORTTAG = "CDHAPort";

        /// <summary>
        /// Oracle: Tablespace, Postgre: Database
        /// </summary>
        const string CDHADATABASETAG = "CDHADatabase";
        const string CDHAUSERTAG = "CDHAUser";
        const string CDHAPASSWORDTAG = "CDHAPassword";

        /// <summary>
        /// Oracle: user, Postgre: schema
        /// </summary>
        const string CDHASCHEMATAG = "CDHASchema";

        const string CDHAPASSWORDSYSTEMTAG = "CDHAPasswordSystem";
        const string CDHAUSERLOGINTAG = "CDHAUserLogin";
        const string CDHAPASSWORDLOGINTAG = "CDHAPasswordLogin";
        #endregion

        #region Xét nghiệm
        /// <summary>
        /// Oracle: ServiceName,Postgre: Host
        /// </summary>
        const string XNHOSTTAG = "XNHost";
        const string XNPORTTAG = "XNPort";

        /// <summary>
        /// Oracle: Tablespace, Postgre: Database
        /// </summary>
        const string XNDATABASETAG = "XNDatabase";
        const string XNUSERTAG = "XNUser";
        const string XNPASSWORDTAG = "XNPassword";

        /// <summary>
        /// Oracle: user, Postgre: schema
        /// </summary>
        const string XNSCHEMATAG = "XNSchema";

        const string XNPASSWORDSYSTEMTAG = "XNPasswordSystem";
        const string XNUSERLOGINTAG = "XNUserLogin";
        const string XNPASSWORDLOGINTAG = "XNPasswordLogin";
        #endregion
        public const string PATHRULE = "..//..//Medilinkxml//rule.xml";

        /// <summary>
        /// IP or server name nếu Oracle: services name
        /// </summary>
        internal static string sHost = "localhost";

        /// <summary>
        /// Port server cài database;
        /// Port server cài database, không tồn tại trong oracle (nếu có: 1521)
        /// </summary>
        internal static string sPort = "5432";

        /// <summary>
        /// PostgreSQL: User;
        /// User database, không cần phải giải mã hóa trước khi truyền vô;
        /// Oracle: không dùng thông số này
        /// </summary>
        internal static string sUserID = "medilink";

        /// <summary>
        /// PostgreSQL: Database; Oracle: Tablespace
        /// </summary>
        internal static string sDatabase = "medilink";

        /// <summary>
        /// PostgreSQL: Password user; Oracle: Password User
        /// </summary>
        internal static string sPassword = "medilink";

        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        internal static string sSchema = "medilink";

        /// <summary>
        /// Mật khẩu của user system, không có trong postgre
        /// </summary>
        internal static string sPasswordSystem = "system";

        /// <summary>
        /// User chứa table config
        /// </summary>
        internal static string sUsernameLogin = "login";

        /// <summary>
        /// Password của User chứa table config
        /// </summary>
        internal static string sPasswordLogin = "login";

        #region Dược
        /// <summary>
        /// IP or server name nếu Oracle: services name
        /// </summary>
        internal static string sDuocHost = "localhost";

        /// <summary>
        /// Port server cài database, không tồn tại trong oracle (nếu có: 1521)
        /// </summary>
        internal static string sDuocPort = "5432";

        /// <summary>
        /// PostgreSQL: User; Oracle: User
        /// </summary>
        internal static string sDuocUserID = "admin";

        /// <summary>
        /// PostgreSQL: Database; Oracle: Tablespace
        /// </summary>
        internal static string sDuocDatabase = "sm";

        /// <summary>
        /// PostgreSQL: Password database; Oracle: Password User
        /// </summary>
        internal static string sDuocPassword = "linh2809";

        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        internal static string sDuocSchema = "pis";

        /// <summary>
        /// Mật khẩu của user system, không có trong postgre
        /// </summary>
        internal static string sDuocPasswordSystem = "jqk";

        /// <summary>
        /// User chứa table config
        /// </summary>
        internal static string sDuocUsernameLogin = "jqk";

        /// <summary>
        /// Password của User chứa table config
        /// </summary>
        internal static string sDuocPasswordLogin = "jqk";
        #endregion

        #region Viện phí
        /// <summary>
        /// IP or server name nếu Oracle: services name
        /// </summary>
        internal static string sVPHost = "localhost";

        /// <summary>
        /// Port server cài database, không tồn tại trong oracle (nếu có: 1521)
        /// </summary>
        internal static string sVPPort = "5432";

        /// <summary>
        /// PostgreSQL: User; Oracle: User
        /// </summary>
        internal static string sVPUserID = "admin";

        /// <summary>
        /// PostgreSQL: Database; Oracle: Tablespace
        /// </summary>
        internal static string sVPDatabase = "sm";

        /// <summary>
        /// PostgreSQL: Password database; Oracle: Password User
        /// </summary>
        internal static string sVPPassword = "linh2809";

        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        internal static string sVPSchema = "pis";

        /// <summary>
        /// Mật khẩu của user system, không có trong postgre
        /// </summary>
        internal static string sVPPasswordSystem = "jqk";

        /// <summary>
        /// User chứa table config
        /// </summary>
        internal static string sVPUsernameLogin = "jqk";

        /// <summary>
        /// Password của User chứa table config
        /// </summary>
        internal static string sVPPasswordLogin = "jqk";
        #endregion

        #region CDHA
        /// <summary>
        /// IP or server name nếu Oracle: services name
        /// </summary>
        internal static string sCDHAHost = "localhost";

        /// <summary>
        /// Port server cài database, không tồn tại trong oracle (nếu có: 1521)
        /// </summary>
        internal static string sCDHAPort = "5432";

        /// <summary>
        /// PostgreSQL: User; Oracle: User
        /// </summary>
        internal static string sCDHAUserID = "admin";

        /// <summary>
        /// PostgreSQL: Database; Oracle: Tablespace
        /// </summary>
        internal static string sCDHADatabase = "sm";

        /// <summary>
        /// PostgreSQL: Password database; Oracle: Password User
        /// </summary>
        internal static string sCDHAPassword = "linh2809";

        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        internal static string sCDHASchema = "pis";

        /// <summary>
        /// Mật khẩu của user system, không có trong postgre
        /// </summary>
        internal static string sCDHAPasswordSystem = "jqk";

        /// <summary>
        /// User chứa table config
        /// </summary>
        internal static string sCDHAUsernameLogin = "jqk";

        /// <summary>
        /// Password của User chứa table config
        /// </summary>
        internal static string sCDHAPasswordLogin = "jqk";
        #endregion

        #region Xét Nghiệm
        /// <summary>
        /// IP or server name nếu Oracle: services name
        /// </summary>
        internal static string sXNHost = "localhost";

        /// <summary>
        /// Port server cài database, không tồn tại trong oracle (nếu có: 1521)
        /// </summary>
        internal static string sXNPort = "5432";

        /// <summary>
        /// PostgreSQL: User; Oracle: User
        /// </summary>
        internal static string sXNUserID = "admin";

        /// <summary>
        /// PostgreSQL: Database; Oracle: Tablespace
        /// </summary>
        internal static string sXNDatabase = "sm";

        /// <summary>
        /// PostgreSQL: Password database; Oracle: Password User
        /// </summary>
        internal static string sXNPassword = "linh2809";

        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        internal static string sXNSchema = "pis";

        /// <summary>
        /// Mật khẩu của user system, không có trong postgre
        /// </summary>
        internal static string sXNPasswordSystem = "jqk";

        /// <summary>
        /// User chứa table config
        /// </summary>
        internal static string sXNUsernameLogin = "jqk";

        /// <summary>
        /// Password của User chứa table config
        /// </summary>
        internal static string sXNPasswordLogin = "jqk";
        #endregion

        internal static string sConStr = "Server=localhost;Port=5432;User Id=admin;Password=linh2809;Database=medilink;Encoding=UNICODE;Pooling=true;";
        internal static string sDuocConStr = "Server=localhost;Port=5432;User Id=admin;Password=linh2809;Database=medilink;Encoding=UNICODE;Pooling=true;";
        internal static string sVPConStr = "Server=localhost;Port=5432;User Id=admin;Password=linh2809;Database=medilink;Encoding=UNICODE;Pooling=true;";
        internal static string sCDHAConStr = "Server=localhost;Port=5432;User Id=admin;Password=linh2809;Database=medilink;Encoding=UNICODE;Pooling=true;";
        internal static string sXNConStr = "Server=localhost;Port=5432;User Id=admin;Password=linh2809;Database=medilink;Encoding=UNICODE;Pooling=true;";
        internal static string sCallConStr = "Server=192.168.1.200;Port=5444;User Id=medilink;Password=123456;Database=medilinkcall;Encoding=UNICODE;Pooling=true;";
        internal static string sFileConfig = "";
        internal static string sNgonNgu = "";
        /// <summary>
        /// Mã hóa chuỗi
        /// </summary>
        static string sKey = "linh@28091989.";

        //linh 23/5/14
        static string sSchemaImage = "";
        static string sSchemaTracking = "";

        protected Database()
        {
            ReadConfig();
        }

        public Database(string s_NgonNgu)
            : this()
        {
#if POSTGRESQL
            iPhanHe = (int)PhanHePhanMem.PostgreSQL;
#elif MYSQL
                iPhanHe = (int) PhanHePhanMem.MySQL;
#elif SQLSERVER
                iPhanHe = (int) PhanHePhanMem.SQLServer;
#else
                iPhanHe = (int)PhanHePhanMem.Oracle;
#endif
            sNgonNgu = s_NgonNgu;
        }

        /// <summary>
        /// IP or Server name, trong Oracle: ServicesName
        /// </summary>
        public static string Host
        {
            get { return sHost; }
            set
            {
                sHost = value;
#if POSTGRESQL
                sConStr = "Server=" + sHost + ";Port=" + sPort + ";User Id=" + sUserID + ";Password=" + sPassword + ";Database=" + sDatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2";//linh 20/8/15
#else
                sConStr = "data source=" + sHost + ";User Id=" + sSchema + ";Password=" + sPassword;
#endif
            }
        }

        /// <summary>
        /// Port server cài database;
        /// Port server cài database, không tồn tại trong oracle (nếu có: 1521)
        /// </summary>
        public static string Port
        {
            get { return sPort; }
            set
            {
                sPort = value;
#if POSTGRESQL
                //chỉ có postgreSQL mới thay đổi connection, oracle, chỉ có 3 thông số: host, schema, password
                sConStr = "Server=" + sHost + ";Port=" + sPort + ";User Id=" + sUserID + ";Password=" + sPassword + ";Database=" + sDatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2";//linh 20/8/15
#endif
            }
        }

        /// <summary>
        /// PostgreSQL: User; 
        /// User database, không cần phải giải mã hóa trước khi truyền vô;
        /// Oracle: không dùng thông số này
        /// </summary>
        public static string User
        {
            get { return sUserID; }
            set
            {
                sUserID = value;

#if POSTGRESQL
                //chỉ có postgreSQL mới thay đổi connection, oracle, chỉ có 3 thông số: host, schema, password
                sConStr = "Server=" + sHost + ";Port=" + sPort + ";User Id=" + sUserID + ";Password=" + sPassword + ";Database=" + sDatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2";//linh 20/8/15
#endif
            }
        }

        /// <summary>
        /// PostgreSQL: Database; Oracle: Tablespace
        /// </summary>
        public static string DatabaseName
        {
            get { return sDatabase; }
            set
            {
                sDatabase = value.Trim();
#if POSTGRESQL
                //chỉ có postgreSQL mới thay đổi connection, oracle, chỉ có 3 thông số: host, schema, password
                sConStr = "Server=" + sHost + ";Port=" + sPort + ";User Id=" + sUserID + ";Password=" + sPassword + ";Database=" + sDatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2";//linh 20/8/15
#endif
            }
        }

        /// <summary>
        /// PostgreSQL: Password user; Oracle: Password User
        /// </summary>
        public static string Password
        {
            get { return sPassword; }
            set
            {
                sPassword = value;
#if POSTGRESQL
                sConStr = "Server=" + sHost + ";Port=" + sPort + ";User Id=" + sUserID + ";Password=" + sPassword + ";Database=" + sDatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2";//linh 20/8/15
#else
                sConStr = "data source=" + sHost + ";User Id=" + sSchema + ";Password=" + sPassword;
#endif
            }
        }

        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        public static string Schema
        {
            get
            {
                return sSchema;
            }
            set
            {
                sSchema = value;
#if POSTGRESQL
                sConStr = "Server=" + sHost + ";Port=" + sPort + ";User Id=" + sUserID + ";Password=" + sPassword + ";Database=" + sDatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2";//linh 20/8/15
#else
                sConStr = "data source=" + sHost + ";User Id=" + sSchema + ";Password=" + sPassword;
#endif
            }
        }

        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        public static string SchemaImage
        {
            get
            {
                return sSchemaImage;
            }
            set
            {
                sSchemaImage = value;
            }
        }
        //linh 17/9/14
        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        public static string SchemaTracking
        {
            get
            {
                return sSchemaTracking;
            }
            set
            {
                sSchemaTracking = value;
            }
        }

        /// <summary>
        /// Password user system trong oracle, không có trong postgre
        /// </summary>
        public static string PasswordSystem
        {
            get { return sPasswordSystem; }
            set { sPasswordSystem = value; }
        }

        /// <summary>
        /// User chứa table config
        /// </summary>
        public static string UsernameLogin
        {
            get { return sUsernameLogin; }
            set { sUsernameLogin = value; }
        }

        /// <summary>
        /// Password của user chứa table config
        /// </summary>
        public static string PasswordLogin
        {
            get { return sPasswordLogin; }
            set { sPasswordLogin = value; }
        }

        #region Dược
        /// <summary>
        /// IP or Server name, trong Oracle: ServicesName
        /// </summary>
        public static string DuocHost
        {
            get { return sDuocHost; }
            set
            {
                sDuocHost = value.Trim();
#if POSTGRESQL
                sDuocConStr = "Server=" + sDuocHost + ";Port=" + sDuocPort + ";User Id=" + sDuocUserID + ";Password=" + sDuocPassword + ";Database=" + sDuocDatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sDuocConStr = "data source=" + sDuocHost + ";User Id=" + sDuocSchema + ";Password=" + sDuocPassword;
#endif
            }
        }

        /// <summary>
        /// Port server cài database
        /// </summary>
        public static string DuocPort
        {
            get { return sDuocPort; }
            set
            {
                sDuocPort = value.Trim();
#if POSTGRESQL
                sDuocConStr = "Server=" + sDuocHost + ";Port=" + sDuocPort + ";User Id=" + sDuocUserID + ";Password=" + sDuocPassword + ";Database=" + sDuocDatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// User database
        /// </summary>
        public static string DuocUser
        {
            get { return sDuocUserID; }
            set
            {
                sDuocUserID = value.Trim();
#if POSTGRESQL
                //chỉ có postgreSQL mới thay đổi connection, oracle, chỉ có 3 thông số: host, schema, password
                sDuocConStr = "Server=" + sDuocHost + ";Port=" + sDuocPort + ";User Id=" + sDuocUserID + ";Password=" + sDuocPassword + ";Database=" + sDuocDatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// Database name
        /// </summary>
        public static string DuocDatabaseName
        {
            get { return sDuocDatabase; }
            set
            {
                sDuocDatabase = value.Trim();
#if POSTGRESQL
                //chỉ có postgreSQL mới thay đổi connection, oracle, chỉ có 3 thông số: host, schema, password
                sDuocConStr = "Server=" + sDuocHost + ";Port=" + sDuocPort + ";User Id=" + sDuocUserID + ";Password=" + sDuocPassword + ";Database=" + sDuocDatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// Password database
        /// </summary>
        public static string DuocPassword
        {
            get { return sDuocPassword; }
            set
            {
                sDuocPassword = value.Trim();
#if POSTGRESQL
                sDuocConStr = "Server=" + sDuocHost + ";Port=" + sDuocPort + ";User Id=" + sDuocUserID + ";Password=" + sDuocPassword + ";Database=" + sDuocDatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sDuocConStr = "data source=" + sDuocHost + ";User Id=" + sDuocSchema + ";Password=" + sDuocPassword;
#endif
            }
        }

        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        public static string DuocSchema
        {
            get
            {
                return sDuocSchema;
            }
            set
            {
                sDuocSchema = value.Trim();
#if POSTGRESQL
                sDuocConStr = "Server=" + sDuocHost + ";Port=" + sDuocPort + ";User Id=" + sDuocUserID + ";Password=" + sDuocPassword + ";Database=" + sDuocDatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sDuocConStr = "data source=" + sDuocHost + ";User Id=" + sDuocSchema + ";Password=" + sDuocPassword;
#endif
            }
        }

        /// <summary>
        /// Password user system trong oracle, không có trong postgre
        /// </summary>
        public static string DuocPasswordSystem
        {
            get { return sDuocPasswordSystem; }
            set { sDuocPasswordSystem = value.Trim(); }
        }

        /// <summary>
        /// User chứa table config
        /// </summary>
        public static string DuocUsernameLogin
        {
            get { return sDuocUsernameLogin; }
            set { sDuocUsernameLogin = value.Trim(); }
        }

        /// <summary>
        /// Password của user chứa table config
        /// </summary>
        public static string DuocPasswordLogin
        {
            get { return sDuocPasswordLogin; }
            set { sDuocPasswordLogin = value.Trim(); }
        }
        #endregion

        #region Viện phí
        /// <summary>
        /// IP or Server name, trong Oracle: ServicesName
        /// </summary>
        public static string VPHost
        {
            get { return sVPHost; }
            set
            {
                sVPHost = value.Trim();
#if POSTGRESQL
                sVPConStr = "Server=" + sVPHost + ";Port=" + sVPPort + ";User Id=" + sVPUserID + ";Password=" + sVPPassword + ";Database=" + sVPDatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sVPConStr = "data source=" + sVPHost + ";User Id=" + sVPSchema + ";Password=" + sVPPassword;
#endif
            }
        }

        /// <summary>
        /// Port server cài database
        /// </summary>
        public static string VPPort
        {
            get { return sVPPort; }
            set
            {
                sVPPort = value.Trim();
#if POSTGRESQL
                sVPConStr = "Server=" + sVPHost + ";Port=" + sVPPort + ";User Id=" + sVPUserID + ";Password=" + sVPPassword + ";Database=" + sVPDatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// User database
        /// </summary>
        public static string VPUser
        {
            get { return sVPUserID; }
            set
            {
                sVPUserID = value.Trim();
#if POSTGRESQL
                sVPConStr = "Server=" + sVPHost + ";Port=" + sVPPort + ";User Id=" + sVPUserID + ";Password=" + sVPPassword + ";Database=" + sVPDatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// Database name
        /// </summary>
        public static string VPDatabaseName
        {
            get { return sVPDatabase; }
            set
            {
                sVPDatabase = value.Trim();
#if POSTGRESQL
                sVPConStr = "Server=" + sVPHost + ";Port=" + sVPPort + ";User Id=" + sVPUserID + ";Password=" + sVPPassword + ";Database=" + sVPDatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// Password database
        /// </summary>
        public static string VPPassword
        {
            get { return sVPPassword; }
            set
            {
                sVPPassword = value.Trim();
#if POSTGRESQL
                sVPConStr = "Server=" + sVPHost + ";Port=" + sVPPort + ";User Id=" + sVPUserID + ";Password=" + sVPPassword + ";Database=" + sVPDatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sVPConStr = "data source=" + sVPHost + ";User Id=" + sVPSchema + ";Password=" + sVPPassword;
#endif
            }
        }

        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        public static string VPSchema
        {
            get
            {
                return sVPSchema;
            }
            set
            {
                sVPSchema = value.Trim();
#if POSTGRESQL
                sVPConStr = "Server=" + sVPHost + ";Port=" + sVPPort + ";User Id=" + sVPUserID + ";Password=" + sVPPassword + ";Database=" + sVPDatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sVPConStr = "data source=" + sVPHost + ";User Id=" + sVPSchema + ";Password=" + sVPPassword;
#endif
            }
        }

        /// <summary>
        /// Password user system trong oracle, không có trong postgre
        /// </summary>
        public static string VPPasswordSystem
        {
            get { return sVPPasswordSystem; }
            set { sVPPasswordSystem = value.Trim(); }
        }

        /// <summary>
        /// User chứa table config
        /// </summary>
        public static string VPUsernameLogin
        {
            get { return sVPUsernameLogin; }
            set { sVPUsernameLogin = value.Trim(); }
        }

        /// <summary>
        /// Password của user chứa table config
        /// </summary>
        public static string VPPasswordLogin
        {
            get { return sVPPasswordLogin; }
            set { sVPPasswordLogin = value.Trim(); }
        }
        #endregion

        #region CDHA
        /// <summary>
        /// IP or Server name, trong Oracle: ServicesName
        /// </summary>
        public static string CDHAHost
        {
            get { return sCDHAHost; }
            set
            {
                sCDHAHost = value.Trim();
#if POSTGRESQL
                sCDHAConStr = "Server=" + sCDHAHost + ";Port=" + sCDHAPort + ";User Id=" + sCDHAUserID + ";Password=" + sCDHAPassword + ";Database=" + sCDHADatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sCDHAConStr = "data source=" + sCDHAHost + ";User Id=" + sCDHASchema + ";Password=" + sCDHAPassword;
#endif
            }
        }

        /// <summary>
        /// Port server cài database
        /// </summary>
        public static string CDHAPort
        {
            get { return sCDHAPort; }
            set
            {
                sCDHAPort = value.Trim();
#if POSTGRESQL
                sCDHAConStr = "Server=" + sCDHAHost + ";Port=" + sCDHAPort + ";User Id=" + sCDHAUserID + ";Password=" + sCDHAPassword + ";Database=" + sCDHADatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// User database
        /// </summary>
        public static string CDHAUser
        {
            get { return sCDHAUserID; }
            set
            {
                sCDHAUserID = value.Trim();
#if POSTGRESQL
                sCDHAConStr = "Server=" + sCDHAHost + ";Port=" + sCDHAPort + ";User Id=" + sCDHAUserID + ";Password=" + sCDHAPassword + ";Database=" + sCDHADatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// Database name
        /// </summary>
        public static string CDHADatabaseName
        {
            get { return sCDHADatabase; }
            set
            {
                sCDHADatabase = value.Trim();
#if POSTGRESQL
                sCDHAConStr = "Server=" + sCDHAHost + ";Port=" + sCDHAPort + ";User Id=" + sCDHAUserID + ";Password=" + sCDHAPassword + ";Database=" + sCDHADatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// Password database
        /// </summary>
        public static string CDHAPassword
        {
            get { return sCDHAPassword; }
            set
            {
                sCDHAPassword = value.Trim();
#if POSTGRESQL
                sCDHAConStr = "Server=" + sCDHAHost + ";Port=" + sCDHAPort + ";User Id=" + sCDHAUserID + ";Password=" + sCDHAPassword + ";Database=" + sCDHADatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sCDHAConStr = "data source=" + sCDHAHost + ";User Id=" + sCDHASchema + ";Password=" + sCDHAPassword;
#endif
            }
        }

        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        public static string CDHASchema
        {
            get
            {
                return sCDHASchema;
            }
            set
            {
                sCDHASchema = value.Trim();
#if POSTGRESQL
                sCDHAConStr = "Server=" + sCDHAHost + ";Port=" + sCDHAPort + ";User Id=" + sCDHAUserID + ";Password=" + sCDHAPassword + ";Database=" + sCDHADatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sCDHAConStr = "data source=" + sCDHAHost + ";User Id=" + sCDHASchema + ";Password=" + sCDHAPassword;
#endif
            }
        }

        /// <summary>
        /// Password user system trong oracle, không có trong postgre
        /// </summary>
        public static string CDHAPasswordSystem
        {
            get { return sCDHAPasswordSystem; }
            set { sCDHAPasswordSystem = value.Trim(); }
        }

        /// <summary>
        /// User chứa table config
        /// </summary>
        public static string CDHAUsernameLogin
        {
            get { return sCDHAUsernameLogin; }
            set { sCDHAUsernameLogin = value.Trim(); }
        }

        /// <summary>
        /// Password của user chứa table config
        /// </summary>
        public static string CDHAPasswordLogin
        {
            get { return sCDHAPasswordLogin; }
            set { sCDHAPasswordLogin = value.Trim(); }
        }
        #endregion

        #region XN
        /// <summary>
        /// IP or Server name, trong Oracle: ServicesName
        /// </summary>
        public static string XNHost
        {
            get { return sXNHost; }
            set
            {
                sXNHost = value.Trim();
#if POSTGRESQL
                sXNConStr = "Server=" + sXNHost + ";Port=" + sXNPort + ";User Id=" + sXNUserID + ";Password=" + sXNPassword + ";Database=" + sXNDatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sXNConStr = "data source=" + sXNHost + ";User Id=" + sXNSchema + ";Password=" + sXNPassword;
#endif
            }
        }

        /// <summary>
        /// Port server cài database
        /// </summary>
        public static string XNPort
        {
            get { return sXNPort; }
            set
            {
                sXNPort = value.Trim();
#if POSTGRESQL
                sXNConStr = "Server=" + sXNHost + ";Port=" + sXNPort + ";User Id=" + sXNUserID + ";Password=" + sXNPassword + ";Database=" + sXNDatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// User database
        /// </summary>
        public static string XNUser
        {
            get { return sXNUserID; }
            set
            {
                sXNUserID = value.Trim();
#if POSTGRESQL
                sXNConStr = "Server=" + sXNHost + ";Port=" + sXNPort + ";User Id=" + sXNUserID + ";Password=" + sXNPassword + ";Database=" + sXNDatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// Database name
        /// </summary>
        public static string XNDatabaseName
        {
            get { return sXNDatabase; }
            set
            {
                sXNDatabase = value.Trim();
#if POSTGRESQL
                sXNConStr = "Server=" + sXNHost + ";Port=" + sXNPort + ";User Id=" + sXNUserID + ";Password=" + sXNPassword + ";Database=" + sXNDatabase + ";Encoding=UNICODE;Pooling=true;";
#endif
            }
        }

        /// <summary>
        /// Password database
        /// </summary>
        public static string XNPassword
        {
            get { return sXNPassword; }
            set
            {
                sXNPassword = value.Trim();
#if POSTGRESQL
                sXNConStr = "Server=" + sXNHost + ";Port=" + sXNPort + ";User Id=" + sXNUserID + ";Password=" + sXNPassword + ";Database=" + sXNDatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sXNConStr = "data source=" + sXNHost + ";User Id=" + sXNSchema + ";Password=" + sXNPassword;
#endif
            }
        }

        /// <summary>
        /// PostgreSQL: Schema, trong Oracle : User
        /// </summary>
        public static string XNSchema
        {
            get
            {
                return sXNSchema;
            }
            set
            {
                sXNSchema = value.Trim();
#if POSTGRESQL
                sXNConStr = "Server=" + sXNHost + ";Port=" + sXNPort + ";User Id=" + sXNUserID + ";Password=" + sXNPassword + ";Database=" + sXNDatabase + ";Encoding=UNICODE;Pooling=true;";
#else
                sXNConStr = "data source=" + sXNHost + ";User Id=" + sXNSchema + ";Password=" + sXNPassword;
#endif
            }
        }

        /// <summary>
        /// Password user system trong oracle, không có trong postgre
        /// </summary>
        public static string XNPasswordSystem
        {
            get { return sXNPasswordSystem; }
            set { sXNPasswordSystem = value.Trim(); }
        }

        /// <summary>
        /// User chứa table config
        /// </summary>
        public static string XNUsernameLogin
        {
            get { return sXNUsernameLogin; }
            set { sXNUsernameLogin = value.Trim(); }
        }

        /// <summary>
        /// Password của user chứa table config
        /// </summary>
        public static string XNPasswordLogin
        {
            get { return sXNPasswordLogin; }
            set { sXNPasswordLogin = value.Trim(); }
        }
        #endregion

        /// <summary>
        /// Ngôn ngữ
        /// </summary>
        public string NgonNgu
        {
            get { return sNgonNgu; }
            set { sNgonNgu = value; }
        }

        /// <summary>
        /// Key để mã hóa dữ liệu, chỉ cho công ty biết, USER không được biết.
        /// </summary>
        static public string Key
        {
            get { return sKey; }
        }

        public int CreateDatabase(MDBConnection mdbCon)
        {
            int iVal = 0;
            try
            {
                if (this.ExistDatabase(mdbCon))
                {
                    iVal = this.CreateSchema(mdbCon);
                    iVal = this.CreateSchema(mdbCon, Database.sSchemaImage);
                    iVal = this.CreateSchema(mdbCon, Database.sSchemaTracking);
                    if (iVal != (int)LoiTaoDatabase.SchemaKhongTaoDuoc)
                    {
                        CreateTable(mdbCon);
                        CreateTableTracking(mdbCon);
                        CreateTrigerPG(mdbCon);//Tú:19/12/2014
                        iVal = 0;
                    }
                }
                else
                {
                    iVal = (int)LoiTaoDatabase.DatabaseChuaTao;
                }
            }
            catch
            {
                iVal = (int)LoiTaoDatabase.DatabaseKhongTaoDuocCauTruc;
            }
            return iVal;
        }

        /// <summary>
        /// Tạo Schema, chương trình nếu chưa tạo schema
        /// </summary>
        /// <param name="_con"></param>
        int CreateSchema(MDBConnection mdbCon)
        {
            int iVal = this.CreateSchema(mdbCon, sSchema);
            return iVal;
        }

        /// <summary>
        /// Tạo Schema, chương trình nếu chưa tạo schema
        /// </summary>
        /// <param name="_con"></param>
        public int CreateSchema(MDBConnection mdbCon, string s_Schema)
        {
            int iVal = 0;
            if (!ExistSchema(mdbCon, s_Schema))
            {
                try
                {
#if POSTGRESQL
                    string s_sql = "CREATE SCHEMA " + s_Schema + " AUTHORIZATION " + sUserID + ";";
                    MDBCommand com = new MDBCommand(s_sql, mdbCon);
                    com.ExecuteNonQuery();
#else
                    string s_sql = "CREATE USER " + s_Schema + " IDENTIFIED BY " + sPassword + " DEFAULT TABLESPACE " + sDatabase + " QUOTA 100M ON " + sDatabase+"";
                    MDBCommand com = new MDBCommand(s_sql, mdbCon);
                    com.CommandType = CommandType.Text;
                    com.ExecuteNonQuery();

                    s_sql = " GRANT CREATE SESSION, IMP_FULL_DATABASE TO " + s_Schema +"";
                    com = new MDBCommand(s_sql, mdbCon);
                    com.CommandType = CommandType.Text;
                    com.ExecuteNonQuery();

                    s_sql = " GRANT JAVASYSPRIV, JAVAUSERPRIV TO " + s_Schema +"";
                    com = new MDBCommand(s_sql, mdbCon);
                    com.CommandType = CommandType.Text;
                    com.ExecuteNonQuery();

                    s_sql = " GRANT ALL PRIVILEGES TO " + s_Schema +"";
                    com = new MDBCommand(s_sql, mdbCon);
                    com.CommandType = CommandType.Text;
                    com.ExecuteNonQuery();
#endif

                }
                catch
                {
                    iVal = (int)LoiTaoDatabase.SchemaKhongTaoDuoc;
                }
            }

            return iVal;
        }

        //khuong 06/05/2014
        /// <summary>
        /// Kiểm tra xem schema đã tồn tại chưa? nếu oracle kiểm tra user
        /// </summary>
        /// <returns></returns>
        bool ExistSchema(MDBConnection mdbCon)
        {
            bool b_Val = this.ExistSchema(mdbCon, Schema);
            return b_Val;
        }

        /// <summary>
        /// Kiểm tra xem schema (trong postgre)| User (trong oracle) đã tồn tại chưa
        /// </summary>
        /// <returns></returns>
        public bool ExistSchema(MDBConnection mdbCon, string s_Schema)
        {
            try
            {
#if POSTGRESQL
                string s_sql = "select nspname from pg_catalog.pg_namespace where lower(nspname)='" + s_Schema.ToLower() + "'";
#else
                string s_sql = "select username from dba_users where lower(username)='" + s_Schema.ToLower() + "'";
#endif
                MDBDataAdapter adt = new MDBDataAdapter(s_sql, mdbCon);
                DataTable dt = new DataTable();
                adt.Fill(dt);
                return dt.Rows.Count > 0;
            }
            catch
            {
                return false;
            }
        }

        /// <summary>
        /// Kiểm tra xem Database được tạo hay chưa? neu otacle kiem tra tablespace
        /// </summary>
        /// <returns></returns>
        bool ExistDatabase(MDBConnection mdbCon)
        {
            try
            {
#if POSTGRESQL
                string s_sql = "select datname from pg_database where lower(datname)='" + sDatabase.ToLower() + "'";
#else
                string s_sql = "select tablespace_name from dba_tablespaces where lower(tablespace_name)='" + sDatabase.ToLower() + "'";
#endif
                MDBDataAdapter adt = new MDBDataAdapter(s_sql, mdbCon);
                DataTable dt = new DataTable();
                adt.Fill(dt);
                if (dt.Rows.Count > 0) { return true; }
            }
            catch
            {
                return false;
            }
            return true;
        }

        /// <summary>
        /// Kiểm tra xem tablespace đã tông tại hay chưa?
        /// </summary>
        /// <param name="mdbCon"></param>
        /// <param name="s_Tablespace"></param>
        /// <returns></returns>
        public static bool ExistTablespace(MDBConnection mdbCon, string s_Tablespace)//linh 17/9/14
        {
#if POSTGRESQL
            string s_Sql = "SELECT * FROM pg_tablespace WHERE lower(spcname) = '" + s_Tablespace.ToLower() + "'";
            MDBDataAdapter mdbAdt = new MDBDataAdapter(s_Sql, mdbCon);
            DataTable dt = new DataTable();
            mdbAdt.Fill(dt);
            if (dt.Rows.Count == 0)
            {
                return false;
            }
            return true;
#else
            string s_Sql = "select TABLESPACE_NAME from dba_tablespaces where lower(TABLESPACE_NAME)='" + s_Tablespace.ToLower() + "'";
            MDBDataAdapter mdbAdt = new MDBDataAdapter(s_Sql, mdbCon);
            DataTable dt = new DataTable();
            mdbAdt.Fill(dt);
            if (dt.Rows.Count == 0)
            {
                return false;
            }
            return true;
#endif
        }

        /// <summary>
        /// Tạo table trong schema.
        /// Benhnhan: table bắt đầu: p_;
        /// Vienphi: table bắt đầu: b_;
        /// Duoc: table bắt đầu: m_;
        /// CDHA: table bắt đầu: r_;
        /// xet nghiem: table bắt đầu: l_;
        /// </summary>
        /// <param name="mdbCon">Connection phải được open</param>
        void CreateTable(MDBConnection mdbCon)
        {
            DataTable dtAllColumn = new DataTable();
            //for (int i = 0; i < 2; i++) //linh bỏ thử (nếu tạo lần 1 bị lỗi, thì bấm tạo lần 2 - đỡ bị chậm)
            {
#if POSTGRESQL
                //ThanhCuong - 22/05/2015
                string s_Sql = "";
                try
                {
                    string s_Exp = "";
                    for (int j = 0; j < 2; j++)
                    {
                        s_Exp += " and table_name not like '%_" + j + "%' ";
                    }
                    s_Sql = "SELECT lower(table_name) table_name,lower(column_name) column_name FROM information_schema.columns WHERE table_schema ='" + sSchema + "'" + s_Exp;
                    MDBDataAdapter mdbAdt = new MDBDataAdapter(s_Sql, mdbCon);
                    mdbAdt.Fill(dtAllColumn);
                }
                catch
                {
                    dtAllColumn = new DataTable();
                    dtAllColumn.Columns.Add("table_name", typeof(string)).DefaultValue = "";
                    dtAllColumn.Columns.Add("column_name", typeof(string)).DefaultValue = "";
                }
                s_Sql = "";
                DataRow[] r_Col = null;
                MDBCommand cmd = null;
                r_Col = dtAllColumn.Select("table_name='m_dmnhomkho'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql = "create table " + sSchema + ".m_dmnhomkho(idnhomkho number(2) default 0, tennhomkho text, tenkhongdau character varying(150), loai number(1) default 0 not null ," +
                    " computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmnhomkho OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".m_dmnhomkho add constraint pk_m_dmnhomkho primary key(idnhomkho);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmuser'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmuser(iddmuser number(5) DEFAULT 0,username character varying(20) not null,tenuser text," +
                        " matkhau character varying(20) not null,manhanvien character varying(4),nhomuser number(1) default 3,khoaaccount number(1) default 0 not null," +
                        " tenkhongdau character varying(150),computer character varying(50),NGAYUD timestamp without time zone DEFAULT sysdate,idnhomkho number(2) default 1 not null)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmuser OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmuser add constraint pk_dmuser primary key(iddmuser);\n";
                s_Sql += "alter table " + sSchema + ".p_dmuser add constraint fk_dmuser_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + ".p_dmuser add constraint un_dmuser_username unique(username);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmvungbenhvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmvungbenhvien(mavung character varying(2),tenvung text not null,dongbo character varying(100) default lpad('0',100,'0'),tenkhongdau character varying(150)," +
                       " ngayud timestamp without time zone default sysdate,username character varying(50),computer character varying(50)) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmuser OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmvungbenhvien add constraint pk_dmvungbenhvien primary key(mavung);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmtinhthanh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmtinhthanh(matinhthanh character varying(3),tentinhthanh text not null,mavung character varying(2)," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmtinhthanh OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmtinhthanh add constraint pk_dmtinhthanh primary key(matinhthanh);\n";
                s_Sql += "alter table " + sSchema + ".p_dmtinhthanh add constraint fk_dmtinhthanh_dmvungbv foreign key(mavung) references " + sSchema + ".p_dmvungbenhvien(mavung) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmquanhuyen'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmquanhuyen(maquanhuyen character varying(5),tenquanhuyen text not null,matinhthanh character varying(3)," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmquanhuyen OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmquanhuyen add constraint pk_dmquanhuyen primary key(maquanhuyen);\n";
                s_Sql += "alter table " + sSchema + ".p_dmquanhuyen add constraint fk_dmquanhuyen_dmtinhthanh foreign key(matinhthanh) references " + sSchema + ".p_dmtinhthanh(matinhthanh) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmphuongxa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmphuongxa(maphuongxa character varying(7),tenphuongxa text not null,maquanhuyen character varying(5),viettat character varying(10)," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmphuongxa OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmphuongxa add constraint pk_dmphuongxa primary key(maphuongxa);\n";
                s_Sql += "alter table " + sSchema + ".p_dmphuongxa add constraint fk_dmphuongxa_dmquanhuyen foreign key(maquanhuyen) references " + sSchema + ".p_dmquanhuyen(maquanhuyen) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmcomputer'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmcomputer(idcomputer number(5),tencomputer text not null,benhnhan character varying(50)," +
                    " duoc character varying(50),vienphi character varying(50),xetnghiem character varying(50),cdha character varying(50),mau character varying(50),ttb character varying(50)," +
                    " tenkhongdau character varying(150),keys character varying(4000), license character varying(4000),dongbo character varying(100) default lpad('0',100,'0'),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmcomputer OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmcomputer add constraint pk_dmcomputer primary key(idcomputer);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmdantoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmdantoc(madantoc character varying(3),tendantoc text not null," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmdantoc OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmdantoc add constraint pk_dmdantoc primary key(madantoc);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmdoituong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmdoituong(madoituong number(2),tendoituong text not null,fieldgia character varying(50)," +
                    " chieudaisothe character varying(50),nhapsothe number(1) default 0 not null,nhapngay number(1) default 0 not null,nhapnoidkkcb number(1) default 0 not null," +
                    " mien number(1) default 0 not null,trasau number(1) default 0 not null,nhapcholam number(1) default 0 not null,tinhchenhlech number(1) default 0," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmdoituong OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmdoituong add constraint pk_dmdoituong primary key(madoituong);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmnghenghiep'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnghenghiep(manghenghiep character varying(2),tennghenghiep text not null," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnghenghiep OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmnghenghiep add constraint pk_dmnghenghiep primary key(manghenghiep);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmnghenghiepbenhvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnghenghiepbenhvien(manghenghiep character varying(3),tennghenghiep text not null," +
                    " tenkhongdau character varying(150),manghenghiepbo character varying(2),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnghenghiepbenhvien OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmnghenghiepbenhvien add constraint pk_dmnghenghiepbv primary key(manghenghiep);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmnghenghiepbenhvien add constraint fk_dmnnbv_dmnn foreign key(manghenghiepbo) references " + sSchema + ".p_dmnghenghiep(manghenghiep) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmtuyenbenhvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmtuyenbenhvien(matuyenbenhvien character varying(2),tentuyenbenhvien text not null," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmtuyenbenhvien OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmtuyenbenhvien add constraint pk_dmtuyenbv primary key(matuyenbenhvien);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmloaibenhvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmloaibenhvien(maloaibenhvien character varying(5),tenloaibenhvien text not null," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmloaibenhvien OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmloaibenhvien add constraint pk_dmloaibv primary key(maloaibenhvien);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmbenhvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmbenhvien(mabenhvien character varying(10),tenbenhvien text not null,diachi text,dienthoai character varying(50),matuyenbenhvien character varying(2),maloaibenhvien character varying(5)," +
                    " hangbenhvien number(1) default 0 not null,matinhthanh character varying(3),fax character varying(20),mail character varying(150),masothue character varying(12),nganhang text,giamdoc text,phogiamdoc text,ketoan text," +
                    " tenkhongdau character varying(150),quantrimang text,manoidkkcb character varying(10),dongbo character varying(100) default lpad('0',100,'0'),ngayud timestamp without time zone default sysdate,username character varying(50),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmbenhvien OWNER TO " + sUserID + ";\n";
                   }
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhvien add constraint pk_p_dmbenhvien primary key(mabenhvien,manoidkkcb);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhvien add constraint fk_dmbv_dmtuyenbv foreign key(matuyenbenhvien) references " + sSchema + ".p_dmtuyenbenhvien(matuyenbenhvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhvien add constraint fk_dmbv_dmloaibv foreign key(maloaibenhvien) references " + sSchema + ".p_dmloaibenhvien(maloaibenhvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhvien add constraint fk_dmbv_dmtt foreign key(matinhthanh) references " + sSchema + ".p_dmtinhthanh(matinhthanh) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmchuongicd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmchuongicd(idchuongicd number(2),tenchuongicd text not null," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmchuongicd OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmchuongicd add constraint pk_dmchuongicd primary key(idchuongicd);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmnhomicd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnhomicd(idnhomicd number(3),tennhomicd text not null,idchuongicd number(2)," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnhomicd OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhomicd add constraint pk_dmnhomicd primary key(idnhomicd);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhomicd add constraint fk_dmnhomicd_chuongicd foreign key(idchuongicd) references " + sSchema + ".p_dmchuongicd(idchuongicd) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmicd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmicd(maicd character varying(10),tenicd text not null,idnhomicd number(3)," +
                    " tenkhongdau character varying(2000),manhombaocao character varying(10),sttnhombaocao character varying(10),benhmantinh number(1) default 0 not null," +
                    " ngayud timestamp without time zone default sysdate,username character varying(50),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmicd OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmicd add constraint pk_dmicd primary key(maicd);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmicd add constraint fk_dmicd_dmnhomicd foreign key(idnhomicd) references " + sSchema + ".p_dmnhomicd(idnhomicd) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmkhoaphong(makhoaphong character varying(2),tenkhoaphong text not null," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmkhoaphong OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmkhoaphong add constraint pk_dmkhoaphong primary key(makhoaphong);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmnhomkhoaphong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnhomkhoaphong(idnhomkhoaphong number(2),tennhomkhoaphong text not null," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnhomkhoaphong OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhomkhoaphong add constraint pk_dmnhomkp primary key(idnhomkhoaphong);\n";
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='b_dmnhomvienphibhyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_dmnhomvienphibhyt(idnhomvienphi number(3),tennhomvienphi text,viettat character varying(10) not null," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_dmnhomvienphibhyt OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".b_dmnhomvienphibhyt add constraint pk_nhomvpbhyt primary key(idnhomvienphi);\n";
                s_Sql += "alter TABLE " + sSchema + ".b_dmnhomvienphibhyt add constraint un_nhomvpbhyt_vietat unique(viettat);\n";
                r_Col = dtAllColumn.Select("table_name='b_dmnhomvienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_dmnhomvienphi(idnhomvienphi number(5),tennhomvienphi text,idnhomvienphibhyt number(3)," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_dmnhomvienphi OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".b_dmnhomvienphi add constraint pk_nhomvp primary key(idnhomvienphi);\n";
                s_Sql += "alter TABLE " + sSchema + ".b_dmnhomvienphi add constraint fk_nhomvp_nhomvpbhyt foreign key(idnhomvienphibhyt) references " + sSchema + ".b_dmnhomvienphibhyt(idnhomvienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='b_dmloaivienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_dmloaivienphi(idloaivienphi number(5),tenloaivienphi text,idnhomvienphi number(5),maloaivienphi character varying(10)," +
                    " tenkhongdau character varying(150),dongbo character varying(100) default lpad('0',100,'0'),ngayud timestamp without time zone default sysdate,username character varying(50),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_dmloaivienphi OWNER TO " + sUserID + ";\n";
                   
                }
                s_Sql += "alter TABLE " + sSchema + ".b_dmloaivienphi add constraint pk_loaivp primary key(idloaivienphi);\n";
                s_Sql += "alter TABLE " + sSchema + ".b_dmloaivienphi add constraint fk_loaivp_nhomvp foreign key(idnhomvienphi) references " + sSchema + ".b_dmnhomvienphi(idnhomvienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_dmgiavienphi(idgiavienphi number(7),tengiavienphi text,idloaivienphi number(5)," +
                    " mavp character varying(20),dvt text,bhyt number(5,2) default 0 not null,gia_th number(14,3) default 0 not null,gia_bh number(14,3) default 0 not null," +
                    " gia_cs number(14,3) default 0 not null,gia_dv number(14,3) default 0 not null,gia_nn number(14,3) default 0 not null," +
                    " gia_ksk number(14,3) default 0 not null,gia_vip number(14,3) default 0 not null,hide number(1) default 0 not null," +
                    " kythuat number(1) default 0 not null,bhyt_traituyen number(5,2) default 0 not null," +
                    " tenkhongdau character varying(500),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_dmgiavienphi OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".b_dmgiavienphi add constraint pk_giavp primary key(idgiavienphi);\n";
                s_Sql += "alter TABLE " + sSchema + ".b_dmgiavienphi add constraint fk_giavp_loaivp foreign key(idloaivienphi) references " + sSchema + ".b_dmloaivienphi(idloaivienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".b_dmgiavienphi add constraint uk_giavp_mavp unique(mavp);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong number(3),makhoaphong character varying(3),tenkhoaphong text not null," +
                    " makhoaphongbo character varying(3),giuongkehoach number(3) default 0 not null,giuongthucke number(3) default 0 not null,sudung number(1) default 1 not null," +
                    " idnhomkhoaphong number(2),idmavpcongkham number(7) default 0 not null,idmavptaikham number(7) default 0 not null,viettat character varying(15)," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50),dauso number(1) default 0 not null)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmkhoaphongbenhvien OWNER TO " + sUserID + ";\n";
                   
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmkhoaphongbenhvien add constraint pk_dmkhoaphongbv primary key(idkhoaphong);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmkhoaphongbenhvien add constraint fk_dmkpbv_dmkp foreign key(makhoaphongbo) references " + sSchema + ".p_dmkhoaphong(makhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmkhoaphongbenhvien add constraint fk_dmkpbv_dmnhomkp foreign key(idnhomkhoaphong) references " + sSchema + ".p_dmnhomkhoaphong(idnhomkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmkhoaphongbenhvien add constraint fk_dmkpbv_dmgiavp_ck foreign key(idmavpcongkham) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmkhoaphongbenhvien add constraint fk_dmkpbv_dmgiavp_tk foreign key(idmavptaikham) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmkhoaphongbenhvien add constraint uk_dmkpbv_makp unique(makhoaphong);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmbenhan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmbenhan(idbenhan number(2), mabenhan character varying(3) not null,tenbenhan text not null,sudung number(1)," +
                    " tenkhongdau character varying(150),loaibenhan number(1) default 0 not null,ngayud timestamp without time zone default sysdate,username character varying(50)," +
                    " tiensubanthan text,tiensugiadinh text,dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmbenhan OWNER TO " + sUserID + ";\n";
                   
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhan add constraint pk_dmbenhan primary key(idbenhan);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhan add constraint un_dmbenhan_maba unique(mabenhan);\n";
                r_Col = dtAllColumn.Select("table_name='p_khoaphongbenhan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_khoaphongbenhan(idkhoaphong number(3),idbenhan number(2)," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_khoaphongbenhan OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".p_khoaphongbenhan add constraint pk_khoaphongbanhan primary key(idkhoaphong,idbenhan);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_khoaphongbenhan add constraint fk_dmkpba_dmkhoaphong foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_khoaphongbenhan add constraint fk_dmkpba_dmbenhan foreign key(idbenhan) references " + sSchema + ".p_dmbenhan(idbenhan) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_khoaphonggiavienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_khoaphonggiavienphi(idkhoaphong number(3),idgiavienphi number(2)," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_khoaphonggiavienphi OWNER TO " + sUserID + ";\n";
                   
                }
                s_Sql += "alter TABLE " + sSchema + ".p_khoaphonggiavienphi add constraint pk_khoaphonggiavp primary key(idkhoaphong,idgiavienphi);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_khoaphonggiavienphi add constraint fk_dmkpvp_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_khoaphonggiavienphi add constraint fk_dmkpvp_dmgiavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_thongso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_thongso(id number(5),ten text,dongbo character varying(100) default lpad('0',100,'0')," +
                    " diengiai text,val text,noidung text,nhomthongso text,loai number(1),benhvien number(1) default 0 not null," +
                    " computer character varying(50),ngayud timestamp without time zone default sysdate, username character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_thongso OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_thongso add constraint pk_thongso primary key(id);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmnhomnhanvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnhomnhanvien(idnhomnhanvien number(2) DEFAULT 0,tennhomnhanvien TEXT not null,viettat character varying(10) not null," +
                    " tenkhongdau character varying(100),computer character varying(50),username character varying(20),NGAYUD timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnhomnhanvien OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhomnhanvien add constraint pk_dmnhomnhanvien primary key(idnhomnhanvien);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhomnhanvien add constraint fk_dmnhomnhanvien_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnhanvien (manhanvien character varying(20),tennhanvien text not null, phai number(1,0) default 0 not null," +
                    " ngaysinh timestamp without time zone,viettat character varying(10),namsinh number(4) default 0 not null, dienthoai character varying(50), didong character varying(50), sonha text," +
                    " thon text, diachi text,mail character varying(154), matinhthanh character varying(3),maquanhuyen character varying(5), maphuongxa character varying(7),madantoc character varying(2)," +
                    " masothue character varying(15),socmnd character varying(15),matkhau varchar(100), chuyenkhoa number(3,0) default 0, ngonngu number(2,0) default 0, " +
                    " idnhomnhanvien number(3,0) default 0,dongbo character varying(100) default lpad('0',100,'0')," +
                    " bangcap text, kinhnghiem text,hinh blob,tenkhongdau character varying(150),computer character varying(50), username character varying(20),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnhanvien OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhanvien add constraint pk_dmnhanvien primary key(manhanvien);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhanvien add constraint un_dmnhanvien_viettat unique(viettat);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhanvien add constraint fk_dmnhanvien_dmtinhthanh foreign key(matinhthanh) references " + sSchema + ".p_dmtinhthanh(matinhthanh) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhanvien add constraint fk_dmnhanvien_dmquanhuyen foreign key(maquanhuyen) references " + sSchema + ".p_dmquanhuyen(maquanhuyen) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhanvien add constraint fk_dmnhanvien_dmphuongxa foreign key(maphuongxa) references " + sSchema + ".p_dmphuongxa(maphuongxa) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhanvien add constraint fk_dmnhanvien_dmdantoc foreign key(madantoc) references " + sSchema + ".p_dmdantoc(madantoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmnhanvien add constraint fk_dmnhanvien_dmnhomnv foreign key(idnhomnhanvien) references " + sSchema + ".p_dmnhomnhanvien(idnhomnhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmbenhnhan (mabn character varying(14),hobenhnhan text,chulotbenhnhan text," +
                    " tenbenhnhan text not null,ngaysinh timestamp without time zone, namsinh number(4) default 0 not null, tuoi character varying(4) not null," +
                    " phai number(1) default 0 not null,manghenghiep character varying(3) not null, madantoc character varying(2) not null, sonha character varying(50)," +
                    " thon text, cholam text, matinhthanh character varying(3) not null, maquanhuyen character varying(5) not null, maphuongxa character varying(7) not null," +
                    " tenkhongdau text, mmyy text, hinh blob, tuvong number(1) default 0 not null, masothue character varying(15), dainthe number(1) default 0," +
                    " dienthoai character varying(20),didong character varying(20),dienthoaicoquan character varying(20),mail character varying(254),cmnd character varying(15),nhommau character varying(1)," +
                    " sothe character varying(20),manoidkkcb character varying(10),tungay timestamp without time zone,denngay timestamp without time zone,traituyen number(1) default 0 not null,quanhe text, hotennguoiquanhe text," +
                    " diachinguoiquanhe text,dienthoainguoiquanhe character varying(50)," +
                    " username character varying(50) default 0, ngayud timestamp without time zone default sysdate, computer character varying(50),masome character varying(14),hotenme text,namsinhme number(4) default 0 not null," +
                    " manghenghiepme character varying(3),tdvhme text,nhommaume character varying(2),parame character varying(11),hotenbo text,namsinhbo number(4) default 0 not null,manghenghiepbo character varying(3),tdvhbo text)" +
                    " WITH (OIDS=true);\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhnhan OWNER TO " + sUserID + ";\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhnhan add constraint pk_dmbenhnhan primary key(mabn);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhnhan add constraint fk_dmbenhnhan_dmnghenghiepbv foreign key(manghenghiep) references " + sSchema + ".p_dmnghenghiepbenhvien(manghenghiep) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhnhan add constraint fk_dmbenhnhan_dmdantoc foreign key(madantoc) references " + sSchema + ".p_dmdantoc(madantoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhnhan add constraint fk_dmbenhnhan_dmtinhthanh foreign key(matinhthanh) references " + sSchema + ".p_dmtinhthanh(matinhthanh) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhnhan add constraint fk_dmbenhnhan_dmquanhuyen foreign key(maquanhuyen) references " + sSchema + ".p_dmquanhuyen(maquanhuyen) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_dmbenhnhan add constraint fk_dmbenhnhan_dmphuongxa foreign key(maphuongxa) references " + sSchema + ".p_dmphuongxa(maphuongxa) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_benhandt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_benhandt (mabn character varying(14) not null,mavaovien number(30) default 0 not null, maql number(30) default 0 not null," +
                    " idkhoaphong number(3), ngay timestamp without time zone default sysdate not null, madoituong number(2) default 2 not null, " +
                    " sovaovien character varying(10), done number(2) default 0 not null, bnmoi number(1) default 0 not null, " +
                    " noitiepdon number(2) default 0 not null, loaiba number(1) default 0 not null,mabs character varying(4)," +
                    " quatrinhbenhly text,khambenhtoanthan text,khambenhcacbophan text,chandoansobo text,maicd character varying(10),benhchinh text,machuyenden number(30) default 0 not null," +
                    " lydodieutri text not null default ' ',username character varying(20),ngayud timestamp without time zone default sysdate, computer character varying(50),dentu number(1) default 2 not null,nhantu number(1) default 2 not null)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_benhandt OWNER TO " + sUserID + ";\n";
                   
                }
                s_Sql += "alter TABLE " + sSchema + ".p_benhandt add constraint pk_benhandt primary key(maql);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_benhandt add constraint fk_benhandt_dmbenhnhan foreign key(mabn) references " + sSchema + ".p_dmbenhnhan(mabn) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_benhandt add constraint fk_benhandt_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_benhandt add constraint fk_benhandt_dmdoituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_benhandt add constraint fk_benhandt_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_benhandt add constraint fk_benhandt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_lienhe'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_lienhe(mavaovien number(30) default 0 not null, tuoi character varying(4), " +
                    " giaychuyenvien number(1,0) default 0 not null,mabsgioithieu character varying(4),manoigioithieu character varying(10),sochuyenden character varying(20)," +
                    " quanhe text,hotennguoiquanhe text,diachinguoiquanhe text,dienthoainguoiquanhe text," +
                    " cholam text,sonha character varying(50),thon text,matinhthanh character varying(3) default '000'" +
                    " ,maquanhuyen character varying(5) default '00000',maphuongxa character varying(7) default '0000000'," +
                    " username character varying(20),	ngayud timestamp without time zone default sysdate, computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_lienhe OWNER TO " + sUserID + ";\n";
                   
                }
                s_Sql += "alter TABLE " + sSchema + ".p_lienhe add constraint pk_lienhe primary key(mavaovien);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_lienhe add constraint fk_lienhe_dmnhanviengt foreign key(mabsgioithieu) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_lienhe add constraint fk_lienhe_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_bhyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_bhyt (id number(30) default 0 not null,maql number(30) default 0 not null, sothe character varying(20), denngay timestamp without time zone not null," +
                    " manoidkkcb character varying(10) not null, tungay timestamp without time zone, ngay1 timestamp without time zone, ngay2 timestamp without time zone, ngay3 timestamp without time zone, ngaytrinh timestamp without time zone, ngayduyet timestamp without time zone," +
                    " traituyen number(1) default 0 not null, manoicap number(7) default 0 ,mmyy text," +
                    " username character varying(20),ngayud timestamp without time zone default sysdate,computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_bhyt OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".p_bhyt add constraint pk_bhyt primary key(id);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_bhyt drop constraint fk_bhyt_benhandt;\n";//linh28/6/14
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                s_Sql += "create sequence " + sSchema + ".seq_id increment by 1 start with 0 maxvalue 999 minvalue 0 cycle;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmxutri'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmxutri(maxutri number(2),tenxutri text,tenkhongdau character varying(100)," +
                    " ngayud timestamp without time zone default sysdate,computer character varying(50),username character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmxutri OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmxutri add constraint pk_dmxutri primary key(maxutri);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmketquadieutri'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmketquadieutri(idketqua number(1,0) default 0, ten text not null,tenkhongdau character varying(100)," +
                    " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmketquadieutri OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmketquadieutri add constraint pk_ketqua primary key(idketqua);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmtinhtrangrakhoa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmtinhtrangrakhoa(idtinhtrangrakhoa number(1,0) default 0, ten text not null, ravien number(1,0) default 1 not null," +
                    " tenkhongdau character varying(100), computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmtinhtrangrakhoa OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_dmtinhtrangrakhoa add constraint pk_tinhtrangrakhoa primary key(idtinhtrangrakhoa);\n";
                r_Col = dtAllColumn.Select("table_name='p_xuatvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_xuatvien(maql number(30,0) default 0, idkhoaphong number(3) default 0 not null, " +
                        " ngay timestamp without time zone default sysdate, idketqua number(1,0) default 1 not null, idtinhtrangrakhoa number(2,0) default 1 not null, benhchinh text default ' ', " +
                        " maicd character varying(9) not null, mabs character varying(4) not null, soluutru text default ' ', traba number(1,0) default 0 not null, " +
                        " idkhoaphongnhapvien number(3) default 0 not null,username character varying(20), ngayud timestamp without time zone default sysdate, computer character varying(50))" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_xuatvien OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".p_xuatvien add constraint pk_xuatvien primary key(maql);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_xuatvien drop constraint fk_xuatvien_benhandt;\n";//linh28/6/14
                s_Sql += "alter TABLE " + sSchema + ".p_xuatvien add constraint fk_xuatvien_dmkhoaphong foreign key(idkhoaphong) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_xuatvien add constraint fk_xuatvien_dmicd foreign key(maicd) references " + sSchema + ".p_dmicd(maicd) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_xuatvien add constraint fk_xuatvien_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_xuatvien drop constraint fk_xuatvien_ketqua;\n";//linh 28/6/14
                s_Sql += "alter TABLE " + sSchema + ".p_xuatvien add constraint fk_xuatvien_tinhtrangrakhoa foreign key(idtinhtrangrakhoa) references " + sSchema + ".p_dmtinhtrangrakhoa(idtinhtrangrakhoa) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_xuatvien add constraint fk_xuatvien_dmkhoaphongnv foreign key(idkhoaphongnhapvien) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_xuatvien add constraint fk_xuatvien_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_xutridieutri'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_xutridieutri (MAQL number(30,0) DEFAULT 0, MAXUTRI number(2) default 0 not null, NGAYUD timestamp without time zone DEFAULT sysdate," +
                    " computer character varying(50), username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_xutridieutri OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".p_xutridieutri drop constraint fk_xutridieutri_xuatvien;\n";//linh28/6/14
                r_Col = dtAllColumn.Select("table_name='b_chidinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_chidinh (id number(30,0) default 0, maql number(30,0) default 0 not null, idkhoa number(30,0) default 0 not null, ngay timestamp without time zone, " +
                    " idkhoaphong number(3 ) default 0 not null, madoituong number(2,0) default 0 not null, idgiavienphi number(7,0) default 0 not null, soluong number(12,4) default 0 not null, " +
                    " dongia number(15,4) default 0 not null, ghichu text, tinhtrang number(1,0) default 0 not null, idkpnoithuchien number(3) default 0 not null, " +
                    " paid number(1,0) default 0 not null, done number(1,0) default 0 not null, idchidinh number(30,0) default 0 not null, " +
                    " idttrv number(30,0) default 0 not null, maicd character varying(9 ), chandoan text, mabs character varying(4 ), loaiba number(1,0) default 3 not null, " +
                    " ngaythuchien timestamp without time zone, idtrongoi number(7,0) default 0 not null, hide number(1,0) default 0 not null,  duyet number(1,0) default 0 not null, " +
                    " lanin number(2,0) default 0 not null, idduoc number(30,0) default 0 not null,ngayud timestamp without time zone default sysdate, username character varying(20), computer character varying(50), " +
                    " vuottran number(1,0) default 0 not null, idpttt number(30,0) default 0 not null)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_chidinh OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".b_chidinh drop constraint fk_chidinh_benhandt;\n";//linh28/6/14
                r_Col = dtAllColumn.Select("table_name='b_dmloaiquyenso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_dmloaiquyenso(maloaiquyenso number(2),tenloaiquyenso text," +
                    " tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50),dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_dmloaiquyenso OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".b_dmloaiquyenso add constraint pk_dmloaiquyenso primary key(maloaiquyenso);\n";
                r_Col = dtAllColumn.Select("table_name='b_dmquyenso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_dmquyenso(idquyenso number(5),tenquyenso text,kyhieu text,maloaiquyenso number(2)," +
                    " tu number(10) default 0,den number(10) default 0,soghi number(10) default 0, ngaylinh timestamp without time zone default sysdate,dangdung number(1) default 0," +
                    " khambenh number(1) default 0,dichvu number(1) default 0,tenkhongdau character varying(150),ngayud timestamp without time zone default sysdate,username character varying(50)," +
                    " dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_dmquyenso OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".b_dmquyenso add constraint pk_dmquyenso primary key(idquyenso);\n";
                s_Sql += "alter TABLE " + sSchema + ".b_dmquyenso add constraint fk_quyenso_loaiquyenso foreign key(maloaiquyenso) references " + sSchema + ".b_dmloaiquyenso(maloaiquyenso) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmnuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmnuoc(idnuoc number(5) default 0, tennuoc text, tenkhongdau character varying(150), ngayud timestamp without time zone DEFAULT sysdate" +
                    " ,computer character varying(50),username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmnuoc OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmnuoc add constraint pk_m_dmnuoc primary key(idnuoc);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnuoc add constraint fk_nuoc_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmloai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmloai(idloai number(3) default 0, tenloai text, tenkhongdau character varying(150), idnhomkho number(2) default 0 not null," +
                    " computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmloai OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmloai add constraint pk_m_dmloai primary key(idloai);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmloai add constraint fk_loai_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmloai add constraint fk_loai_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmnhomhang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmnhomhang(idnhomhang number(2) default 0, tennhomhang text, tenkhongdau character varying(150) " +
                    " ,computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmnhomhang OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhomhang add constraint pk_m_dmnhomhang primary key(idnhomhang);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhomhang add constraint fk_nhomhang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmhang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmhang(idhang number(5) default 0, tenhang text, tenkhongdau character varying(150), idnhomkho number(2) default 0 not null," +
                    " idnhomhang number(2) default 0 not null,computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmhang OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmhang add constraint pk_m_dmhang primary key(idhang);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmhang add constraint fk_hang_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmhang add constraint fk_hang_nhomhang foreign key(idnhomhang) references " + sSchema + ".m_dmnhomhang(idnhomhang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmhang add constraint fk_hang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmdang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmdang(iddang number(2) default 0, tendang text, tenkhongdau character varying(30),ngayud timestamp without time zone DEFAULT sysdate," +
                    " computer character varying(50),username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmdang OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmdang add constraint pk_m_dmdang primary key(iddang);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmdang add constraint fk_dang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmduongdung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmduongdung(idduongdung number(3) default 0, tenduongdung text, tenkhongdau character varying(150),ngayud timestamp without time zone DEFAULT sysdate," +
                    " computer character varying(50),username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmduongdung OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmduongdung add constraint pk_m_dmduongdung primary key(idduongdung);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmduongdung add constraint fk_duongdung_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmnhomketoan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmnhomketoan(idnhomketoan number(2,0) default 0, manhomketoan character varying(50), tennhomketoan text, tenkhongdau character varying(150)," +
                    " ngayud timestamp without time zone DEFAULT sysdate,computer character varying(50),username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmnhomketoan OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhomketoan add constraint pk_m_dmnhomketoan primary key(idnhomketoan);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhomketoan add constraint fk_nhomketoan_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmnhomin'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmnhomin(idnhomin number(2) default 0, tennhomin text, tenkhongdau character varying(150), idnhomkho number(2) default 0 not null " +
                    " ,computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmnhomin OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhomin add constraint pk_m_dmnhomin primary key(idnhomin);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhomin add constraint fk_nhomin_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhomin add constraint fk_nhomin_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmnganhang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmnganhang(idnganhang number(3) default 0, tennganhang text, tenkhongdau character varying(150), sotaikhoan varchar(15) " +
                    " ,masothue character varying(15), dienthoai character varying(50), fax character varying(15), diachi text" +
                    " ,computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmnganhang OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmnganhang add constraint pk_m_dmnganhang primary key(idnganhang);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnganhang add constraint fk_nganhang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmnhacungcap'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmnhacungcap(idnhacungcap number(5) default 0, manhacungcap character varying(50), tennhacungcap text, tenkhongdau character varying(150)" +
                    " , idnhomkho number(2) default 0 not null, sotaikhoan varchar(15), masothue character varying(15), daidien text, dienthoai character varying(50), fax character varying(15), diachi text" +
                    " ,idnganhang number(3) default 0 not null,computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmnhacungcap OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhacungcap add constraint pk_m_dmnhacungcap primary key(idnhacungcap);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhacungcap add constraint fk_nhacungcap_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhacungcap add constraint fk_nhacungcap_nganhang foreign key(idnganhang) references " + sSchema + ".m_dmnganhang(idnganhang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhacungcap add constraint fk_nhacungcap_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmnhombietduoc(idnhombietduoc number(3) default 0, tennhombietduoc text, tenkhongdau character varying(150), idnhomkho number(2) default 0 not null," +
                    " idloaivienphi number(5) default 0 not null, ngayud timestamp without time zone DEFAULT sysdate,computer character varying(50),username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmnhombietduoc OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhombietduoc add constraint pk_m_dmnhombietduoc primary key(idnhombietduoc);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhombietduoc add constraint fk_nhombietduoc_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhombietduoc add constraint fk_nhombietduoc_loaivienphi foreign key(idloaivienphi) references " + sSchema + ".b_dmloaivienphi(idloaivienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhombietduoc add constraint fk_nhombietduoc_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmhoatchat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmhoatchat(idhoatchat number(7,0) default 0, mahoatchat character varying(8), tenhoatchat text, tenkhongdau character varying(400)," +
                    " ngayud timestamp without time zone DEFAULT sysdate, RX_OTC number(1,0) default 1 not null, hamluong text, dang text, " +
                    " idduongdung number(3) default 0 not null, sttbhyt character varying(8), hoichan number(1,0) default 0 not null, cachdung text,computer character varying(50),username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmhoatchat OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmhoatchat add constraint pk_m_dmhoatchat primary key(idhoatchat);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmhoatchat add constraint un_dmhoatchat_mahoatchat unique(mahoatchat);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmhoatchat add constraint fk_hoatchat_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmnguon'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmnguon(idnguon number(2,0) default 0, tennguon text, tenkhongdau character varying(150), " +
                    " idnhomkho number(2) default 0 not null,computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmnguon OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmnguon add constraint pk_m_dmnguon primary key(idnguon);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnguon add constraint fk_nguon_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='m_dmkho'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmkho(idkho number(3,0) default 0, tenkho text, tenkhongdau character varying(150)," +
                    " idnhomkho number(2) default 0 not null,khotrungtam number(1) default 0 not null,thua number(1) default 0 not null,dutru number(1) default 0 not null," +
                    " dongy number(1) default 0 not null,open number(1) default 0 not null,chuyenkho number(1) default 0 not null,idkhotra number(3,0) default 0 not null," +
                    " khophache number(1) default 0 not null,idkhonguyenlieu number(3) default 0 not null," +
                    " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmkho OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmkho add constraint pk_m_dmkho primary key(idkho);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmkho add constraint fk_kho_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmkho add constraint fk_kho_dmnhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmnhomphieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmnhomphieu(idnhomphieu number(2,0) default 0, tennhomphieu text, tenkhongdau character varying(150), " +
                    " kho character varying(254),nguon character varying(254),madoituong character varying(254),computer character varying(50),username character varying(20), " +
                    " ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmnhomphieu OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhomphieu add constraint pk_m_dmnhomphieu primary key(idnhomphieu);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmnhomphieu add constraint fk_phieu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmphieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmphieu(idphieu number(3,0) default 0, tenphieu text, tenkhongdau character varying(150), " +
                    " loai number(1) default 0 not null,idnhomphieu number(2) default 0 not null,kho character varying(254), idnhomkho number(2) default 0 not null," +
                    " computer character varying(50), username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmphieu OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmphieu add constraint pk_m_dmphieu primary key(idphieu);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmphieu add constraint fk_dmphieu_nhomphieu foreign key(idnhomphieu) references " + sSchema + ".m_dmnhomphieu(idnhomphieu) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmphieu add constraint fk_dmphieu_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmphieu add constraint fk_dmphieu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmkhoaphong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmkhoaphong(idkhoaphong number(3,0) default 0, makhoaphong character varying(10), tenkhoaphong text, tenkhongdau character varying(150)," +
                    " idnhomkho character varying(254),idkhoaphongbenhvien number(3,0) default 0 not null,idkho character varying(254),tutruc character varying(254),idnhomphieu character varying(254)," +
                    " idphieu character varying(254),computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmkhoaphong OWNER TO " + sUserID + ";\n";
                   
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmkhoaphong add constraint pk_m_dmkhoaphong primary key(idkhoaphong);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmkhoaphong add constraint fk_dmkhoaphong_dmkpbenhvien foreign key(idkhoaphongBenhVien) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmkhoaphong add constraint fk_khoaphong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmbd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmbd(idbietduoc number(7,0) default 0, mabietduoc character varying(15), tenbietduoc text, tenkhongdau character varying(150)," +
                    " dang text, hamluong text, idnhombietduoc number(3) default 0 not null," +
                    " idloai number(3) default 0 not null, idhang number(5) default 0 not null, idnuoc number(5) default 0 not null," +
                    " bhyt number(3) default 0 not null, tenhoatchat text, mahoatchat character varying(1000),donvilinh text," +
                    " idnhomkho number(2) default 0 not null, sodangky character varying(20),dongia number(24,10) default 0 not null,soluongtoithieu number(10) default 0 not null," +
                    " giaban number(18,4) default 0 not null,ngaytra number(3) default 0 not null,tutruc number(1) default 0 not null,idnhomin number(2) default 0 not null," +
                    " duongdung text,idnhacungcap number(5) default 0 not null,dangdonggoi text,khongnhapmoi number(1) default 0 not null," +
                    " phattron number(1) default 0 not null,soluongdonggoi number(7) default 1 not null,maatc character varying(50)," +
                    " giabhyt number(18,4) default 0 not null,kythuat number(1) default 0 not null,chenhlech number(1) default 0 not null,cachdung text," +
                    " donvidung text,thuoctheodon number(1) default 1 not null,idkho character varying(254),locthan number(1) default 0 not null,cotrongkhoaduocbv number(1) default 0 not null," +
                    " dienthoai character varying(50),binhongia number(1) default 0 not null,mabenhvienapthau character varying(50)," +
                    " tenkhoahocvithuoc text,tenkhoahocnguyenvatlieu text,sttbyt character varying(20),stt21 character varying(50),stt6282 character varying(50)," +
                    " thanhphan text,chidinh text,chongchidinh text,chuy text,cothai text,tuongtac text," +
                    " ngoaiy text,lieuluong text,tyle number(3) default 0 not null,giabandangky number(18,4) default 0 not null,ngayapdung timestamp without time zone,giathau number(18,4) default 0 not null," +
                    " ngoaithau number(1) default 0 not null,idloaithuocbyt number(3) default 0 not null,nguongoc text,hoichan number(1) default 0 not null,travo number(1) default 0 not null," +
                    " computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmbd OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmbd add constraint pk_m_dmbd primary key(idbietduoc);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmbd add constraint uk_dmbd_mabd unique (mabietduoc);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmbd add constraint fk_dmbd_hang foreign key(idhang) references " + sSchema + ".m_dmhang(idhang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmbd add constraint fk_dmbd_loai foreign key(idloai) references " + sSchema + ".m_dmloai(idloai) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmbd add constraint fk_dmbd_nhombietduoc foreign key(idnhombietduoc) references " + sSchema + ".m_dmnhombietduoc(idnhombietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmbd add constraint fk_dmbd_nuoc foreign key(idnuoc) references " + sSchema + ".m_dmnuoc(idnuoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmbd add constraint fk_dmbd_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmbd add constraint fk_dmbd_nhomin foreign key(idnhomin) references " + sSchema + ".m_dmnhomin(idnhomin) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmbd add constraint fk_dmbd_nhacungcap foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + ".m_dmbd add constraint fk_dmbd_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='b_hoantra'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".b_hoantra(id number(30)  DEFAULT 0 not null, diemthu number(2) default 0 not null, idquyenso number(5) DEFAULT 0 not null, " +
                    " sobienlai number(10) DEFAULT 0 not null,ngay timestamp without time zone, maql number(30) DEFAULT 0 not null, idkhoa number(30) DEFAULT 0 not null, idkhoaphong number(3) DEFAULT 0 not null, " +
                    " sotien number(15,4) DEFAULT 0 not null,loai number(2) DEFAULT 0 not null,loaibn number(2) DEFAULT 0 not null,username character varying(20), usernamenl character varying(20)," +
                    " ngayud timestamp without time zone DEFAULT sysdate, DONGBO character varying(100) DEFAULT lpad('0',100,'0'),COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_hoantra OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".b_hoantra add CONSTRAINT pk_b_hoantra PRIMARY KEY (id);\n";
                s_Sql += "alter TABLE " + sSchema + ".b_hoantra drop CONSTRAINT fk_b_hoantra_benhandt ;\n";//linh28/6/14
                r_Col = dtAllColumn.Select("table_name='b_tamung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".b_tamung(id number(30)  DEFAULT 0 not null, diemthu number(2) default 0 not null," +
                    " maql number(30) DEFAULT 0 not null,  idkhoa number(30) DEFAULT 0 not null," +
                    " idquyenso number(5) DEFAULT 0 not null,  sobienlai number(10) DEFAULT 0 not null,ngay timestamp without time zone," +
                    " loai number(2) DEFAULT 0 not null,  idkhoaphong number(3) DEFAULT 0 not null,  madoituong number(2) DEFAULT 0 not null," +
                    " sotien number(15,4) DEFAULT 0 not null, done number(1) DEFAULT 0 not null, lanin number(2) DEFAULT 0 not null," +
                    " loaibn number(2) DEFAULT 0 not null, idttrv number(30) DEFAULT 0 not null,  datru number(15,4) DEFAULT 0 not null," +
                    " ketoan number(20) default 0 not null,idtonghop number(30) default 0 not null,lan number(5) default 1," +
                    " username character varying(20), usernamenl character varying(20), ngayud timestamp without time zone DEFAULT sysdate," +
                    " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_tamung OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".b_tamung add CONSTRAINT pk_b_tamung PRIMARY KEY (id);\n";
                s_Sql += "alter TABLE " + sSchema + ".b_tamung drop CONSTRAINT fk_b_tamung_benhandt ;\n";//linh28/6/14
                r_Col = dtAllColumn.Select("table_name='p_benhkemtheo'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".P_BENHKEMTHEO(ID number(30,0) DEFAULT 0 not null, MAQL number(30,0) DEFAULT 0 not null,CHANDOAN TEXT," +
                    " MAICD character varying(10), NGAYUD timestamp without time zone DEFAULT sysdate, USERNAME character varying(50), DONGBO character varying(100) DEFAULT lpad('0',100,'0'),COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".P_BENHKEMTHEO OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".P_BENHKEMTHEO add CONSTRAINT pk_cdkemtheo PRIMARY KEY (id);\n";
                s_Sql += "alter TABLE " + sSchema + ".P_BENHKEMTHEO add CONSTRAINT uc_cdkemtheo UNIQUE (maql,maicd);\n";
                s_Sql += "alter TABLE " + sSchema + ".P_BENHKEMTHEO drop CONSTRAINT fk_BENHKEMTHEO_benhandt ;\n";//linh28/6/14
                s_Sql += "alter TABLE " + sSchema + ".P_BENHKEMTHEO add CONSTRAINT fk_BENHKEMTHEO_dmicd FOREIGN KEY (maicd) REFERENCES " + sSchema + ".p_dmicd(maicd) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_hiendien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_HIENDIEN (ID number(30) DEFAULT 0, MAQL number(30) DEFAULT 0 not null, idkhoaphong number(3) default 0  not null, " +
                            " NGAY timestamp without time zone default sysdate not null, idkhoaphongchuyenden number(3) default 0  not null, done number(1) DEFAULT 0 not null, GIUONG character varying(20), " +
                            " MABS character varying(4), MAICD character varying(9), chandoan text,username character varying(20), computer character varying(50),ngayud timestamp without time zone default sysdate,machuyenden number(30) default 0 not null)" +
                            " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_HIENDIEN OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_HIENDIEN add constraint pk_hiendien primary key(id);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_HIENDIEN drop constraint fk_hiendien_benhandt;\n";//linh 28/6/14
                s_Sql += "alter TABLE " + sSchema + ".p_HIENDIEN drop constraint fk_hiendien_uk_maql;\n";//linh 16/10/14
                s_Sql += "alter TABLE " + sSchema + ".p_HIENDIEN add constraint fk_hiendien_khoaphong foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_HIENDIEN add constraint fk_hiendien_noichuyenden foreign key (idkhoaphongchuyenden) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_HIENDIEN add constraint fk_hiendien_dmbs foreign key (mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_HIENDIEN add constraint fk_hiendien_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + ".p_benhandt add constraint uk_benhandt_mavaovien unique(mavaovien,maql);\n";
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='trinhdovanhoa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add trinhdovanhoa text;\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.trinhdovanhoa is 'dung trong benh an tam than';\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='ngaybong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add ngaybong timestamp without time zone;\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.ngaybong is 'dung trong benh an bong';\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='para'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add para character varying(11);\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.para is 'dung trong benh an san khoa';\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='ngaykinhcuoiki'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add ngaykinhcuoiki timestamp without time zone;\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.ngaykinhcuoiki is 'dung trong benh an san khoa';\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='ngaysinhdukien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add ngaysinhdukien timestamp without time zone;\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.ngaysinhdukien is 'dung trong benh an san khoa';\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='dacdiemthai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add dacdiemthai text;\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.dacdiemthai is 'dung trong benh an san khoa';\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='nhanapmatphai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add nhanapmatphai character varying(10);\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.nhanapmatphai is 'dung trong benh an mat';\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='nhanapmattrai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add nhanapmattrai character varying(10);\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.nhanapmattrai is 'dung trong benh an mat';\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='thiluckhongkinhmatphai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add thiluckhongkinhmatphai text;\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.thiluckhongkinhmatphai is 'dung trong benh an mat';\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='thiluckhongkinhmattrai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add thiluckhongkinhmattrai text;\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.thiluckhongkinhmattrai is 'dung trong benh an mat';\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='thiluccokinhmatphai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add thiluccokinhmatphai character varying(10);\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.thiluccokinhmatphai is 'dung trong benh an mat';\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='thiluccokinhmattrai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add thiluccokinhmattrai character varying(10);\n";
                    s_Sql += "comment on column " + sSchema + ".p_benhandt.thiluccokinhmattrai is 'dung trong benh an mat';\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='idkhoa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add idkhoa number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='idbenhan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add idbenhan number(2) default 24 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_benhandt add constraint fk_benhandt_benhan foreign key(idbenhan) references " + sSchema + ".p_dmbenhan ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='soluutru'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add soluutru character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_nhapkhoa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_nhapkhoa (id number(30) default 0, maql number(30) default 0 not null, idkhoaphong number(3) default 0 not null, " +
                        " idbenhan number(3) default 0 not null, ngay timestamp without time zone default sysdate not null, tuoivao character varying(4), giuong character varying(60)," +
                        " idkhoachuyen number(3) default 0 not null, chandoan text not null, maicd character varying(9) not null, mabs character varying(4) not null," +
                        " lan number(3,0) default 0 not null, username character varying(20), computer character varying(50), ngayud timestamp without time zone default sysdate,machuyenden number(30) default 0 not null)" +//linh 25/7/14
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_nhapkhoa OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".p_nhapkhoa add constraint pk_nhapkhoa primary key(id);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_nhapkhoa drop constraint fk_nhapkhoa_benhandt ;\n";//linh28/6/14
                s_Sql += "alter TABLE " + sSchema + ".p_nhapkhoa add constraint fk_nhapkhoa_dmkpnoichuyen foreign key(idkhoachuyen) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_nhapkhoa add constraint fk_nhapkhoa_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_nhapkhoa add constraint fk_nhapkhoa_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_nhapkhoa add constraint fk_nhapkhoa_dmicd foreign key(maicd) references " + sSchema + ".p_dmicd(maicd) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".p_nhapkhoa add constraint fk_nhapkhoa_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmloaithuocbyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmloaithuocbyt(idloaithuocbyt number(3) default 0, tenloaithuocbyt text, tenkhongdau character varying(150), " +
                    " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmloaithuocbyt OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dmloaithuocbyt add constraint pk_m_dmloaithuocbyt primary key(idloaithuocbyt);\n";
                s_Sql += "alter TABLE " + sSchema + ".m_dmloaithuocbyt add constraint fk_loaithuocbyt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='r_dmloaicdha'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".r_dmloaicdha(idloaicdha number(2,0) default 0 not null, stt number(2,0) default 0 not null," +
                            " tenloaicdha text not null,chuprieng number(1,0) default 0 not null,tutruc number(1,0) default 0 not null,kythuat number(1,0) default 0 not null," +
                            " chuphinh number(1,0) default 0 not null,chonhinh number(1,0) default 0 not null,inhinh number(1,0) default 0 not null,locnhanvien number(1,0) default 0 not null," +
                            " nhapsolan number(1,0) default 0 not null,traloirieng number(1,0) default 0 not null,sohinh number(2,0) default 0 not null,quanlyphim number(1,0) default 0 not null," +
                            " quanlyvattu number(1,0) default 0 not null,batbuocnhapphim number(1,0) default 0 not null,nhapmota number(1,0) default 0 not null,nhapnhanvien2 number(1,0) default 0 " +
                            " not null," +
                            " nhapidcls number(1,0) default 0 not null,tudongcapnhattutruc number(1,0) default 0 not null,makp_duoc number(3,0) default 0 not null,chontencoquan number(1,0) default 0 not null," +
                            " readonly number(1,0) default 0 not null,tenkhongdau character varying(150)," +
                            " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                            " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".r_dmloaicdha OWNER TO " + sUserID + ";\n";
                   
                }
                s_Sql += "alter TABLE " + sSchema + ".r_dmloaicdha add constraint pk_r_loaicdha primary key(idloaicdha);\n";
                s_Sql += "alter TABLE " + sSchema + ".r_dmloaicdha add constraint fk_dmloaicdha_dmkhoaphong foreign key(makp_duoc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".r_dmloaicdha add constraint fk_dmloaicdha_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='r_dmmay'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".r_dmmay(idmay number(2,0) default 0 not null, stt number(2,0) default 0 not null," +
                        " tenmay text not null,idloaicdha number(2,0) default 0 not null,readonly number(1,0) default 0 not null,tenkhongdau character varying(150)," +
                        " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".r_dmmay OWNER TO " + sUserID + ";\n";
                   
                }
                s_Sql += "alter TABLE " + sSchema + ".r_dmmay add constraint pk_r_dmmay primary key(idmay);\n";
                s_Sql += "alter TABLE " + sSchema + ".r_dmmay add constraint fk_dmmay_dmloaicdha foreign key(idloaicdha) references " + sSchema + ".r_dmloaicdha(idloaicdha) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".r_dmmay add constraint fk_dmmay_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='r_dmkythuat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".r_dmkythuat(idkythuat number(7,0) default 0 not null, MAKT character varying(6), TENKYTHUAT TEXT, IDLOAICDHA number(3,0) default 0 not null," +
                        " IDFORM number(4,0) default 0 not null,TYLEBACSY number(10,4) default 0 not null,TYLENHANVIEN number(10,4) default 0 not null,TYLENHANVIEN1 number(10,4) default 0 not null,REPORT character varying(100), IDVP number(7,0) default 0 not null,MAPT character varying(6), KIEUMOTA number(1) default 0 not null,HIDE number(1,0) default 0 not null, " +
                        " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".r_dmkythuat OWNER TO " + sUserID + ";\n";
                   
                }
                s_Sql += "alter TABLE " + sSchema + ".r_dmkythuat add constraint pk_r_dmkythuat primary key(idkythuat);\n";
                s_Sql += "alter TABLE " + sSchema + ".r_dmkythuat add constraint fk_dmkythuatcdha_dmloaicdha foreign key(idloaicdha) references " + sSchema + ".r_dmloaicdha(idloaicdha) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".r_dmkythuat add constraint fk_dmkythuatcdha_dmgiavp foreign key(idvp) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".r_dmkythuat add constraint fk_dmkythuatcdha_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='r_dmmaumota'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".r_dmmaumota(mabs character varying(4) not null, MAKT character varying(6) not null, idmau  number(3,0) default 0 not null," +
                        " IDLOAICDHA number(3,0) default 0 not null, kythuatthuchien text,mota text,KETLUAN TEXT," +
                        " DENGHI TEXT,TENMAU TEXT,computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".r_dmmaumota OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter TABLE " + sSchema + ".r_dmmaumota alter mota type text;\n";
                s_Sql += "alter TABLE " + sSchema + ".r_dmmaumota add constraint pk_r_dmmau primary key(mabs,MAKT,idmau);\n";
                s_Sql += "alter TABLE " + sSchema + ".r_dmmaumota add constraint fk_dmmau_dmloaicdha foreign key(idloaicdha) references " + sSchema + ".r_dmloaicdha(idloaicdha) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".r_dmmaumota add constraint fk_dmmau_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".r_dmmaumota add constraint fk_dmmau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_xuatkhoa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_xuatkhoa (id number(30) default 0, ngay timestamp without time zone, idketqua number(1) default 0, idtinhtrangrakhoa number(2) default 0," +
                        " chandoan text, maicd character varying(9 ), mabs character varying(4 ), bienchung number(1) default 0, taibien number(1) default 0," +
                        " idkhoaphongchuyendi number(3) default 0 not null," +
                        " giaiphau number(1) default 0, username character varying(20), ngayud timestamp without time zone default sysdate, computer character varying(50))" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_xuatkhoa OWNER TO " + sUserID + ";\n";
                }
                //s_Sql += "alter TABLE " + sSchema + ".p_xuatkhoa add constraint pk_xuatkhoa primary key(id);\n";
                s_Sql += "alter TABLE " + sSchema + ".p_xuatkhoa drop constraint fk_xuatkhoa_nhapkhoa ;\n";//linh28/6/14
                //s_Sql += "alter TABLE " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_ketqua foreign key (idketqua) references " + sSchema + ".p_dmketquadieutri(idketqua) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                //s_Sql += "alter TABLE " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_tinhtrang foreign key (idtinhtrangrakhoa) references " + sSchema + ".p_dmtinhtrangrakhoa(idtinhtrangrakhoa) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                //s_Sql += "alter TABLE " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_dmbs foreign key (mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                //s_Sql += "alter TABLE " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                //s_Sql += "alter TABLE " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_dmkpbv foreign key (idkhoaphongchuyendi) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                //s_Sql += "alter TABLE " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_dmicd foreign key (maicd) references " + sSchema + ".p_dmicd(maicd) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='mabenhvienchuyendi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add mabenhvienchuyendi character varying(10);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='lamsang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add lamsang text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='xetnghiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add xetnghiem text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='chandoan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add chandoan text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='thuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add thuoc text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='tinhtrangchuyenvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add tinhtrangchuyenvien text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='vanchuyen'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add vanchuyen text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='nguoidua'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add nguoidua text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='lydochuyenvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add lydochuyenvien text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongso_ext'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_thongso_ext(id number(7), ma number(7), ten text,val text) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_thongso_ext OWNER TO " + sUserID + ";\n";
                    
                }
                s_Sql += "alter table " + sSchema + ".p_thongso_ext add constraint pk_thongso_ext primary key(id,ma);\n";
                s_Sql += "alter table " + sSchema + ".p_thongso_ext add constraint fk_thongso_thongso_ext foreign key(id) references " + sSchema + ".p_thongso(id) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_theodoi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_theodoi(idtheodoi number(30) default 0, idbietduoc number(7) default 0 not null, idnguon number(2) default 0 not null," +
                        " idhang number(5) default 0 not null, idnuoc number(5) default 0 not null, handung timestamp without time zone, losx character varying(20), idnhacungcap number(5) default 0 not null, " +
                        " dongia number(12,4) default 0 not null, giaban number(12,4) default 0 not null, giagoc number(12,4) default 0 not null, vat number(3) default 0 not null," +
                        " chietkhau number(5,2) default 0 not null, khaiton number(1) default 0 not null, " +
                        " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate, " +
                        " mmyy character varying(4) default to_char(sysdate,'mmyy') not null)" +//linh 29/8/14
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_theodoi OWNER TO " + sUserID + ";\n";
                    //s_Sql += "alter TABLE " + sSchema + ".m_theodoi add constraint pk_m_theodoi primary key(idtheodoi);\n";
                    //s_Sql += "alter TABLE " + sSchema + ".m_theodoi add constraint fk_theodoi_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    //s_Sql += "alter TABLE " + sSchema + ".m_theodoi add constraint fk_theodoi_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    //s_Sql += "alter TABLE " + sSchema + ".m_theodoi add constraint fk_theodoi_dmhang foreign key(idhang) references " + sSchema + ".m_dmhang(idhang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    //s_Sql += "alter TABLE " + sSchema + ".m_theodoi add constraint fk_theodoi_dmnuoc foreign key(idnuoc) references " + sSchema + ".m_dmnuoc(idnuoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    //s_Sql += "alter TABLE " + sSchema + ".m_theodoi add constraint fk_theodoi_dmnhacungcap foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    //s_Sql += "alter TABLE " + sSchema + ".m_theodoi add constraint fk_theodoi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='m_tonkhochitiet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_tonkhochitiet(mmyy character varying(4), idkho number(3) default 0, idtheodoi number(30) default 0 not null, " +
                        " soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                        " soluongxuat number(30,8) default 0 not null, soluongkiemke number(30,8) default 0 not null, khoa number(1) default 0 not null, " +
                        " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tonkhochitiet OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tonkhochitiet add constraint pk_m_tonkhochitiet primary key(mmyy,idkho,idtheodoi);\n";//linh 25/8/14
                    s_Sql += "alter TABLE " + sSchema + ".m_tonkhochitiet drop constraint fk_tonkhochitiet_theodoi ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".m_tonkhochitiet add constraint fk_tonkhochitiet_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tonkhochitiet add constraint fk_tonkhochitiet_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tonkhotonghop'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_tonkhotonghop(mmyy character varying(4), idkho number(3) default 0, idbietduoc number(7) default 0 not null, " +
                        " idnguon number(2) default 0 not null, soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                        " soluongxuat number(30,8) default 0 not null, soluongyeucau number(30,8) default 0 not null, soluongkiemke number(30,8) default 0 not null," +
                        " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tonkhotonghop OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tonkhotonghop add constraint pk_m_tonkhotonghop primary key(mmyy,idkho,idbietduoc,idnguon);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tondau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_tondau(mmyy character varying(4), idkho number(3) default 0, idtheodoi number(30) default 0 not null, " +
                        " soluong number(30,8) default 0 not null, computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate,idtutruc number(3) default 0 not null)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tondau OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_tondau add constraint pk_m_tondau primary key(mmyy,idkho,idtheodoi,idtutruc);\n";
                    s_Sql += "alter table " + sSchema + ".m_tondau drop constraint fk_tondau_theodoi ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".m_tondau add constraint fk_tondau_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_tondau add constraint fk_tondau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_tondau add constraint fk_tondau_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongso_ext' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongso_ext add username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongso_ext' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongso_ext add computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongso_ext' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongso_ext add ngayud timestamp without time zone default sysdate;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_thongso_ext alter column ma type number(7);\n";
                s_Sql += "alter table " + sSchema + ".p_thongso_ext alter column ma set default 0 ;\n";
                s_Sql += "alter table " + sSchema + ".p_thongso_ext alter column ma set not null;\n";
                r_Col = dtAllColumn.Select("table_name='l_dmsoxetnghiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_dmsoxetnghiem(idsoxetnghiem number(2),tensoxetnghiem text,masoxetnghiem character varying(10)," +
                    " tenkhongdau character varying(100), username character varying(20), computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmsoxetnghiem OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmsoxetnghiem add constraint pk_soxn primary key(idsoxetnghiem);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmsoxetnghiem add constraint uk_soxn_ma unique(masoxetnghiem);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmnhomxetnghiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_dmnhomxetnghiem(idnhomxetnghiem number(3),tennhomxetnghiem text,manhomxetnghiem character varying(10)," +
                    " idsoxetnghiem number(2),tenkhongdau character varying(150),username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmnhomxetnghiem OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmnhomxetnghiem add constraint pk_nhomxn primary key(idnhomxetnghiem);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmnhomxetnghiem add constraint fk_nhomxn_soxn foreign key(idsoxetnghiem) references " + sSchema + ".l_dmsoxetnghiem(idsoxetnghiem) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmloaixetnghiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_dmloaixetnghiem(idloaixetnghiem number(5),tenloaixetnghiem text,maloaixetnghiem character varying(10)," +
                    " idnhomxetnghiem number(3),tenkhongdau character varying(150)," +
                    " username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmloaixetnghiem OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmloaixetnghiem add constraint pk_loaixn primary key(idloaixetnghiem);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmloaixetnghiem add constraint fk_loaixn_nhomxn foreign key(idnhomxetnghiem) references " + sSchema + ".l_dmnhomxetnghiem(idnhomxetnghiem) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmxetnghiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_dmxetnghiem(idxetnghiem number(7),tenxetnghiem text,maxetnghiem character varying(10),idloaixetnghiem number(5)," +
                    " donvi text,binhthuongnu character varying(50),binhthuongnam character varying(50),minnu number(10,5), maxnu number(10,5), minnam number(10,5)," +
                    " maxnam number(10,5),stt number(7) default 1 not null,tenkhongdau character varying(150)," +
                    " username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmxetnghiem OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmxetnghiem add constraint pk_xn primary key(idxetnghiem);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmxetnghiem add constraint fk_xn_loaixn foreign key(idloaixetnghiem) references " + sSchema + ".l_dmloaixetnghiem(idloaixetnghiem) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmvienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_dmvienphi(idvienphi number(7),idsoxetnghiem number(2),idgiavienphi number(6),tieuban number(3) default 0 not null,  " +
                      " username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmvienphi OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmvienphi add constraint pk_vienphi primary key(idvienphi);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmvienphi add constraint fk_vp_soxn foreign key(idsoxetnghiem) references " + sSchema + ".l_dmsoxetnghiem(idsoxetnghiem) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmvienphi add constraint fk_vp_giavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmxetnghiemmap'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_dmxetnghiemmap(idvienphi number(7),idxetnghiem number(7),username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmxetnghiemmap OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmxetnghiemmap add constraint pk_xetnghiemmap primary key(idvienphi,idxetnghiem);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmxetnghiemmap add constraint fk_xnmap_xn foreign key(idxetnghiem) references " + sSchema + ".l_dmxetnghiem(idxetnghiem) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_dmxetnghiemmap add constraint fk_xnmap_vp foreign key(idvienphi) references " + sSchema + ".l_dmvienphi(idvienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_ylenhthuoc(idylenhthuoc number(30) default 0 not null,ngay timestamp without time zone default sysdate not null, idkhoaphong number(3) default 0 not null,  " +
                      " idtutruc number(3) default 0 not null,idphieu number(3) default 0 not null, trangthai number(1) default 0 not null, mmyy character varying(4) not null,  " +
                      " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_ylenhthuoc OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_ylenhthuoc add constraint pk_m_ylenhthuoc primary key(idylenhthuoc);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuocds'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_ylenhthuocds(idylenhthuocds number(30) default 0 not null,idylenhthuoc number(30) default 0 not null,maql number(30) default 0 not null,  " +
                      " idkhoa number(30) default 0 not null,ghichu text,songay number(2) default 0 not null, mmyy character varying(4) not null,  " +
                      " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                      "  WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_ylenhthuocds OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_ylenhthuocds add constraint pk_m_ylenhthuocds primary key(idylenhthuocds);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_ylenhthuocds drop constraint fk_ylenhthuocds_ylenhthuoc ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".m_ylenhthuocds drop constraint fk_ylenhthuocds_benhandt ;\n";//linh28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuocct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_ylenhthuocct(idylenhthuocds number(30) default 0 not null,stt number(3) default 1 not null,idbietduoc number(7) default 0 not null, " +
                      " madoituong number(2) default 2 not null,idkho number(3) default 0 not null,idnguon number(2) default 0 not null, soluongyeucau number(20,7) default 0 not null,  " +
                      " soluongphat number(20,7) default 0 not null,cachdung text, ghichu text, mmyy character varying(4) not null,  " +
                      " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                      "  WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_ylenhthuocct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_ylenhthuocct add constraint pk_m_ylenhthuocct primary key(idylenhthuocds,stt);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_ylenhthuocct drop constraint fk_ylenhthuocct_ylenhthuocds ;\n";//linh28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='m_thucxuattutruc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_thucxuattutruc(idylenhthuocds number(30) default 0 not null,stt number(3) default 1 not null,idtheodoi number(30) default 0 not null,  " +
                      " madoituong number(3) default 2 not null,idkho number(3) default 0 not null, soluong number(15,7) default 0 not null,  " +
                      " mmyy character varying(4) not null,computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20)) " +
                       " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_thucxuattutruc OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_thucxuattutruc add constraint pk_m_thucxuattutruc primary key(idylenhthuocds,stt);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_thucxuattutruc drop constraint fk_thucxuattutruc_ylenhthuocds ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".m_thucxuattutruc drop constraint fk_thucxuattutruc_theodoi ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".m_thucxuattutruc add  constraint fk_thucxuattutruc_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_thucxuattutruc add constraint fk_thucxuattutruc_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_thucxuattutruc add constraint fk_thucxuattutruc_dmdoituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_thucxuattutruc add constraint ck_thucxuattutruc_soluong check (soluong>0);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_phieuduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_phieuduyet(idphieuduyet number(30) default 0 not null,ngay timestamp without time zone default sysdate not null, idkhoaphong number(3) default 0 not null," +
                      " idtutruc number(3) default 0 not null,idphieu number(3) default 0 not null, trangthai number(1) default 0 not null, mmyy character varying(4) not null,  " +
                      " noiphatsinh number(1) default 0,  computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phieuduyet OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phieuduyet add constraint pk_m_phieuduyet primary key(idphieuduyet);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phieuduyet add constraint fk_phieuduyet_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phieuduyet add constraint fk_phieuduyet_dmkhoaphong foreign key(idkhoaphong) references " + sSchema + ".m_dmkhoaphong (idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phieuduyet add constraint fk_phieuduyet_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phieuduyet add constraint fk_phieuduyet_dmphieu foreign key(idphieu) references " + sSchema + ".m_dmphieu (idphieu) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_xuatnoiviends'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_xuatnoiviends(idxuatnoiviends number(30) default 0 not null,idphieuduyet number(30) default 0 not null,maql number(30) default 0 not null, " +
                      " idkhoa number(30) default 0 not null,idylenhthuocds number(30) default 0 not null,ngayylenh timestamp without time zone not null,ghichu text, mmyy character varying(4) not null,  " +
                      " idktcao number(30) default 0 not null,computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))  " +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoiviends OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoiviends add constraint pk_m_xuatnoiviends primary key(idxuatnoiviends);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoiviends drop constraint fk_xuatnoiviends_phieuduyet ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoiviends drop constraint fk_xuatnoiviends_ylenhthuocds ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoiviends drop constraint fk_xuatnoiviends_benhandt;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_xuatnoivienct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_xuatnoivienct(idxuatnoiviends number(30) default 0 not null,stt number(3) default 1 not null,idtheodoi number(30) default 0 not null," +
                      " madoituong number(3) default 2 not null,idkho number(3) default 0 not null, soluong number(20,7) default 0 not null,cachdung text, ghichu text,  " +
                      " idktcao number(30) default 0 not null,mmyy character varying(4) not null,computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoivienct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoivienct add constraint pk_m_xuatnoivienct primary key(idxuatnoiviends,stt);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoivienct add constraint fk_xuatnoivienct_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoivienct drop constraint fk_xuatnoivienct_theodoi ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoivienct drop constraint fk_xuatnoivienct_xuatnoiviends ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoivienct add constraint fk_xuatnoivienct_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoivienct add constraint fk_xuatnoivienct_dmdoituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatnoivienct add constraint ck_xuatnoivienct_soluong check (soluong>0);\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='m_tienthuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_tienthuoc(idxuatnoiviends number(30) default 0 not null,stt number(3) default 1 not null,idbietduoc number(7) default 0 not null, " +
                      " madoituong number(3) default 2 not null,soluong number(15,7) default 0 not null,giaban number(24,8) default 0 not null,  " +
                      " idttrv number(30) default 0 not null,  " +
                      " mmyy character varying(4) not null,computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                       " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tienthuoc OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tienthuoc add constraint pk_m_tienthuoc primary key(idxuatnoiviends,stt);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tienthuoc drop constraint fk_tienthuoc_xuatnoiviends ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".m_tienthuoc add constraint fk_tienthuoc_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tienthuoc add constraint fk_tienthuoc_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tienthuoc add constraint fk_tienthuoc_dmdoituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tontutrucchitiet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_tontutrucchitiet(mmyy character varying(4) not null,idkho number(3) not null,idtutruc number(3) not null,idtheodoi number(30) not null,  " +
                      " soluongtondau number(24,8) default 0 not null,soluongnhap number(24,8) default 0 not null,soluongxuat number(24,8) default 0 not null," +
                      " soluongkiemke number(24,8) default 0 not null,computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tontutrucchitiet OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_tontutrucchitiet add constraint pk_m_tontutrucchitiet primary key(mmyy,idkho,idtutruc,idtheodoi)  ;\n";
                    s_Sql += "alter table " + sSchema + ".m_tontutrucchitiet drop constraint fk_tontutrucchitiet_theodoi ;\n";//linh28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='m_tontutructonghop'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_tontutructonghop(mmyy character varying(4) not null,idkho number(2) not null,idtutruc number(3) not null,idbietduoc number(7) not null, " +
                      " idnguon number(3) not null,soluongtondau number(24,8) default 0 not null,soluongnhap number(24,8) default 0 not null,soluongxuat number(24,8) default 0 not null,  " +
                      " soluongkiemke number(24,8) default 0 not null,computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_tontutructonghop OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_tontutructonghop add constraint pk_tontutructonghop primary key(mmyy,idkho,idtutruc,idbietduoc,idnguon);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='khoaphong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add khoaphong character varying(3000);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='doituong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add doituong character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='nhomkho'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add nhomkho character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='kho'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add kho character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='nhomthuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add nhomthuoc character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='duocthuhoi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add duocthuhoi number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='duoctaosolieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add duoctaosolieu number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='duocchuyensolieudutru'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add duocchuyensolieudutru number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='dmxuatkhac'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add dmxuatkhac character varying(100);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='duocsuaphieunhap'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add duocsuaphieunhap number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnuoc' and column_name='ma'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnuoc add ma character varying(3);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_nhapll'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_nhapll(idnhap number(30) default 0, mmyy character varying(4) not null, sophieu character varying(20),  ngaynhap timestamp without time zone, " +
                      " sohoadon character varying(254), ngayhoadon timestamp without time zone, bienbankiemnhap character varying(15), ngaykiem timestamp without time zone, loai number(2) default 0 not null,   " +
                      " idkhoaphongduoc number(3,0) default 0 not null, nguoigiao text, idnhacungcap number(5) default 0 not null, idkho number(3) default 0,   " +
                      " idnguon number(2) default 0 not null, no character varying(254), co character varying(10), paid number(1) default 0 not null,   " +
                      " lanin number(3) default 0 not null, computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                      "  WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_nhapll OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_nhapll add constraint pk_m_nhapll primary key(idnhap);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_nhapll add constraint fk_nhapll_nhacungcap foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_nhapll add constraint fk_nhapll_kho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_nhapll add constraint fk_nhapll_nguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_nhapll add constraint fk_nhapll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_nhapct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_nhapct(idnhap number(30) default 0, stt number(3) default 0 not null, mmyy character varying(4) not null,   " +
                      " idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null, soluong1 number(30,8) default 0 not null, " +
                      " soluong2 number(30,8) default 0 not null, tyle number(7,2) default 0 not null, computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                       "  WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_nhapct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_nhapct add constraint pk_m_nhapct primary key(idnhap,stt);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_nhapct drop constraint fk_nhapct_nhapll ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".m_nhapct drop constraint fk_nhapct_theodoi ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".m_nhapct add constraint fk_nhapct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmmucdodiung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dmmucdodiung(id number(3) not null, ten text,username character varying(20),  " +
                      " ngayud timestamp without time zone DEFAULT sysdate,DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                       " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmmucdodiung OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmmucdodiung add CONSTRAINT pk_p_dmmucdodiung PRIMARY KEY (id);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_diungthuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_diungthuoc(mabn character varying(14) not null, tenhoatchat text,  " +
                    " idmucdo number(3) DEFAULT 0 not null,username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,  " +
                      " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_diungthuoc OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_diungthuoc add CONSTRAINT pk_p_diungthuoc PRIMARY KEY (mabn,tenhoatchat);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_diungthuoc add CONSTRAINT fk_p_diungthuoc_mucdodiung FOREIGN KEY(idmucdo) REFERENCES " + sSchema + ".p_dmmucdodiung(id) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_diungthuoc add CONSTRAINT fk_p_diungthuoc_dmbenhnhan FOREIGN KEY(mabn) REFERENCES " + sSchema + ".p_dmbenhnhan(mabn) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dausinhton'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dausinhton(id number(30)  DEFAULT 0 not null, maql number(30) default 0 not null,  " +
                      " idkhoa number(30) DEFAULT 0 not null,mach number(5) default 0 not null,nhietdo number(7,2) default 0 not null , " +
                      " huyetap character varying(7),cannang number(7,2) default 0 not null, chieucao number(5) default 0 not null,   " +
                      " nhiptho number(5) default 0 not null, ngay timestamp without time zone default sysdate,mabs character varying(4),manv character varying(4),  " +
                      " username character varying(20),phong text,giuong text,ghichu text,dienbien text,  " +
                      " idylenhthuocds number(30) default 0 not null,  " +
                      " ngayud timestamp without time zone DEFAULT sysdate,DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                       " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dausinhton OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dausinhton add CONSTRAINT pk_p_dausinhton PRIMARY KEY (id);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dausinhton drop CONSTRAINT fk_p_dausinhton_benhandt ;\n";//linh28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='p_benhmantinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_benhmantinh(mabn character varying(14) not null, ngay timestamp without time zone default sysdate not null, chandoan text,  " +
                      " maicd character varying(10) DEFAULT 0 not null,ghichu text,username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,  " +
                      " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                       "  WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_benhmantinh OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_benhmantinh add CONSTRAINT pk_p_benhmantinh PRIMARY KEY (mabn,maicd);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_benhmantinh add CONSTRAINT fk_p_benhmantinh_dmbenhnhan FOREIGN KEY(mabn) REFERENCES " + sSchema + ".p_dmbenhnhan(mabn) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhtiensu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_benhtiensu(id number(30) default 0 not null, mabn character varying(14) not null, ngay timestamp without time zone default sysdate, chandoan text, " +
                      "  maicd character varying(10) DEFAULT 0 not null,ghichu text,username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,  " +
                      "  DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                       " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_benhtiensu OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_benhtiensu add CONSTRAINT pk_p_benhtiensu PRIMARY KEY (id);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_benhtiensu add CONSTRAINT fk_p_benhtiensu_dmbenhnhan FOREIGN KEY(mabn) REFERENCES " + sSchema + ".P_dmbenhnhan(mabn) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_benhtiensu add CONSTRAINT fk_p_benhtiensu_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmlydoxuat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmlydoxuat(idlydo number(2) default 0, tenlydo text , tenkhongdau character varying(150),   " +
                      " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmlydoxuat OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmlydoxuat add constraint pk_m_dmlydoxuat primary key(idlydo);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmlydoxuat add constraint fk_dmlydoxuat_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_xuatll'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_xuatll(idxuat number(30) default 0, mmyy character varying(4) not null, sophieu character varying(20),  ngay timestamp without time zone not null,  " +
                      " loai number(2) default 0 not null,idkhoxuat number(3,0) default 0 not null, idkhonhap number(3,0) default 0 not null, idtutruc number(3) default 0 not null,  " +
                      " iddutrucap number(30) default 0 not null,lanin number(3) default 0 not null,idlydoxuat number(2) default 0 not null,ghichu text," +
                      " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                        "  WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatll OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatll add constraint pk_m_xuatll primary key(idxuat);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatll add constraint fk_xuatll_dmkhoxuat foreign key(idkhoxuat) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatll add constraint fk_xuatll_dmkhonhap foreign key(idkhonhap) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatll add constraint fk_xuatll_dmkhoaphong foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatll add constraint fk_xuatll_dmlydoxuat foreign key(idlydoxuat) references " + sSchema + ".m_dmlydoxuat(idlydo) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatll add constraint fk_xuatll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='m_xuatct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_xuatct(idxuat number(30) default 0, stt number(3) default 0 not null, mmyy character varying(4) not null,   " +
                      " idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null,   " +
                      " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatct add constraint pk_m_xuatct primary key(idxuat,stt);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_xuatct drop constraint fk_xuatct_theodoi ;\n";//linh28/6/14
                }
                s_Sql += "alter TABLE " + sSchema + ".M_YLENHTHUOC ADD CONSTRAINT UK_YLENHTHUOC_ID UNIQUE (NGAY,IDKHOAPHONG,IDTUTRUC,IDPHIEU);\n";
                s_Sql += "alter table " + sSchema + ".m_dmkhoaphong add constraint fk_mdmkp_pdmkp foreign key(idkhoaphongbenhvien) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + ".m_dmphieu add constraint fk_dmphieu_dmnhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuocct' and column_name='solan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add solan number(2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuocct' and column_name='sovien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add sovien number(5,2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketqua'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_ketqua(idketqua number(30,0) default 0,mmyy character varying(4),sophieu number(30,0) default 0 not null,mabn character varying(14),  " +
                      " maql number(30,0) default 0 not null,idkhoa number(30,0) default 0 not null,ngay timestamp without time zone,idkhoaphong number(3) default 0 not null,mabschidinh character varying(4), " +
                      " loaibn number(1,0) default 0 not null,tinhtrang number(1,0) default 0 not null,maicd character varying(10),chandoan text,  " +
                      " madoituong number(2,0) default 0 not null,maktv character varying(4),ngayra timestamp without time zone,mabsdoc character varying(4),ghichu text,nhanxet text, " +
                      " ketluan text,denghi text,mabenhpham text,stt character varying(200),lanin number(3,0) default 0 not null,  " +
                      " ngaylaymau timestamp without time zone default sysdate,dalaymau number(1,0) default 0 not null,traketqua number(1,0) default 0 not null,id_khu number(1,0) default 0 not null,  " +
                      " username character varying(20),ngayud timestamp without time zone default sysdate,computer character varying(50),mainkey character varying(15))" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_ketqua OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".l_ketqua add constraint pk_l_ketqua primary key(idketqua);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_ketquachitiet(idketqua number(30,0) default 0,idxetnghiem number(7,0) default 0,mmyy character varying(4),  " +
                      " idchidinh number(30,0) default 0 not null,idxuatnoivien number(30,0) default 0 not null,ketqua text,ketqua_ori text, " +
                      " ghichu text,done number(1,0) default 0 not null,id_may number(5,0) default 0 not null,ketqua_hople number(1,0) default 0 not null,  " +
                      " username character varying(20),ngayud timestamp without time zone default sysdate,computer character varying(50),chaylai number(1,0) default 0 not null," +
                      "lydochaylai text,ketquachaylai text,mabschidinh character varying(4),maicd character varying(10),chandoan text)" +//ThanhCuong - 01/04/2015
                       " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".l_ketquachitiet OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add constraint pk_l_ketquachitiet primary key(idketqua,idxetnghiem);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_ketquachitiet drop constraint fk_l_kqchitiet_l_ketqua ;\n";//linh28/6/14
                s_Sql += "alter table " + sSchema + ".l_ketquachitiet drop constraint fk_l_kqchitiet_b_chidinh ;\n";//linh28/6/14
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='idsoxetnghiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add idsoxetnghiem character varying(20);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_ketqua add constraint fk_l_kq_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_tondau' and column_name='idtutruc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tondau add idtutruc number(3) default 0 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".m_tondau add constraint fk_tondau_dmkp foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='maicdnoigioithieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add maicdnoigioithieu character varying(10);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='chandoannoigioithieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add chandoannoigioithieu text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_theodoi' and column_name='thanhtien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_theodoi add column thanhtien number(24,8) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan' and column_name='idnuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add idnuoc number(5,0) default 0 not null;\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".P_DMBENHNHAN ADD CONSTRAINT FK_DMBENHNHAN_DMNUOC FOREIGN KEY (IDNUOC) REFERENCES " + sSchema + ".M_DMNUOC (IDNUOC) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuoc' and column_name='idphieuduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuoc add idphieuduyet character varying(254);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='chenhlech'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add chenhlech number(1,0) default 0 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".m_ylenhthuocct drop constraint CK_YLENHTHUOCCT_SLPHAT_SLYC;\n";
                r_Col = dtAllColumn.Select("table_name='r_ketquall'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".r_ketquall(IDKETQUA number(30,0) DEFAULT 0,NGAY timestamp without time zone DEFAULT sysdate,NGAYCHUP timestamp without time zone DEFAULT sysdate,  " +
                              " MAQL number(30,0) DEFAULT 0  not null,LOAIBN number(1,0) DEFAULT 0,MABS character varying(4), MAKTV character varying(4), MAKTV1 character varying(4),  " +
                              " TINHTRANG number(2,0) DEFAULT 0,GHICHU TEXT, LANIN number(2,0) DEFAULT 0, MACANLAMSANG number(12,0) DEFAULT 0,    " +
                              " USERNAMECHUP character varying(20),COMPUTER character varying(50),USERNAME character varying(20),NGAYUD timestamp without time zone DEFAULT sysdate)" +
                              " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".r_ketquall OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".r_ketquall add constraint pk_r_ketquall primary key(IDKETQUA)  ;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_ketquact'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".R_KETQUACT(IDKETQUA number(30,0) DEFAULT 0  not null,MAKT number(7,0) DEFAULT 0  not null,SOLAN number(1,0) DEFAULT 0  not null, " +
                              " DONGIA number(18,4) DEFAULT 0  not null,IDKHOA number(30,0) DEFAULT 0  not null,IDCHIDINH number(30,0) DEFAULT 0  not null,NGAYCHIDINH timestamp without time zone DEFAULT sysdate,  " +
                              " TINHTRANGCHIDINH number(2,0) DEFAULT 0  not null, MABS character varying(4),MAKP number (3,0) DEFAULT 0  not null , MADOITUONG number(2,0) DEFAULT 0  not null,  " +
                              " MAICD character varying(9),CHANDOAN TEXT, GHICHU TEXT,IDPTTT number(30,0) DEFAULT 0 not null,  " +
                              " IDXUATNOIVIENDS number(30,0) DEFAULT 0 not null,IDDUOC_TOA number(30,0) DEFAULT 0  not null,IDMAY number(3,0) DEFAULT 0 not null,  " +
                              " KYTHUAT TEXT,MOTA text,KETLUAN TEXT,DENGHI TEXT,IDTTRV number(30,0) DEFAULT 0 not null,  " +
                              " IDCHIDINH_THEM character varying(200),NGAYUD timestamp without time zone DEFAULT sysdate,KHONGTRALOIKETQUA number(1,0) DEFAULT 0 not null)" +
                              " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".R_KETQUACT alter mota type text;\n";
                    s_Sql += "alter TABLE " + sSchema + ".R_KETQUACT OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".R_KETQUACT add constraint pk_r_ketquact primary key(idketqua,makt);\n";
                }
                s_Sql += "alter table " + sSchema + ".r_dmkythuat add constraint uk_r_dmkythuat_idvp unique(idvp);\n";

                s_Sql += "alter table " + sSchema + ".r_ketquall drop constraint fk_ketquall_benhandt ;\n";//linh28/6/14
                s_Sql += "alter table " + sSchema + ".r_ketquall add constraint fk_ketquall_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + ".r_ketquact drop constraint fk_ketquact_ketquall ;\n";//linh28/6/14
                s_Sql += "alter table " + sSchema + ".r_ketquact drop constraint fk_ketquact_chidinh ;\n";//linh28/6/14
                s_Sql += "alter table " + sSchema + ".r_ketquact add constraint fk_ketquact_dmkhoaphongbv foreign key(makp) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + ".r_ketquact add constraint fk_ketquact_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + ".r_ketquact add constraint fk_ketquact_dmmay foreign key(idmay) references " + sSchema + ".r_dmmay(idmay) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='manghenghiep'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add manghenghiep character varying(3);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='idnuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add IDNUOC number(5,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='phai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add PHAI number(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='huongthan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add huongthan number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='gaynghien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add gaynghien number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_toathuocll'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_toathuocll(idtoathuoc number(30) default 0, mmyy character varying(4), ngay timestamp without time zone, maql number(30) DEFAULT 0 not null,   " +
                      " trangthai number(1) DEFAULT 0 not null, songay number(2) DEFAULT 0 not null, idduyet number(30) DEFAULT 0 not null,  " +
                      " idkhoaphong number(3), mabs character varying(4), chandoan text, maicd character varying(10), lanin number(2) DEFAULT 0 not null,   " +
                      " idkythuatcao number(30) DEFAULT 0 not null, COMPUTER character varying(50),loidan text ,ghichu text,idnhomphieu number(2,0) DEFAULT 0 not null," +
                      " USERNAME character varying(20), NGAYUD timestamp without time zone DEFAULT sysdate)" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_toathuocll OWNER TO " + sUserID + ";\n";

                    s_Sql += "alter table " + sSchema + ".p_toathuocll add constraint pk_p_toathuocll primary key(idtoathuoc);\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocll drop constraint fk_toathuoc_benhandt ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".p_toathuocll add constraint fk_toathuoc_khoaphong foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocll add constraint fk_toathuoc_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocll add constraint fk_toathuoc_dmnhomphieu foreign key(idnhomphieu) references " + sSchema + ".m_dmnhomphieu(idnhomphieu) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocll add constraint fk_toathuocll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_toathuocct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_toathuocct(idtoathuoc number(30) default 0, mmyy character varying(4), stt number(3) DEFAULT 0, madoituong number(2) default 0 not null, idbietduoc number(7) DEFAULT 0 not null,songay number(2) DEFAULT 0 not null," +
                      " idkho number(3) default 0 not null, soluongyeucau number(12,4) default 0 not null,soluongphat number(12,4) DEFAULT 0 not null, idnguon number(2) default 0 not null,   " +
                      " cachdung text, sang character varying(10), trua character varying(10), chieu character varying(10), toi character varying(10)  " +
                      " , ghichu text, COMPUTER character varying(50),USERNAME character varying(20), NGAYUD timestamp without time zone DEFAULT sysdate)" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_toathuocct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint pk_p_toathuocct primary key(idtoathuoc,stt);\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocct drop constraint fk_toathuocct_toathuocll ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint fk_toathuoc_doituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint fk_toathuoc_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint fk_toathuoc_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint fk_toathuoc_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint fk_toathuocct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmlydovaovien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmlydovaovien(idlydovaovien number(5,0),tenlydovaovien text,username character varying(20),ngayud timestamp without time zone default sysdate,computer varchar(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmlydovaovien OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmlydovaovien add constraint pk_dmlydovaovien primary key(idlydovaovien);\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmlydovaovien add constraint fk_dmlydovaovien_user foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='idlydodieutri'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add idlydodieutri number(5,0) default 0 not null;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuoc' and column_name='sophieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuoc add sophieu character varying(20);\n";
                }
                s_Sql += "alter table " + sSchema + ".p_benhandt alter column para type character varying(11);\n";
                r_Col = dtAllColumn.Select("table_name='b_tamungcd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".b_tamungcd(id number(30)  DEFAULT 0 not null," +
                    " maql number(30) DEFAULT 0 not null,  idkhoa number(30) DEFAULT 0 not null, idkhoaphong number(3) DEFAULT 0 not null, " +
                    " ngay timestamp without time zone default sysdate, madoituong number(2) DEFAULT 0 not null,loaibn number(2) DEFAULT 0 not null,idtamung number(30) default 0 not null," +
                    " sotien number(15,4) DEFAULT 0 not null, done number(1) DEFAULT 0 not null,lan number(5) default 1 ," +
                    " username character varying(20), usernamenl character varying(20), ngayud timestamp without time zone DEFAULT sysdate, " +
                    " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_tamungcd OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".b_tamungcd add CONSTRAINT pk_b_tamungcd PRIMARY KEY (id);\n";
                    s_Sql += "alter table " + sSchema + ".b_tamungcd drop CONSTRAINT fk_b_tamungcd_benhandt ;\n";//linh28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".b_vienphi(idvienphi number(30)  DEFAULT 0 not null," +
                    " maql number(30) DEFAULT 0 not null,  idkhoa number(30) DEFAULT 0 not null, idkhoaphong number(3) DEFAULT 0 not null, giuong character varying(20)," +
                    " ngayvao timestamp without time zone not null, ngayra timestamp without time zone not null, chandoan TEXT,maicd character varying(50), diemthu number(2) default 0 not null," +
                    " loai number(2) default 0, idquyenso number(5) DEFAULT 0 not null, sobienlai number(10) default 0 not null," +
                    " ngay timestamp without time zone default sysdate, sotien number(15,4) DEFAULT 0 not null, sotientamung number(15,4) DEFAULT 0 not null," +
                    " mien number(15,4) DEFAULT 0 not null,sotienbhyttra number(15,4) DEFAULT 0 not null, lanin number(2) DEFAULT 0 not null," +
                    " idtonghop number(30) default 0 not null, chenhlech number(15,4) DEFAULT 0 not null,idquyensodv number(15,4) default 0 not null," +
                    " sobienlaidv number(15,4) default 0 not null,username character varying(20), usernamenl character varying(20), miencs number(15,4) DEFAULT 0 not null," +
                    " miendv number(15,4) DEFAULT 0 not null,miencs_ngaytt timestamp without time zone,sophieu number(10) default 0 not null,ngayud timestamp without time zone DEFAULT sysdate," +
                    " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_vienphi OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphi add CONSTRAINT pk_b_vienphi PRIMARY KEY (idvienphi);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphi drop CONSTRAINT fk_b_vienphi_benhandt ;\n";//linh28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphict'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".b_vienphict(idvienphi number(30)  DEFAULT 0 not null, stt number(5) default 0 not null,ngay timestamp without time zone default sysdate," +
                    " idkhoaphong number(3) DEFAULT 0 not null, madoituong number(2) DEFAULT 0 not null," +
                    " idgiavienphi number(7) default 0 not null,soluong number(15,4) default 0 not null," +
                    " dongia number(15,4) default 0 not null, vat number(7,2) default 0 not null,sotien number(15,4) default 0 not null," +
                    " sothe character varying(20), giamua number(15,4) default 0 not null, tra number(15,4) default 0 not null," +
                    " ngaytra timestamp without time zone default sysdate,bhytduyet number(1) default 0 not null,bhyttra number(15,4),idtonghop number(30) default 0 not null," +
                    " idkhoaphongthuchien number(3) default 0 not null, gia_bh number(15,4) default 0 not null, mien number(15,4) DEFAULT 0 not null," +
                    " mabs character varying(4),tylemien number(10,5) default 0 not null, ngayud timestamp without time zone DEFAULT sysdate," +
                    " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50 ))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_vienphict OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict add CONSTRAINT pk_b_vienphict PRIMARY KEY (idvienphi,stt);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict drop constraint fk_b_vienphict_vienphi ;\n";//linh28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add stt number(2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmxutri' and column_name='phongluu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmxutri add phongluu number(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmxutri' and column_name='ngoaitru'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmxutri add ngoaitru number(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketqua' and column_name='nguoilaymau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketqua add nguoilaymau character varying(4);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmloaipttt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dmloaipttt(idloaipttt number(1) not null,tenloaipttt text, username character varying(20),ngayud timestamp without time zone DEFAULT sysdate," +
                    " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmloaipttt OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmloaipttt add constraint pk_p_dmloaipttt primary key(idloaipttt);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmloaipttt add constraint fk_p_dmloaipttt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmloainhompttt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dmloainhompttt(idloainhompttt number(1) default 0 not null, tenloainhompttt text, username character varying(20),ngayud timestamp without time zone DEFAULT sysdate," +
                    " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmloainhompttt OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmloainhompttt add constraint pk_p_dmloainhompttt primary key(idloainhompttt);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmloainhompttt add constraint fk_p_dmloainhompttt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhompttt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dmnhompttt(manhompttt character varying(3),tennhompttt text,idloainhompttt number(1) default 1 not null, username character varying(20),ngayud timestamp without time zone DEFAULT sysdate," +
                    " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnhompttt OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmnhompttt add constraint pk_p_dmnhompttt primary key(manhompttt);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmnhompttt add constraint fk_p_dmnhompttt_loainhompttt foreign key(idloainhompttt) references " + sSchema + ".p_dmloainhompttt(idloainhompttt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmnhompttt add constraint fk_p_dmnhompttt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmgaymegayte'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dmgaymegayte(idgaymegayte number(2) default 0 not null, tengaymegayte text, username character varying(20),ngayud timestamp without time zone DEFAULT sysdate," +
                    " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmgaymegayte OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmgaymegayte add constraint pk_p_dmgaymegayte primary key(idgaymegayte);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmgaymegayte add constraint fk_p_dmgaymegayte_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphuongphappttt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dmphuongphappttt(maphuongphappttt character varying(7) not null, tenphuongphappttt text, " +
                    " idloaipttt number(1) default 1 not null,manhompttt character varying(3),idgiavienphi number(7,0) default 0 not null,username character varying(20),ngayud timestamp without time zone DEFAULT sysdate," +
                    " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmphuongphappttt OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add constraint pk_p_dmphuongphappttt primary key(maphuongphappttt);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add constraint fk_p_dmphuongphappttt_dmgiavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add constraint fk_p_dmphuongphappttt_dmloaipttt foreign key(idloaipttt) references " + sSchema + ".p_dmloaipttt(idloaipttt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add constraint fk_p_dmphuongphappttt_nhompttt foreign key(manhompttt) references " + sSchema + ".p_dmnhompttt(manhompttt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add constraint fk_p_dmphuongphappttt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_duyetchiphi(idduyetchiphi number(30) default 0, mmyy character varying(4) not null, ngay timestamp without time zone default sysdate not null, maql number(30) DEFAULT 0 not null," +
                    " idquyenso number(5) default 0 not null, sobienlai number(10) default 0 not null,idkhoaphong number(3) default 0 not null," +
                    " tongtienthuoc number(24,8) default 0 not null, tongtiencls number(24,8) default 0 not null, bntra number(24,8) default 0 not null, bhyttra number(24,8) default 0 not null," +
                    " trangthai number(1) default 0 not null, idtonghop number(30) DEFAULT 0 not null, idkythuatcao number(30) DEFAULT 0 not null," +
                    " idttrv number(30) DEFAULT 0 not null, COMPUTER character varying(50),USERNAME character varying(20), NGAYUD timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_duyetchiphi OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add idnhomphieu number(2,0) DEFAULT 0 not null;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add constraint pk_m_duyetchiphi primary key(idduyetchiphi);\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi drop constraint fk_duyetchiphi_benhandt ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add constraint fk_duyetchiphi_khoaphong foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add constraint fk_duyetchiphi_dmnhomphieu foreign key(idnhomphieu) references " + sSchema + ".m_dmnhomphieu(idnhomphieu) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add constraint fk_duyetchiphi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphithuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_duyetchiphithuoc(idduyetchiphi number(30) default 0, stt number(3) DEFAULT 0, mmyy character varying(4), soluong number(12,4) DEFAULT 0 not null, " +
                    " dongia number(12,4) default 0 not null, idtheodoi number(30) DEFAULT 0 not null, idkho number(3) default 0 not null, idtoathuoc number(30) DEFAULT 0 not null, " +
                    " COMPUTER character varying(50),USERNAME character varying(20), NGAYUD timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_duyetchiphithuoc OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add madoituong number(2) default 0 not null;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add constraint pk_m_duyetchiphithuoc primary key(idduyetchiphi,stt);\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc drop constraint fk_duyetchiphithuoc_chiphi ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc drop constraint fk_duyetchiphithuoc_theodoi ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add constraint fk_duyetchiphithuoc_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add constraint fk_duyetchiphithuoc_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphicls'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_duyetchiphicls(idduyetchiphi number(30) default 0, stt number(3) DEFAULT 0, mmyy character varying(4), soluong number(12,4) DEFAULT 0 not null, " +
                    " dongia number(12,4) default 0 not null, idgiavienphi number(7) DEFAULT 0 not null, idchidinh number(30) DEFAULT 0 not null, COMPUTER character varying(50)," +
                    " USERNAME character varying(20), NGAYUD timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_duyetchiphicls OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add constraint pk_m_duyetchiphicls primary key(idduyetchiphi,stt);\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphicls drop constraint fk_duyetchiphicls_chiphi ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphicls drop constraint fk_duyetchiphicls_chidinh ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add constraint fk_duyetchiphicls_dmgiavienphi foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add constraint fk_duyetchiphicls_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphicls' and column_name='madoituong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add madoituong number(2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuocct' and column_name='idtheodoi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add idtheodoi number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmdiadiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmdiadiem(iddiadiem number(3,0) default 0,tendiadiem character varying(50),stt number(3,0) default 0 not null,username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmdiadiem OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmdiadiem add constraint pk_p_dmdiadiem primary key(iddiadiem);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbophan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmbophan(idbophan number(1,0) default 0,tenbophan character varying(50),stt number(5,0) default 0 not null,username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmbophan OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmbophan add constraint pk_p_dmbophan primary key(idbophan);\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='p_dmnguyennhantainan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnguyennhantainan(idnguyennhan number(2,0) default 0,tennguyennhan text,stt number(3,0) default 0 not null,username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnguyennhantainan OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmnguyennhantainan add constraint pk_p_dmnguyennhantainan primary key(idnguyennhan);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmngodoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmngodoc(idngodoc number(1,0) default 0,tenngodoc text,stt number(3,0) default 0 not null,username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                   " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmngodoc OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmngodoc add constraint pk_p_dmngodoc primary key(idngodoc);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmdienbien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmdienbien(iddienbien number(1,0) default 0,tendienbien text,stt number(2,0) default 0 not null,username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmdienbien OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmdienbien add constraint pk_p_dmdienbien primary key(iddienbien);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmxutritainan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmxutritainan(idxutritainan number(1,0) default 0,tenxutritainan text,stt number(2,0) default 0 not null,username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                     " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmxutritainan OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmxutritainan add constraint pk_p_dmxutritainan primary key(idxutritainan);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_tainanthuongtich'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_tainanthuongtich(maql number(30,0) default 0,ngay timestamp without time zone not null,iddiadiem number(1,0) default 0 not null,idbophan number(1,0) default 0 not null,idnguyennhan number(2,0) default 0 not null," +
                       "  idngodoc number(1,0) default 0 not null,iddienbien number(1,0) default 0 not null,idxutritainan number(1,0) default 0 not null,thon text,matinhthanh character varying(3)," +
                        " maquanhuyen character varying(5),maphuongxa character varying(7),lydo text,chandoan text,dieutri text,lucvao text, " +
                        " lucra text,socap number(1,0) default 0,phuongtienvaovien text,phuongtientainan text,phuongtiengaytainan number(2,0) default 0 not null," +
                        " phuongtiengaytainankhac text,mubaohiem number(1,0) default 0 not null,gaiquai number(1,0) default 0 not null,bivo number(1,0) default 0 not null," +
                        " loaimu text,ruoubia number(1,0) default 0 not null,camquan number(1,0) default 0 not null,doconmau number(5,0) default 0 not null," +
                        " doconhoitho number(5,0) default 0 not null,sonao number(1,0) default 0 not null,glassgow number(5,0) default 0 not null,cotsongco number(1,0) default 0 not null," +
                        " chanthuongkhac number(1,0) default 0 not null,nhapvien number(1,0) default 0 not null,mocapcuu number(1,0) default 0 not null,tuvong number(1,0) default 0 not null," +
                        " xinve number(1,0) default 0 not null,mabenhvien character varying(10),manhanvien character varying(4), " +
                        " username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_tainanthuongtich OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add constraint pk_p_tainanthuongtich primary key(maql);\n";
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmdiadiem foreign key(iddiadiem) references " + sSchema + ".p_dmdiadiem(iddiadiem) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmbophan foreign key(idbophan) references " + sSchema + ".p_dmbophan(idbophan) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmnguyennhantainan foreign key(idnguyennhan) references " + sSchema + ".p_dmnguyennhantainan(idnguyennhan) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmngodoc foreign key(idngodoc) references " + sSchema + ".p_dmngodoc(idngodoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmdienbien foreign key(iddienbien) references " + sSchema + ".p_dmdienbien(iddienbien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmxutritainan foreign key(idxutritainan) references " + sSchema + ".p_dmxutritainan(idxutritainan) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuocct' and column_name='ngayylenh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add ngayylenh timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocct alter column ngayylenh type timestamp without time zone ;\n";
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocct alter column ngayylenh set not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmnguyennhantainan alter column idnguyennhan type number(2);\n";
                s_Sql += "alter table " + sSchema + ".p_dmnguyennhantainan alter column idnguyennhan set default 0 ;\n";
                s_Sql += "alter table " + sSchema + ".p_dmnguyennhantainan alter column idnguyennhan set not null;\n";
                s_Sql += "alter table " + sSchema + ".p_tainanthuongtich alter column idnguyennhan type number(2);\n";
                s_Sql += "alter table " + sSchema + ".p_tainanthuongtich alter column idnguyennhan set default 0;\n";
                s_Sql += "alter table " + sSchema + ".p_tainanthuongtich alter column idnguyennhan set not null;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmmaupttt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dmmaupttt(mamaupttt character varying(10) not null,tenmaupttt text,maphuongphappttt character varying(7)," +
                    " mabs character varying(4),idkhoaphong number(3),noidung text, idgiavienphi number(7), manvpt character varying(4), manvphu1 character varying(4), manvphu2 character varying(4),manvgayme1 character varying(4)," +
                    " manvgayme2 character varying(4), manvhoisuc character varying(4), manvdungcu character varying(4), manvphumo character varying(4)," +
                    " username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmmaupttt OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint pk_p_dmmaupttt primary key(mamaupttt);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmgiavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmpppttt foreign key (maphuongphappttt) references " + sSchema + ".p_dmphuongphappttt(maphuongphappttt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmkhoaphongbv foreign key(idkhoaphong) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien1 foreign key(manvpt) references " + sSchema + ".P_DMNHANVIEN(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien2 foreign key (manvphu1) references " + sSchema + ".P_DMNHANVIEN(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien3 foreign key (manvphu2) references " + sSchema + ".P_DMNHANVIEN(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien4 foreign key (manvgayme1) references " + sSchema + ".P_DMNHANVIEN(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien5 foreign key (manvgayme2) references " + sSchema + ".P_DMNHANVIEN(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien6 foreign key (manvhoisuc) references " + sSchema + ".P_DMNHANVIEN(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien7 foreign key (manvdungcu) references " + sSchema + ".P_DMNHANVIEN(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien8 foreign key (manvphumo) references " + sSchema + ".P_DMNHANVIEN(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtinhhinhpt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dmtinhhinhpt(idtinhhinhpt number(1) not null,tentinhhinhpt text, " +
                    " username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmtinhhinhpt OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".P_DMTINHHINHPT add constraint pk_p_dmtinhhinhpt PRIMARY KEY (idtinhhinhpt);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmtinhhinhpt add CONSTRAINT fk_p_dmtinhhinhpt_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtaibienpt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dmtaibienpt(idtaibienpt number(1) not null,tentaibienpt text," +
                    " username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmtaibienpt OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmtaibienpt add CONSTRAINT pk_p_dmtaibienpt PRIMARY KEY (idtaibienpt);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmtaibienpt add CONSTRAINT fk_p_dmtaibienpt_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtuvongpt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dmtuvongpt(idtuvongpt number(1) not null,tentuvongpt text, " +
                    " username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmtuvongpt OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmtuvongpt add CONSTRAINT pk_p_dmtuvongpt PRIMARY KEY (idtuvongpt);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmtuvongpt add CONSTRAINT fk_p_dmtuvongpt_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphongmo'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_dmphongmo(idphongmo number(2) not null,tenphongmo text,idkhoaphong number(3)," +
                    " username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmphongmo OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphongmo add CONSTRAINT pk_p_dmphongmo PRIMARY KEY (idphongmo);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphongmo add constraint fk_p_dmphongmo_dmkhoaphongbv foreign key (idkhoaphong) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphongmo add CONSTRAINT fk_p_dmphongmo_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_pttt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_pttt(idpttt number(30) default 0 not null,maql number(30) default 0 not null,sophieu number(5) default 0 not null, " +
                     " idkhoaphong number(3) default 0 not null,ngay timestamp without time zone default sysdate,maicdtruoc character varying(50),chandoantruoc text,maicdsau character varying(50), " +
                     " chandoansau text,maphuongphappttt character varying(7),idgaymegayte number(2) default 0 not null,idtinhhinhpt number(1) default 0 not null, " +
                     " maphauthuatvien character varying(4),idtaibienpt number(1) default 0 not null,idtuvongpt number(1) default 0 not null,mamau character varying(10),ngayketthuc " +
                     " timestamp without time zone default sysdate,manvphu1 character varying(4),manvphu2 character varying(4),manvgayme1 character varying(4),manvgayme2 character varying(4),manvhoisuc character varying(4), " +
                     " manvdungcu character varying(4),noidungtuongtrinh text,phuongphapthucte text, " +
                     " idphongmo number(2) default 0 not null,somat number(1) default 0 not null,molaimienphi number(1) default 0 not null,idxuatnoivien " +
                     " number(30) default 0 not null,idkhoa number(30) default 0 not null, " +
                     " idgiavienphi number(7) default 0 not null,idloaipttt number(1) default 0 not null, " +
                     " noisoi number(1) default 0 not null,idchidinh number(30) default 0 not null,ghichu text,lanin number(2),mmyy character varying(4)," +
                     " username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                     " WITH (OIDS=true);\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt alter noidungtuongtrinh type text;\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_pttt OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add CONSTRAINT pk_p_pttt PRIMARY KEY (idpttt);\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt drop constraint fk_p_pttt_benhandt ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_khoaphongbv foreign key (idkhoaphong) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmgaymegayte foreign key (idgaymegayte) references  " + sSchema + ".P_DMGAYMEGAYTE(idgaymegayte) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmtinhhinhpt foreign key (idtinhhinhpt) references " + sSchema + ".P_DMTINHHINHPT(idtinhhinhpt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmtaibienpt foreign key (idtaibienpt) references " + sSchema + ".P_DMTAIBIENPT(idtaibienpt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmtuvongpt foreign key (idtuvongpt) references " + sSchema + ".P_DMTUVONGPT(idtuvongpt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmphongmo foreign key (idphongmo) references " + sSchema + ".p_dmphongmo(idphongmo) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmgiavp foreign key (idgiavienphi) references " + sSchema + ".B_DMGIAVIENPHI(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmloaipttt foreign key (idloaipttt) references " + sSchema + ".p_dmloaipttt(idloaipttt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien1 foreign key (maphauthuatvien) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien2 foreign key (manvphu1) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien3 foreign key (manvphu2) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien4 foreign key (manvgayme1) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien5 foreign key (manvgayme2) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien6 foreign key (manvhoisuc) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien7 foreign key (manvdungcu) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt add CONSTRAINT fk_p_pttt_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_xuatnoivienct' and column_name='ngayylenh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add ngayylenh timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".m_xuatnoivienct alter column ngayylenh type timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".m_xuatnoivienct alter column ngayylenh set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tienthuoc' and column_name='ngayylenh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tienthuoc add ngayylenh timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".m_tienthuoc alter column ngayylenh type timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".m_tienthuoc  alter column ngayylenh set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_tainanthuongtich' and column_name='idkhoaphong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add idkhoaphong number(3) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_tainanthuongtich' and column_name='idkhoa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add idkhoa number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnguyennhanchet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnguyennhanchet(idnguyennhanchet number(1,0),tennguyennhanchet text,username character varying(20),computer character varying(50)," +
                    " ngayud timestamp without time zone default sysdate not null)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnguyennhanchet OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmnguyennhanchet add constraint pk_p_dmnguyennhanchet primary key(idnguyennhanchet);\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='p_dmtinhtranggpb'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmtinhtranggpb(idtinhtranggpb number(1,0),tentinhtranggpb text,username character varying(20),computer character varying(50)," +
                    " ngayud timestamp without time zone default sysdate not null)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmtinhtranggpb OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmtinhtranggpb add constraint pk_p_dmtinhtranggpb primary key(idtinhtranggpb);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_tuvong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_tuvong(maql number(30,0),ngaynhan timestamp without time zone,ngaymo timestamp without time zone,chandoan text,maicd character varying(10)," +
                    " idnguyennhanchet number(1,0) default 0 not null,ghichu text,idtinhtranggpb number(1,0) default 0 not null," +
                    " khamtuthi number(1,0) default 0 not null,idkhoaphong number(3,0) default 0 not null,idkhoa number(30,0) default 0 not null," +
                    " username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate not null)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_tuvong OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_tuvong add constraint pk_p_tuvong primary key(maql);\n";
                    s_Sql += "alter table " + sSchema + ".p_tuvong add constraint fk_p_tuvong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_tuvong add constraint fk_p_tuvong_dmnguyennhanchet foreign key(idnguyennhanchet) references " + sSchema + ".p_dmnguyennhanchet(idnguyennhanchet) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_tuvong add constraint fk_p_tuvong_dmtinhtranggpb foreign key(idtinhtranggpb) references " + sSchema + ".p_dmtinhtranggpb(idtinhtranggpb) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_tuvong add constraint fk_p_tuvong_dmkhoaphongbenhvien foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongsothebhyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_thongsothebhyt(id number(7),kitu character varying(10),tuvitri number(2) default 0 not null,denvitri number(2) default 0 not null," +
                    " bhyttra number(3))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_thongsothebhyt OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_thongsothebhyt add constraint pk_thongsobhyt primary key(id,kitu);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_tuvong' and column_name='ngay'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_tuvong add ngay timestamp without time zone default sysdate not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmdoituong' and column_name='loaigia'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmdoituong add loaigia number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_hinhanh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + SchemaImage + ".r_hinhanh ( idketqua number (30,0) default 0 not null, stt number (2,0) default 0 not null," +
                         "  hinhanh blob,  COMPUTER character varying(50),   USERNAME character varying(20),   NGAYUD timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + SchemaImage + ".r_hinhanh OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table  " + SchemaImage + ".r_hinhanh add constraint pk_r_hinhanh primary key(IDKETQUA,STT);\n";
                    s_Sql += "alter table  " + SchemaImage + ".r_hinhanh drop constraint fk_hinhanh_ketquall ;\n";//linh 28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='m_nhapll' and column_name='vat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_nhapll add vat number(3) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_nhapct' and column_name='thanhtien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_nhapct add thanhtien number(24,4) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmnhomvienphibhyt' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmnhomvienphibhyt add stt number(2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmphai(idphai number(1,0), tenphai text,computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmphai OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphai add constraint pk_p_dmphai primary key(idphai);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhommau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnhommau(manhommau character varying(3), tennhommau character varying(100),computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnhommau OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmnhommau add constraint pk_p_dmnhommau primary key(manhommau);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhomuser'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnhomuser(idnhomuser number(3,0), tennhomuser text,computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnhomuser OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmnhomuser add constraint pk_p_dmnhomuser primary key(idnhomuser);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmloaikythuatvienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_dmloaikythuatvienphi(idloaikythuatvienphi number(3,0), tenloaikythuatvienphi text,computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_dmloaikythuatvienphi OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".b_dmloaikythuatvienphi add constraint pk_b_dmloaikythuatvienphi primary key(idloaikythuatvienphi);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtinhtrangthuchiencls'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmtinhtrangthuchiencls(idtinhtrangthuchiencls number(3,0), tentinhtrangthuchiencls text,computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmtinhtrangthuchiencls OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmtinhtrangthuchiencls add constraint pk_p_dmtinhtrangthuchiencls primary key(idtinhtrangthuchiencls);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmloaibn'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmloaibn(idloaibn number(3,0), tenloaibn text,computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmloaibn OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmloaibn add constraint pk_p_dmloaibn primary key(idloaibn);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhantu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnhantu(idnhantu number(1,0), tennhantu text,computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnhantu OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmnhantu add constraint pk_p_dmnhantu primary key(idnhantu);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmdentu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmdentu(iddentu number(1,0), tendentu text,computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmdentu OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmdentu add constraint pk_p_dmdentu primary key(iddentu);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmfieldgia'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_dmfieldgia(mafieldgia character varying(20), tenfieldgia text,computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_dmfieldgia OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".b_dmfieldgia add constraint pk_b_dmfieldgia primary key(mafieldgia);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhanhen'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmbenhnhanhen(mabn character varying(14),hobenhnhan text not null,chulotbenhnhan text," +
                     " tenbenhnhan text not null,ngaysinh timestamp without time zone, namsinh number(4) default 0 not null, tuoi character varying(4) not null," +
                        " phai number(1) default 0 not null,sonha character varying(50),thon text, cholam text, matinhthanh character varying(3) not null, " +
                        " maquanhuyen character varying(5) not null,maphuongxa character varying(7) not null,tenkhongdau text, mmyy text,dienthoai character varying(20)," +
                        " didong character varying(20),dienthoaicoquan character varying(20),mail character varying(254)," +
                        " username character varying(50) default 0, ngayud timestamp without time zone default sysdate, computer character varying(50))" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmbenhnhanhen OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhanhen add constraint pk_p_dmbenhnhanhen primary key(mabn);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhanhen add constraint fk_dmbenhnhanhen_dmtinhthanh foreign key(matinhthanh) references " + sSchema + ".p_dmtinhthanh(matinhthanh) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhanhen add constraint fk_dmbenhnhanhen_dmquanhuyen foreign key(maquanhuyen) references " + sSchema + ".p_dmquanhuyen(maquanhuyen) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhanhen add constraint fk_dmbenhnhanhen_dmphuongxa foreign key(maphuongxa) references " + sSchema + ".p_dmphuongxa(maphuongxa) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lichhen'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_lichhen(idlichhen number(30,0),mmyy character varying(4),macuochen character varying(14),mabs character varying(4),noihen text,mabn character varying(10)," +
                        " idkhoaphong number(3),giobatdau character varying(5),gioketthuc character varying(5),ngay timestamp without time zone default sysdate,noidung text,slot number(3,0)," +
                        " tinhtrang number(1,0) default 0,username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                         " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_lichhen OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_lichhen add constraint pk_p_lichhen primary key(idlichhen);\n";
                    //s_Sql += "alter table " + sSchema + ".p_lichhen add constraint un_p_lichhen unique(ngay,mabs,giobatdau);\n"; linh 22/9/15
                    s_Sql += "alter table " + sSchema + ".p_lichhen add constraint fk_p_lichhen_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichhen add constraint fk_p_lichhen_dmkhoaphongbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichhen add constraint fk_p_lichhen_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lichlamviecbacsi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_lichlamviecbacsi(idlichlamviec number(30,0),mmyy character varying(4),mabs character varying(4),giobatdau character varying(5),gioketthuc character varying(5),ngay timestamp without time zone," +
                        " noidung text,slot number(3,0),username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                       " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_lichlamviecbacsi OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_lichlamviecbacsi add constraint pk_p_lichlamviecbacsi primary key(idlichlamviec);\n";
                    s_Sql += "alter table " + sSchema + ".p_lichlamviecbacsi add constraint un_p_lichlamviecbacsi unique(ngay,mabs,giobatdau);\n";
                    s_Sql += "alter table " + sSchema + ".p_lichlamviecbacsi add constraint fk_p_lichlamviec_dmnv foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichlamviecbacsi add constraint fk_p_lichlamviec_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_sophieuduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_sophieuduyet(mmyy character varying(4), idphieuduyet number(30),idnhom number(3),sophieu number(5) default 0 not null,kihieu character varying(20)," +
                     " computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate)" +
                       " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_sophieuduyet OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_sophieuduyet add constraint pk_m_sophieuduyet primary key(idphieuduyet,idnhom);\n";
                    s_Sql += "alter table " + sSchema + ".m_sophieuduyet drop constraint fk_m_sophieuduyet_phieuduyet ;\n";//linh 28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='kyrakhoa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhanvien add kyrakhoa number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='kyravien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhanvien add kyravien number(1) default 0 not null;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='p_giayravien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_giayravien(maql number(30) default 0 not null,phuongphapdieutri text," +
                    " loidanbacsi text,manvkyravien character varying(4),lanin number(2)," +
                    " ketquagiaiphaubenhly text, manhommau character varying(3), rh character varying(50), ngaytaikham timestamp without time zone, taikham text," +
                    " mabacsitaikham character varying(4),chandoan text,manvkyrakhoa character varying(4),tinhtrangnguoibenhlucravien text," +
                    " username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_giayravien OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_giayravien add CONSTRAINT pk_p_giayravien PRIMARY KEY (maql);\n";
                    s_Sql += "alter table " + sSchema + ".p_giayravien add constraint fk_p_giayravien_dmnhanvien1 foreign key (manvkyravien) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_giayravien add constraint fk_p_giayravien_dmnhommau foreign key (manhommau) references " + sSchema + ".p_dmnhommau(manhommau) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_giayravien add constraint fk_p_giayravien_dmnhanvien2 foreign key (mabacsitaikham) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_giayravien add constraint fk_p_giayravien_dmnhanvien3 foreign key (manvkyrakhoa) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_giayravien add CONSTRAINT fk_p_giayravien_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphi' and column_name='sophieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add sophieu character varying(14) default 0 not null;\n";
                }
                s_Sql += "alter table  " + sSchema + ".p_lichhen alter mabn type varchar(14);\n";
                s_Sql += "alter table  " + sSchema + ".p_dmnhommau alter tennhommau type text;\n";
                r_Col = dtAllColumn.Select("table_name='m_xuatll' and column_name='idnhacungcap'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_xuatll add idnhacungcap number(5) default 0 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".m_xuatll add CONSTRAINT fk_m_xuatll_dmnhacungcap FOREIGN KEY(idnhacungcap) REFERENCES " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='idvienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table  " + sSchema + ".l_ketquachitiet add idvienphi number(7,0) default 0 not null;\n";
                }
                s_Sql += "alter table  " + sSchema + ".l_ketquachitiet drop constraint pk_l_ketquachitiet;\n";
                s_Sql += "alter table  " + sSchema + ".l_ketquachitiet add constraint pk_l_ketquachitiet primary key(idketqua,idxetnghiem,idvienphi);\n";
                r_Col = dtAllColumn.Select("table_name='p_dausinhton' and column_name='idpttt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table  " + sSchema + ".p_dausinhton add idpttt number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhtiensu' and column_name='loai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table  " + sSchema + ".p_benhtiensu add loai number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan' and column_name='idthesmartcard'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add idthesmartcard character varying(15);\n";
                    s_Sql += "update " + sSchema + ".p_dmbenhnhan set idthesmartcard=mabn where idthesmartcard is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhan alter idthesmartcard set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add constraint uk_dmnhannhan_idsmartcard unique(idthesmartcard);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_capmabenhnhan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_capmabenhnhan(mmyy character varying(4),idkhoaphong number(3,0) default 0 not null,dauso number(1,0) default 0 not null," +
                        " giatri number(6,0) default 0 not null,username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate not null)" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_capmabenhnhan OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_capmabenhnhan add constraint pk_p_capmabenhnhan primary key(mmyy);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='idbenhtiensu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add idbenhtiensu number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tienthuoc' and column_name='idktcao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tienthuoc add idktcao number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan_hinhanh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + SchemaImage + ".p_dmbenhnhan_hinhanh ( mabn character varying(14) not null, " +
                         " hinhanh blob,  COMPUTER character varying(50),   USERNAME character varying(20),   NGAYUD timestamp without time zone DEFAULT sysdate)" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + SchemaImage + ".p_dmbenhnhan_hinhanh OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table  " + SchemaImage + ".p_dmbenhnhan_hinhanh add constraint pk_p_dmbenhnhan_hinhanh primary key(mabn);\n";
                    //s_Sql += "alter table  " + SchemaImage + ".p_dmbenhnhan_hinhanh add constraint fk_dmbn_dmbenhnhan_hinhanh foreign key(mabn) references " + sSchema + ".p_dmbenhnhan(mabn) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";//ThanhCuong - 11/06/2015 - bỏ key lưu hình nền mabn='188'
                }
                s_Sql += "alter table  " + SchemaImage + ".p_dmbenhnhan_hinhanh drop constraint fk_dmbn_dmbenhnhan_hinhanh;\n";//ThanhCuong - 11/06/2015
                r_Col = dtAllColumn.Select("table_name='p_giaychuyenvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".p_giaychuyenvien(maql number(30) default 0 not null,mabenhvien character varying(10)," +
                    " hangbv number(1,0),lamsang text, xetnghiem text, chandoan text, thuoc text," +
                    " tinhtrang text,lydochuyenvien text,ngay timestamp without time zone default sysdate,phuongtienvanchuyen text," +
                    " nguoidua text,lanin number(2) default 0,username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,DONGBO character varying(100) DEFAULT lpad('0',100,'0'), " +
                    " COMPUTER character varying(50))" +
                     " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_giaychuyenvien OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add CONSTRAINT pk_p_giaychuyenvien PRIMARY KEY (maql);\n";
                    s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add CONSTRAINT fk_p_giaychuyenvien_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan_hinhanh' and column_name='idhinhanh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table  " + SchemaImage + ".P_DMBENHNHAN_HINHANH add idhinhanh number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan_hinhanh' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table  " + SchemaImage + ".P_DMBENHNHAN_HINHANH add stt number(2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan_hinhanh' and column_name='loai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table  " + SchemaImage + ".P_DMBENHNHAN_HINHANH add loai number(3) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan_hinhanh' and column_name='duongdan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table  " + SchemaImage + ".P_DMBENHNHAN_HINHANH add duongdan varchar(1024);\n";
                }
                s_Sql += "alter table  " + SchemaImage + ".p_dmbenhnhan_hinhanh drop constraint pk_p_dmbenhnhan_hinhanh;\n";

                s_Sql += "alter table  " + SchemaImage + ".p_dmbenhnhan_hinhanh add constraint pk_p_dmbenhnhan_hinhanh primary key(mabn,loai,stt,idhinhanh);\n";
                r_Col = dtAllColumn.Select("table_name='r_dmloaicdha' and column_name='hinhdicom'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmloaicdha add hinhdicom number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='s_dmchucnang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".s_dmchucnang(machucnang character varying(50), tenchucnang text,chucnangcha text," +
                    " loaichucnang number(2) default 0 not null,benhvien number(1) default 0 not null)" +
                     " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".s_dmchucnang OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".s_dmchucnang add computer character varying(50);\n";
                    s_Sql += "alter table " + sSchema + ".s_dmchucnang add ngayud timestamp without time zone default sysdate not null;\n";
                    s_Sql += "alter table " + sSchema + ".s_dmchucnang add username character varying(20);\n";
                    s_Sql += "alter table " + sSchema + ".s_dmchucnang add constraint pk_s_dmchucnang primary key(machucnang,loaichucnang);\n";
                    s_Sql += "alter table " + sSchema + ".s_dmchucnang add constraint fk_s_dmchucnang_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_quyennguoidung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_quyennguoidung(username character varying(20),machucnang character varying(50),loaichucnang number(2),computer character varying(50)," +
                    " ngayud timestamp without time zone default sysdate,userphanquyen character varying(20))" +
                     " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_quyennguoidung OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_quyennguoidung add constraint pk_p_quyennguoidung primary key(username,machucnang,loaichucnang);\n";
                    s_Sql += "alter table " + sSchema + ".p_quyennguoidung add constraint fk_p_quyennguoidung_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_quyennguoidung add constraint fk_p_quyennguoidung_chucnang foreign key (machucnang,loaichucnang) references " + sSchema + ".s_dmchucnang(machucnang,loaichucnang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_quyennguoidung add constraint fk_p_quyennguoidung_user foreign key (userphanquyen) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                s_Sql += "alter table " + sSchema + ".b_dmgiavienphi alter bhyt_traituyen type number(5,2);\n";
                s_Sql += "alter table " + sSchema + ".b_dmgiavienphi alter bhyt_traituyen set default 0;\n";
                r_Col = dtAllColumn.Select("table_name='p_giaychuyenvien' and column_name='sochuyenvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add sochuyenvien character varying(50);\n";
                }
                else { s_Sql += "alter table " + sSchema + ".p_giaychuyenvien alter sochuyenvien character varying(50);\n"; }//ThanhCuong - 15/07/2015
                s_Sql += "alter table " + sSchema + ".m_xuatnoiviends drop column ngayylenh;\n";
                r_Col = dtAllColumn.Select("table_name='m_sophieumau38'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_sophieumau38(mabn character varying(14),mavaovien number(30) default 0 not null, ngay timestamp without time zone default sysdate not null, loaibenhan number(1) default 3 not null," +
                    " sophieu number(12) default 0 not null, lanin number(5) default 1 not null,lydoinlai text,lydohuy text,computer character varying(50)," +
                    " ngayud timestamp without time zone default sysdate not null,username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_sophieumau38 OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_sophieumau38 add mmyy character varying(4);\n";
                    s_Sql += "alter table " + sSchema + ".m_sophieumau38 add constraint pk_m_sophieumau38 primary key(mavaovien,ngay,loaibenhan);\n";
                    s_Sql += "alter table " + sSchema + ".m_sophieumau38 add constraint fk_m_sophieumau38_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphictthuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".b_vienphictthuoc(idvienphi number(30)  DEFAULT 0 not null, stt number(5) default 0 not null,ngay timestamp without time zone default sysdate," +
                    " idkhoaphong number(3) DEFAULT 0 not null, madoituong number(2) DEFAULT 0 not null," +
                    " idgiavienphi number(7) default 0 not null,soluong number(15,4) default 0 not null," +
                    " dongia number(22,4) default 0 not null, vat number(7,2) default 0 not null,sotien number(22,4) default 0 not null," +
                    " sothe character varying(20), giamua number(22,4) default 0 not null, tra number(15,4) default 0 not null," +
                    " ngaytra timestamp without time zone default sysdate,bhytduyet number(1) default 0 not null,bhyttra number(15,4),idtonghop number(30) default 0 not null," +
                    " idkhoaphongthuchien number(3) default 0 not null, gia_bh number(15,4) default 0 not null, mien number(15,4) DEFAULT 0 not null," +
                    " mabs character varying(4),tylemien number(5,2) default 0 not null, ngayud timestamp without time zone DEFAULT sysdate," +
                    " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_vienphictthuoc OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add CONSTRAINT pk_vienphictthuoc PRIMARY KEY (idvienphi,stt);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc drop constraint fk_vienphictthuoc_vienphi ;\n";//linh28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015,//Tú:19/06/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphi add mmyy character varying(4);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphict' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015,//Tú:19/06/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphict add mmyy character varying(4);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphictthuoc' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015,//Tú:19/06/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add mmyy character varying(4);\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphicls' and column_name='mabs'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015,//Tú:19/06/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add mabs character varying(4);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphict' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015,//Tú:19/06/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphict add username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphictthuoc' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015,//Tú:19/06/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphichuavuottran'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".b_vienphichuavuottran(idvienphi number(30)  DEFAULT 0 not null, stt number(5) default 0 not null,ngay timestamp without time zone default sysdate," +
                        " idkhoaphong number(3) DEFAULT 0 not null, madoituong number(2) DEFAULT 0 not null," +
                        " idgiavienphi number(7) default 0 not null,soluong number(15,4) default 0 not null," +
                        " dongia number(22,4) default 0 not null, vat number(7,2) default 0 not null,sotien number(22,4) default 0 not null," +
                        " sothe character varying(20), giamua number(22,4) default 0 not null, tra number(15,4) default 0 not null," +
                        " ngaytra timestamp without time zone default sysdate,bhytduyet number(1) default 0 not null,bhyttra number(15,4),idtonghop number(30) default 0 not null," +
                        " idkhoaphongthuchien number(3) default 0 not null, gia_bh number(15,4) default 0 not null, mien number(15,4) DEFAULT 0 not null," +
                        " mabs character varying(4),tylemien number(5,2) default 0 not null,mmyy character varying(4),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate," +
                        " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_vienphichuavuottran OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran add CONSTRAINT b_vienphicvt PRIMARY KEY (idvienphi,stt);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran drop constraint fk_vienphicvt_vienphi ;\n";//linh28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='b_thuocchuavuottran'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".b_thuocchuavuottran(idvienphi number(30)  DEFAULT 0 not null, stt number(5) default 0 not null,ngay timestamp without time zone default sysdate," +
                        " idkhoaphong number(3) DEFAULT 0 not null, madoituong number(2) DEFAULT 0 not null," +
                        " idgiavienphi number(7) default 0 not null,soluong number(15,4) default 0 not null," +
                        " dongia number(22,4) default 0 not null, vat number(7,2) default 0 not null,sotien number(22,4) default 0 not null," +
                        " sothe character varying(20), giamua number(22,4) default 0 not null, tra number(15,4) default 0 not null," +
                        " ngaytra timestamp without time zone default sysdate,bhytduyet number(1) default 0 not null,bhyttra number(15,4),idtonghop number(30) default 0 not null," +
                        " idkhoaphongthuchien number(3) default 0 not null, gia_bh number(15,4) default 0 not null, mien number(15,4) DEFAULT 0 not null," +
                       "  mabs character varying(4),tylemien number(5,2) default 0 not null,mmyy character varying(4),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate," +
                        " DONGBO character varying(100) DEFAULT lpad('0',100,'0'), COMPUTER character varying(50))" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_thuocchuavuottran OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran add CONSTRAINT b_thuoccvt PRIMARY KEY (idvienphi,stt);\n";
                    s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran drop constraint fk_thuoccvt_vienphi ;\n";//linh28/6/14
                }
                r_Col = dtAllColumn.Select("table_name='s_useroption'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".s_useroption (username character varying(20),loaioption number(3),val character varying(50),userphanquyen character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".s_useroption OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".s_useroption add constraint pk_useroption primary key(username,loaioption);\n";
                    s_Sql += "alter table " + sSchema + ".s_useroption add constraint fk_useroptiondmuser foreign key (username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_solienhoadon'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_solienhoadon(id number(2),reportname character varying(100),solien number(2,0) default 1 not null,noidung text)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".b_solienhoadon OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".b_solienhoadon add constraint pk_b_solienhoadon primary key(id);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmicd' and column_name='tentienganh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmicd add tentienganh character varying(500);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_nhomquyenloibhyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_nhomquyenloibhyt(idnhomquyenloi number(2),tennhomquyenloi text,tuvitri number(2) default 0 not null," +
                    " denvitri number(2) default 0 not null) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_nhomquyenloibhyt OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_nhomquyenloibhyt add constraint pk_p_nhomquyenloibhyt primary key(idnhomquyenloi);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongsothebhyt' and column_name='nhomquyenloi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongsothebhyt add nhomquyenloi number(2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongso' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongso add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmviettat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_dmviettat(idviettat number(5,0),maviettat character varying(20),tenviettat character varying(254)," +
                       "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".l_dmviettat add constraint pk_l_dmviettat primary key(idviettat);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmgoiygioitinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmgoiygioitinh(id number(5,0),ten character varying(100),idphai number(1,0) default 0,username character varying(20)," +
                        "computer character varying(50),ngayud timestamp without time zone default sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmgoiygioitinh add constraint pk_p_dmgoiygioitinh primary key(id);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmgoiygioitinh add constraint fk_p_dmgoiygioitinh_dmphai foreign key(idphai) references " + sSchema + ".p_dmphai(idphai)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='nhanmaildutrumuahang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhanvien add nhanmaildutrumuahang number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='nhanmailbaohettonkho'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhanvien add nhanmailbaohettonkho number(1) default 0 not null;\n";//Thủy 11/06/2014
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='nhanmailbaohetdate'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhanvien add nhanmailbaohetdate number(1) default 0 not null;\n";//Thủy 11/06/2014
                }
                r_Col = dtAllColumn.Select("table_name='m_dutrumuall'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".m_dutrumuall(iddutrumua number(30) default 0, mmyy character varying(4), sophieu number(12,0) DEFAULT 0 not null, ngay timestamp without time zone default sysdate not null, sothang number(2) default 0 not null," +
                        "ghichu nvarchar2(254), trangthai number(1) default 0 not null, COMPUTER character varying(50), USERNAME character varying(20), NGAYUD timestamp without time zone DEFAULT sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrumuall add constraint pk_m_dutrumuall primary key(iddutrumua);\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrumuall add constraint fk_dutrumuall_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dutrumuact'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".m_dutrumuact(iddutrumua number(30) default 0, mmyy character varying(4), idbietduoc number(7,0) default 0 not null, " +
                        "soluongdutru number(30,8) default 0 not null,soluongduyet number(30,8) default 0 not null,idduyetdutrumua number(30) default 0 not null, " +
                        "soluongxuat number(30,8) default 0 not null,soluongton number(30,8) default 0 not null," +
                        "COMPUTER character varying(50), USERNAME character varying(20), NGAYUD timestamp without time zone DEFAULT sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact add constraint pk_m_dutrumuact primary key(iddutrumua,idbietduoc);\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact drop constraint fk_dutrumuact_dutrumuall ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact add constraint fk_dutrumuact_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact add constraint fk_dutrumuact_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetdutrumuall'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_duyetdutrumuall(idduyetdutrumua number(30) default 0, mmyy character varying(4) not null, sophieu character varying(20), ngay timestamp without time zone default sysdate not null, " +
                        "ghichu nvarchar2(254),computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetdutrumuall add constraint pk_m_duyetdutrumuall primary key(idduyetdutrumua);\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetdutrumuall add constraint fk_duyetdutrumuall_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetdutrumuact'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_duyetdutrumuact(idduyetdutrumua number(30) default 0, stt number(5) default 0 not null, mmyy character varying(4) not null, idbietduoc number(7,0) default 0 not null, " +
                        "soluong number(30,8) default 0 not null,computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetdutrumuact add constraint pk_m_duyetdutrumuact primary key(idduyetdutrumua,stt);\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetdutrumuact add constraint fk_duyetdutrumuact_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetdutrumuact add constraint fk_duyetdutrumuact_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmbenhnhan alter manghenghiepme type character varying(3);\n";
                s_Sql += "alter table " + sSchema + ".p_dmbenhnhan alter manghenghiepbo type character varying(3);\n";
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='idhoantra'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphi add idhoantra number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphict' and column_name='idhoantra'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphict add idhoantra number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphictthuoc' and column_name='idhoantra'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add idhoantra number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_tamung' and column_name='idhoantra'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_tamung add idhoantra number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='loaibn'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphi add loaibn number(2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_nhapct' and column_name='idduyetdutrumua'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_nhapct add idduyetdutrumua number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetdutrumuact' and column_name='soluongnhap'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetdutrumuact add soluongnhap number(30,8) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='loaibn'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add loaibn character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongsotylegiaban'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_thongsotylegiaban(id number(7,0),stt number(5,0),giamuatu number(20,4),giamuaden number(20,4),tyle number(5,2)," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".p_thongsotylegiaban add constraint pk_p_thongsotylegiaban primary key(id,stt);\n";
                    s_Sql += "alter table " + sSchema + ".p_thongsotylegiaban add constraint fk_p_thongsotylegiaban_thongso foreign key(id) references " + sSchema + ".p_thongso(id) on update restrict on delete restrict;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                #region ThanhCuong - 30/07/2015 - Kho máu
                r_Col = dtAllColumn.Select("table_name='bl_dmnguon'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_dmnguon(idnguon number(2,0) default 0, tennguon text, tenkhongdau character varying(150), " +
                        "idnhomkho number(2) default -1 not null,computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate,idnhib serial) WITH (OIDS=true);\n";
                    s_Sql += " alter TABLE " + sSchema + ".bl_dmnguon OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter table " + sSchema + ".bl_dmnguon add constraint pk_bl_dmnguon primary key(idnguon);\n";
                    s_Sql += " alter table " + sSchema + ".bl_dmnguon add constraint fk_blnguonmau_dmnhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_dmnguon add constraint fk_blnguonmau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomin'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_dmnhomin(idnhomin number(2) default 0, tennhomin text, tenkhongdau character varying(150), idnhomkho number(2) default -1 not null " +
                     " ,computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,idnhib serial)" +
                     " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmnhomin OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmnhomin add constraint pk_bl_dmnhomin primary key(idnhomin);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmnhomin add constraint fk_blmaunhomin_maunhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmnhomin add constraint fk_blmaunhomin_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmloaimau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_dmloaimau(idloai number(3) default 0, tenloai text, tenkhongdau character varying(150),nhom character varying(3), idnhomkho number(2) default -1 not null," +
                    " computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,idnhib serial)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmloaimau OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmloaimau add constraint pk_bl_dmloaimau primary key(idloai);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmloaimau add constraint fk_blloaimau_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmloaimau add constraint fk_blloaimau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_dmthetich(idthetich number(2) default 0, tenthetich text, tenkhongdau character varying(150), idnhomkho number(2) default -1 not null " +
                    ",thetich number(5) default 0 not null,dvt text,computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,idnhib serial)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmthetich OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmthetich add constraint pk_bl_dmthetich primary key(idthetich);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmthetich add constraint fk_blmauthetich_maunhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmthetich add constraint fk_blmauthetich_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomrhd'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_dmnhomrhd(idrhd number(2) default 0, tenrhd text, tenkhongdau character varying(150) " +
                    " ,computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmnhomrhd OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmnhomrhd add constraint pk_bl_dmnhomrhd primary key(idrhd);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmnhomrhd add constraint fk_blnhomrhd_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_dmmau(idmau number(7,0) default 0, mamau character varying(15), tenmau text, tenkhongdau character varying(150)," +
                        "dang text,idthetich number(2) default 0 not null, manhommau character varying(3) default 0 not null, " +
                        "idloaimau number(3) default 0 not null, bhyt number(3) default 0 not null,dongia number(24,10) default 0 not null,idnhomin number(2) default 0 not null," +
                        "hide number(1) default 0 not null, computer character varying(50), username character varying(20), ngayud timestamp without time zone DEFAULT sysdate,idnhib serial) WITH (OIDS=true);\n";
                    s_Sql += " alter TABLE " + sSchema + ".bl_dmmau OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter TABLE " + sSchema + ".bl_dmmau add constraint pk_bl_dmmau primary key(idmau);\n";
                    s_Sql += " alter table " + sSchema + ".bl_dmmau add constraint fk_bl_dmmau_thetich foreign key(idthetich) references " + sSchema + ".bl_dmthetich(idthetich) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_dmmau add constraint fk_bl_dmmau_loaimau foreign key(idloaimau) references " + sSchema + ".bl_dmloaimau(idloai) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_dmmau add constraint fk_bl_dmmau_nhommau foreign key(manhommau) references " + sSchema + ".p_dmnhommau(manhommau) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_dmmau add constraint fk_bl_dmmau_maunhomin foreign key(idnhomin) references " + sSchema + ".bl_dmnhomin(idnhomin) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_dmmau add constraint fk_bl_dmmau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_dmnhacungcap(idnhacungcap number(5) default 0, manhacungcap character varying(50), tennhacungcap text, tenkhongdau character varying(150)" +
                   ", dienthoai character varying(50), diachi text,computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,idnhib serial) WITH (OIDS=true);\n";
                    s_Sql += " alter TABLE " + sSchema + ".bl_dmnhacungcap OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter table " + sSchema + ".bl_dmnhacungcap add constraint pk_bl_dmnhacungcap primary key(idnhacungcap);\n";
                    s_Sql += " alter table " + sSchema + ".bl_dmnhacungcap add constraint fk_blmaunhacungcap_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_theodoi(mabichmau character varying(20), idmau number(7) default 0 not null, idnguon number(2) default 0 not null, " +
                        " ngaydieuche timestamp without time zone not null, handung timestamp without time zone not null, idnhacungcap number(5) default 0 not null, " +
                        "dongia number(12,4) default 0 not null, giaban number(12,4) default 0 not null, khaiton number(1) default 0 not null, nguoicho text, ngaylaymau timestamp without time zone not null,nhiembenh number(1) default 0 not null , " +
                       "computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate,mmyy varchar2(4) DEFAULT to_char(sysdate, 'mmyy'::text) NOT NULL,idnhib serial) WITH (OIDS=true);\n";
                    s_Sql += " alter TABLE " + sSchema + ".bl_theodoi OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter table " + sSchema + ".bl_theodoi add constraint pk_bl_theodoi primary key(mabichmau);\n";
                    s_Sql += " alter table " + sSchema + ".bl_theodoi add constraint fk_bl_theodoi_dmmau foreign key(idmau) references " + sSchema + ".bl_dmmau(idmau) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_theodoi add constraint fk_bl_theodoi_dmnguon foreign key(idnguon) references " + sSchema + ".bl_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_theodoi add constraint fk_bl_theodoi_dmnhacungcap foreign key(idnhacungcap) references " + sSchema + ".bl_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_theodoi add constraint fk_bl_theodoi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_tonkhochitiet(mmyy character varying(4), idkho number(3) default 0, mabichmau character varying(20), " +
                        " soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                        " soluongxuat number(30,8) default 0 not null, khoa number(1) default 0 not null, " +
                       "computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate,idnhib serial) WITH (OIDS=true);\n";
                    s_Sql += " alter TABLE " + sSchema + ".bl_tonkhochitiet OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter table " + sSchema + ".bl_tonkhochitiet add constraint pk_bl_tonkhochitiet primary key(mmyy,idkho,mabichmau);\n";
                    s_Sql += " alter table " + sSchema + ".bl_tonkhochitiet add constraint fk_bl_tonkhochitiet_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_tonkhochitiet drop constraint fk_bl_tonkhochitiet_theodoi ;\n";//linh28/6/14
                    s_Sql += " alter table " + sSchema + ".bl_tonkhochitiet add constraint fk_bl_tonkhochitiet_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_tonkhotonghop(mmyy character varying(4), idkho number(3) default 0, idmau number(7) default 0 not null, " +
                        " idnguon number(2) default 0 not null, soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                        " soluongxuat number(30,8) default 0 not null, soluongyeucau number(30,8) default 0 not null, " +
                       "computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate,idnhib serial) WITH (OIDS=true);\n";
                    s_Sql += " alter TABLE " + sSchema + ".bl_tonkhotonghop OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter table " + sSchema + ".bl_tonkhotonghop add constraint pk_bl_tonkhotonghop primary key(mmyy,idkho,idmau,idnguon);\n";
                    s_Sql += " alter table " + sSchema + ".bl_tonkhotonghop add constraint fk_bl_tonkhotonghop_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_tonkhotonghop add constraint fk_bl_tonkhotonghop_dmmau foreign key(idmau) references " + sSchema + ".bl_dmmau(idmau) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_tonkhotonghop add constraint fk_bl_tonkhotonghop_dmnguon foreign key(idnguon) references " + sSchema + ".bl_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_tonkhotonghop add constraint fk_bl_tonkhotonghop_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                s_Sql += " alter table " + sSchema + ".bl_tonkhotonghop add constraint pk_bl_tonkhotonghop primary key(mmyy,idkho,idmau,idnguon);\n";
                r_Col = dtAllColumn.Select("table_name='bl_tondau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_tondau(mmyy character varying(4), idkho number(3) default 0, mabichmau character varying(20), " +
                       "soluong number(30,8) default 0 not null, computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate,idnhib serial) WITH (OIDS=true);\n";
                    s_Sql += " alter TABLE " + sSchema + ".bl_tondau OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter table " + sSchema + ".bl_tondau add constraint pk_bl_tondau primary key(mmyy,idkho,mabichmau);\n";
                    s_Sql += " alter table " + sSchema + ".bl_tondau add constraint fk_bltondau_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += " alter table " + sSchema + ".bl_tondau add constraint fk_bltondau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                s_Sql += " alter table " + sSchema + ".bl_tondau drop constraint fk_bltondau_theodoi ;\n";
                r_Col = dtAllColumn.Select("table_name='bl_nhapll'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_nhapll(idnhap number(30) default 0, mmyy character varying(4) not null, sophieu character varying(20),  ngaynhap timestamp without time zone, " +
                      " loai number(2) default 0 not null, idnhacungcap number(5) default 0 not null, idkho number(3) default 0, idnguon number(2) default 0,ghichu text, computer character varying(50)," +
                      "username character varying(20), ngayud timestamp without time zone DEFAULT sysdate,idnhib serial) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_nhapll OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_nhapll add constraint pk_bl_nhapll primary key(idnhap);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_nhapll add constraint fk_nhapll_nhacungcap foreign key(idnhacungcap) references " + sSchema + ".bl_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_nhapll add constraint fk_nhapll_kho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_nhapll add constraint fk_nhapll_nguon foreign key(idnguon) references " + sSchema + ".bl_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_nhapll add constraint fk_nhapll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_nhapct(idnhap number(30) default 0, stt number(3) default 0 not null, mmyy character varying(4) not null, " +
                      " mabichmau character varying(20), soluong number(30,8) default 0 not null,ghichu text, computer character varying(50),username character varying(20), " +
                      "ngayud timestamp without time zone DEFAULT sysdate,idnhib serial) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_nhapct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_nhapct add constraint pk_bl_nhapct primary key(idnhap,stt);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_nhapct add constraint fk_nhapct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_xuatll(idxuat number(30) default 0, mmyy character varying(4) not null, sophieu character varying(20),  ngay timestamp without time zone not null,  " +
                      " loai number(2) default 0 not null,idkhoxuat number(3,0) default 0 not null, idkhonhap number(3,0) default 0 not null, idlydoxuat number(2,0) default 0 not null, idngoaivien number(5,0) default 0 not null, " +
                      "lanin number(3) default 0 not null,ghichu text,computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate,idnhib serial)" +
                        "  WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatll OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatll add constraint pk_bl_xuatll primary key(idxuat);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatll add constraint fk_xuatll_dmkhoxuat foreign key(idkhoxuat) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatll add constraint fk_xuatll_dmkhonhap foreign key(idkhonhap) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatll add constraint fk_xuatll_dmlydoxuat foreign key(idlydoxuat) references " + sSchema + ".m_dmlydoxuat(idlydo) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatll add constraint fk_xuatll_dmngoaivien foreign key(idngoaivien) references " + sSchema + ".bl_dmngoaivien(idngoaivien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatll add constraint fk_xuatll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_xuatct(idxuat number(30) default 0, stt number(3) default 0 not null, mmyy character varying(4) not null, " +
                      " mabichmau character varying(20), soluong number(30,8) default 0 not null, computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate,idnhib serial)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatct add constraint pk_bl_xuatct primary key(idxuat,stt);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_khoasolieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_khoasolieu(mmyy character varying(4), done number(1,0) default 0 not null, computer character varying(50)," +
                        "username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,idnhib serial) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_khoasolieu OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_khoasolieu add constraint pk_bl_khoasolieu primary key(mmyy);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmngoaivien'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".bl_dmngoaivien(idngoaivien number(5) default 0, tenngoaivien text, tenkhongdau character varying(150)" +
                     ",computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate,idnhib serial)" +
                     " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmngoaivien OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmngoaivien add constraint pk_bl_dmngoaivien primary key(idngoaivien);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmngoaivien add constraint fk_bldmngoaivien_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_ylenhmau(idylenhmau number(30) default 0 not null,ngay timestamp without time zone default sysdate not null, idkhoaphong number(3) default 0 not null,  " +
                      " idphieu number(3) default 0 not null, trangthai number(1) default 0 not null,idphieuduyet character varying(254),sophieu character varying(20), mmyy character varying(4) not null,  " +
                      " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20),idnhib serial)" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_ylenhmau OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_ylenhmau add constraint pk_bl_ylenhmau primary key(idylenhmau);\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_ylenhmauds(idylenhmauds number(30) default 0 not null,idylenhmau number(30) default 0 not null,maql number(30) default 0 not null, " +
                      " idkhoa number(30) default 0 not null,solandatruyen number(3) default 0 not null,ghichu text,taibien number(1) default 0 not null, mmyy character varying(4) not null, computer character varying(50),ngayud timestamp without time zone default sysdate," +
                      "username character varying(20),idnhib serial) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_ylenhmauds OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_ylenhmauds add constraint pk_bl_ylenhmauds primary key(idylenhmauds);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_ylenhmauct(idylenhmauds number(30) default 0 not null,stt number(3) default 1 not null,idmau number(7) default 0 not null, " +
                      " madoituong number(2) default 2 not null,idkho number(3) default 0 not null,idnguon number(2) default 0 not null, soluongyeucau number(20,7) default 0 not null,  " +
                      " soluongphat number(20,7) default 0 not null, ghichu text, mmyy character varying(4) not null,computer character varying(50),ngayud timestamp without time zone default sysdate," +
                      "username character varying(20),ngayylenh timestamp without time zone default sysdate,mabichmau character varying(20),idkey numeric(30,0) default 0 not null,idnhib serial)" +
                      "  WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_ylenhmauct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_ylenhmauct add constraint pk_bl_ylenhmauct primary key(idylenhmauds,stt);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_phieuduyet(idphieuduyet number(30) default 0 not null,ngay timestamp without time zone default sysdate not null, idkhoaphong number(3) default 0 not null," +
                      " idnhomphieu number(2) default -1 not null, trangthai number(1) default 0 not null, lanin number(3) default 0 not null, mmyy character varying(4) not null,  " +
                      " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyet OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyet add constraint pk_bl_phieuduyet primary key(idphieuduyet);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyet add constraint fk_phieuduyet_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyet add constraint fk_phieuduyet_dmkhoaphong foreign key(idkhoaphong) references " + sSchema + ".m_dmkhoaphong (idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyet add constraint fk_phieuduyet_dmphieu foreign key(idphieu) references " + sSchema + ".m_dmphieu (idphieu) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_xuatnoiviends(idxuatnoiviends number(30) default 0 not null,idphieuduyet number(30) default 0 not null,maql number(30) default 0 not null, " +
                      " idkhoa number(30) default 0 not null,idylenhmauds number(30) default 0 not null,ghichu text, mmyy character varying(4) not null,  " +
                      " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))  " +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoiviends OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoiviends add constraint pk_bl_xuatnoiviends primary key(idxuatnoiviends);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_xuatnoivienct(idxuatnoiviends number(30) default 0 not null,stt number(3) default 1 not null,mabichmau character varying(20)," +
                      " madoituong number(3) default 2 not null,idkho number(3) default 0 not null, soluong number(20,7) default 0 not null, ghichu text,mmyy character varying(4) not null," +
                      "soluongdinhnhom number(3) default 0 not null,sophanungcheo number(3) default 0 not null,cheo1 text,cheo2 text,cheocoombs text,dongia number(12,4) default 0 not null," +
                      "idttrv number(30) default 0 not null,ngayylenh timestamp without time zone not null,idmaugoc number(7) default 0 not null,tygiausd number(24,4) default 0 not null,computer character varying(50)," +
                      "ngayud timestamp without time zone default sysdate,username character varying(20),idkey number(30) default 0 not null) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoivienct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoivienct add constraint pk_bl_xuatnoivienct primary key(idxuatnoiviends,stt);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoivienct add constraint fk_xuatnoivienct_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoivienct add constraint fk_xuatnoivienct_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoivienct add constraint fk_xuatnoivienct_dmdoituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoivienct add constraint ck_xuatnoivienct_soluong check (soluong>0);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyetkho'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_phieuduyetkho(idphieuduyet number(30) default 0, idkho number(3) default 0, trangthai number(1) default 0 not null,mmyy character varying(4) not null, " +
                        "ngayud timestamp without time zone DEFAULT sysdate, computer character varying(50),username character varying(20),idnhib serial)" +
                   " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyetkho OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyetkho add constraint pk_bl_phieuduyetkho primary key(idphieuduyet,idkho);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyetkho add constraint fk_phieuduyetkho_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyetkho add constraint fk_phieuduyetkho_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dangduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_dangduyet(idkhoaphong numeric(3,0),ngay timestamp without time zone default sysdate not null," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate not null,idnhib serial) with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet add constraint pk_bl_dangduyet primary key(idkhoaphong);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmautd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_dmmautd(idmau number(7,0) default 0, idmautd number(7,0) default 0,soluong number(12,4) default 1 not null," +
                        " computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmmautd OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmmautd add constraint pk_bl_dmmautd primary key(idmau,idmautd);\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmmautd add constraint fk_dmmautd_dmmau foreign key(idmau) references " + sSchema + ".bl_dmmau(idmau) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".bl_dmmautd add constraint fk_dmmautd_dmmau1 foreign key(idmautd) references " + sSchema + ".bl_dmmau(idmau) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd add constraint fk_dmmautd_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheo'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_goikemtheo(idgoikemtheo number(7,0),tengoikemtheo text,tenkhongdau character varying(150),idloaimau number(3),noiphatsinh number(1) default 0 not null," +
                        "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate,idnhib serial) with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".bl_goikemtheo add constraint pk_bl_goikemtheo primary key(idgoikemtheo,idloaimau,noiphatsinh);\n";
                    s_Sql += "alter table " + sSchema + ".bl_goikemtheo add constraint fk_bl_goikemtheo_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) on update restrict on delete restrict;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bl_goikemtheoct(idgoikemtheo number(7,0),idgiavienphi number(7,0),soluong number(12,4) default 0 not null,madoituong number(2,0) default 0 not null,idnguon number(2,0) default 0 not null," +
                        "gia_th number(14,3) default 0 not null,gia_bh number(14,3) default 0 not null,gia_cs number(14,3) default 0 not null,gia_dv number(14,3) default 0 not null," +
                        "gia_nn number(14,3) default 0 not null,gia_ksk number(14,3) default 0 not null,gia_vip number(14,3) default 0 not null,username character varying(20)," +
                             "computer character varying(50),ngayud timestamp without time zone default sysdate,idnhib serial) with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".bl_goikemtheoct add constraint pk_bl_goikemtheoct primary key(idgoikemtheo,idgiavienphi);\n";
                    s_Sql += "alter table " + sSchema + ".bl_goikemtheoct add constraint fk_bl_goikemtheoct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) on update restrict on delete restrict;\n";
                }
                #endregion end kho máu

                #region ThanhCuong-18/06/2014-Trang Thiết Bị
                r_Col = dtAllColumn.Select("table_name='e_dmdang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_dmdang(iddang number(2) default 0, tendang nvarchar2(50), tenkhongdau varchar2(30),ngayud DATE DEFAULT sysdate," +
                        "computer varchar2(50),username varchar2(20)) WITH (OIDS=true);\n";
                    s_Sql += " alter TABLE " + sSchema + ".e_dmdang OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter table " + sSchema + ".e_dmdang add constraint pk_e_dmdang primary key(iddang);\n";
                    s_Sql += " alter table " + sSchema + ".e_dmdang add constraint fk_TTBdang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmhang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_dmhang(idhang number(5) default 0, tenhang text, tenkhongdau character varying(150), idnhomkho number(2) default 0 not null," +
                    " idnhomhang number(2) default 0 not null,computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmhang OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmhang add constraint pk_e_dmhang primary key(idhang);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmhang add constraint fk_TTBhang_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmhang add constraint fk_TTBhang_nhomhang foreign key(idnhomhang) references " + sSchema + ".m_dmnhomhang(idnhomhang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmhang add constraint fk_TTBhang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmnhomttb'");
                if (r_Col != null && r_Col.Length > 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "drop table " + sSchema + ".e_dmnhomttb cascade;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmnhom'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_dmnhom(idnhom number(3) default 0, tennhom text, tenkhongdau character varying(150), idnhomkho number(2) default 0 not null," +
                    " ngayud timestamp without time zone DEFAULT sysdate,computer character varying(50),username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmnhom OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".e_dmnhom add constraint pk_e_dmnhom primary key(idnhom);\n";
                s_Sql += "alter TABLE " + sSchema + ".e_dmnhom add constraint fk_TTBnhom_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".e_dmnhom add constraint fk_TTBnhom_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='e_dmloai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_dmloai(idloai number(3) default 0, tenloai text, tenkhongdau character varying(150), idnhomkho number(2) default 0 not null," +
                    " computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmloai OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmloai add constraint pk_e_dmloai primary key(idloai);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmloai add constraint fk_TTBloai_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmloai add constraint fk_TTBloai_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmttb'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_dmttb(idttb number(7,0) default 0, mattb character varying(15), tenttb text, tenkhongdau character varying(150)," +
                    " dang text, model character varying(50), sohieu varchar2(50), idnhomttb number(3) default 1 not null, idnhom number(3) default 0 not null,idloai number(3) default 0 not null," +
                    " idhang number(5) default 0 not null, idnuoc number(5) default 0 not null, idnhomkho number(2) default 0 not null, computer character varying(50)," +
                    " username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmttb OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint pk_e_dmttb primary key(idttb);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint fk_dmttb_hang foreign key(idhang) references " + sSchema + ".e_dmhang(idhang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint fk_dmttb_loai foreign key(idloai) references " + sSchema + ".e_dmloai(idloai) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint fk_dmttb_nhom foreign key(idnhom) references " + sSchema + ".e_dmnhom(idnhom) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint fk_dmttb_nuoc foreign key(idnuoc) references " + sSchema + ".m_dmnuoc(idnuoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint fk_dmttb_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".e_dmttb add constraint fk_dmttb_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmttb' and column_name='idnhomttb'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_dmttb add idnhomttb number(1);\n";
                    s_Sql += "update " + sSchema + ".e_dmttb set idnhomttb=1 where idnhomttb is null;\n";
                    s_Sql += "alter table " + sSchema + ".e_dmttb alter column idnhomttb set default 1;\n";
                    s_Sql += "alter table " + sSchema + ".e_dmttb alter column idnhomttb set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmnguon'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_dmnguon(idnguon number(2,0) default 0, tennguon text, tenkhongdau character varying(150), " +
                    " idnhomkho number(2) default 0 not null,computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmnguon OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmnguon add constraint pk_e_dmnguon primary key(idnguon);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmnguon add constraint fk_ttbnguon_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmkho'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_dmkho(idkho number(3,0) default 0, tenkho text, tenkhongdau character varying(150)," +
                    " idnhomkho number(2) default 0 not null,khotrungtam number(1) default 0 not null,thua number(1) default 0 not null,chuyenkho number(1) default 0 not null," +
                    "computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmkho OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmkho add constraint pk_e_dmkho primary key(idkho);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmkho add constraint fk_ttbkho_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_dmkho add constraint fk_ttbkho_dmnhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_theodoi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_theodoi(idtheodoi number(30) default 0, mmyy character varying(4), idttb number(7) default 0 not null, idnguon number(2) default 0 not null," +
                                    " idhang number(5) default 0 not null, idnuoc number(5) default 0 not null, ngaysanxuat timestamp without time zone, ngaysudung timestamp without time zone, " +
                                    "ngaytinhkhauhao timestamp without time zone, sohieu character varying(50), soquyetdinh character varying(50), idnhacungcap number(5) default 0 not null," +
                                    " giamua number(30,4) default 0 not null, nguyengia number(30,4) default 0 not null, tienchietkhau number(30,4) default 0 not null, tienvanchuyen number(30,4) default 0 not null, " +
                                    "chiphikhac number(30,4) default 0 not null, vat number(3) default 0 not null, phanbo number(3) default 0 not null, tylekhauhaothang number(10,4) default 0 not null," +
                                    " sotienkhauhaothang number(30,4) default 0 not null, tylekhauhaonam number(10,4) default 0 not null, sotienkhauhaonam number(30,4) default 0 not null, thoigiansudung number(3) default 0 not null, " +
                                    "giatriconlai number(30,4) default 0 not null, khaiton number(1) default 0 not null, " +
                                   " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_theodoi OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint pk_e_theodoi primary key(idtheodoi,mmyy);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmttb foreign key(idttb) references " + sSchema + ".e_dmttb(idttb) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmnguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmhang foreign key(idhang) references " + sSchema + ".e_dmhang(idhang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmnuoc foreign key(idnuoc) references " + sSchema + ".m_dmnuoc(idnuoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmnhacungcap foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                s_Sql += "alter table " + sSchema + ".e_theodoi alter tylekhauhaothang type number(10,4);\n";
                s_Sql += "alter table " + sSchema + ".e_theodoi alter tylekhauhaonam type number(10,4);\n";
                r_Col = dtAllColumn.Select("table_name='e_tonkhochitiet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_tonkhochitiet(mmyy character varying(4), idkho number(3) default 0, idtheodoi number(30) default 0 not null, " +
                                    " soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                                    " soluongxuat number(30,8) default 0 not null,  computer character varying(50),username character varying(20), " +
                                    "ngayud timestamp without time zone DEFAULT sysdate)" +
                                   " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tonkhochitiet OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tonkhochitiet add constraint pk_e_tonkhochitiet primary key(mmyy,idkho,idtheodoi);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tonkhochitiet add constraint fk_e_tonkhochitiet_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tonkhochitiet drop constraint fk_e_tonkhochitiet_theodoi ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".e_tonkhochitiet add constraint fk_e_tonkhochitiet_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_tonkhotonghop'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_tonkhotonghop(mmyy character varying(4), idkho number(3) default 0, idttb number(7) default 0 not null, " +
                    " idnguon number(2) default 0 not null, soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                    " soluongxuat number(30,8) default 0 not null, soluongyeucau number(30,8) default 0 not null," +
                    " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tonkhotonghop OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tonkhotonghop add constraint pk_e_tonkhotonghop primary key(mmyy,idkho,idttb,idnguon);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tonkhotonghop add constraint fk_e_tonkhotonghop_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tonkhotonghop add constraint fk_e_tonkhotonghop_dmttb foreign key(idttb) references " + sSchema + ".e_dmttb(idttb) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tonkhotonghop add constraint fk_e_tonkhotonghop_dmnguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tonkhotonghop add constraint fk_e_tonkhotonghop_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_tondau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_tondau(mmyy character varying(4), idkho number(3) default 0, idtutruc number(3) default 0, idtheodoi number(30) default 0 not null, " +
                                   " soluong number(30,8) default 0 not null, computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tondau OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".e_tondau add constraint pk_e_tondau primary key(mmyy,idkho,idtutruc,idtheodoi);\n";
                    s_Sql += "alter table " + sSchema + ".e_tondau add constraint fk_e_tondau_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".e_tondau drop constraint fk_e_tondau_theodoi ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".e_tondau add constraint fk_e_tondau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_tontutrucchitiet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_tontutrucchitiet(mmyy character varying(4) not null,idkho number(3) not null,idtutruc number(3) not null,idtheodoi number(30) not null,  " +
                      " soluongtondau number(24,8) default 0 not null,soluongnhap number(24,8) default 0 not null,soluongxuat number(24,8) default 0 not null," +
                      " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tontutrucchitiet OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add constraint pk_e_tontutrucchitiet primary key(mmyy,idkho,idtutruc,idtheodoi)  ;\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add constraint fk_e_tontutrucchitiet_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet drop constraint fk_e_tontutrucchitiet_theodoi ;\n";//linh28/6/14
                    s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add constraint fk_e_tontutrucchitiet_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add constraint ck_e_tontutrucchitiet_sln check (soluongnhap>=0);\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add constraint ck_e_tontutrucchitiet_slx check (soluongxuat>=0);\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_tontutructonghop'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_tontutructonghop(mmyy character varying(4) not null,idkho number(2) not null,idtutruc number(3) not null,idttb number(7) not null, " +
                      " idnguon number(3) not null,soluongtondau number(24,8) default 0 not null,soluongnhap number(24,8) default 0 not null,soluongxuat number(24,8) default 0 not null,  " +
                      " computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20))" +
                      " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_tontutructonghop OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint pk_e_tontutructonghop primary key(mmyy,idkho,idtutruc,idttb,idnguon);\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint fk_e_tontutructonghop_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint fk_e_tontutructonghop_dmnguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint fk_e_tontutructonghop_dmttb foreign key(idbietduoc) references " + sSchema + ".e_dmttb(idttb)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint fk_e_tontutructonghop_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint ck_e_tontutructonghop_sln check (soluongnhap>=0);\n";
                    s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint ck_e_tontutructonghop_slx check (soluongxuat>=0);\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_nhapll'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_nhapll(idnhap number(30) default 0, mmyy character varying(4) not null, sophieu character varying(20),  ngaynhap timestamp without time zone DEFAULT sysdate not null, " +
                      " sohoadon character varying(254), ngayhoadon timestamp without time zone, loai number(2) default 0 not null, idkhoaphongduoc number(3,0) default 0 not null, idnhacungcap number(5) default 0 not null, idkho number(3) default 0,   " +
                      " idnguon number(2) default 0 not null, paid number(1) default 0 not null, lanin number(3) default 0 not null, idnhomttb number(3) default 0 not null, computer character varying(50),username character varying(20), " +
                      "ngayud timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapll OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint pk_e_nhapll primary key(idnhap);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint fk_e_nhapll_nhacungcap foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint fk_e_nhapll_kho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint fk_e_nhapll_khoaphong foreign key(idkhoaphongduoc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint fk_e_nhapll_nguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint fk_e_nhapll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".e_nhapll drop constraint fk_e_nhapll_nhom ;\n";//ThanhCuong - 23/05/2015
                r_Col = dtAllColumn.Select("table_name='e_nhapct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_nhapct(idnhap number(30) default 0, stt number(3) default 0 not null, mmyy character varying(4) not null, " +
                      " idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null, computer character varying(50),username character varying(20), " +
                      "ngayud timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapct add constraint pk_e_nhapct primary key(idnhap,stt);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapct drop constraint fk_e_nhapct_nhapll ;\n";//linh28/6/14
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapct add constraint fk_e_nhapct_theodoi foreign key(idtheodoi,mmyy) references " + sSchema + ".e_theodoi(idtheodoi,mmyy) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_nhapct add constraint fk_e_nhapct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_xuatll'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_xuatll(idxuat number(30) default 0, mmyy character varying(4) not null, sophieu character varying(20),  ngay timestamp without time zone not null,  " +
                      " loai number(2) default 0 not null,idkhoxuat number(3,0) default 0 not null, idkhonhap number(3,0) default 0 not null, idtutruc number(3) default 0 not null,  " +
                      " idnhomttb number(3) default 0 not null,lanin number(3) default 0 not null,ghichu text,computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                        "  WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_xuatll OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_xuatll add constraint pk_e_xuatll primary key(idxuat);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_xuatll add constraint fk_ttbxuatll_dmkhoxuat foreign key(idkhoxuat) references " + sSchema + ".e_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_xuatll add constraint fk_ttbxuatll_dmkhonhap foreign key(idkhonhap) references " + sSchema + ".e_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_xuatll add constraint fk_ttbxuatll_dmkhoaphong foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_xuatll add constraint fk_ttbxuatll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".e_xuatll drop constraint fk_ttbxuatll_nhom ;\n";//ThanhCuong - 23/05/2015
                r_Col = dtAllColumn.Select("table_name='e_xuatct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".e_xuatct(idxuat number(30) default 0, stt number(3) default 0 not null, mmyy character varying(4) not null, " +
                      " idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null, " +
                      " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_xuatct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".e_xuatct add constraint pk_e_xuatct primary key(idxuat,stt);\n";
                }
                #endregion end Trang Thiết Bị

                r_Col = dtAllColumn.Select("table_name='p_dmloaiphong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmloaiphong(idloaiphong number(2,0) default 0,stt number(2,0) default 0,maloaiphong character varying(10)," +
                             "tenloaiphong text,username character varying(20),\n";
                    s_Sql += "computer character varying(50),ngayud timestamp without time zone default sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmloaiphong add constraint pk_p_dmloaiphong primary key(idloaiphong);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmloaiphong add constraint fk_p_dmloaiphong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) on update restrict on delete restrict;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmphong(idphong number(5,0),stt number(5,0) default 0,idkhoaphong number(3,0) default 0,maphong character varying(10)," +
                             "tenphong text,idloaiphong number(2,0) default 0,idloaivienphi number(3,0),dichvu number(1,0) default 0,username character varying(20)," +
                             "computer  character varying(50),ngayud timestamp without time zone default sysdate) WITH (OIDS=TRUE);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".p_dmphong  OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphong add constraint pk_p_dmphong primary key(idphong);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphong add constraint fk_p_dmphong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) on update restrict on delete restrict;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphong add constraint fk_p_dmphong_dmkhoaphongbenhvien foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) on update restrict on delete restrict;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphong add constraint fk_p_dmphong_dmloaiphong foreign key(idloaiphong) references " + sSchema + ".p_dmloaiphong(idloaiphong) on update restrict on delete restrict;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphong add constraint fk_p_dmphong_dmloaivienphi foreign key(idloaivienphi) references " + sSchema + ".b_dmloaivienphi(idloaivienphi) on update restrict on delete restrict;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmgiuong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmgiuong(idgiuong number(7,0),stt number(7,0) default 0,idphong number(5,0) default 0,magiuong character varying(20)," +
                             "tengiuong text,bhyt number(7,2) default 0,gia_th number(10,0) default 0,gia_bh number(10,0) default 0,gia_cs number(10,0) default 0," +
                             "gia_dv number(10,0) default 0,gia_nn number(12,2) default 0,soluong number(3,0) default 0,gia_ksk number(10,0) default 0," +
                             "gia_vip number(10,0) default 0,tinhtrang number(1,0) default 0,username character varying(20),computer character varying(50)," +
                             "ngayud timestamp without time zone default sysdate,block number(7,0) default 0) WITH (OIDS=TRUE);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".p_dmgiuong  OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmgiuong add constraint pk_p_dmgiuong primary key(idgiuong);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmgiuong add constraint fk_p_dmgiuong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) on update restrict on delete restrict;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmgiuong add constraint fk_p_dmgiuong_dmphong foreign key(idphong) references " + sSchema + ".p_dmphong(idphong) on update restrict on delete restrict;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmgiuong add constraint fk_p_dmgiuong_dmgiavienphi foreign key(idgiuong) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) on update restrict on delete restrict;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_theodoigiuong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_theodoigiuong(idtheodoigiuong number(30,0),idkhoaphong number(3,0)," +
                             "maql number(30,0) default 0,idkhoa number(30,0) default 0,madoituong number(2,0) default 0,idgiuong number(7,0) default 0," +
                             "tungay timestamp without time zone,denngay timestamp without time zone,soluong number(20,2) default 0,dongia number(12,2) default 0," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate) WITH (OIDS=TRUE);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".p_theodoigiuong  OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_theodoigiuong add constraint pk_p_theodoigiuong primary key(idtheodoigiuong);\n";
                    s_Sql += "alter table " + sSchema + ".p_theodoigiuong add constraint fk_p_theodoigiuong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) on update restrict on delete restrict;\n";
                    s_Sql += "alter table " + sSchema + ".p_theodoigiuong add constraint fk_p_theodoigiuong_dmgiuong foreign key(idgiuong) references " + sSchema + ".p_dmgiuong(idgiuong) on update restrict on delete restrict;\n";
                    s_Sql += "alter table " + sSchema + ".p_theodoigiuong add constraint fk_p_theodoigiuong_dmkpbenhvien foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) on update restrict on delete restrict;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmnhomvienphi' and column_name='manhomvienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmnhomvienphi add manhomvienphi varchar2(10);\n";
                    s_Sql += "update " + sSchema + ".b_dmnhomvienphi set manhomvienphi=to_char(idnhomvienphi) where manhomvienphi is null;\n";
                }
                s_Sql += "alter table " + sSchema + ".b_dmgiavienphi alter column mavp type varchar2(10);\n";
                s_Sql += "alter table " + sSchema + ".p_theodoigiuong alter column soluong type number(20,0);\n";
                r_Col = dtAllColumn.Select("table_name='p_theodoigiuong' and column_name='idchidinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_theodoigiuong add idchidinh number(30,0);\n";
                    s_Sql += "update " + sSchema + ".p_theodoigiuong set idchidinh=0 where idchidinh is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_theodoigiuong alter column idchidinh set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".p_theodoigiuong alter column idchidinh set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_benhandt set mmyy=to_char(ngay,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhandt alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhandt alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='p_nhapkhoa' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_nhapkhoa add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_nhapkhoa set mmyy=to_char(ngay,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_nhapkhoa alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_nhapkhoa alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatkhoa' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatkhoa add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_xuatkhoa set mmyy=to_char(ngay,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatkhoa alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatkhoa alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_xuatvien set mmyy=to_char(ngay,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatvien alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatvien alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_bhyt' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_bhyt add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_bhyt set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_bhyt alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_bhyt alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhkemtheo' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhkemtheo add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_benhkemtheo set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhkemtheo alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhkemtheo alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhmantinh' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhmantinh add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_benhmantinh set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhmantinh alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhmantinh alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhtiensu' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhtiensu add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_benhtiensu set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhtiensu alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhtiensu alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dausinhton' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dausinhton add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_dausinhton set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_dausinhton alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_dausinhton alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giaychuyenvien' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_giaychuyenvien set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_giaychuyenvien alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_giaychuyenvien alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giayravien' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giayravien add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_giayravien set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_giayravien alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_giayravien alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lichhen' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lichhen add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_lichhen set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichhen alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichhen alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lichlamviecbacsi' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lichlamviecbacsi add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_lichlamviecbacsi set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichlamviecbacsi alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichlamviecbacsi alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_lienhe set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_lienhe alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_lienhe alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_pttt' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_pttt add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_pttt set mmyy=to_char(ngay,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_pttt alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_tainanthuongtich' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_tainanthuongtich set mmyy=to_char(ngay,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_theodoigiuong' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_theodoigiuong add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_theodoigiuong set mmyy=to_char(tungay,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_theodoigiuong alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_theodoigiuong alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xutridieutri' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xutridieutri add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".p_xutridieutri set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_xutridieutri alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_xutridieutri alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_ketquall' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_ketquall add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".r_ketquall set mmyy=to_char(ngay,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".r_ketquall alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".r_ketquall alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_ketquact' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_ketquact add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".r_ketquact set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".r_ketquact alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".r_ketquact alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_hoantra' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_hoantra add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".b_hoantra set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_hoantra alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".b_hoantra alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_tamung' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_tamung add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".b_tamung set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_tamung alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".b_tamung alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_tamungcd' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_tamungcd add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".b_tamungcd set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_tamungcd alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".b_tamungcd alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_thuocchuavuottran' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".b_thuocchuavuottran set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphichuavuottran' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".b_vienphichuavuottran set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphi add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".b_vienphi set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphi alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphi alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphict' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphict add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".b_vienphict set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='b_vienphictthuoc' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".b_vienphictthuoc set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketqua' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketqua add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".l_ketqua set mmyy=to_char(ngay,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".l_ketqua alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".l_ketqua alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".l_ketquachitiet set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add mmyy varchar2(4);\n";
                    s_Sql += "update " + sSchema + ".b_chidinh set mmyy=to_char(ngayud,'mmyy') where mmyy is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column mmyy set not null;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column mmyy set default to_char(sysdate,'mmyy');\n";
                }
                s_Sql += "alter table " + sSchema + ".r_dmkythuat alter makt type character varying(10);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmchucnangekipmo'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmchucnangekipmo " +
                            "( " +
                            "idchucnang number(2) NOT NULL, " +
                            "tenchucnang character varying(100)," +
                            "username character varying(20)," +
                            "ngayud timestamp without time zone DEFAULT sysdate," +
                            "dongbo character varying(100) DEFAULT lpad('0'::text, 100, '0'::text)," +
                            "computer character varying(50)" +
                            ") WITH (OIDS=TRUE);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".p_dmchucnangekipmo  OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_dmchucnangekipmo add CONSTRAINT pk_p_dmchucnangekipmo PRIMARY KEY (idchucnang);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmchucnangekipmo add CONSTRAINT fk_p_dmchucnangekipmo_dmuser FOREIGN KEY (username) REFERENCES " + sSchema + ".p_dmuser (username) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thanhvienekipmo'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_thanhvienekipmo" +
                            "( " +
                            "idchucnang number(2) not null," +
                            "idpttt number(30,0) default 0 not null," +
                            "manhanvien character varying(4) NOT NULL," +
                            "ghichu text," +
                            "mmyy character varying(4) NOT NULL DEFAULT to_char(sysdate, 'mmyy'::text)," +
                            "username character varying(20)," +
                            "ngayud timestamp without time zone DEFAULT sysdate," +
                            "dongbo character varying(100) DEFAULT lpad('0'::text, 100, '0'::text)," +
                            "computer character varying(50)) WITH (OIDS=TRUE);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".p_thanhvienekipmo  OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add CONSTRAINT pk_p_thanhvienekipmo PRIMARY KEY (idchucnang,idpttt,manhanvien);";
                    s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add CONSTRAINT fk_p_thanhvienekipmo_dmchucnangekipmo FOREIGN KEY (idchucnang)  REFERENCES " + sSchema + ".p_dmchucnangekipmo (idchucnang) MATCH SIMPLE  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add CONSTRAINT fk_p_thanhvienekipmo_dmnhanvien FOREIGN KEY (manhanvien) REFERENCES " + sSchema + ".p_dmnhanvien (manhanvien) MATCH SIMPLE  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add CONSTRAINT fk_p_thanhvienekipmo_dmuser FOREIGN KEY (username) REFERENCES " + sSchema + ".p_dmuser (username) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmmay' and column_name='loaimay'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmmay add loaimay number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dutrucapll'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dutrucapll(iddutrucap number(30) default 0, " +
                        " mmyy character varying(4) not null DEFAULT to_char(sysdate,'mmyy'), sophieu character varying(20), " +
                        " ngay timestamp without time zone, idkhoxuat number(3) default 0, idkhonhap number(3) default 0, done number(1) default 0 not null, " +
                        " ghichu text, computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dutrucapll OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dutrucapll add constraint pk_m_dutrucapll primary key(iddutrucap);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dutrucapll add constraint fk_dutrucapll_khoxuat foreign key(idkhoxuat) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dutrucapll add constraint fk_dutrucapll_khonhap foreign key(idkhonhap) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dutrucapll add constraint fk_dutrucapll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrucapll add ghichu text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dutrucapct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dutrucapct(iddutrucap number(30) default 0, " +
                        "mmyy character varying(4) not null DEFAULT to_char(sysdate,'mmyy'), " +
                        "idbietduoc number(7,0) default 0 not null, soluongdutru number(30,8) default 0 not null, soluongduyet number(30,8) default 0 not null, " +
                        "idduyetdutrucap number(30) default 0 not null, computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate) " +
                        "WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dutrucapct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dutrucapct add constraint pk_m_dutrucapct primary key(iddutrucap,idbietduoc);\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrucapct add constraint fk_dutrucapct_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dutrucapct add constraint fk_dutrucapct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chuyensolieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_chuyensolieu(idchuyensolieu number(30,0) default 0,mmyy character varying(4) not null default to_char(sysdate,'mmyy')," +
                             "ngay timestamp without time zone default sysdate,mavaovien number(30,0) default 0,maql number(30,0) default 0,idkhoa number(30,0) default 0," +
                             "ngayvaovien timestamp without time zone,ngayravien timestamp without time zone,idkhoaphong number(3,0),maicd character varying(10),chandoan text," +
                             "sotien number(15,4) default 0,tamung number(10,0) default 0,bhyttra number(15,4) default 0,mien number(15,4) default 0,done number(1,0) default 0," +
                             "idttrv number(30,0) default 0,vuottran number(1,0) default 0,username character varying(20),computer character varying(50)," +
                             "ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".b_chuyensolieu add constraint pk_b_chuyensolieu primary key(idchuyensolieu);\n";
                    s_Sql += "alter table " + sSchema + ".b_chuyensolieu add constraint fk_b_chuyensolieu_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) on update restrict on delete restrict;\n";
                    s_Sql += "alter table " + sSchema + ".b_chuyensolieu add constraint fk_b_chuyensolieu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) on update restrict on delete restrict;\n";
                    s_Sql += "alter table " + sSchema + ".b_chuyensolieu owner to " + sUserID + ";\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphucappttt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmphucappttt(idchucnang number(2,0),idloaipttt number(1,0) default 0,idloainhompttt number(1,0) default 0," +
                             "sotien number(14,3) default 0,ghichu text,username character varying(20),ngayud timestamp without time zone default sysdate," +
                             "dongbo character varying(100) default lpad('0',100,'0'),computer character varying(50));\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphucappttt add constraint pk_p_dmphucappttt primary key(idchucnang);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphucappttt add constraint fk_p_dmphucappttt_loaipttt foreign key(idloaipttt) references " + sSchema + ".p_dmloaipttt(idloaipttt) on update restrict on delete restrict;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphucappttt add constraint fk_p_dmphucappttt_nhompttt foreign key(idloainhompttt) references " + sSchema + ".p_dmloainhompttt(idloainhompttt) on update restrict on delete restrict;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmphucappttt add constraint fk_p_dmphucappttt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) on update restrict on delete restrict;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thanhvienekipmo' and column_name='ngayduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add ngayduyet timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thanhvienekipmo' and column_name='sotien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add sotien number(14,3) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_pttt' and column_name='ngayduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_pttt add ngayduyet timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_pttt' and column_name='duyetphucap'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_pttt add duyetphucap number(1,0) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_goivienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_goivienphi(idgoivienphi number(7,0),idgiavienphi number(7,0),soluong number(5,2),username character varying(20)," +
                             "computer character varying(50),ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add constraint pk_b_goivienphi primary key(idgoivienphi,idgiavienphi);\n";
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add constraint fk_b_goivienphi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) on update restrict on delete restrict;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='goivienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add goivienphi number(1,0) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_goivienphi' and column_name='madoituong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add madoituong number(2,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_goivienphi' and column_name='gia_th'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_th number(14,3) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_goivienphi' and column_name='gia_bh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_bh number(14,3) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_goivienphi' and column_name='gia_cs'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_cs number(14,3) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_goivienphi' and column_name='gia_dv'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_dv number(14,3) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_goivienphi' and column_name='gia_nn'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_nn number(14,3) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_goivienphi' and column_name='gia_ksk'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_ksk number(14,3) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_goivienphi' and column_name='gia_vip'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_vip number(14,3) default 0 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".r_dmmaumota alter makt type character varying(10);\n";
                s_Sql += "alter table " + sSchema + ".b_dmnhomvienphi alter column idnhomvienphi type number(5);\n";//linh 15/7/14
                s_Sql += "alter table " + sSchema + ".b_dmgiavienphi alter column idnhomvienphi type number(5);\n";//linh 15/7/14
                r_Col = dtAllColumn.Select("table_name='bc_report'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bc_report(idreport number(30) default 0 not null,tenreport  character varying(200),tieude text,sql text," +
                        "columntitle text,username character varying(20)," +
                        "computer character varying(50),ngayud timestamp without time zone default sysdate)  with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".bc_report add constraint pk_bc_report primary key(idreport);\n";//linh17/7/14
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='bc_control'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".bc_control(idreport number(30) default 0 not null,stt number(4) default 0 not null," +
                        "controltype  character varying(200),controlname  character varying(200),controltext  character varying(200),controltop number(4) default 0 not null," +
                        "controlleft number(4) default 0 not null,controlwidth number(4) default 0 not null,controlheight number(4) default 0 not null," +
                        "controlindex number(4) default 0 not null, controldefault text,username character varying(20)," +
                        "computer character varying(50),ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".bc_control add constraint pk_bc_control primary key(idreport,stt);\n";
                    s_Sql += "alter table " + sSchema + ".bc_control add constraint fk_control_report foreign key(idreport) references " + sSchema + ".bc_report(idreport)  on update restrict on delete restrict;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphi' and column_name='hoten'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add hoten text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphi' and column_name='diachi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add diachi text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphi' and column_name='hotenbacsy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add hotenbacsy text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbdtd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmbdtd(idbietduoc number(7,0) default 0, idbietduoctd number(7,0) default 0," +
                        " computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmbdtd OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmbdtd add constraint pk_m_dmbdtd primary key(idbietduoc,idbietduoctd);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmbdtd add constraint fk_dmbdtd_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmbdtd add constraint fk_dmbdtd_dmbd1 foreign key(idbietduoctd) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_dmbdtd add constraint fk_dmbdtd_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                s_Sql += "alter table " + sSchema + ".m_dmbdtd alter column donvilinh type text;\n";
                r_Col = dtAllColumn.Select("table_name='m_xuatnoivienct' and column_name='idbietduocgoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add idbietduocgoc number(7) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tienthuoc' and column_name='idtheodoi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tienthuoc add idtheodoi number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tienthuoc' and column_name='idbietduocgoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tienthuoc add idbietduocgoc number(7) default 0 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmbenhnhan drop constraint fk_dmbenhnhan_dmbenhvien;\n";
                s_Sql += "alter table " + sSchema + ".b_dmgiavienphi alter column mavp type character varying(20);\n";
                s_Sql += "alter table " + sSchema + ".m_dmnhacungcap alter column sotaikhoan type character varying(20);\n";
                s_Sql += "alter table " + sSchema + ".m_dmnhacungcap alter column masothue type character varying(20);\n";
                s_Sql += "alter table " + sSchema + ".m_dmkhoaphong alter column makhoaphong type  character varying(20);\n";
                s_Sql += "alter table " + sSchema + ".m_dmbd alter column sodangky type character varying(30)\n;";
                r_Col = dtAllColumn.Select("table_name='m_phatthuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_phatthuoc(idduyet number(30) default 0 not null,idkho number(3) default 0 not null,ngay timestamp without time zone default sysdate not null," +
                      "mmyy character varying(4) not null,computer character varying(50),ngayud timestamp without time zone default sysdate,username character varying(20)) with (oids=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phatthuoc OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phatthuoc add constraint pk_m_phatthuoc primary key(idduyet,idkho);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phatthuoc add constraint fk_phatthuoc_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phatthuoc add constraint fk_phatthuoc_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add stt number(7,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_toathuocct' and column_name='solan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_toathuocct add solan character varying(10);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_toathuocct' and column_name='sovien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_toathuocct add sovien character varying(10);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_khoasolieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_khoasolieu(mmyy character varying(4), done number(1,0) default 0 not null, computer character varying(50)," +
                        "username character varying(20),ngayud timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_khoasolieu OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_khoasolieu add constraint pk_m_khoasolieu primary key(mmyy);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphithuoc' and column_name='cachdung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add cachdung text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtinhthanh' and column_name='matinhthanh_bh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmtinhthanh add matinhthanh_bh character varying(2);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmquanhuyen' and column_name='maquanhuyen_bh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmquanhuyen add maquanhuyen_bh character varying(2);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_phieuduyet' and column_name='sophieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_phieuduyet add sophieu number(5);\n";
                    s_Sql += "update " + sSchema + ".m_phieuduyet set sophieu=0 where sophieu is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_phieuduyet alter column sophieu set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".m_phieuduyet alter column sophieu set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_phieuduyet' and column_name='lanin'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_phieuduyet add lanin number(3);\n";
                    s_Sql += "update " + sSchema + ".m_phieuduyet set lanin=0 where lanin is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_phieuduyet alter column lanin set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".m_phieuduyet alter column lanin set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='congkhamtiepdon'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add congkhamtiepdon number(1) default 0 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_toathuocct alter column sang type character varying(10);\n";
                s_Sql += "alter table " + sSchema + ".p_toathuocct alter column trua type character varying(10);\n";
                s_Sql += "alter table " + sSchema + ".p_toathuocct alter column chieu type character varying(10);\n";
                s_Sql += "alter table " + sSchema + ".p_toathuocct alter column toi type character varying(10);\n";
                s_Sql += "alter table " + sSchema + ".p_toathuocct alter column sovien type character varying(10);\n";
                s_Sql += "alter table " + sSchema + ".p_toathuocct alter column solan type character varying(10);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='idkhoaphong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add idkhoaphong number(3,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='bidanh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add bidanh text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='noisinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add noisinh text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='matinh_noisinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add matinh_noisinh character varying(3) default 000 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='maquanhuyen_noisinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add maquanhuyen_noisinh character varying(5) default 000 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='maphuongxa_noisinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add maphuongxa_noisinh character varying(7) default 000 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='nguyenquan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add nguyenquan text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='idnuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add idnuoc number(5,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='noiohiennay'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add noiohiennay text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='matinh_noio'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add matinh_noio character varying(3) default 000 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='maquanhuyen_noio'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add maquanhuyen_noio character varying(5) default 000 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='maphuongxa_noio'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add maphuongxa_noio character varying(7) default 000 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='ngaycapcmnd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add ngaycapcmnd timestamp without time zone default sysdate;\n";//Thuy 14/09/15 bỏ not null
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='noicapcmnd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add noicapcmnd text;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='matongiao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add matongiao character varying(2);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='mahocvan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add mahocvan character varying(4);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='machucdanh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add machucdanh character varying(2);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='sotaikhoan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add sotaikhoan character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='idnganhang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add idnganhang number(3,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='dienthoaicoquan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add dienthoaicoquan character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='maviettat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add maviettat character varying(10);\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_ngoaingu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " create table " + sSchema + ".h_ngoaingu(idngoaingu number(2,0) default 0 not null, manhanvien character varying(4), computer character varying(50)," +
                        "username character varying(20),ngayud timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_ngoaingu OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_ngoaingu add constraint pk_h_ngoaingu primary key(idngoaingu,manhanvien);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_ngoaingu add constraint fk_h_ngoaingu_dmnhanvien foreign key(manhanvien) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_ngoaingu add constraint fk_h_ngoaingu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmchucvu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".h_dmchucvu(machucvu number(2,0) default 0 not null,tenchucvu text,hesochucvu number(6,2),tenviettat text,computer character varying(50)," +
                        "username character varying(20),ngayud timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmchucvu OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmchucvu add constraint pk_h_dmchucvu primary key(machucvu);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmchucvu add constraint fk_h_dmchucvu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmngoaingu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".h_dmngoaingu(idngoaingu number(2,0) default 0 not null,tenngoaingu text,computer character varying(50)," +
                       "username character varying(20),ngayud timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmngoaingu OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmngoaingu add constraint pk_h_dmngoaingu primary key(idngoaingu);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmngoaingu add constraint fk_h_dmngoaingu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmtongiao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " create table " + sSchema + ".h_dmtongiao(matongiao number(2,0) default 0 not null, tentongiao character varying(100)) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmtongiao OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmtongiao add constraint pk_h_dmtongiao primary key(matongiao);\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmchucdanh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " create table " + sSchema + ".h_dmchucdanh(machucdanh number(2,0) default 0 not null, tenchucdanh character varying(200),tenviettat character varying(200),computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmchucdanh OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmchucdanh add constraint pk_h_dmchucdanh primary key(machucdanh);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmchucdanh add constraint fk_h_dmchucdanh_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmtrinhdovitinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " create table " + sSchema + ".h_dmtrinhdovitinh(matrinhdovitinh number(2,0) default 0 not null, tentrinhdovitinh character varying(100)) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmtrinhdovitinh OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmtrinhdovitinh add constraint pk_h_dmtrinhdovitinh primary key(matrinhdovitinh);\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmchuyenmon'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".h_dmchuyenmon(machuyenmon number(2,0) default 0 not null,tenchuyenmon text,tenviettat text,computer character varying(50)," +
                        "username character varying(20),ngayud timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmchuyenmon OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmchuyenmon add constraint pk_h_dmchuyenmon primary key(machuyenmon);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmchuyenmon add constraint fk_h_dmchuyenmon_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmhocvan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " create table " + sSchema + ".h_dmhocvan(mahocvan number(2,0) default 0 not null,tenhocvan character varying(100)) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmhocvan OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_dmhocvan add constraint pk_h_dmhocvan primary key(mahocvan);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_capmathebhyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_capmathebhyt(id number(5,0),username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmdoituong' and column_name='nhaptuyen'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmdoituong add nhaptuyen number(1,0) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphicls' and column_name='congkhamtiepdon'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add congkhamtiepdon number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhacungcap' and column_name='sodk'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhacungcap add sodk character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmcachdung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table  " + sSchema + ".m_dmcachdung ( tencachdung text, tenkhongdau character varying(254), " +
                         " COMPUTER character varying(50), USERNAME character varying(20), NGAYUD timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmcachdung OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table  " + sSchema + ".m_dmcachdung add constraint pk_m_dmcachdung primary key(tenkhongdau);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_labthongso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_labthongso(idmay number(3) default 0, idxetnghiem number(7) default 0 not null,stt number(3)," +
                        "tenxetnghiem varchar2(254),computer varchar2(50)," +
                        "ketqua varchar2(254),username varchar2(20),ngayud timestamp  without time zone default sysdate,maxetnghiem varchar2(20)," +
                        "nhapamtinhduongtinh number(1) default 0 not null," +
                        "fieldtinhtudong varchar2(20),nhanthem number(5,2) default 1 not null) with(oids=true);\n";//linh 14/8/14
                    s_Sql += "alter table " + sSchema + ".l_labthongso add constraint pk_l_labthongso primary key(idmay,idxetnghiem);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dutrucapct' and column_name='idnguon'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dutrucapct add idnguon number(2) default 0 not null;\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_dutrucapct add constraint fk_m_dutrucapct_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                //Tú:14/08/2014
                s_Sql += "alter table " + sSchema + ".b_goivienphi drop constraint fk_b_goivienphi_giavp;\n";
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='idktcao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add idktcao number(30,0);\n";
                    s_Sql += "update " + sSchema + ".b_chidinh set idktcao=0 where idktcao is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column idktcao set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column idktcao set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_goivienphi' and column_name='idnguon'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add idnguon number(2,0) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_denghi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_denghi(iddenghi number(30) default 0 not null,sophieu character varying(20),mmyy character varying(4) DEFAULT to_char(sysdate, 'mmyy'::text) not null,ngaydenghi timestamp without time zone," +
                        "trangthai number(1) default 0 not null,ghichu text,computer character varying(50),username character varying(20),ngayud timestamp  without time zone default sysdate) with(oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".m_denghi add constraint pk_m_denghi primary key(iddenghi);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_denghi add constraint fk_m_denghi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_denghichitiet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_denghichitiet(iddenghi number(30) default 0 not null,mmyy character varying(4) DEFAULT to_char(sysdate, 'mmyy'::text) not null,idnhap number(30) default 0 not null,mmyynhap character varying(4) not null,ngaynhap timestamp without time zone," +
                        "tongtien number(24,8) default 0 not null,datra number(24,8) default 0 not null,tkno character varying(50),tkco character varying(50),computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate) with(oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".m_denghichitiet add constraint pk_m_denghichitiet primary key(iddenghi,idnhap);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_denghichitiet add constraint fk_m_denghichitiet_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphuongxa' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmphuongxa add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmquanhuyen' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmquanhuyen add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtinhthanh' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmtinhthanh add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhvien' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmbenhvien add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmnhomvienphi' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmnhomvienphi add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmloaivienphi' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmloaivienphi add hide number(1) default 0 not null;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmloai' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmloai add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmhang' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmhang add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnuoc' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnuoc add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add hide number(1) default 0 not null;";
                }
                //linh 19/8/14
                s_Sql += "alter table " + sSchema + ".m_dmnhacungcap alter column fax type varchar2(50);\n";
                //linh 25/8/14
                s_Sql += "alter table " + sSchema + ".p_dmbenhvien drop constraint pk_dmbenhvien cascade;\n";
                s_Sql += "alter table " + sSchema + ".p_dmbenhvien add constraint pk_p_dmbenhvien primary key(mabenhvien,manoidkkcb);\n";
                r_Col = dtAllColumn.Select("table_name='m_toamau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_toamau(idtoamau number(7), tentoa text, tenkhongdau character varying(150),mabs character varying(4), maicd character varying(10), tutuoi number(2) default 0 not null," +
                    " dentuoi number(2) default 0 not null, phai number(1) default -1 not null,songay number(2) default 0 not null,computer character varying(50)," +
                    " ngayud timestamp without time zone default sysdate not null,username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_toamau OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_toamau add constraint pk_m_toamau primary key(idtoamau);\n";
                    s_Sql += "alter table " + sSchema + ".m_toamau add constraint fk_m_toamau_nhanvien foreign key (mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_toamau add constraint fk_m_toamau_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_toamau add phai number(1) default -1 not null;\n";
                    s_Sql += "alter table " + sSchema + ".m_toamau add songay number(2) default 0 not null;\n";//ThanhCuong - 26/08/2014
                    s_Sql += "alter table " + sSchema + ".m_toamau add tenkhongdau character varying(150);\n";//ThanhCuong - 26/08/2014
                }
                r_Col = dtAllColumn.Select("table_name='m_toamauct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_toamauct(idtoamau number(7),idbietduoc number(7,0) default 0 not null, sang character varying(10), trua character varying(10), chieu character varying(10), " +
                        "toi character varying(10), soluongyeucau number(12,4) default 0 not null,songay number(2) DEFAULT 0 not null, cachdung text, ghichu text," +
                    " computer character varying(50),ngayud timestamp without time zone default sysdate not null,username character varying(20))" +
                    " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_toamauct OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_toamauct add constraint pk_m_toamauct primary key(idtoamau,idbietduoc);\n";
                    s_Sql += "alter table " + sSchema + ".m_toamauct add constraint fk_m_toamauct_bietduoc foreign key (idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_toamauct add constraint fk_m_toamauct_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_toamauct add soluongyeucau number(12,4) default 0 not null;\n";//ThanhCuong - 26/08/2014
                    s_Sql += "alter table " + sSchema + ".m_toamauct add songay number(2) default 0 not null;\n";//ThanhCuong - 26/08/2014
                    s_Sql += "alter table " + sSchema + ".m_toamauct add computer character varying(50);\n";//ThanhCuong - 26/08/2014
                }
                s_Sql += "alter table " + sSchema + ".p_benhandt alter column sovaovien type character varying(20);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmdoituong' and column_name='kho'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmdoituong add kho character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_theodoi' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_theodoi add mmyy character varying(4) default to_char(sysdate,'mmyy') not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_labketqua'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_labketqua (idtraketqua varchar2(254),ngay timestamp default now not null,stt number(5) default 0 not null," +
                        " idxetnghiem number(7) default 0 not null,idmay number(3) default 0 not null,ketqua varchar2(50)," +
                        " mmyy varchar2(4) default to_char(sysdate,'mmyy') not null,computer varchar2(50),username varchar2(20));\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmmay' and column_name='vitristtlaymau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmmay add vitristtlaymau number(3) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmmay' and column_name='kituketthuc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmmay add kituketthuc varchar2(10);\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmmay' and column_name='kituphancach'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmmay add kituphancach varchar2(10);\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmmay' and column_name='ip'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmmay add ip number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmloaiquyenso' and column_name='dangdung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmloaiquyenso add dangdung number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='sotientongchiphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add sotientongchiphi number(24,8) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='sotienbhyttra'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add sotienbhyttra number(24,8) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='sotienbntra'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add sotienbntra number(24,8) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='sotienmien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add sotienmien number(24,8) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='sotienhaophi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add sotienhaophi number(24,8) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='sotientamung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add sotientamung number(24,8) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='sotienkhac'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add sotienkhac number(24,8) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='d_dmkhuhoso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".d_dmkhuhoso (idkhuhoso number(2),tenkhuhoso varchar2(150),ngayud date,computer varchar2(50)," +
                        "username varchar2(20), tenkhongdau varchar2(100)) with (oids=true);\n";
                    s_Sql += "alter table  " + sSchema + ".d_dmkhuhoso add constraint pk_dmkhuhoso primary key(idkhuhoso);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='capcuu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".p_dmkhoaphongbenhvien add capcuu number(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='d_dmkehoso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".d_dmkehoso (idkehoso number(3),tenkehoso varchar2(150),ngayud date,computer varchar2(50)," +
                        "username varchar2(20),idkhuhoso number(2) default 0 not null, tenkhongdau varchar2(100)) with (oids=true);\n";
                    s_Sql += "alter table  " + sSchema + ".d_dmkehoso add constraint pk_dmkehoso primary key(idkehoso);\n";
                    s_Sql += "alter table  " + sSchema + ".d_dmkehoso add constraint fk_dmke_khu foreign key(idkhuhoso) references " + sSchema + ".d_dmkhuhoso(idkhuhoso);\n";
                }
                r_Col = dtAllColumn.Select("table_name='d_dmtanghoso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".d_dmtanghoso (idtanghoso number(2),tentanghoso varchar2(150),ngayud date,computer varchar2(50)," +
                        "username varchar2(20),idkehoso number(3) default 0 not null, tenkhongdau varchar2(100)) with (oids=true);\n";
                    s_Sql += "alter table  " + sSchema + ".d_dmtanghoso add constraint pk_dmtanghoso primary key(idtanghoso);\n";
                    s_Sql += "alter table  " + sSchema + ".d_dmtanghoso add constraint fk_dmtang_ke foreign key(idkehoso) references " + sSchema + ".d_dmkehoso(idkehoso);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='idtanghoso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add column idtanghoso number(3);\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatvien alter column idtanghoso set default 0;\n";
                    s_Sql += "update " + sSchema + ".p_xuatvien set idtanghoso=0 where idtanghoso is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatvien alter column idtanghoso set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='ghichuhoso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add column ghichuhoso varchar2(200);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_theodoi' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".m_theodoi add mmyy character varying(4) default to_char(sysdate,'mmyy') not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmkhoaphong' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmkhoaphong add hide number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmloaiquyenso' and column_name='dangdung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmloaiquyenso add column dangdung number(1,0) default 0;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_xuatvien drop constraint fk_xuatvien_tinhtrangrakhoa;\n";
                s_Sql += "alter table " + sSchema + ".p_xuatvien drop constraint fk_xuatvien_dmkhoaphongnv;\n";
                r_Col = dtAllColumn.Select("table_name='b_dmquyenso' and column_name='nguoidung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmquyenso add nguoidung character varying(20);\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='tachchitiet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add tachchitiet number(1,0) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_toathuocct' and column_name='duongdung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_toathuocct add duongdung text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='daduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphi add column daduyet number(1,0);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphi alter column daduyet set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='ngayduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphi add column ngayduyet timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphi alter column ngayduyet set DEFAULT null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='sttduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphi add column sttduyet number(10,0);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphi alter column sttduyet set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='tinhtheogiabhyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add tinhtheogiabhyt number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='capcuu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".p_dmkhoaphongbenhvien add capcuu number(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='d_dmkhuhoso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".d_dmkhuhoso (idkhuhoso number(2),tenkhuhoso varchar2(150),ngayud date,computer varchar2(50)," +
                        "username varchar2(20), tenkhongdau varchar2(100)) with (oids=true);\n";
                    s_Sql += "alter table  " + sSchema + ".d_dmkhuhoso add constraint pk_dmkhuhoso primary key(idkhuhoso);\n";
                }
                r_Col = dtAllColumn.Select("table_name='d_dmkehoso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".d_dmkehoso (idkehoso number(3),tenkehoso varchar2(150),ngayud date,computer varchar2(50)," +
                        "username varchar2(20),idkhuhoso number(2) default 0 not null, tenkhongdau varchar2(100)) with (oids=true);\n";
                    s_Sql += "alter table  " + sSchema + ".d_dmkehoso add constraint pk_dmkehoso primary key(idkehoso);\n";
                    s_Sql += "alter table  " + sSchema + ".d_dmkehoso add constraint fk_dmke_khu foreign key(idkhuhoso) references " + sSchema + ".d_dmkhuhoso(idkhuhoso);\n";
                }
                r_Col = dtAllColumn.Select("table_name='d_dmtanghoso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".d_dmtanghoso (idtanghoso number(2),tentanghoso varchar2(150),ngayud date,computer varchar2(50)," +
                        "username varchar2(20),idkehoso number(3) default 0 not null, tenkhongdau varchar2(100)) with (oids=true);\n";
                    s_Sql += "alter table  " + sSchema + ".d_dmtanghoso add constraint pk_dmtanghoso primary key(idtanghoso);\n";
                    s_Sql += "alter table  " + sSchema + ".d_dmtanghoso add constraint fk_dmtang_ke foreign key(idkehoso) references " + sSchema + ".d_dmkehoso(idkehoso);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='idtanghoso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add column idtanghoso number(3);\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatvien alter column idtanghoso set default 0;\n";
                    s_Sql += "update " + sSchema + ".p_xuatvien set idtanghoso=0 where idtanghoso is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatvien alter column idtanghoso set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='ghichuhoso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add column ghichuhoso varchar2(200);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_ketqua drop column mabn cascade;\n";
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='nguoiduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphi add column nguoiduyet varchar2(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='madvkt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column madvkt varchar2(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='tinhtheogiabhyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add tinhtheogiabhyt number(1) default 0 not null;\n";
                }
                s_Sql += "ALTER TABLE " + sSchema + ".p_dmbenhnhan  ADD CONSTRAINT ck_p_dmbenhnhan_mabn CHECK (mabn<>'');\n";
                s_Sql += "CREATE INDEX ind_dmbenhnhan_tenkhongdau ON " + sSchema + ".p_dmbenhnhan USING btree (tenkhongdau desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_dmbenhnhan_hobenhnhan ON " + sSchema + ".p_dmbenhnhan USING btree (hobenhnhan desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_dmbenhnhan_chulotbenhnhan ON " + sSchema + ".p_dmbenhnhan USING btree (chulotbenhnhan desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_dmbenhnhan_tenbenhnhan ON " + sSchema + ".p_dmbenhnhan USING btree (tenbenhnhan desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_dmbenhnhan_mabn ON " + sSchema + ".p_dmbenhnhan USING btree (mabn desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_dmbenhnhan_sothe ON " + sSchema + ".p_dmbenhnhan USING btree (sothe desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_dmbenhnhan_mmyy ON " + sSchema + ".p_dmbenhnhan USING btree (mmyy desc NULLS LAST);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".p_hiendien ADD CONSTRAINT ck_hiendien_id CHECK (id<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".p_hiendien ADD CONSTRAINT ck_hiendien_maql CHECK (maql<>0);\n";
                s_Sql += "CREATE INDEX ind_hiendien_ngay ON " + sSchema + ".p_hiendien USING btree (ngay desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_hiendien_idkhoaphong ON " + sSchema + ".p_hiendien USING btree (idkhoaphong desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_hiendien_maql ON " + sSchema + ".p_hiendien USING btree (maql desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_hiendien_id ON " + sSchema + ".p_hiendien USING btree (id desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_capmabn_id ON " + sSchema + ".p_capmabenhnhan USING btree (mmyy desc NULLS LAST);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".b_dmgiavienphi ADD CONSTRAINT ck_b_dmgiavienphi_ma CHECK (mavp<>'');\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_dmbd ADD CONSTRAINT ck_dmbd_ma CHECK (mabietduoc<>'');\n";
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='chuyenvientheoyeucau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add column chuyenvientheoyeucau number(1,0);\n";
                    s_Sql += "update " + sSchema + ".p_xuatvien set chuyenvientheoyeucau=0 where chuyenvientheoyeucau is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatvien alter column chuyenvientheoyeucau set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatvien alter column chuyenvientheoyeucau set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giaychuyenvien' and column_name='chuyenvientheoyeucau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add column chuyenvientheoyeucau number(1,0);\n";
                    s_Sql += "update " + sSchema + ".p_giaychuyenvien set chuyenvientheoyeucau=0 where chuyenvientheoyeucau is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_giaychuyenvien alter column chuyenvientheoyeucau set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".p_giaychuyenvien alter column chuyenvientheoyeucau set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='madvkt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add column madvkt varchar2(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_nhapll' and column_name='ghichu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_nhapll add column ghichu character varying(254);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='dinhmucnhapnam'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add column dinhmucnhapnam number(20) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='danhapnam'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add column danhapnam number(20) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='nam'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add column nam character varying(2) default to_char(sysdate,'yy') not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='hoachat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column hoachat number(24,4) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='vtth'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column vtth number(24,4) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='khauhaotscd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column khauhaotscd number(5,2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='chiphiquanly'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column chiphiquanly number(5,2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='thuetndn'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column thuetndn number(5,2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='conglaodongtructiep1'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column conglaodongtructiep1 number(5,2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='conglaodongtructiep2'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column conglaodongtructiep2 number(5,2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='tygiausd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add column tygiausd number(24,4) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tienthuoc' and column_name='tygiausd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tienthuoc add column tygiausd number(24,4) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphicls' and column_name='tygiausd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add column tygiausd number(24,4) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphithuoc' and column_name='tygiausd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add column tygiausd number(24,4) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphict' and column_name='tygiausd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphict add column tygiausd number(24,4) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphictthuoc' and column_name='tygiausd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add column tygiausd number(24,4) default 0 not null;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='giaytokemtheo'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add column giaytokemtheo number(2,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='loaibnkham'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add column loaibnkham number(2,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='khamchuongtrinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add column khamchuongtrinh number(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_toamauct' and column_name='solan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_toamauct add solan number(2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_toamauct' and column_name='sovien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_toamauct add sovien number(5,2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_toamau' and column_name='loai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_toamau add loai number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhomnhanvien' and column_name='loai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhomnhanvien add column loai number(2,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_theodoi' and column_name='sodangky'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_theodoi add sodangky character varying(30);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='matbang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column matbang number(5,2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='conglaodongtructiepnn1'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column conglaodongtructiepnn1 number(5,2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='conglaodongtructiepnn2'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column conglaodongtructiepnn2 number(5,2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giayravien' and column_name='chandoankemtheo'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giayravien add column chandoankemtheo text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan' and column_name='mamemonelink'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add mamemonelink varchar2(50);\n";
                    s_Sql += "update " + sSchema + ".p_dmbenhnhan set mamemonelink=mabn where mamemonelink is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhan alter column mamemonelink set not null;\n";
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhan alter column mamemonelink set default mabn;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add constraint uk_dmbenhnhan_mamemonelink unique(mamemonelink) ;\n";
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan' and column_name='ngaycapcmnd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add column ngaycapcmnd date;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan' and column_name='noicapcmnd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add noicapcmnd varchar2(50);\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmbenhnhan alter column idthesmartcard type varchar2(20);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmnoilamviec'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnoilamviec(idnoilamviec number(7) default 0, tennoilamviec text, tenkhongdau character varying(200),ngayud timestamp without time zone DEFAULT sysdate," +
                   " computer character varying(50),username character varying(20))" +
                   " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnoilamviec OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnoilamviec add constraint pk_p_dmnoilamviec primary key(idnoilamviec);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_dmnoilamviec add constraint fk_noilamviec_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='giaychungsinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add column giaychungsinh number(1,0);\n";
                    s_Sql += "update " + sSchema + ".p_lienhe set giaychungsinh=0 where giaychungsinh is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_lienhe alter column giaychungsinh set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien_hinhanh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " create table " + sSchemaImage + ".p_dmnhanvien_hinhanh (manhanvien character varying(4) NOT NULL,stt number(2,0) default 0 not null," +
                            " hinhanh bytea, computer character varying(50), username character varying(20),ngayud timestamp without time zone default sysdate," +
                            " duongdan character varying(1024)) with (oids=true);\n";
                    s_Sql += " alter table " + sSchemaImage + ".p_dmnhanvien_hinhanh add constraint pk_p_dmnhanvien_hinhanh primary key (manhanvien,stt);\n";
                    //s_Sql += " alter table " + sSchemaImage + ".p_dmnhanvien_hinhanh add constraint fk_dmnv_dmnhanvien_hinhanh foreign key (manhanvien)" +
                    //        " references " + sSchema + ".p_dmnhanvien(manhanvien) match simple on update restrict on delete restrict;\n";
                    s_Sql += " alter table " + sSchemaImage + ".p_dmnhanvien_hinhanh  owner to " + sUserID + ";\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='machuyenmon'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add column machuyenmon number(2,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='mahocvan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien alter column mahocvan type number(2,0);\n";
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien alter column mahocvan set default 0;\n";
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien alter column mahocvan set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='machucvu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add column machucvu number(2,0);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='ngaybonhiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add column ngaybonhiem timestamp without time zone default sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='thoigianbonhiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add column thoigianbonhiem number(2,0) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='ngaycongtac'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".p_dmnhanvien add column ngaycongtac timestamp without time zone default sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmhopdong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " CREATE TABLE " + sSchema + ".h_dmhopdong ( mahopdong number(2,0) default 0 not null,  tenhopdong character varying(100)," +
                            "dongbhxh number(1,0) default 0 not null , buocthamgiabhtn number(1,0) default 0 not null ," +
                            "computer character varying(50), username character varying(20), ngayud timestamp without time zone DEFAULT sysdate," +
                            "CONSTRAINT pk_h_dmhopdong PRIMARY KEY (mahopdong)) WITH (OIDS=TRUE);\n";
                    s_Sql += " ALTER TABLE " + sSchema + ".h_dmhopdong OWNER TO " + sUserID + ";\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmhinhthuclamviec'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " CREATE TABLE " + sSchema + ".h_dmhinhthuclamviec(ma number(1,0) default 0 not null, ten character varying(100), computer character varying(50)," +
                             "username character varying(20), ngayud timestamp without time zone DEFAULT sysdate, CONSTRAINT pk_h_dmhinhthuclamviec PRIMARY KEY (ma)" +
                                " ) WITH (OIDS=TRUE);\n";
                    s_Sql += " ALTER TABLE " + sSchema + ".h_dmhinhthuclamviec OWNER TO " + sUserID + ";\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='bangiamdoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhanvien add column bangiamdoc number(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_hopdong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_hopdong(idhopdong character varying(4),manhanvien character varying(4),sohopdong character varying(100)," +
                             "mahopdong number(2,0) default 0 not null, ngaykyhopdong timestamp without time zone default sysdate," +
                             "ngaybatdauhieuluc timestamp without time zone default sysdate,ngayhethieuluc timestamp without time zone default sysdate," +
                             "luongcoban number(14,0) default 0 not null,luongchinhthuc number(14,0) default 0 not null, mahinhthuclamviec number(1,0) default 0 not null," +
                             "machucvu number(2,0), idkhoaphong number(3,0),nguoidaidienctyky character varying(4), ngaynghiviec timestamp without time zone," +
                             "sophep number(2,0) default 0, computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate," +
                             "CONSTRAINT pk_h_hopdong PRIMARY KEY (idhopdong))WITH ( OIDS=TRUE);\n";
                    s_Sql += " ALTER TABLE " + sSchema + ".h_hopdong OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".h_hopdong add constraint fk_hopdong_nhanvien foreign key(manhanvien) references " + sSchema + ".p_dmnhanvien(manhanvien)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".h_hopdong add constraint fk_hopdong_dmkhoaphong foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".h_hopdong add constraint fk_hopdong_dmhinhthuclv foreign key(mahinhthuclamviec) references " + sSchema + ".h_dmhinhthuclamviec(ma)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".h_hopdong add constraint fk_hopdong_dmchucvu foreign key(machucvu) references " + sSchema + ".h_dmchucvu(machucvu)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".h_hopdong add constraint fk_hopdong_dmnhanvien foreign key(nguoidaidienctyky) references " + sSchema + ".p_dmnhanvien(manhanvien)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_phuluchopdong(idphuluchopdong character varying(4),sophuluchopdong character varying(100),tenphuluchopdong character varying(200)," +
                        "masohopdonggoc character varying(4), mahopdong number(2,0) default 0 not null, ngaykyphuluchopdong timestamp without time zone default sysdate," +
                        "ngayhieulucphuluchopdong timestamp without time zone default sysdate, ngaybatdauhieuluc timestamp without time zone default sysdate," +
                        "ngayhethieuluc timestamp without time zone default sysdate, luongcoban number(14,0) default 0 not null, luongchinhthuc number(14,0) default 0 not null," +
                        "mahinhthuclamviec number(1,0) default 0 not null, machucvu number(2,0), idkhoaphong number(3,0), nguoidaidienctyky character varying(4)," +
                        "sophep number(2,0), bhxh numeric(1,0) DEFAULT 0, bhyt numeric(1,0) DEFAULT 0, bhtn numeric(1,0) DEFAULT 0, "+
                        "h_hsboiduonghienvat numeric(2,0) DEFAULT 0 NOT NULL, h_hsluong numeric(10,2) DEFAULT 0, h_hschucvu numeric(10,2) DEFAULT 0," +
                        "h_hsvuotkhung numeric(10,2) DEFAULT 0, h_hskiemnhiem numeric(10,2) DEFAULT 0, h_hstrachnhiemcongviec numeric(10,2) DEFAULT 0,"+
                        "h_hsphucapkhuvuc numeric(10,2) DEFAULT 0, h_hsbaoluu numeric(10,2) DEFAULT 0, h_hsdochai numeric(10,2) DEFAULT 0, "+
                        "h_hsphucapdacbiet numeric(10,2) DEFAULT 0, h_hsdacthu numeric(10,2) DEFAULT 0, h_hsluudong numeric(10,2) DEFAULT 0,"+
                        "h_hsthuhut numeric(10,2) DEFAULT 0, h_hsuudai numeric(10,2) DEFAULT 0, h_pctienan numeric(12,2) DEFAULT 0, "+
                        "h_pctienxang numeric(12,2) DEFAULT 0, h_pctiendienthoai numeric(12,2) DEFAULT 0, h_pckhac numeric(12,2) DEFAULT 0, "+
                        "h_tongluonghesopc numeric(15,2) DEFAULT 0, phuluchopdong numeric(1,0) DEFAULT 0 not null," +
                        "computer character varying(50), username character varying(20),ngayud timestamp without time zone DEFAULT sysdate," +
                        " CONSTRAINT pk_h_phuluchopdong PRIMARY KEY (idphuluchopdong)) WITH ( OIDS=TRUE );\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".h_phuluchopdong OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add constraint fk_hopdong_phuluchopdong foreign key(masohopdonggoc) references " + sSchema + ".h_hopdong(idhopdong)  ON UPDATE RESTRICT ON DELETE RESTRICT;";
                }
                //Thuy 30/09/15
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='bhxh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column bhxh numeric(1,0) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='bhyt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column bhyt numeric(1,0) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='bhtn'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column bhtn numeric(1,0) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hsboiduonghienvat'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hsboiduonghienvat numeric(2,0) DEFAULT 0 NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hsluong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hsluong numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hschucvu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hschucvu numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hsvuotkhung'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hsvuotkhung numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hskiemnhiem'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hskiemnhiem numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hstrachnhiemcongviec'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hstrachnhiemcongviec numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hsphucapkhuvuc'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hsphucapkhuvuc numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hsbaoluu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hsbaoluu numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hsdochai'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hsdochai numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hsphucapdacbiet'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hsphucapdacbiet numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hsdacthu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hsdacthu numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hsluudong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hsluudong numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hsthuhut'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hsthuhut numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_hsuudai'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_hsuudai numeric(10,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_pctienan'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_pctienan numeric(12,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_pctienxang'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_pctienxang numeric(12,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_pctiendienthoai'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_pctiendienthoai numeric(12,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_pckhac'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_pckhac numeric(12,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='h_tongluonghesopc'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column h_tongluonghesopc numeric(15,2) DEFAULT 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='phuluchopdong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add column phuluchopdong numeric(1,0) DEFAULT 0 not null;\n";
                }
                //end Thuy 30/9/15
                r_Col = dtAllColumn.Select("table_name='h_dmnhomchamcong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_dmnhomchamcong(ma character varying(2) NOT NULL,ten text,	ghichu text,CONSTRAINT h_dmnhomchamcong_pkey PRIMARY KEY (ma)" +
                            ") WITHOUT OIDS;\n";
                    s_Sql += " ALTER TABLE " + sSchema + ".h_dmnhomchamcong OWNER TO " + sUserID + ";\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmcalamviec'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " CREATE TABLE " + sSchema + ".h_dmcalamviec(maca number default 0 not null, tenca character varying(20)," +
                        "batdau character varying(10), ketthuc character varying(10), sophuttre number DEFAULT 0, sophutsom number DEFAULT 0," +
                        "batdauvao character varying(10), ketthucvao character varying(10), batdaura character varying(10), ketthucra character varying(10)," +
                        "sogio number(10,2) DEFAULT 0, manhom_chamcong character varying(2), computer character varying(50)," +
                        "username character varying(20), ngayud timestamp without time zone DEFAULT sysdate, CONSTRAINT pk_dmcalamviec PRIMARY KEY (maca))WITH (OIDS=FALSE);\n";
                    s_Sql += " ALTER TABLE " + sSchema + ".h_dmcalamviec  OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter table " + sSchema + ".h_dmcalamviec add constraint fk_calv_nhomchamcong foreign key(manhom_chamcong) references " + sSchema + ".h_dmnhomchamcong (ma) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='h_dmtrangthaichamcong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " CREATE TABLE " + sSchema + ".h_dmtrangthaichamcong(ma character varying(2) NOT NULL, ten character varying(200), computer character varying(50)," +
                        "username character varying(20), ngayud timestamp without time zone DEFAULT sysdate, CONSTRAINT pk_dmtrangthaichamcong PRIMARY KEY (ma)" +
                        ") WITH (OIDS=TRUE);\n";
                    s_Sql += " ALTER TABLE " + sSchema + ".h_dmtrangthaichamcong OWNER TO " + sUserID + ";\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmnhomvienphibaocao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_dmnhomvienphibaocao(idnhomvienphi number(3),tennhomvienphi varchar2(150),tenkhongdau varchar2(100)," +
                        "computer varchar2(50),ngayud date default sysdate not null,username varchar2(20));\n";
                    s_Sql += "alter table " + sSchema + ".b_dmnhomvienphibaocao add constraint pk_nhomvienpphibc primary key(idnhomvienphi);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmloaivienphi' and column_name='idnhomvienphibaocao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmloaivienphi add idnhomvienphibaocao number(3) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giayravien' and column_name='ngayravien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giayravien add ngayravien timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmtuongtac'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmtuongtac (mahoatchat1 VARCHAR2(8),tenhoatchat1 character varying(508),mahoatchat2 VARCHAR2(8),tenhoatchat2 character varying(508)," +
                            "tacdung character varying(1000),computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_dmtuongtac OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_dmtuongtac add constraint pk_m_dmtuongtac primary key(tenhoatchat1,tenhoatchat2);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_vienphi_phongthuchien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + Schema + ".p_vienphi_phongthuchien(idgiavienphi number(7),idkhoaphongbenhvien number(3),username varchar2(20)," +
                        "computer varchar2(50),ngayud date default sysdate) WITH (OIDS=TRUE);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".p_vienphi_phongthuchien OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_vienphi_phongthuchien add constraint pk_vienphi_phongthuchien primary key(idgiavienphi,idkhoaphongbenhvien);\n";
                    s_Sql += "alter table " + sSchema + ".p_vienphi_phongthuchien add constraint fk_vienphi_giavienphi foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
                    s_Sql += "alter table " + sSchema + ".p_vienphi_phongthuchien add constraint fk_vienphi_khoaphong foreign key(idkhoaphongbenhvien) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add stt number(5);\n";
                    s_Sql += "update " + sSchema + ".b_chidinh set stt=0 where stt is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column stt set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column stt set not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_giaychuyenvien rename column lydochuyenvien to huongdieutri;\n";
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='iddotchidinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add iddotchidinh number(30) default 0 not null;\n";//linh 9/12/14
                }
                r_Col = dtAllColumn.Select("table_name='m_xuatnoivienct' and column_name='soluongyeucau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " alter table " + sSchema + ".m_xuatnoivienct add column soluongyeucau number(20,7);\n";
                    s_Sql += "update " + sSchema + ".m_xuatnoivienct set soluongyeucau=0 where soluongyeucau is null;\n";
                    s_Sql += " alter table " + sSchema + ".m_xuatnoivienct alter column soluongyeucau set default 0;\n";
                    s_Sql += " alter table " + sSchema + ".m_xuatnoivienct alter column soluongyeucau set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thauds'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " create table " + sSchema + ".m_thauds(idthau number(30,0) default 0 not null,idnhomkho number(2) DEFAULT 0 not null," +
                        "ngayquyetdinh date,soquyetdinh varchar2(50),dotthau nvarchar2(50),nam number(4,0),idnhacungcap number(5,0) default 0 not null," +
                        "ghichu nvarchar2(500),username varchar2(20),computer varchar2(50),ngayud date DEFAULT sysdate) WITH (OIDS=TRUE);\n";
                    s_Sql += " ALTER TABLE " + sSchema + ".m_thauds OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter table " + sSchema + ".m_thauds add constraint pk_m_thauds primary key(idthau);\n";
                    s_Sql += " alter table " + sSchema + ".m_thauds add constraint fk_thauds_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
                    s_Sql += " alter table " + sSchema + ".m_thauds add constraint fk_thauds_nhacc foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap);\n";
                    s_Sql += " alter table " + sSchema + ".m_thauds add constraint fk_thauds_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thauct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " create table " + sSchema + ".m_thauct(idthau number(30,0) default 0 not null,stt number (3,0) default 0 not null,idbietduoc number(7) DEFAULT 0 not null," +
                        "handung date,soluong number(30,8) DEFAULT 0 not null,dongia number(24,10) default 0 not null,vat number(3) DEFAULT 0 not null," +
                        "giasauvat number(24,10) default 0 not null,ghichu nvarchar2(500),username varchar2(20),computer varchar2(50),ngayud date DEFAULT sysdate) WITH (OIDS=TRUE);\n";
                    s_Sql += " ALTER TABLE " + sSchema + ".m_thauct OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter table " + sSchema + ".m_thauct add constraint pk_m_thauct primary key(idthau,stt);\n";
                    s_Sql += " alter table " + sSchema + ".m_thauct add constraint fk_thauct_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
                    s_Sql += " alter table " + sSchema + ".m_thauct add constraint fk_thauct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giaychuyenvien' and column_name='sohoso'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add sohoso character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmkho' and column_name='khochuongtrinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmkho add khochuongtrinh numeric(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='donvitinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add donvitinh varchar2(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='csbt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add csbt varchar2(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='cantren'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add cantren number(10);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='canduoi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add canduoi number(10);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_ketqua alter column nguoilaymau type varchar2(20);\n";
                r_Col = dtAllColumn.Select("table_name='l_ketqua' and column_name='iddotchidinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketqua add iddotchidinh number(30);\n";
                    s_Sql += "alter table " + sSchema + ".l_ketqua alter column iddotchidinh set default 0 ;\n";
                    s_Sql += "update " + sSchema + ".l_ketqua set iddotchidinh=0 where iddotchidinh is null;\n";
                    s_Sql += "alter table " + sSchema + ".l_ketqua alter column iddotchidinh set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='mayxetnghiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add mayxetnghiem varchar2(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='batthuong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add batthuong number(1);\n";
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet alter column batthuong set default 0;\n";
                    s_Sql += "update " + sSchema + ".l_ketquachitiet set batthuong=0 where batthuong is null;\n";
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet alter column batthuong set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='tylethuocvattu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add tylethuocvattu numeric(5,2) default 0 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmuser alter column matkhau type varchar2(500);\n";
                r_Col = dtAllColumn.Select("table_name='p_goitiepdon'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_goitiepdon(khu number(3) default 0 not null,stt number (7) default 0 not null," +
                        "quay number (3) default 0 not null,trangthai number (1) default 0 not null,ngay date DEFAULT sysdate) WITH (OIDS=TRUE);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".p_goitiepdon OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_goitiepdon add constraint pk_p_goitiepdon primary key(khu,stt);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thauds' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_thauds add mmyy character varying(4);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thauct' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_thauct add mmyy character varying(4);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmloaiquyenso' and column_name='loaithu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmloaiquyenso add loaithu numeric(1,0) default 0 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".b_hoantra add constraint ck_b_hoantra_id check (id<>0);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='sotiendinhmucdieutri'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add column sotiendinhmucdieutri number(9) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='tomtatcls'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add column tomtatcls text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='daxulythuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add column daxulythuoc text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='thanhtoan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add thanhtoan numeric(1,0);\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatvien alter column thanhtoan set default 0;\n";
                    s_Sql += "update " + sSchema + ".p_xuatvien set thanhtoan=0 where thanhtoan is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_xuatvien alter column thanhtoan set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_phieuduyetkho'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_phieuduyetkho(idphieuduyet number(30) default 0, idkho number(3) default 0, trangthai number(1) default 0 not null,mmyy character varying(4) not null, " +
                        "ngayud timestamp without time zone DEFAULT sysdate, computer character varying(50),username character varying(20))" +
                   " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phieuduyetkho OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phieuduyetkho add constraint pk_m_phieuduyetkho primary key(idphieuduyet,idkho);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phieuduyetkho add constraint fk_phieuduyetkho_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_phieuduyetkho add constraint fk_phieuduyetkho_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='p_Benhkemtheo' and column_name='idkhoa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_Benhkemtheo add column idkhoa numeric(30,0);\n";
                    s_Sql += "alter table " + sSchema + ".p_Benhkemtheo alter column idkhoa set default 0;\n";
                    s_Sql += "update " + sSchema + ".p_Benhkemtheo set idkhoa=0 where idkhoa is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_Benhkemtheo alter column idkhoa set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='sohoadonnganhang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphi add sohoadonnganhang varchar2(20);\n";//linh 24/12/14
                }
                r_Col = dtAllColumn.Select("table_name='p_giayravien' and column_name='chandoantruoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giayravien add chandoantruoc text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giayravien' and column_name='chandoansau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giayravien add chandoansau text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giayravien' and column_name='phuongthucvocam'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giayravien add phuongthucvocam text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giayravien' and column_name='luoctrinhpt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giayravien add luoctrinhpt text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giayravien' and column_name='ngaypt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giayravien add ngaypt timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongsothebhyt' and column_name='ngayapdung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongsothebhyt add column ngayapdung timestamp without time zone;\n";
                    s_Sql += "update " + sSchema + ".p_thongsothebhyt set ngayapdung=to_date('01/01/2000','dd/MM/yyyy') where ngayapdung is null;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_thongsothebhyt drop constraint pk_thongsothebhyt;\n";
                s_Sql += "alter table " + sSchema + ".p_thongsothebhyt add constraint pk_thongsothebhyt primary key(id,kitu,nhomquyenloi,ngayapdung);\n";
                r_Col = dtAllColumn.Select("table_name='p_thongsotylecacdichvu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_thongsotylecacdichvu(id number(7),idbietduoc number(7),bhyt number(3),ngayapdung timestamp without time zone)" +
                   " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_thongsotylecacdichvu OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_thongsotylecacdichvu add constraint pk_thongsotylecacdichvu primary key(id,idbietduoc,ngayapdung);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmtuongtac' and column_name='mucdo'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmtuongtac add mucdo number(1) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dausinhton' and column_name='ylenh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dausinhton add column ylenh character varying(1000);\n";//Thuy 5/1/15
                }
                s_Sql += "alter table " + sSchema + ".l_ketquachitiet drop constraint pk_l_ketquachitiet;\n";
                s_Sql += "alter table " + sSchema + ".l_ketquachitiet add constraint pk_l_ketquachitiet_new primary key(idketqua, idxetnghiem, idvienphi,idchidinh);\n";
                r_Col = dtAllColumn.Select("table_name='p_thongsotylegiaban' and column_name='idnhomkho'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongsotylegiaban add idnhomkho number(2) default 0 not null;\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".p_thongsotylegiaban add constraint fk_thongsotylegiaban_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                r_Col = dtAllColumn.Select("table_name='p_dausinhton' and column_name='loai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dausinhton add column loai numeric(1,0) default 0 not null;\n";//Thuy 5/1/15
                }
                r_Col = dtAllColumn.Select("table_name='p_thongsotyletraituyen'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_thongsotyletraituyen(id number(7),loaiba number(1),tyle number(3),ngayapdung timestamp without time zone)" +
                   " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_thongsotyletraituyen OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_thongsotyletraituyen add constraint pk_thongsotyletraituyen primary key(id,loaiba,ngayapdung);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='idloaicdha'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add idloaicdha character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_theodoidulieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_theodoidulieu (idtheodoidulieu number(30),ngaylamviec date default sysdate,solieuthang varchar2(4)," +
                        "thaotac nvarchar2(500),ngayud date default sysdate, " +
                        "username varchar2(50), computer varchar2(50),mmyy varchar2 (4) default to_char(sysdate,'mmyy')) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_theodoidulieu OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_theodoidulieu add constraint pk_theodoidulieu primary key(idtheodoidulieu);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_hoichan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_hoichan(idhoichan number(30,0) DEFAULT 0,maql numeric(30,0) default 0,ngay timestamp without time zone default sysdate,mmyy varchar2 (4) default to_char(sysdate,'mmyy')," +
                        "chutoa character varying(4),thuki character varying(4),quatrinhbenhly text,ketluan text,huongdieutri text," +
                        "computer character varying(50),NGAYUD timestamp without time zone DEFAULT sysdate,username character varying(20)) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_hoichan OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".p_hoichan add CONSTRAINT pk_p_hoichan PRIMARY KEY (idhoichan);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombaocao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmnhombaocao(idnhombaocao number(2), tennhombaocao varchar2(150),username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".m_dmnhombaocao add constraint pk_dmnhombaocao primary key(idnhombaocao);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='idnhombaocao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add idnhombaocao number(2) default 0 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add constraint pk_dmnhombaocao foreign key(idnhombaocao) references " + sSchema + ".m_dmnhombaocao(idnhombaocao);;";
                r_Col = dtAllColumn.Select("table_name='p_hoichan_thanhvien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_hoichan_thanhvien" +
                            "( " +
                            "idhoichan number(30,0) default 0 not null," +
                            "manhanvien character varying(4) NOT NULL," +
                            "mmyy character varying(4) NOT NULL DEFAULT to_char(sysdate, 'mmyy'::text)," +
                            "username character varying(20)," +
                            "ngayud timestamp without time zone DEFAULT sysdate," +
                            "dongbo character varying(100) DEFAULT lpad('0'::text, 100, '0'::text)," +
                            "computer character varying(50)) WITH (OIDS=TRUE);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".p_hoichan_thanhvien  OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".p_hoichan_thanhvien add CONSTRAINT pk_p_hoichan_thanhvien PRIMARY KEY (idhoichan,manhanvien);";
                    s_Sql += "alter table " + sSchema + ".p_hoichan_thanhvien add CONSTRAINT fk_p_hoichan_thanhvien_dmnhanvien FOREIGN KEY (manhanvien) REFERENCES " + sSchema + ".p_dmnhanvien (manhanvien) MATCH SIMPLE  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".p_hoichan_thanhvien add CONSTRAINT fk_p_hoichan_thanhvien_dmuser FOREIGN KEY (username) REFERENCES " + sSchema + ".p_dmuser (username) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_hoichan' and column_name='idkhoaphong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_hoichan add idkhoaphong number(3,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi_old'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_dmgiavienphi_old as select * from " + sSchema + ".b_dmgiavienphi where 1=0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi_old' and column_name='ngaythaydoi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_old add ngaythaydoi timestamp without time zone;\n";
                }
                s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_old add constraint pk_b_dmgiavienphi_old primary key(idgiavienphi,ngaythaydoi);\n";
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi_new'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_dmgiavienphi_new as select * from " + sSchema + ".b_dmgiavienphi where 1=0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi_new' and column_name='dacapnhat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_new add dacapnhat numeric(1,0) default 0 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_new add constraint pk_b_dmgiavienphi_new primary key(idgiavienphi);\n";
                r_Col = dtAllColumn.Select("table_name='b_dmquyenso' and column_name='dungchung'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmquyenso add dungchung number(1) default 0 not null;\n";//ThanhCuong - 10/01/2015
                    s_Sql += "update " + sSchema + ".b_dmquyenso set dungchung=0 where dungchung is null;\n";//ThanhCuong - 10/01/2015
                    s_Sql += "alter table " + sSchema + ".b_dmquyenso alter column dungchung set not null;\n";//ThanhCuong - 10/01/2015
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='khu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add khu number(1) default 0;\n";//ThanhCuong - 13/01/2015
                    s_Sql += "update " + sSchema + ".p_dmkhoaphongbenhvien set khu=0 where khu is null;\n";//ThanhCuong - 13/01/2015
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien alter column khu set not null;\n";//ThanhCuong - 13/01/2015
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='idkhu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add idkhu number(3) default 0;\n";//ThanhCuong - 13/01/2015
                    s_Sql += "update " + sSchema + ".p_dmkhoaphongbenhvien set idkhu=0 where idkhu is null;\n";//ThanhCuong - 13/01/2015
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien alter column idkhu set not null;\n";//ThanhCuong - 13/01/2015
                }
                r_Col = dtAllColumn.Select("table_name='p_goitiepdon' and column_name='makhoaphong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_goitiepdon add makhoaphong varchar2(3);\n";//ThanhCuong - 13/01/2015
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='doituongkcb'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add doituongkcb numeric(1,0);\n";
                    s_Sql += "alter table " + sSchema + ".p_benhandt alter column doituongkcb set default 0;\n";
                    s_Sql += "update " + sSchema + ".p_benhandt set doituongkcb=0 where doituongkcb is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhandt alter column doituongkcb set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_ketquall' and column_name='idphongthuchien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_ketquall add idphongthuchien number(3);\n";
                    s_Sql += "alter table " + sSchema + ".r_ketquall alter column idphongthuchien set default 0;\n";
                    s_Sql += "update " + sSchema + ".r_ketquall set idphongthuchien=0 where idphongthuchien is null;\n";
                    s_Sql += "alter table " + sSchema + ".r_ketquall alter column idphongthuchien set not null;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='khangsinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add khangsinh number(1) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='vattu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add vattu number(1) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='hoachat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add hoachat number(1) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphi' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add stt number(7);\n";
                    s_Sql += "update " + sSchema + ".m_duyetchiphi set stt=0 where stt is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column stt set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column stt set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='sttvienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add sttvienphi number(7);\n";
                    s_Sql += "update " + sSchema + ".b_chidinh set sttvienphi=0 where sttvienphi is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column sttvienphi set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column sttvienphi set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='trangthaigoivp'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add trangthaigoivp number(1);\n";
                    s_Sql += "update " + sSchema + ".b_chidinh set trangthaigoivp=0 where trangthaigoivp is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column trangthaigoivp set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column trangthaigoivp set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_phatstttiepdon'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_phatstttiepdon (ngay date default sysdate not null, stt number(5) default 0 not null,loaibn number(3) default 0 not null, " +
                         "mmyy varchar2(4) default to_char(sysdate,'mmyy'),computer varchar2(50));\n";
                    s_Sql += "alter table " + sSchema + ".p_phatstttiepdon add constraint pk_p_phatstttiepdon primary key(ngay,loaibn,stt);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='loaiba'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add loaiba varchar2(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='idkhoaphongchidinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add idkhoaphongchidinh varchar2(2000);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='idphongthutien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add idphongthutien number(3);\n";
                    s_Sql += "update " + sSchema + ".b_chidinh set idphongthutien=0 where idphongthutien is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column idphongthutien set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column idphongthutien set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='trangthaigoicls'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add trangthaigoicls number(1);\n";
                    s_Sql += "update " + sSchema + ".b_chidinh set trangthaigoicls=0 where trangthaigoicls is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column trangthaigoicls set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column trangthaigoicls set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphi' and column_name='sttvienphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add sttvienphi number(7);\n";
                    s_Sql += "update " + sSchema + ".m_duyetchiphi set sttvienphi=0 where sttvienphi is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column sttvienphi set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column sttvienphi set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphi' and column_name='trangthaigoivp'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add trangthaigoivp number(3);\n";
                    s_Sql += "update " + sSchema + ".m_duyetchiphi set trangthaigoivp=0 where trangthaigoivp is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column trangthaigoivp set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column trangthaigoivp set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmcomputer' and column_name='goi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".p_dmcomputer add goi number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmcomputer' and column_name='ipservergoi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".p_dmcomputer add ipservergoi varchar2(100);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmcomputer' and column_name='portgoi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".p_dmcomputer add portgoi number(4) default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmcomputer' and column_name='khu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".p_dmcomputer add khu varchar2(50);\n";//ThanhCuong - 20/01/2015
                }
                r_Col = dtAllColumn.Select("table_name='p_dmcomputer' and column_name='quay'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".p_dmcomputer add quay number(3) default 0;\n";//ThanhCuong - 20/01/2015
                }
                s_Sql += "ALTER TABLE " + Schema + ".p_dmcomputer ADD CONSTRAINT uk_computer UNIQUE (tencomputer);\n";
                r_Col = dtAllColumn.Select("table_name='b_vienphict' and column_name='idktcao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphict add idktcao numeric(30,0);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict alter column idktcao set default 0;\n";
                    s_Sql += "update " + sSchema + ".b_vienphict set idktcao=0 where idktcao is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict alter column idktcao set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphict' and column_name='goiktcao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphict add goiktcao numeric(1,0);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict alter column goiktcao set default 0;\n";
                    s_Sql += "update " + sSchema + ".b_vienphict set goiktcao=0 where goiktcao is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict alter column goiktcao set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphictthuoc' and column_name='idktcao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add idktcao numeric(30,0);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc alter column idktcao set default 0;\n";
                    s_Sql += "update " + sSchema + ".b_vienphictthuoc set idktcao=0 where idktcao is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc alter column idktcao set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphictthuoc' and column_name='goiktcao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add goiktcao numeric(1,0);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc alter column goiktcao set default 0;\n";
                    s_Sql += "update " + sSchema + ".b_vienphictthuoc set goiktcao=0 where goiktcao is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc alter column goiktcao set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmicd' and column_name='ngoaidinhsuat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmicd add ngoaidinhsuat numeric(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhomtranbhyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_dmnhomtranbhyt(idnhomtranbhyt numeric(3,0),tennhomtranbhyt character varying(254),mathe character varying(254)," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".p_dmnhomtranbhyt add constraint pk_p_dmnhomtranbhyt primary key(idnhomtranbhyt);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_bhytxuattoan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".b_bhytxuattoan(idbhytxuattoan numeric(30,0),thang numeric(2,0),nam numeric(4,0),mabn character varying(14),hoten text," +
                             "namsinh numeric(4,0),gioitinh character varying(10),sothe character varying(20),manoidkkcb character varying(20),maicd character varying(10)," +
                             "ngayvao timestamp without time zone,ngayra timestamp without time zone,songaydieutri numeric(4,0),tongchiphi numeric(20,4),xetnghiem numeric(20,4)," +
                             "cdha numeric(20,4),thuoc numeric(20,4),mau numeric(20,4),pttt numeric(20,4),vtytth numeric(20,4),vtyttt numeric(20,4),dvktc numeric(20,4)," +
                             "thuock numeric(20,4),congkham numeric(20,4),tiengiuong numeric(20,4),cpvc numeric(20,4),tongtien numeric(20,4),bntra numeric(20,4)," +
                             "bhyttra numeric(20,4),ngoaiquyds numeric(20,4),lydovv text,benhkhac text,noikcb text,namqt numeric(4,0),thangqt numeric(4,0)," +
                             "tungay timestamp without time zone,denngay timestamp without time zone,diachi text,idkhoaphong numeric(3,0),khoathanhtoan text,tyle numeric(5,2)," +
                             "nhomdangky text,tuyen text,nhomquyenloi numeric(2,0),nhomthe text,tainangt numeric(1,0),loaibc numeric(1,0),username character varying(20)," +
                             "computer character varying(50),ngayud timestamp without time zone default sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".b_bhytxuattoan add constraint pk_b_bhytxuattoan primary key(idbhytxuattoan);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_xetnghiemchuyenmau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_xetnghiemchuyenmau(idketqua numeric(30,0),idchidinh numeric(30,0),idgiavienphi numeric(7,0) default 0 not null," +
                             "mabenhvien character varying(10),username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".l_xetnghiemchuyenmau add constraint pk_l_xetnghiemchuyenmau(idketqua,idchidinh);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='khamsuckhoe'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add khamsuckhoe number(1) default 0 not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".m_theodoidulieu alter column thaotac type character varying(500);\n";
                r_Col = dtAllColumn.Select("table_name='p_lichhen' and column_name='ngaykham'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lichhen add ngaykham date;\n";//Thuy 5/2/15
                    s_Sql += "alter table " + sSchema + ".p_lichhen alter column ngaykham set default sysdate;\n";//Thuy 5/2/15
                }
                s_Sql += "alter table " + sSchema + ".p_lichhen drop constraint un_p_lichhen;\n";//Thuy 5/2/15
                s_Sql += "alter table " + sSchema + ".p_lichhen add constraint un_lichhen unique(ngay,ngaykham,mabs,giobatdau);\n"; //linh 22/9/15
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='l_xetnghiemchuyenmau' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_xetnghiemchuyenmau add mmyy character varying(4);\n";
                    s_Sql += "update " + sSchema + ".l_xetnghiemchuyenmau set mmyy=to_char(ngayud,'mmyy') where mmyy is null or mmyy='';\n";
                }
                s_Sql += "alter table " + sSchema + ".m_ylenhthuocct alter column soluongyeucau type number(20,7);\n";
                s_Sql += "alter table " + sSchema + ".m_ylenhthuocct alter column soluongyeucau set default 0 ;\n";
                s_Sql += "alter table " + sSchema + ".m_ylenhthuocct alter column soluongyeucau set not null;\n";
                s_Sql += "alter table " + sSchema + ".m_ylenhthuocct alter column soluongphat type number(20,7);\n";
                s_Sql += "alter table " + sSchema + ".m_ylenhthuocct alter column soluongphat set default 0 ;\n";
                s_Sql += "alter table " + sSchema + ".m_ylenhthuocct alter column soluongphat set not null;\n";
                r_Col = dtAllColumn.Select("table_name='b_vienphict' and column_name='haophi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphict add haophi numeric(15,4);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict alter column haophi set default 0;\n";
                    s_Sql += "update " + sSchema + ".b_vienphict set haophi=0 where haophi is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict alter column haophi set not null;\n";
                }
                s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column stt type number(7,0);\n";
                s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column stt set default 0 ;\n";
                s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column stt set not null;\n";
                s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column sttvienphi type number(7,0);\n";
                s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column sttvienphi set default 0 ;\n";
                s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column sttvienphi set not null;\n";
                r_Col = dtAllColumn.Select("table_name='b_vienphictthuoc' and column_name='haophi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add haophi numeric(15,4);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc alter column haophi set default 0;\n";
                    s_Sql += "update " + sSchema + ".b_vienphictthuoc set haophi=0 where haophi is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc alter column haophi set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphichuavuottran' and column_name='haophi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran add haophi numeric(15,4);\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran alter column haophi set default 0;\n";
                    s_Sql += "update " + sSchema + ".b_vienphichuavuottran set haophi=0 where haophi is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran alter column haophi set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_thuocchuavuottran' and column_name='haophi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran add haophi numeric(15,4);\n";
                    s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran alter column haophi set default 0;\n";
                    s_Sql += "update " + sSchema + ".b_thuocchuavuottran set haophi=0 where haophi is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran alter column haophi set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_bhyt' and column_name='ngaygiahan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_bhyt add ngaygiahan date;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmongxetnghiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".l_dmongxetnghiem (idongxetnghiem number(1) default 0 ,maongxetnghiem varchar2(3)," +
                        "tenongxetnghiem nvarchar2(100),computer varchar2(100),username varchar2(50),ngayud date default sysdate,tenkhongdau varchar2(150));\n";
                    s_Sql += "alter table " + sSchema + ".l_dmongxetnghiem add constraint pk_dmongxetnghiem primary key (idongxetnghiem);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='idongxetnghiem'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add idongxetnghiem number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='matramgoirobo'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add matramgoirobo character varying(10);\n";//ThanhCuong - 05/03/2015
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='sttbyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add sttbyt character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lichhen' and column_name='chandoan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".p_lichhen add chandoan character varying(500);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lichhen' and column_name='sothe'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".p_lichhen add sothe character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='stt21'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".b_dmgiavienphi add stt21 character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi_new' and column_name='sttbyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".b_dmgiavienphi_new add sttbyt character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi_new' and column_name='stt21'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".b_dmgiavienphi_new add stt21 character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='tenbietduocbyt'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".m_dmbd add tenbietduocbyt text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_phatstttiepdon' and column_name='quay'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_phatstttiepdon add quay number(3) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_phatstttiepdon' and column_name='trangthai'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_phatstttiepdon add trangthai number(1) default 0 not null;\n";
                }
                s_Sql += "update " + sSchema + ".b_vienphict set mien=sotien where mien=0 and madoituong in(select madoituong from " + sSchema + ".p_dmdoituong where mien=1);\n";
                s_Sql += "update " + sSchema + ".b_vienphictthuoc set mien=sotien where mien=0 and madoituong in(select madoituong from " + sSchema + ".p_dmdoituong where mien=1);\n";
                s_Sql += "update " + sSchema + ".b_vienphict set haophi=sotien where haophi=0 and madoituong in(5);\n";
                s_Sql += "update " + sSchema + ".b_vienphictthuoc set haophi=sotien where haophi=0 and madoituong in(5);\n";
                r_Col = dtAllColumn.Select("table_name='p_lichhen' and column_name='mavaovien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lichhen add mavaovien numeric(30,0);\n";
                    s_Sql += "alter table " + sSchema + ".p_lichhen alter column mavaovien set default 0;\n";
                    s_Sql += "update " + sSchema + ".p_lichhen set mavaovien=0 where mavaovien is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichhen alter column mavaovien set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_hoichan' and column_name='tenhoichan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".p_hoichan add column tenhoichan text;\n";//Thuy 16/3/15
                }
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuocct' and column_name='idkey'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".m_ylenhthuocct add idkey numeric(30,0);\n";
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocct alter column idkey set default 0;\n";
                    s_Sql += "update " + sSchema + ".m_ylenhthuocct set idkey=0 where idkey is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocct alter column idkey set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_xuatnoivienct' and column_name='idkey'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".m_xuatnoivienct add idkey numeric(30,0);\n";
                    s_Sql += "alter table " + sSchema + ".m_xuatnoivienct alter column idkey set default 0;\n";
                    s_Sql += "update " + sSchema + ".m_xuatnoivienct set idkey=0 where idkey is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_xuatnoivienct alter column idkey set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhnhantheodoi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_benhnhantheodoi(mabn character varying(14),sothe character varying(20),username character varying(50)," +
                             "computer character varying(50),ngayud timestamp without time zone not null default sysdate);\n";
                    s_Sql += "alter table " + sSchema + ".p_benhnhantheodoi add constraint pk_p_benhnhantheodoi primary key(mabn,sothe);\n";
                    s_Sql += "alter table " + sSchema + ".p_benhnhantheodoi add constraint fk_p_benhnhantheodoi_dmbenhnhan foreign key(mabn) references " + Schema + ".p_dmbenhnhan(mabn) match simple on update restrict on delete restrict;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='ghichu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".b_dmgiavienphi add ghichu numeric(1,0) default 0 not null;\n";//Thuy 23/3/15
                }
                r_Col = dtAllColumn.Select("table_name='l_dmxetnghiem' and column_name='binhthuongte'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmxetnghiem add binhthuongte character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmxetnghiem' and column_name='minte'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmxetnghiem add minte numeric(10,5);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmxetnghiem' and column_name='maxte'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmxetnghiem add maxte numeric(10,5);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutri'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_vudieutri(idvudieutri number(30) default 0) WITH (OIDS=true);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutri' and column_name='idvudieutri'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutri add idvudieutri number(30) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutri' and column_name='ngay'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutri add ngay timestamp without time zone DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutri' and column_name='loaibieu'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutri add loaibieu varchar(100);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutri' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutri add mmyy character varying(4) DEFAULT to_char(sysdate, 'mmyy'::text) NOT NULL;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='p_vudieutri' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutri add computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutri' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutri add username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutri' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutri add ngayud timestamp without time zone DEFAULT sysdate;\n";
                }
                s_Sql += "alter table " + sSchema + ".p_vudieutri add constraint pk_p_vudieutri primary key (idvudieutri);\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v01;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v02;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v03;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v04;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v05;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v06;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v07;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v08;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v09;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v10;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v11;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v12;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v13;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v14;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v15;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v16;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v17;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v18;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v19;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v20;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v21;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v22;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v23;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v24;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v25;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v26;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v27;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v28;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v29;\n";
                s_Sql += "alter table " + sSchema + ".p_vudieutri drop column v30;\n";
                r_Col = dtAllColumn.Select("table_name='p_vudieutrichitiet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_vudieutrichitiet(idvudieutri number(30) default 0, " +
                        "noidung character varying(1000) ,key numeric(5),mmyy character varying(4) NOT NULL DEFAULT to_char(sysdate, 'mmyy'::text), " +
                        "v01 numeric(24,8) default 0 not null,v02 numeric(24,8) default 0 not null,v03 numeric(24,8) default 0 not null," +
                        "v04 numeric(24,8) default 0 not null,v05 numeric(24,8) default 0 not null,v06 numeric(24,8) default 0 not null," +
                        "v07 numeric(24,8) default 0 not null,v08 numeric(24,8) default 0 not null,v09 numeric(24,8) default 0 not null," +
                        "v10 numeric(24,8) default 0 not null," +
                        "v11 numeric(24,8) default 0 not null,v12 numeric(24,8) default 0 not null,v13 numeric(24,8) default 0 not null," +
                        "v14 numeric(24,8) default 0 not null,v15 numeric(24,8) default 0 not null,v16 numeric(24,8) default 0 not null," +
                        "v17 numeric(24,8) default 0 not null,v18 numeric(24,8) default 0 not null,v19 numeric(24,8) default 0 not null," +
                        "v20 numeric(24,8) default 0 not null," +
                        "v21 numeric(24,8) default 0 not null,v22 numeric(24,8) default 0 not null,v23 numeric(24,8) default 0 not null," +
                        "v24 numeric(24,8) default 0 not null,v25 numeric(24,8) default 0 not null,v26 numeric(24,8) default 0 not null," +
                        "v27 numeric(24,8) default 0 not null,v28 numeric(24,8) default 0 not null,v29 numeric(24,8) default 0 not null," +
                        "v30 numeric(24,8) default 0 not null,ma varchar2(20)," +
                        "computer character varying(50),username character varying(20),ngayud timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                    s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add constraint pk_p_vudieutrichitiet primary key (idvudieutri,key);\n";
                    s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add CONSTRAINT fk_p_vudieutrichitiet_vudieutri FOREIGN KEY (idvudieutri) REFERENCES " + sSchema + ".p_vudieutri (idvudieutri) MATCH SIMPLE  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                s_Sql += "alter table " + sSchema + ".m_xuatnoivienct alter column soluong type number(20,7);\n";
                s_Sql += "alter table " + sSchema + ".m_xuatnoivienct alter column soluong set default 0 ;\n";
                s_Sql += "alter table " + sSchema + ".m_xuatnoivienct alter column soluong set not null;\n";
                s_Sql += "alter table " + sSchema + ".m_xuatnoivienct alter column soluongyeucau type number(20,7);\n";
                s_Sql += "alter table " + sSchema + ".m_xuatnoivienct alter column soluongyeucau set default 0 ;\n";
                s_Sql += "alter table " + sSchema + ".m_xuatnoivienct alter column soluongyeucau set not null;\n";
                //Tú:31/03/2015
                s_Sql += "alter table " + sSchema + ".m_dmbd alter column idloaithuocbyt type numeric(3,0);\n";
                r_Col = dtAllColumn.Select("table_name='p_hoichanphauthuat_ekip'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_hoichanphauthuat_ekip(idhoichanphauthuat numeric(30,0),manhanvien character varying(4),mmyy character varying(4)," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate not null);\n";
                    s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat_ekip add constraint pk_p_hoichanphauthuat_ekip primary key(idhoichanphauthuat,manhanvien);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_hoichanphauthuat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".p_hoichanphauthuat(idhoichanphauthuat numeric(30,0),maql numeric(30,0) default 0 not null,ngay timestamp without time zone," +
                             "idkhoa numeric(30,0) default 0 not null,idkhoaphong numeric(3,0) default 0 not null," +
                             " mmyy character varying(4)  DEFAULT to_char(sysdate, 'mmyy'::text) NOT NULL ,dienbien text,hc text,hst text," +
                             "bc text,md text,mc text,nhommau text,ure text,creatinin text,glucoza text,protit text,howell text,prothrobin text,nuoctieu text,xquang text," +
                             "sieuam text,dientim text,phanungthuoc text,phuongphapphauthuat text,phuongphapvocam text,khokhan text,dutrumau text," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate not null);\n";
                    s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat add constraint pk_p_hoichanphauthuat primary key(idhoichanphauthuat);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='mabschidinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add mabschidinh character varying(4);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='maicd'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add maicd character varying(10);\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='chandoan'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add chandoan text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_hoichanphauthuat_ekip' and column_name='idchucnang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat_ekip add idchucnang numeric(2,0) default 0 not null;\n";
                    s_Sql += "update " + sSchema + ".p_hoichanphauthuat_ekip set idchucnang=0 where idchucnang is null or idchucnang='';\n";
                    s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat_ekip alter column idchucnang set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat_ekip alter column idchucnang set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_hoichanphauthuat' and column_name='ngaymo'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat add ngaymo timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_phieusoket15'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += " create table " + sSchema + ".p_phieusoket15(idphieusoket number(30),maql number(30) default 0 not null, idkhoaphongbenhvien number(3) default 0 not null," +
                        "dienbienlamsang varchar2(500),xetnghiemcanlamsang varchar2(500),quatrinhdieutri varchar2(500),danhgiaketqua varchar2(500),huongdieutri varchar2(500)," +
                        "mabsdieutri varchar2(4) default '0000' not null,mabstruongkhoa varchar2(4),mmyy varchar2(4)  DEFAULT to_char(sysdate, 'mmyy'::text) NOT NULL ,username varchar2(50),computer varchar2(50)," +
                        "ngayud date default sysdate);\n";
                    s_Sql += " alter table " + sSchema + ".p_phieusoket15 add constraint pk_phieusoket15 primary key(idphieusoket);\n";
                    s_Sql += " alter table " + sSchema + ".p_phieusoket15 add constraint fk_phieusoket15_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
                    s_Sql += " alter table " + sSchema + ".p_phieusoket15 add constraint fk_phieusoket15_dmbsdt foreign key(mabsdieutri) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
                    s_Sql += " alter table " + sSchema + ".p_phieusoket15 add constraint fk_phieusoket15_dmtruongkhoa foreign key(mabstruongkhoa) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmuser alter column nhomthuoc type varchar2(500);\n";
                r_Col = dtAllColumn.Select("table_name='m_denghitra'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_denghitra(iddenghitra number(30) default 0, mmyy character varying(4) DEFAULT to_char(sysdate, 'mmyy'::text) not null, sophieu character varying(20),  ngay timestamp without time zone not null,  " +
                      " trangthai number(1) default 0 not null,idkhoxuat number(3,0) default 0 not null, idkhonhap number(3,0) default 0 not null, ghichu text," +
                      " computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                        "  WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_denghitra OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_denghitra add constraint pk_m_denghitra primary key(iddenghitra);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_denghitra add constraint fk_denghitra_dmkhoxuat foreign key(idkhoxuat) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_denghitra add constraint fk_denghitra_dmkhonhap foreign key(idkhonhap) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_denghitra add constraint fk_denghitra_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_denghitract'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_denghitract(iddenghitra number(30) default 0, stt number(3) default 0 not null, mmyy character varying(4) DEFAULT to_char(sysdate, 'mmyy'::text) not null," +
                      " idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null, computer character varying(50),username character varying(20), ngayud timestamp without time zone DEFAULT sysdate)" +
                        " WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_denghitract OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_denghitract add constraint pk_m_denghitract primary key(iddenghitra,stt);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_xuatll' and column_name='iddenghitra'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_xuatll add iddenghitra number(30);\n";
                    s_Sql += "alter table " + sSchema + ".m_xuatll alter column iddenghitra set default 0 ;\n";
                    s_Sql += "update " + sSchema + ".m_xuatll set iddenghitra=0 where iddenghitra is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_xuatll alter column iddenghitra set not null;\n";
                }
                s_Sql += "alter TABLE " + sSchema + ".m_xuatll add constraint fk_xuatll_denghitra foreign key(iddenghitra) references " + sSchema + ".m_denghitra(iddenghitra) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter TABLE " + sSchema + ".m_denghitract add constraint ck_denghitra_iddenghitract check (iddenghitra<>0);\n";
                r_Col = dtAllColumn.Select("table_name='m_dmkho' and column_name='khomau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmkho add khomau numeric(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_toamauct' and column_name='madoituong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_toamauct add madoituong number(2) default 0 not null;\n";//ThanhCuong - 07/04/2015
                }
                s_Sql += "update " + sSchema + ".l_ketquachitiet a set mabschidinh=(select mabschidinh from " + sSchema + ".l_ketqua b where b.idketqua=a.idketqua) where mabschidinh is null or mabschidinh='';\n";
                s_Sql += "alter table " + sSchema + ".l_ketquachitiet alter column mabschidinh set default '0000' ;\n";
                s_Sql += "alter table " + sSchema + ".l_ketquachitiet alter column mabschidinh set not null;\n";
                s_Sql += "alter table " + sSchema + ".m_dmkho add column duyettudong numeric(1,0) default 0 not null;\n";
                r_Col = dtAllColumn.Select("table_name='p_vudieutrichitiet' and column_name='ma'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add column ma varchar2(20);\n";//linh 10/4/15
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutrichitiet' and column_name='nuocsanxuat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add column nuocsanxuat varchar2(200);\n";//linh 10/4/15
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutrichitiet' and column_name='dactrungkythuat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add column dactrungkythuat varchar2(200);\n";//linh 10/4/15
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutrichitiet' and column_name='nguonkinhphi'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add column nguonkinhphi varchar2(200);\n";//linh 10/4/15
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='barcode'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add column barcode character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='ngaycapphat'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add column ngaycapphat timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='xutri'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add xutri character varying(254);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='vitamin'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add vitamin number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='corticoid'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add corticoid number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='thuocme'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add thuocme number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='phacheyhct'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add phacheyhct number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='dichtruyen'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add dichtruyen number(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dutrumuact' and column_name='dongia'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact add dongia number(12,4);\n";
                    s_Sql += "update " + sSchema + ".m_dutrumuact set dongia=0 where dongia is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact alter column dongia set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact alter column dongia set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dutrumuact' and column_name='idhang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact add idhang number(5);\n";
                    s_Sql += "update " + sSchema + ".m_dutrumuact set idhang=0 where idhang is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact alter column idhang set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact alter column idhang set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dutrumuact' and column_name='idnuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact add idnuoc number(5);\n";
                    s_Sql += "update " + sSchema + ".m_dutrumuact set idnuoc=0 where idnuoc is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact alter column idnuoc set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact alter column idnuoc set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmnhombaocao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".r_dmnhombaocao(idnhombaocao numeric(2,0) not null,stt numeric(2) default 0 not null,tennhombaocao character varying(150)," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".r_dmnhombaocao owner to medilink;\n";
                    s_Sql += "alter table " + sSchema + ".r_dmnhombaocao add constraint pk_r_dmnhombaocao primary key (idnhombaocao);\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmkythuat' and column_name='idnhombaocao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmkythuat add column idnhombaocao numeric(2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thauds' and column_name='tungay'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_thauds add column tungay timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thauds' and column_name='denngay'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_thauds add column denngay timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombaocao' and column_name='idbaocao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombaocao add idbaocao numeric(1) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='idnhombaocao'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add idnhombaocao numeric(2) default 0 not null;\n";
                }
                //Tú:07/05/2015
                s_Sql += "alter table " + sSchema + ".p_hiendien drop constraint fk_hiendien_dmicd;\n";
                r_Col = dtAllColumn.Select("table_name='m_thauct' and column_name='idhang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_thauct add idhang number(5);\n";
                    s_Sql += "update " + sSchema + ".m_thauct set idhang=0 where idhang is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_thauct alter column idhang set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_thauct alter column idhang set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thauct' and column_name='idnuoc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_thauct add idnuoc number(5);\n";
                    s_Sql += "update " + sSchema + ".m_thauct set idnuoc=0 where idnuoc is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_thauct alter column idnuoc set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_thauct alter column idnuoc set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='phimxquang'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add column phimxquang numeric(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thauct' and column_name='soluongdanhap'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_thauct add soluongdanhap number(30,7);\n";
                    s_Sql += "update " + sSchema + ".m_thauct set soluongdanhap=0 where soluongdanhap is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_thauct alter column soluongdanhap set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_thauct alter column soluongdanhap set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thauds' and column_name='conhoatdong'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_thauds add conhoatdong number(1);\n";
                    s_Sql += "update " + sSchema + ".m_thauds set conhoatdong=0 where conhoatdong is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_thauds alter column conhoatdong set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_thauds alter column conhoatdong set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='uutien'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add uutien number(1);\n";
                    s_Sql += "update " + sSchema + ".p_lienhe set uutien=0 where uutien is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_lienhe alter column uutien set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".p_lienhe alter column uutien set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='dieutrikethop'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add column dieutrikethop numeric(1,0);\n";
                    s_Sql += "update " + sSchema + ".p_benhandt set dieutrikethop=0 where dieutrikethop is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhandt alter column dieutrikethop set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhandt alter column dieutrikethop set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='idkhoaphongchidinh'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add column idkhoaphongchidinh numeric(3,0);\n";
                    s_Sql += "update " + sSchema + ".p_benhandt set idkhoaphongchidinh=0 where idkhoaphongchidinh is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhandt alter column idkhoaphongchidinh set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".p_benhandt alter column idkhoaphongchidinh set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='config' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".config add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmcomputer' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmcomputer add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmdoituong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmdoituong add idnhib serial;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='p_dmnghenghiepbenhvien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnghenghiepbenhvien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmvungbenhvien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmvungbenhvien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtinhthanh' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmtinhthanh add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnghenghiep' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnghenghiep add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhomicd' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhomicd add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtuyenbenhvien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmtuyenbenhvien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmloaivienphi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmloaivienphi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmloaibenhvien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmloaibenhvien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhomkhoaphong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhomkhoaphong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmnhomvienphi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmnhomvienphi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmnhomvienphibhyt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmnhomvienphibhyt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_chamcong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_chamcong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmnhom' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_dmnhom add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmchuongicd' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmchuongicd add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhvien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmbenhvien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_khoaphongbenhan' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_khoaphongbenhan add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_khoaphonggiavienphi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_khoaphonggiavienphi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhomnhanvien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhomnhanvien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongso' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongso add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmdantoc' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmdantoc add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhan' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmbenhan add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmquanhuyen' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmquanhuyen add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhanvien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xutridieutri' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xutridieutri add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmloaiquyenso' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmloaiquyenso add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmketquadieutri' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmketquadieutri add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtinhtrangrakhoa' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmtinhtrangrakhoa add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmxutri' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmxutri add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lienhe' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lienhe add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphuongxa' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmphuongxa add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_bhyt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_bhyt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmdang' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmdang add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmhang' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmhang add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmduongdung' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmduongdung add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhomketoan' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhomketoan add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhomhang' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhomhang add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnganhang' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnganhang add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmquyenso' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmquyenso add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmloai' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmloai add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmhoatchat' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmhoatchat add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhomphieu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhomphieu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmkhoaphong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmkhoaphong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmkho' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmkho add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnguon' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnguon add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhomin' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhomin add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhomkho' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhomkho add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmicd' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmicd add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_hoantra' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_hoantra add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmphieu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmphieu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_hiendien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_hiendien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmloaithuocbyt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmloaithuocbyt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_nhapkhoa' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_nhapkhoa add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhkemtheo' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhkemtheo add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_tamung' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_tamung add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhandt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhandt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnuoc' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnuoc add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_theodoi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_theodoi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatvien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatvien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmloaicdha' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmloaicdha add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_xuatkhoa' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_xuatkhoa add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmkythuat' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmkythuat add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmmaumota' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmmaumota add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tonkhochitiet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tonkhochitiet add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmmay' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmmay add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tonkhotonghop' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tonkhotonghop add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhacungcap' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhacungcap add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuoc' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuoc add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thucxuattutruc' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_thucxuattutruc add idnhib serial;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='l_dmnhomxetnghiem' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmnhomxetnghiem add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_phieuduyet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_phieuduyet add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_xuatnoiviends' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_xuatnoiviends add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongso_ext' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongso_ext add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tondau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tondau add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuocds' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocds add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmxetnghiem' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmxetnghiem add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmloaixetnghiem' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmloaixetnghiem add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmvienphi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmvienphi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmxetnghiemmap' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmxetnghiemmap add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmsoxetnghiem' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmsoxetnghiem add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_nhapll' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_nhapll add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tontutrucchitiet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tontutrucchitiet add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tienthuoc' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tienthuoc add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_nhapct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_nhapct add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmmucdodiung' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmmucdodiung add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhmantinh' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhmantinh add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_diungthuoc' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_diungthuoc add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_tontutructonghop' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_tontutructonghop add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhtiensu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhtiensu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dausinhton' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dausinhton add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_xuatnoivienct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_ketquall' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_ketquall add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_ketquact' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_ketquact add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_xuatct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_xuatct add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmlydoxuat' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmlydoxuat add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_xuatll' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_xuatll add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuocct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquachitiet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketquachitiet add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmuser' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmuser add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_toathuocll' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_toathuocll add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketqua' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_ketqua add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_toathuocct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_toathuocct add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphithuoc' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmloainhompttt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmloainhompttt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmlydovaovien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmlydovaovien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhompttt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhompttt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmgaymegayte' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmgaymegayte add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphuongphappttt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_tamungcd' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_tamungcd add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmloaipttt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmloaipttt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmmaupttt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmmaupttt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphicls' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmdiadiem' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmdiadiem add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtuvongpt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmtuvongpt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtaibienpt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmtaibienpt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtinhhinhpt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmtinhhinhpt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnguyennhanchet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnguyennhanchet add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphongmo' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmphongmo add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongsothebhyt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongsothebhyt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtinhtranggpb' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmtinhtranggpb add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_tuvong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_tuvong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhomuser' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhomuser add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_pttt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_pttt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphai' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmphai add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_tainanthuongtich' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmloaikythuatvienphi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmloaikythuatvienphi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmtinhtrangthuchiencls' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmtinhtrangthuchiencls add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmloaibn' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmloaibn add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhantu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhantu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmdentu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmdentu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmfieldgia' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmfieldgia add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_sophieuduyet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_sophieuduyet add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhanhen' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmbenhnhanhen add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lichhen' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lichhen add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lichlamviecbacsi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_lichlamviecbacsi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_sophieumau38' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_sophieumau38 add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhommau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhommau add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_capmabenhnhan' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_capmabenhnhan add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='s_dmchucnang' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".s_dmchucnang add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_quyennguoidung' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_quyennguoidung add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giaychuyenvien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_giayravien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_giayravien add idnhib serial;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='m_dutrumuall' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dutrumuall add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dutrumuact' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dutrumuact add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='s_useroption' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".s_useroption add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_solienhoadon' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_solienhoadon add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_nhomquyenloibhyt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_nhomquyenloibhyt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetdutrumuall' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetdutrumuall add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetdutrumuact' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetdutrumuact add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmviettat' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmviettat add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmgoiygioitinh' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmgoiygioitinh add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphict' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphict add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphictthuoc' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongsotylegiaban' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongsotylegiaban add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphichuavuottran' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_thuocchuavuottran' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmkho' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmkho add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmthetich add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bl_tonkhotonghop add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmloaimau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bl_theodoi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhomphieu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhomphieu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnguon' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmnguon add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomin' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmnhomin add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmphieu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmphieu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bl_tonkhochitiet add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomrhd' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmnhomrhd add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmnhacungcap add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tondau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bl_tondau add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmdang' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_dmdang add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_tonkhochitiet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_tonkhochitiet add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_theodoi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_theodoi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_tontutructonghop' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_tontutructonghop add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_tonkhotonghop' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_tonkhotonghop add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_nhapll' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_nhapll add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmloai' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_dmloai add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_nhapct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_nhapct add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_tontutrucchitiet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_xuatll' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_xuatll add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_tondau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_tondau add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_xuatct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_xuatct add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmkho' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_dmkho add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmnhom' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_dmnhom add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmloaiphong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmloaiphong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_theodoigiuong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_theodoigiuong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmphong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thanhvienekipmo' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dutrucapll' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dutrucapll add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmgiuong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmgiuong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dutrucapct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dutrucapct add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmchucnangekipmo' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmchucnangekipmo add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chuyensolieu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_chuyensolieu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmphucappttt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmphucappttt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_goivienphi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_goivienphi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbdtd' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbdtd add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_phatthuoc' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_phatthuoc add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_khoasolieu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_khoasolieu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bc_report' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bc_report add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bc_control' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".bc_control add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_ngoaingu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_ngoaingu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmngoaingu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmngoaingu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmtongiao' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmtongiao add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmchucdanh' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmchucdanh add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmchucvu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmchucvu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmtrinhdovitinh' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmtrinhdovitinh add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmchuyenmon' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmchuyenmon add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmhocvan' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmhocvan add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_capmathebhyt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_capmathebhyt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_denghichitiet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_denghichitiet add idnhib serial;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='m_denghi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_denghi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmcachdung' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmcachdung add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_labthongso' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_labthongso add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_labketqua' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_labketqua add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='d_dmkhuhoso' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".d_dmkhuhoso add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='d_dmkehoso' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".d_dmkehoso add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='d_dmtanghoso' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".d_dmtanghoso add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_toamau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_toamau add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnoilamviec' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnoilamviec add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_hopdong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_hopdong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmhopdong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmhopdong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_phuluchopdong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_phuluchopdong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmhinhthuclamviec' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmhinhthuclamviec add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmnhomvienphibaocao' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmnhomvienphibaocao add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmnhomchamcong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmnhomchamcong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmcalamviec' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmcalamviec add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='h_dmtrangthaichamcong' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".h_dmtrangthaichamcong add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_toamauct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_toamauct add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thauds' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_thauds add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_vienphi_phongthuchien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vienphi_phongthuchien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_thauct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_thauct add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_phieuduyetkho' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_phieuduyetkho add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_hoichan' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_hoichan add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_theodoidulieu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_theodoidulieu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongsotylecacdichvu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongsotylecacdichvu add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmtuongtac' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmtuongtac add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_thongsotyletraituyen' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_thongsotyletraituyen add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_goitiepdon' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_goitiepdon add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombaocao' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombaocao add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi_new' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_new add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_hoichan_thanhvien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_hoichan_thanhvien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi_old' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_old add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_xetnghiemchuyenmau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_xetnghiemchuyenmau add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_phatstttiepdon' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_phatstttiepdon add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutri' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutri add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_vudieutrichitiet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnhomtranbhyt' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhomtranbhyt add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_bhytxuattoan' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_bhytxuattoan add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmongxetnghiem' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmongxetnghiem add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_benhnhantheodoi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_benhnhantheodoi add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_hoichanphauthuat' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_hoichanphauthuat_ekip' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat_ekip add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_phieusoket15' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_phieusoket15 add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_denghitra' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_denghitra add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_denghitract' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_denghitract add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='r_dmnhombaocao' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".r_dmnhombaocao add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmnguyennhantainan' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnguyennhantainan add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmhang' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_dmhang add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmttb' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_dmttb add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbophan' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmbophan add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmngodoc' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmngodoc add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmdienbien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmdienbien add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmxutritainan' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".p_dmxutritainan add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmnguon' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_dmnguon add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_dmvienphi' and column_name='hesotest'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".l_dmvienphi add column hesotest numeric(5,2) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_cosotutruc'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_cosotutruc(idtutruc numeric(3,0) default 0 not null,idbietduoc numeric(7,0) default 0 not null," +
                        "soluong numeric(30,7) default 0 not null,mmyy  varchar2(4)  DEFAULT to_char(sysdate, 'mmyy'::text) NOT NULL ," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate,idnhib serial) with (oids=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".m_cosotutruc OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".m_cosotutruc add constraint pk_m_cosotutruc primary key(idtutruc,idbietduoc,mmyy);\n";
                    s_Sql += "alter table " + sSchema + ".m_cosotutruc add constraint fk_cosotutruc_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_cosotutruc add constraint fk_cosotutruc_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                    s_Sql += "alter table " + sSchema + ".m_cosotutruc add constraint fk_cosotutruc_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_nhapll' and column_name='idthau'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_nhapll add idthau number(30,0);\n";
                    s_Sql += "update " + sSchema + ".m_nhapll set idthau=0 where idthau is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_nhapll alter column idthau set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_nhapll alter column idthau set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='thuocphongxa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column thuocphongxa numeric(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi_new' and column_name='thuocphongxa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_new add column thuocphongxa numeric(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi_old' and column_name='thuocphongxa'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_old add column thuocphongxa numeric(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dangduyet'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dangduyet(idkhoaphong numeric(3,0),ngay timestamp without time zone default sysdate not null," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate not null,idnhib serial) with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".m_dangduyet add constraint pk_m_dangduyet primary key(idkhoaphong);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dangduyet' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dangduyet add ngayud timestamp without time zone default sysdate not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dangduyet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dangduyet add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc40'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmnhombietduoc40(idnhombietduoc40 numeric(5,0),tennhombietduoc40 character varying(500),username character varying(20)," +
                             "computer character varying(50),ngayud timestamp without time zone default sysdate not null,idnhib serial) with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc40 add constraint pk_m_nhombietduoc40 primary key(idnhombietduoc40);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmnhombietduoc40' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc40 add idnhib serial;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='m_dmloaibietduoc40'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "create table " + sSchema + ".m_dmloaibietduoc40(idloaibietduoc40 numeric(5,0),tenloaibietduoc40 character varying(500)," +
                             "idnhombietduoc40 numeric(5,0) default 0 not null," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate not null,idnhib serial);\n";
                    s_Sql += "alter table " + sSchema + ".m_dmloaibietduoc40 add constraint pk_m_loaibietduoc40 primary key(idloaibietduoc40);\n";
                    s_Sql += "alter table " + sSchema + ".m_dmloaibietduoc40 add constraint fk_m_loaibietduoc40_nhom foreign key(idnhombietduoc40) references " + sSchema + ".m_dmnhombietduoc40(idnhombietduoc40) on update restrict on delete restrict;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmloaibietduoc40' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmloaibietduoc40 add idnhib serial;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='idloaibietduoc40'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add column idloaibietduoc40 numeric(5,0) default 0 not null;\n";
                }
                //Tú:23/05/2015
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='sttbd22'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add column sttbd22 character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='stthc22'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add column stthc22 character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='e_dmloai' and column_name='idnhom'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 23/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".e_dmloai add idnhom numeric(3,0) default 0 not null;\n";
                    s_Sql += "alter table " + sSchema + ".e_dmloai add constraint fk_e_loai_nhom foreign key(idnhom) references " + sSchema + ".e_dmnhom(idnhom) on update restrict on delete restrict;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_maicdthuoc'");//ThanhCuong - 26/05/2015
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".m_maicdthuoc(maicd character varying(10),idbietduoc numeric(7,0),soluong numeric(30,0),idnhib serial) with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".m_maicdthuoc add constraint pk_m_maicdthuoc primary key(maicd,idbietduoc);\n";
                }
                //Tú:09/06/2015
                r_Col = dtAllColumn.Select("table_name='p_bhyt' and column_name='bhyt5nam'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_bhyt add bhyt5nam numeric(1,0);\n";
                    s_Sql += "update " + sSchema + ".p_bhyt set bhyt5nam=0 where bhyt5nam is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_bhyt alter column bhyt5nam set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".p_bhyt alter column bhyt5nam set not null;\n";
                }
                //Tú:22/06/2015
                s_Sql += "alter table " + sSchema + ".p_dmicd add column hide numeric(1,0) default 0 not null;\n";
                //linh 23/6/15
                r_Col = dtAllColumn.Select("table_name='s_ngonngu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".s_ngonngu(name varchar2(2000),value_en varchar2(2000),value_fr varchar2(2000)," +
                        "value_ja varchar2(2000),value_ko varchar2(2000),value_de varchar2(2000),value_cn varchar2(2000)," +
                        "value_ca varchar2(2000),comment varchar2(2000),idnhib serial) with (oids=true);\n";
                }
                s_Sql += "alter table " + sSchema + ".s_ngonngu add constraint pk_s_ngonngu primary key(name);\n";
                //Tú:26/06/2015
                r_Col = dtAllColumn.Select("table_name='m_trukhotam'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".m_trukhotam(idtrukhotam numeric(30,0),idduyetchiphi numeric(30,0) default 0 not null," +
                             "mmyy character varying(4) default to_char(sysdate,'mmyy') not null,ngay timestamp without time zone default sysdate not null," +
                             "idtheodoitam numeric(30,0) default 0 not null,idbietduoc numeric(7,0) default 0 not null,idkho numeric(3,0) default 0 not null," +
                             "idnguon numeric(2,0) default 0 not null,soluong numeric(12,4) default 0 not null," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate not null);\n";
                }
                s_Sql += "alter table " + sSchema + ".m_trukhotam add constraint pk_m_trukhotam_idtrukhotam primary key(idtrukhotam);\n";
                //Tú:30/06/2015
                r_Col = dtAllColumn.Select("table_name='m_trukhotam' and column_name='dongia'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".m_trukhotam add column dongia numeric(12,4);\n";
                    s_Sql += "update " + sSchema + ".m_trukhotam set dongia=0 where dongia is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_trukhotam alter column dongia set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_trukhotam alter column dongia set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphithuoc' and column_name='idtheodoitam'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add column idtheodoitam numeric(30,0);\n";
                    s_Sql += "update " + sSchema + ".m_duyetchiphithuoc set idtheodoitam=0 where idtheodoitam is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc alter column idtheodoitam set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc alter column idtheodoitam set not null;\n";
                }
                //Tú:29/06/2015
                s_Sql += "alter table " + sSchema + ".d_dmtanghoso alter column idtanghoso type numeric(3,0);\n";
                //Tú:30/06/2015
                r_Col = dtAllColumn.Select("table_name='m_trukhotam' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".m_trukhotam add column stt numeric(3,0);\n";
                    s_Sql += "update " + sSchema + ".m_trukhotam set stt=0 where stt is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_trukhotam alter column stt set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_trukhotam alter column stt set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_dmkho' and column_name='loaiba'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + sSchema + ".m_dmkho add loaiba varchar2(50);\n";
                }
                //Tú:01/07/2015
                r_Col = dtAllColumn.Select("table_name='l_dmhoachatxetnghiem'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".l_dmhoachatxetnghiem(idgiavienphi numeric(7,0),idbietduoc numeric(7,0),dinhmuc numeric(12,4)," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_dmhoachatxetnghiem add constraint pk_l_dmhoachatxetnghiem primary key(idgiavienphi,idbietduoc);\n";
                s_Sql += "alter table " + sSchema + ".l_dmhoachatxetnghiem add constraint fk_l_dmhoachatxetnghiem_giavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) on update restrict on delete restrict;\n";
                s_Sql += "alter table " + sSchema + ".l_dmhoachatxetnghiem add constraint fk_l_dmhoachatxetnghiem_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) on update restrict on delete restrict;\n";
                s_Sql += "alter table " + sSchema + ".l_dmhoachatxetnghiem add constraint ck_l_dmhoachatxetnghiem_idgiavp check (idgiavienphi<>0);\n";
                //Tú:20/07/2015
                s_Sql += "alter table " + sSchema + ".p_dmgiuong alter column soluong type number(5,0);\n";
                //linh 20/7/15
                r_Col = dtAllColumn.Select("table_name='b_dmloaitiente'");
                if (r_Col == null || r_Col.Length == 0)
                {
                    s_Sql += "create table " + sSchema + ".b_dmloaitiente (idloaitiente number(1),tenloaitiente varchar2(100),tenkhongdau varchar2(100)," +
                        "ngayud date default sysdate,username varchar2(50),computer varchar2(50));\n";
                }
                s_Sql += "alter table " + sSchema + ".b_dmloaitiente add constraint pk_loaitiente primary key(idloaitiente);\n";
                //linh 20/7/15
                r_Col = dtAllColumn.Select("table_name='b_tygiangoaite'");
                if (r_Col == null || r_Col.Length == 0)
                {
                    s_Sql += "create table " + sSchema + ".b_tygiangoaite (idngoaite int,idloaitientrongnuoc int,sotien number(12,4) default 0 not null,ngay date default sysdate," +
                        " computer varchar2(50), username varchar2(50),ngayud date default sysdate );\n";
                }
                s_Sql += "alter table " + sSchema + ".b_tygiangoaite add constraint pk_tygiangoaite primary key (idngoaite ,idloaitientrongnuoc,ngay);\n";
                r_Col = dtAllColumn.Select("table_name='b_thuchitiente'");
                if (r_Col == null || r_Col.Length == 0)
                {
                    s_Sql += "create table " + sSchema + ".b_thuchitiente(idvienphi number(30),idloaitiente int,loaigiaodich int default 0 not null,soluong number(8) default 0 not null," +
                        " menhgia number(9) default 0 not null,tygia number(9) default 1 not null,thanhtien number(15,4) default 0 not null, ngayud date default sysdate," +
                        " computer varchar2(50),username varchar2(50));\n";
                }
                s_Sql += "alter table " + sSchema + ".b_thuchitiente add constraint pk_thuchitiente primary key(idvienphi,idloaitiente,loaigiaodich,menhgia);\n";
                s_Sql += "alter table " + sSchema + ".b_thuchitiente add constraint fk_thuchitiente_loaitiente foreign key(idloaitiente) references " + sSchema + ".b_dmloaitiente(idloaitiente);\n";
                //Tú:29/07/2015
                r_Col = dtAllColumn.Select("table_name='p_lichchaythan'");
                if (r_Col == null || r_Col.Length == 0)
                {
                    s_Sql += "create table " + sSchema + ".p_lichchaythan(idlichchaythan numeric(30),maql numeric(30),idkhoa numeric(30),ngay timestamp without time zone default sysdate not null," +
                             "idmay numeric(2,0),ca numeric(2),mabs character varying(4),idkhoaphong numeric(3,0),loai numeric(1),trangthai numeric(1,0),giuong character varying(20)," +
                             "ghichu text,mmyy character varying(4),username character varying(20),computer character varying(50)," +
                             "ngayud timestamp without time zone default sysdate not null) with (oids=true);\n";
                }
                s_Sql += "alter table " + sSchema + ".p_lichchaythan add constraint pk_p_lichchaythan primary key(idlichchaythan);\n";
                s_Sql += "alter table " + sSchema + ".p_lichchaythan add constraint fk_p_lichchaythan_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) on update restrict on delete restrict;\n";
                s_Sql += "alter table " + sSchema + ".p_lichchaythan add constraint fk_p_lichchaythan_dmmay foreign key(idmay) references " + sSchema + ".r_dmmay(idmay) on update restrict on delete restrict;\n";
                //linh 3/8/15
                r_Col = dtAllColumn.Select("table_name='b_thuchitiente' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_thuchitiente add mmyy character varying(4) default to_char(sysdate,'mmyy') not null;\n";
                }
                //Tú:03/08/2015
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='thuocchaythan'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".m_dmbd add thuocchaythan numeric(1,0) default 0 not null;\n";
                }
                //Tú:03/08/2015
                r_Col = dtAllColumn.Select("table_name='m_ylenhthuocds' and column_name='idlichchaythan'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocds add idlichchaythan numeric(30,0);\n";
                    s_Sql += "update " + sSchema + ".m_ylenhthuocds set idlichchaythan=0 where idlichchaythan is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocds alter column idlichchaythan set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_ylenhthuocds alter column idlichchaythan set not null;\n";
                }
                //Tú:03/08/2015
                r_Col = dtAllColumn.Select("table_name='p_lichchaythan' and column_name='ngaychay'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_lichchaythan add ngaychay timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lichchaythan' and column_name='idmaychay'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_lichchaythan add idmaychay numeric(2,0) default 0 not null;\n";
                    s_Sql += "update " + sSchema + ".p_lichchaythan set idmaychay=0 where idmaychay is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichchaythan alter column idmaychay set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichchaythan alter column idmaychay set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lichchaythan' and column_name='cachay'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_lichchaythan add cachay numeric(2,0) default 0 not null;\n";
                    s_Sql += "update " + sSchema + ".p_lichchaythan set cachay=0 where cachay is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichchaythan alter column cachay set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".p_lichchaythan alter column cachay set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_lichchaythan' and column_name='mabschay'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_lichchaythan add mabschay character varying(4);\n";
                }
                //Tú:07/08/2015
                s_Sql += "update " + Schema + ".m_duyetchiphithuoc set idtheodoitam=idtheodoi where idtheodoitam=0 and idtheodoi<>0;\n";
                //Thuy 11/8/15
                r_Col = dtAllColumn.Select("table_name='h_chamcong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "CREATE TABLE " + Schema + ".h_chamcong( manhanvien character varying(4) NOT NULL, idkhoaphong numeric(3,0) NOT NULL," +
                    " mmyy character varying(4) NOT NULL DEFAULT to_char(sysdate, 'mmyy'::character varying)," +
                    " n1 character varying(2), n2 character varying(2), n3 character varying(2), n4 character varying(2), n5 character varying(2)," +
                    " n6 character varying(2), n7 character varying(2), n8 character varying(2), n9 character varying(2)," +
                    " n10 character varying(2), n11 character varying(2), n12 character varying(2), n13 character varying(2)," +
                    " n14 character varying(2), n15 character varying(2), n16 character varying(2), n17 character varying(2)," +
                    " n18 character varying(2), n19 character varying(2), n20 character varying(2), n21 character varying(2)," +
                    " n22 character varying(2), n23 character varying(2), n24 character varying(2), n25 character varying(2)," +
                    " n26 character varying(2), n27 character varying(2), n28 character varying(2), n29 character varying(2)," +
                    " n30 character varying(2), n31 character varying(2), computer character varying(50), username character varying(20)," +
                    " ngayud timestamp without time zone DEFAULT sysdate ) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + Schema + ".h_chamcong OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + Schema + ".h_chamcong add constraint pk_h_chamcong primary key(manhanvien,idkhoaphong,mmyy);\n";
                }
                //Tú:12/08/2015
                r_Col = dtAllColumn.Select("table_name='b_quyettoanbhyt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + Schema + ".b_quyettoanbhyt(idvienphi numeric(30,0) not null default 0,maql numeric(30,0) not null default 0," +
                        "idkhoa numeric(30,0) not null default 0,idkhoaphong numeric(3,0) not null default 0,giuong character varying(20)," +
                        "ngayvao timestamp without time zone not null,ngayra timestamp without time zone not null,chandoan text,maicd character varying(50)," +
                        "diemthu numeric(2,0) not null default 0,loai numeric(2,0) default 0,idquyenso numeric(5,0) not null default 0," +
                        "sobienlai numeric(10,0) not null default 0,ngay timestamp without time zone default sysdate,sotien numeric(15,4) not null default 0," +
                        "sotientamung numeric(15,4) not null default 0,mien numeric(15,4) not null default 0,sotienbhyttra numeric(15,4) not null default 0," +
                        "lanin numeric(2,0) not null default 0,idtonghop numeric(30,0) not null default 0,chenhlech numeric(15,4) not null default 0," +
                        "idquyensodv numeric(15,4) not null default 0,sobienlaidv numeric(15,4) not null default 0,username character varying(20)," +
                        "usernamenl character varying(20),miencs numeric(15,4) not null default 0,miendv numeric(15,4) not null default 0," +
                        "miencs_ngaytt timestamp without time zone,sophieu numeric(10,0) not null default 0,ngayud timestamp without time zone default sysdate," +
                        "dongbo character varying(100),computer character varying(50),mmyy character varying(4) not null default to_char(sysdate, 'mmyy')," +
                        "idhoantra numeric(30,0) not null default 0,loaibn numeric(2,0) not null default 0,daduyet numeric(1,0) default 0," +
                        "ngayduyet timestamp without time zone,sttduyet numeric(10,0) default 0,nguoiduyet character varying(20),sohoadonnganhang character varying(20)," +
                        "idnhib serial not null,idquyettoan numeric(30,0) not null default 0,ngayquyettoan timestamp without time zone," +
                        "nguoiquyettoan character varying(20))with (oids=true);\n";
                    s_Sql += "alter table " + Schema + ".b_quyettoanbhyt owner to medilink;\n";
                }
                s_Sql += "alter table " + Schema + ".b_quyettoanbhyt add constraint pk_quyettoanbhyt primary key(idvienphi);\n";
                r_Col = dtAllColumn.Select("table_name='b_quyettoanbhytct'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + Schema + ".b_quyettoanbhytct(idvienphi numeric(30,0),stt numeric(5,0),ngay timestamp without time zone default sysdate," +
                        "idkhoaphong numeric(3,0) not null default 0,madoituong numeric(2,0) not null default 0,idgiavienphi numeric(7,0) not null default 0," +
                        "soluong numeric(15,4) not null default 0,dongia numeric(15,4) not null default 0,vat numeric(7,2) not null default 0," +
                        "sotien numeric(15,4) not null default 0,sothe character varying(20),giamua numeric(15,4) not null default 0,tra numeric(15,4) not null default 0," +
                        "ngaytra timestamp without time zone default sysdate,bhytduyet numeric(1,0) not null default 0,bhyttra numeric(15,4)," +
                        "idtonghop numeric(30,0) not null default 0,idkhoaphongthuchien numeric(3,0) not null default 0,gia_bh numeric(15,4) not null default 0," +
                        "mien numeric(15,4) not null default 0,mabs character varying(4),tylemien numeric(10,5) not null default 0," +
                        "ngayud timestamp without time zone default sysdate,dongbo character varying(100),computer character varying(50)," +
                        "mmyy character varying(4) not null default to_char(sysdate, 'mmyy'),username character varying(20),idhoantra numeric(30,0) not null default 0," +
                        "tygiausd numeric(24,4) not null default 0,idktcao numeric(30,0) not null default 0,goiktcao numeric(1,0) not null default 0," +
                        "haophi numeric(15,4) not null default 0,idnhib serial not null)with (oids=true);\n";
                    s_Sql += "alter table " + Schema + ".b_quyettoanbhytct owner to medilink;\n";
                }
                s_Sql += "alter table " + Schema + ".b_quyettoanbhytct add constraint pk_quyettoanbhytct primary key(idvienphi,stt);\n";
                r_Col = dtAllColumn.Select("table_name='b_quyettoanbhytctthuoc'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + Schema + ".b_quyettoanbhytctthuoc(idvienphi numeric(30,0) not null default 0,stt numeric(5,0) not null default 0," +
                        "ngay timestamp without time zone default sysdate,idkhoaphong numeric(3,0) not null default 0,madoituong numeric(2,0) not null default 0," +
                        "idgiavienphi numeric(7,0) not null default 0,soluong numeric(15,4) not null default 0,dongia numeric(22,4) not null default 0," +
                        "vat numeric(7,2) not null default 0,sotien numeric(22,4) not null default 0,sothe character varying(20),giamua numeric(22,4) not null default 0," +
                        "tra numeric(15,4) not null default 0,ngaytra timestamp without time zone default sysdate,bhytduyet numeric(1,0) not null default 0," +
                        "bhyttra numeric(15,4),idtonghop numeric(30,0) not null default 0,idkhoaphongthuchien numeric(3,0) not null default 0," +
                        "gia_bh numeric(15,4) not null default 0,mien numeric(15,4) not null default 0,mabs character varying(4),tylemien numeric(5,2) not null default 0," +
                        "ngayud timestamp without time zone default sysdate,dongbo character varying(100),computer character varying(50)," +
                        "mmyy character varying(4) not null default to_char(sysdate, 'mmyy'),username character varying(20),idhoantra numeric(30,0) not null default 0," +
                        "tygiausd numeric(24,4) not null default 0,goiktcao numeric(1,0) not null default 0,idktcao numeric(30,0) not null default 0," +
                        "haophi numeric(15,4) not null default 0,idnhib serial not null)with (oids=true);\n";
                    s_Sql += "alter table " + Schema + ".b_quyettoanbhytctthuoc owner to medilink;\n";
                }
                s_Sql += "alter table " + Schema + ".b_quyettoanbhytctthuoc add constraint pk_quyettoanbhytctthuoc primary key(idvienphi,stt);\n";
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='idquyettoan'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + Schema + ".b_vienphi add idquyettoan numeric(30,0);\n";
                    s_Sql += "update " + sSchema + ".b_vienphi set idquyettoan=0 where idquyettoan is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphi alter column idquyettoan set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphi alter column idquyettoan set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='ngayquyettoan'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + Schema + ".b_vienphi add ngayquyettoan timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphi' and column_name='nguoiquyettoan'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + Schema + ".b_vienphi add nguoiquyettoan character varying(20);\n";
                }
                //Thuy 15/8/15
                r_Col = dtAllColumn.Select("table_name='h_quatrinhcongtac'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_quatrinhcongtac (  id numeric(3,0) default 0 not null, manhanvien character varying(4) NOT NULL," +
                        " noidungcongtac text, hsluong numeric(6,2), machucvu numeric(2,0), tungay timestamp without time zone," +
                        " denngay timestamp without time zone, machucdanh numeric(2,0), ghichu text, computer character varying(50)," +
                        " username character varying(20), ngayud timestamp without time zone DEFAULT sysdate) WITH ( OIDS=TRUE);\n";
                    s_Sql += "alter TABLE " + Schema + ".h_quatrinhcongtac OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + Schema + ".h_quatrinhcongtac add constraint pk_h_quatrinhcongtac primary key(id,manhanvien);\n";
                }
                //ThanhCuong - 18/08/2015
                r_Col = dtAllColumn.Select("table_name='m_dmbd' and column_name='icd10'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + Schema + ".m_dmbd add icd10 text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmbenhnhan' and column_name='rhd'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + Schema + ".p_dmbenhnhan add rhd character varying(10);\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmbenhnhan alter column nhommau type character varying(3);\n";
                //Tú:20/08/2015
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='paidtamung'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add column paidtamung numeric(1,0);\n";
                    s_Sql += "update " + sSchema + ".b_chidinh set paidtamung=0 where paidtamung is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column paidtamung set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column paidtamung set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_toathuocct' and column_name='paidtamung'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_toathuocct add column paidtamung numeric(1,0);\n";
                    s_Sql += "update " + sSchema + ".p_toathuocct set paidtamung=0 where paidtamung is null;\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocct alter column paidtamung set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".p_toathuocct alter column paidtamung set not null;\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                //Tú:24/08/2015
                r_Col = dtAllColumn.Select("table_name='m_khoasolieuchitiet'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".m_khoasolieuchitiet(mmyy character varying(4), done number(1,0) default 0 not null,idkho character varying(500)," +
                             "idtutruc character varying(500),computer character varying(50),username character varying(20)," +
                             "ngayud timestamp without time zone default sysdate,idnhib serial not null) with (oids=true);\n";
                    s_Sql += "alter table " + sSchema + ".m_khoasolieuchitiet owner to medilink;\n";
                    s_Sql += "alter table " + sSchema + ".m_khoasolieuchitiet add constraint pk_m_khoasolieuchitiet primary key(mmyy);\n";
                }
                //Tú:25/08/2015
                r_Col = dtAllColumn.Select("table_name='m_duyetchiphi' and column_name='paidtamung'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi add column paidtamung numeric(1,0);\n";
                    s_Sql += "update " + sSchema + ".m_duyetchiphi set paidtamung=0 where paidtamung is null;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column paidtamung set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".m_duyetchiphi alter column paidtamung set not null;\n";
                }
                //Tú:27/08/2015
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='songayhentraketqua'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add column songayhentraketqua numeric(3,0) default 0 not null;\n";
                }
                //Thuy 27/08/2015
                r_Col = dtAllColumn.Select("table_name='h_thongtinbaohiem'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "  CREATE TABLE " + sSchema + ".h_ThongTinBaoHiem ( manhanvien character varying(4) NOT NULL, SoLD character varying(10)," +
                        " NgayCapSoLD timestamp without time zone, NoiCapSoLD text, matinhthanhCapSoLD character varying(3),ChuyenTuCoQuan text," +
                        " ngaychuyen timestamp without time zone, SoDKLD character varying(10), ngaydksudunglaodong timestamp without time zone, SoBHXH character varying(50)," +
                        " ngaycapBHXH timestamp without time zone,noicapBHXH character varying(3),sothangkhongtinhBHXH numeric(2,0) default 0,tongthoigiantinhBHXH numeric(3,0) default 0," +
                        " sotheBHYT character varying(25),ngaycaptheBHYT timestamp without time zone,noicaptheBHYT character varying(3),thoihantungay timestamp without time zone," +
                        " thoihandenngay timestamp without time zone,mabvdangkitheBHYT character varying(10),BHTN numeric(1,0) default 0,BHNT numeric(1,0) default 0," +
                        " bhkhac numeric(1,0) default 0,computer character varying(50)," +
                        " username character varying(20), ngayud timestamp without time zone DEFAULT sysdate) WITH ( OIDS=TRUE);\n";
                    s_Sql += " ALTER TABLE " + sSchema + ".h_ThongTinBaoHiem  OWNER TO " + sUserID + ";\n";
                    s_Sql += " alter table " + sSchema + ".h_ThongTinBaoHiem add constraint pk_h_ThongTinBaoHiem primary key(manhanvien);\n";
                }
                //Thuy 31/08/2015
                r_Col = dtAllColumn.Select("table_name='h_chamcongngoaigio'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_chamcongngoaigio(id numeric(10,0) not null, manhanvien character varying(4) NOT NULL," +
                        " idkhoaphong numeric(3,0) NOT NULL, mmyy character varying(4) NOT NULL DEFAULT to_char(sysdate, 'mmyy'::character varying)," +
                        " ngay timestamp without time zone, giobatdau timestamp without time zone, gioketthuc timestamp without time zone," +
                        " ngaybatdau timestamp without time zone, ngayketthuc timestamp without time zone, letet numeric(1,0) DEFAULT 0 not null," +
                        " t7cn numeric(1,0) DEFAULT 0 not null, congviec text,computer character varying(50), username character varying(20)," +
                        " ngayud timestamp without time zone DEFAULT sysdate ) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".h_chamcongngoaigio OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".h_chamcongngoaigio add constraint pk_h_chamcongngoaigio primary key(id,manhanvien,mmyy);\n";
                    s_Sql += "alter table " + sSchema + ".h_chamcongngoaigio add constraint fk_h_chamcongngoaigio_dmnhanvien FOREIGN key(manhanvien) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add stt int default 0 not null;\n";
                }
                //Tú:03/09/2015
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='yeucau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add yeucau numeric(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='tachtrongbaocao'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add tachtrongbaocao int default 0 not null;\n";
                }
                //Tú:04/09/2015
                r_Col = dtAllColumn.Select("table_name='p_dmdoituong' and column_name='tylegiaban'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_dmdoituong add tylegiaban numeric(12,4) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='p_dmdoituong' and column_name='giabanlaytruocvat'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_dmdoituong add giabanlaytruocvat numeric(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='m_theodoidoituong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".m_theodoidoituong(idtheodoi numeric(30,0),mmyy character varying(4),madoituong numeric(2,0),giaban numeric(12,4)," +
                             "username character varying(50),computer character varying(50),ngayud timestamp without time zone default sysdate);\n";
                }
                s_Sql += "alter table " + sSchema + ".m_theodoidoituong add constraint pk_m_theodoidoituong primary key(idtheodoi,madoituong);\n";
                //Thuy 04/09/2015
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien' and column_name='matrinhdovitinh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_dmnhanvien add matrinhdovitinh numeric(2,0) DEFAULT 0 NOT NULL;\n";
                }
                #region máu
                //Tú:07/09/2015
                r_Col = dtAllColumn.Select("table_name='bl_dangduyet' and column_name='idkhoaphong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet add column idkhoaphong numeric(3,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet alter column idkhoaphong set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dangduyet' and column_name='ngay'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet add column ngay timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet alter column ngay set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet alter column ngay set default sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dangduyet' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet add column username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dangduyet' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet add column computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dangduyet' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet add column ngayud timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet alter column ngayud set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet alter column ngayud set default sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dangduyet' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet add column idnhib serial;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet alter column idnhib set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dangduyet alter column idnhib set default nextval('" + sSchema + ".bl_dangduyet_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmloaimau' and column_name='idloai'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau add column idloai numeric(3,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau alter column idloai set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau alter column idloai set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmloaimau' and column_name='tenloai'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau add column tenloai text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmloaimau' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau add column tenkhongdau character varying(150);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmloaimau' and column_name='nhom'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau add column nhom character varying(3);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmloaimau' and column_name='idnhomkho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau add column idnhomkho numeric(2,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau alter column idnhomkho set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau alter column idnhomkho set default (-1);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmloaimau' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau add column computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmloaimau' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau add column username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmloaimau' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau add column ngayud timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau alter column ngayud set default sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmloaimau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau add column idnhib serial;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau alter column idnhib set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmloaimau alter column idnhib set default nextval('" + sSchema + ".bl_dmloaimau_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='idmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column idmau numeric(7,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column idmau set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column idmau set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='mamau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column mamau character varying(15);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='tenmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column tenmau text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column tenkhongdau character varying(150);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='dang'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column dang text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='idthetich'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column idthetich numeric(2,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column idthetich set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column idthetich set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='manhommau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column manhommau character varying(3);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column manhommau set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column manhommau set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='idloaimau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column idloaimau numeric(3,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column idloaimau set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column idloaimau set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='bhyt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column bhyt numeric(3,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column bhyt set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column bhyt set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='dongia'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column dongia numeric(24,10);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column dongia set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column dongia set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='idnhomin'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column idnhomin numeric(2,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column idnhomin set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column idnhomin set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='hide'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column hide numeric(1,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column hide set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column hide set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column ngayud timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column ngayud set default sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmau add column idnhib serial;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column idnhib set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmau alter column idnhib set default nextval('" + sSchema + ".bl_dmmau_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmautd' and column_name='idmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd add column idmau numeric(7,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd alter column idmau set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd alter column idmau set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmautd' and column_name='idmautd'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd add column idmautd numeric(7,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd alter column idmautd set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd alter column idmautd set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmautd' and column_name='soluong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd add column soluong numeric(12,4);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd alter column soluong set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd alter column soluong set default 1;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmautd' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd add column computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmautd' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd add column username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmmautd' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd add column ngayud timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmmautd alter column ngayud set default sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmngoaivien' and column_name='idngoaivien'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien add column idngoaivien numeric(5,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien alter column idngoaivien set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien alter column idngoaivien set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmngoaivien' and column_name='tenngoaivien'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien add column tenngoaivien text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmngoaivien' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien add column tenkhongdau character varying(150);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmngoaivien' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien add column computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmngoaivien' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien add column username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmngoaivien' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien add column ngayud timestamp without time zone;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien alter column ngayud set default sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmngoaivien' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien add column idnhib serial;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien alter column idnhib set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmngoaivien alter column idnhib set default nextval('" + sSchema + ".bl_dmngoaivien_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnguon' and column_name='idnguon'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".bl_dmnguon add column idnguon numeric(2,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmnguon alter column idnguon set not null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_dmnguon alter column idnguon set default 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnguon' and column_name='tennguon'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ADD COLUMN tennguon text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnguon' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ADD COLUMN tenkhongdau character varying(150);\n";
                }
                //--------------------------------------------------------------------------------------------------
                r_Col = dtAllColumn.Select("table_name='bl_dmnguon' and column_name='idnhomkho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ADD COLUMN idnhomkho numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ALTER COLUMN idnhomkho SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ALTER COLUMN idnhomkho SET DEFAULT (-1);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnguon' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnguon' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnguon' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnguon' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnguon ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_dmnguon_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap' and column_name='idnhacungcap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ADD COLUMN idnhacungcap numeric(5,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ALTER COLUMN idnhacungcap SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ALTER COLUMN idnhacungcap SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap' and column_name='manhacungcap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ADD COLUMN manhacungcap character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap' and column_name='tennhacungcap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ADD COLUMN tennhacungcap text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ADD COLUMN tenkhongdau character varying(150);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap' and column_name='dienthoai'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ADD COLUMN dienthoai character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap' and column_name='diachi'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ADD COLUMN diachi text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhacungcap' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhacungcap ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_dmnhacungcap_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomin' and column_name='idnhomin'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ADD COLUMN idnhomin numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ALTER COLUMN idnhomin SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ALTER COLUMN idnhomin SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomin' and column_name='tennhomin'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ADD COLUMN tennhomin text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomin' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ADD COLUMN tenkhongdau character varying(150);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomin' and column_name='idnhomkho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ADD COLUMN idnhomkho numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ALTER COLUMN idnhomkho SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ALTER COLUMN idnhomkho SET DEFAULT (-1);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomin' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomin' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomin' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomin' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomin ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_dmnhomin_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomin' and column_name='idrhd'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ADD COLUMN idrhd numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ALTER COLUMN idrhd SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ALTER COLUMN idrhd SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomrhd' and column_name='tenrhd'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ADD COLUMN tenrhd text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomrhd' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ADD COLUMN tenkhongdau character varying(150);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomrhd' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomrhd' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomrhd' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmnhomrhd' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmnhomrhd ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_dmnhomrhd_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich' and column_name='idthetich'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ADD COLUMN idthetich numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ALTER COLUMN idthetich SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ALTER COLUMN idthetich SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich' and column_name='tenthetich'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ADD COLUMN tenthetich text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ADD COLUMN tenkhongdau character varying(150);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich' and column_name='idnhomkho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ADD COLUMN idnhomkho numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ALTER COLUMN idnhomkho SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ALTER COLUMN idnhomkho SET DEFAULT (-1);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich' and column_name='thetich'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ADD COLUMN thetich numeric(5,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ALTER COLUMN thetich SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ALTER COLUMN thetich SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich' and column_name='dvt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ADD COLUMN dvt text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_dmthetich' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_dmthetich ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_dmthetich_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheo' and column_name='idgoikemtheo'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ADD COLUMN idgoikemtheo numeric(7,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ALTER COLUMN idgoikemtheo SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheo' and column_name='tengoikemtheo'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ADD COLUMN tengoikemtheo text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheo' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ADD COLUMN tenkhongdau character varying(150);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheo' and column_name='idloaimau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ADD COLUMN idloaimau numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ALTER COLUMN idloaimau SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheo' and column_name='noiphatsinh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ADD COLUMN noiphatsinh numeric(1,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ALTER COLUMN noiphatsinh SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ALTER COLUMN noiphatsinh SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheo' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheo' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheo' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheo' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheo ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_goikemtheo_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='idgoikemtheo'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN idgoikemtheo numeric(7,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN idgoikemtheo SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='idgiavienphi'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN idgiavienphi numeric(7,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN idgiavienphi SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='soluong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN soluong numeric(12,4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN soluong SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN soluong SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='madoituong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN madoituong numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN madoituong SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN madoituong SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='idnguon'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN idnguon numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN idnguon SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN idnguon SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='gia_th'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN gia_th numeric(14,3);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_th SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_th SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='gia_bh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN gia_bh numeric(14,3);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_bh SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_bh SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='gia_cs'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN gia_cs numeric(14,3);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_cs SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_cs SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='gia_dv'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN gia_dv numeric(14,3);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_dv SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_dv SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='gia_nn'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN gia_nn numeric(14,3);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_nn SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_nn SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='gia_ksk'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN gia_ksk numeric(14,3);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_ksk SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_ksk SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='gia_vip'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN gia_vip numeric(14,3);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_vip SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN gia_vip SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_goikemtheoct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_goikemtheoct ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_goikemtheoct_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_khoasolieu' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_khoasolieu' and column_name='done'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ADD COLUMN done numeric(1,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ALTER COLUMN done SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ALTER COLUMN done SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_khoasolieu' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_khoasolieu' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_khoasolieu' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_khoasolieu' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_khoasolieu ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_khoasolieu_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapct' and column_name='idnhap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ADD COLUMN idnhap numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ALTER COLUMN idnhap SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ALTER COLUMN idnhap SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapct' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ADD COLUMN stt numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ALTER COLUMN stt SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ALTER COLUMN stt SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapct' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapct' and column_name='mabichmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ADD COLUMN mabichmau character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapct' and column_name='soluong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ADD COLUMN soluong numeric(30,8);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ALTER COLUMN soluong SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ALTER COLUMN soluong SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapct' and column_name='ghichu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ADD COLUMN ghichu text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapct' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapct' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapct' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapct ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_nhapct_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='idnhap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN idnhap numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN idnhap SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN idnhap SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='sophieu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN sophieu character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='ngaynhap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN ngaynhap timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='loai'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN loai numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN loai SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN loai SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='idnhacungcap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN idnhacungcap numeric(5,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN idnhacungcap SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN idnhacungcap SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='idkho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN idkho numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN idkho SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='idnguon'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN idnguon numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN idnguon SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='ghichu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN ghichu text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_nhapll' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_nhapll ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_nhapll_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyet' and column_name='idphieuduyet'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ADD COLUMN idphieuduyet numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN idphieuduyet SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN idphieuduyet SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyet' and column_name='ngay'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ADD COLUMN ngay timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN ngay SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN ngay SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyet' and column_name='idkhoaphong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ADD COLUMN idkhoaphong numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN idkhoaphong SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN idkhoaphong SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyet' and column_name='idnhomphieu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ADD COLUMN idnhomphieu numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN idnhomphieu SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN idnhomphieu SET DEFAULT (-1);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyet' and column_name='trangthai'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ADD COLUMN trangthai numeric(1,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN trangthai SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN trangthai SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyet' and column_name='lanin'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ADD COLUMN lanin numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN lanin SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN lanin SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyet' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyet' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyet' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyet' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyet ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyetkho' and column_name='idphieuduyet'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ADD COLUMN idphieuduyet numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ALTER COLUMN idphieuduyet SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ALTER COLUMN idphieuduyet SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyetkho' and column_name='idkho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ADD COLUMN idkho numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ALTER COLUMN idkho SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ALTER COLUMN idkho SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyetkho' and column_name='trangthai'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ADD COLUMN trangthai numeric(1,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ALTER COLUMN trangthai SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ALTER COLUMN trangthai SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyetkho' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyetkho' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyetkho' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyetkho' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_phieuduyetkho' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_phieuduyetkho ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_phieuduyetkho_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='mabichmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN mabichmau character varying(20);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN mabichmau SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='idmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN idmau numeric(7,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN idmau SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN idmau SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='idnguon'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN idnguon numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN idnguon SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN idnguon SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='ngaydieuche'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN ngaydieuche timestamp without time zone not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='handung'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN handung timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='idnhacungcap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN idnhacungcap numeric(5,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN idnhacungcap SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN idnhacungcap SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='dongia'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN dongia numeric(12,4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN dongia SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN dongia SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='giaban'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN giaban numeric(12,4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN giaban SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN giaban SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='khaiton'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN khaiton numeric(1,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN khaiton SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN khaiton SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='nguoicho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN nguoicho text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='ngaylaymau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN ngaylaymau timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='nhiembenh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN nhiembenh numeric(1,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN nhiembenh SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN nhiembenh SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN mmyy SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN mmyy SET DEFAULT to_char((sysdate)::timestamp with time zone, 'mmyy'::text);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_theodoi' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_theodoi ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_theodoi_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tondau' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tondau' and column_name='idkho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ADD COLUMN idkho numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ALTER COLUMN idkho SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ALTER COLUMN idkho SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tondau' and column_name='mabichmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ADD COLUMN mabichmau character varying(20);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ALTER COLUMN mabichmau SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tondau' and column_name='soluong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ADD COLUMN soluong numeric(30,8);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ALTER COLUMN soluong SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ALTER COLUMN soluong SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tondau' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tondau' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tondau' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tondau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tondau ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_tondau_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='idkho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ADD COLUMN idkho numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN idkho SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN idkho SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='mabichmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ADD COLUMN mabichmau character varying(20);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN mabichmau SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='soluongtondau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ADD COLUMN soluongtondau numeric(30,8);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN soluongtondau SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN soluongtondau SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='soluongnhap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ADD COLUMN soluongnhap numeric(30,8);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN soluongnhap SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN soluongnhap SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='soluongxuat'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ADD COLUMN soluongxuat numeric(30,8);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN soluongxuat SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN soluongxuat SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='khoa'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ADD COLUMN khoa numeric(1,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN khoa SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN khoa SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhochitiet' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhochitiet ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_tonkhochitiet_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='idkho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN idkho numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN idkho SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN idkho SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='idmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN idmau numeric(7,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN idmau SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN idmau SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='idnguon'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN idnguon numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN idnguon SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN idnguon SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='soluongtondau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN soluongtondau numeric(30,8);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN soluongtondau SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN soluongtondau SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='soluongnhap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN soluongnhap numeric(30,8);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN soluongnhap SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN soluongnhap SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='soluongxuat'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN soluongxuat numeric(30,8);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN soluongxuat SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN soluongxuat SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='soluongyeucau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN soluongyeucau numeric(30,8);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN soluongyeucau SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN soluongyeucau SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_tonkhotonghop' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_tonkhotonghop ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_tonkhotonghop_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatct' and column_name='idxuat'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ADD COLUMN idxuat numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ALTER COLUMN idxuat SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ALTER COLUMN idxuat SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatct' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ADD COLUMN stt numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ALTER COLUMN stt SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ALTER COLUMN stt SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatct' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatct' and column_name='mabichmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ADD COLUMN mabichmau character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatct' and column_name='soluong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ADD COLUMN soluong numeric(30,8);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ALTER COLUMN soluong SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ALTER COLUMN soluong SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatct' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatct' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatct' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatct ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_xuatct_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='idxuat'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN idxuat numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idxuat SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idxuat SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='sophieu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN sophieu character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='ngay'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN ngay timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN ngay SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='loai'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN loai numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN loai SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN loai SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='idkhoxuat'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN idkhoxuat numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idkhoxuat SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idkhoxuat SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='idkhonhap'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN idkhonhap numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idkhonhap SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idkhonhap SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='idlydoxuat'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN idlydoxuat numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idlydoxuat SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idlydoxuat SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='idngoaivien'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN idngoaivien numeric(5,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idngoaivien SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idngoaivien SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='lanin'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN lanin numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN lanin SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN lanin SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='ghichu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN ghichu text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatll' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatll ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_xuatll_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='idxuatnoiviends'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN idxuatnoiviends numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN idxuatnoiviends SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN idxuatnoiviends SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN stt numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN stt SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN stt SET DEFAULT 1;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='mabichmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN mabichmau character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='madoituong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN madoituong numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN madoituong SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN madoituong SET DEFAULT 2;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='idkho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN idkho numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN idkho SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN idkho SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='soluong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN soluong numeric(20,7);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN soluong SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN soluong SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='ghichu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN ghichu text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='soluongdinhnhom'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN soluongdinhnhom numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN soluongdinhnhom SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN soluongdinhnhom SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='sophanungcheo'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN sophanungcheo numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN sophanungcheo SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN sophanungcheo SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='cheo1'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN cheo1 text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='cheo2'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN cheo2 text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='cheocoombs'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN cheocoombs text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='dongia'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN dongia numeric(12,4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN dongia SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN dongia SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='idttrv'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN idttrv numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN idttrv SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN idttrv SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='ngayylenh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN ngayylenh timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN ngayylenh SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='idmaugoc'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN idmaugoc numeric(7,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN idmaugoc SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN idmaugoc SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='idkey'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN idkey numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN idkey SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN idkey SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoivienct' and column_name='tygiausd'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ADD COLUMN tygiausd numeric(24,4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN tygiausd SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoivienct ALTER COLUMN tygiausd SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ADD COLUMN idxuatnoiviends numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN idxuatnoiviends SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN idxuatnoiviends SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ADD COLUMN idphieuduyet numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN idphieuduyet SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN idphieuduyet SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ADD COLUMN maql numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN maql SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN maql SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ADD COLUMN idkhoa numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN idkhoa SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN idkhoa SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ADD COLUMN idylenhmauds numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN idylenhmauds SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN idylenhmauds SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ADD COLUMN ghichu text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends' and column_name='tenkhongdau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_xuatnoiviends ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='idylenhmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN idylenhmau numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN idylenhmau SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN idylenhmau SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='ngay'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN ngay timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN ngay SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN ngay SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='idkhoaphong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN idkhoaphong numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN idkhoaphong SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN idkhoaphong SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='idphieu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN idphieu numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN idphieu SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN idphieu SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='trangthai'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN trangthai numeric(1,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN trangthai SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN trangthai SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='idphieuduyet'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN idphieuduyet character varying(254);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='sophieu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN sophieu character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmau' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmau ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_ylenhmau_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='idylenhmauds'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN idylenhmauds numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idylenhmauds SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idylenhmauds SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='stt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN stt numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN stt SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN stt SET DEFAULT 1;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='idmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN idmau numeric(7,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idmau SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idmau SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='madoituong'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN madoituong numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN madoituong SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN madoituong SET DEFAULT 2;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='idkho'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN idkho numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idkho SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idkho SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='idnguon'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN idnguon numeric(2,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idnguon SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idnguon SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='soluongyeucau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN soluongyeucau numeric(20,7);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN soluongyeucau SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN soluongyeucau SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='soluongphat'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN soluongphat numeric(20,7);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN soluongphat SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN soluongphat SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='ghichu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN ghichu text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='ngayylenh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN ngayylenh timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN ngayylenh SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='mabichmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN mabichmau character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='idkey'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN idkey numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idkey SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idkey SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauct' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauct ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_ylenhmauct_idnhib_seq'::regclass);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='idylenhmauds'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN idylenhmauds numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN idylenhmauds SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN idylenhmauds SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='idylenhmau'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN idylenhmau numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN idylenhmau SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN idylenhmau SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='maql'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN maql numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN maql SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN maql SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='idkhoa'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN idkhoa numeric(30,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN idkhoa SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN idkhoa SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='solandatruyen'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN solandatruyen numeric(3,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN solandatruyen SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN solandatruyen SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='ghichu'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN ghichu text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='taibien'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN taibien numeric(1,0);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN taibien SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN taibien SET DEFAULT 0;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='mmyy'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN mmyy character varying(4);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN mmyy SET NOT NULL;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='computer'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN computer character varying(50);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='ngayud'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN ngayud timestamp without time zone;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN ngayud SET DEFAULT sysdate;\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='username'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN username character varying(20);\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_ylenhmauds' and column_name='idnhib'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ADD COLUMN idnhib serial;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN idnhib SET NOT NULL;\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".bl_ylenhmauds ALTER COLUMN idnhib SET DEFAULT nextval('" + sSchema + ".bl_ylenhmauds_idnhib_seq'::regclass);\n";
                }
                #endregion
                r_Col = dtAllColumn.Select("table_name='s_thongbao'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".s_thongbao(idthongbao number(30),tenthongbao varchar2(500),noidung text,ngaythongbao date default sysdate not null," +
                        "username varchar2(50),computer varchar2(50),ngayud date default sysdate ,username_sua varchar2(4000),username_xoa varchar2(4000)," +
                        "username_doc varchar2(4000)) WITH (OIDS=true);\n";
                    s_Sql += "alter TABLE " + sSchema + ".s_thongbao OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".s_thongbao add constraint pk_thongbao primary key(idthongbao);\n";
                }
                //Tú:10/09/2015
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='xetnghiemcoban'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add xetnghiemcoban numeric(1,0) default 0 not null;\n";
                }
                //ThanhCuong - 11/09/2015
                s_Sql += "delete from " + sSchema + ".m_dmnhomphieu where idnhomphieu=-2;\n";
                r_Col = dtAllColumn.Select("table_name='m_dmphieu' and column_name='idkey'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".m_dmphieu add idkey numeric(3,0) default 0 not null;\n";
                }
                //Tú:16/09/2015
                r_Col = dtAllColumn.Select("table_name='b_vienphict' and column_name='bhyt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphict add bhyt numeric(5,2);\n";
                    s_Sql += "update " + sSchema + ".b_vienphict set bhyt=0 where bhyt is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict alter column bhyt set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphict alter column bhyt set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_vienphictthuoc' and column_name='bhyt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add bhyt numeric(5,2);\n";
                    s_Sql += "update " + sSchema + ".b_vienphictthuoc set bhyt=0 where bhyt is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc alter column bhyt set default 0 ;\n";
                    s_Sql += "alter table " + sSchema + ".b_vienphictthuoc alter column bhyt set not null;\n";
                }
                //Thuy 17/09/15
                r_Col = dtAllColumn.Select("table_name='h_heso_nv'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_heso_nv(  manhanvien character varying(5) NOT NULL,  idkhoaphong character varying(3) NOT NULL,"+
                    " mmyy character varying(4) NOT NULL DEFAULT to_char(sysdate, 'mmyy'::character varying), bhxh numeric(1,0) DEFAULT 0,"+
                    " bhyt numeric(1,0) DEFAULT 0, bhtn numeric(1,0) DEFAULT 0, h_hsboiduonghienvat character varying(4) DEFAULT 0,"+
                    " h_hsluong numeric(10,2) DEFAULT 0, h_hschucvu numeric(10,2) DEFAULT 0, h_hsvuotkhung numeric(10,2) DEFAULT 0, "+
                    " h_hskiemnhiem numeric(10,2) DEFAULT 0, h_hstrachnhiemcongviec numeric(10,2) DEFAULT 0, h_hsphucapkhuvuc numeric(10,2) DEFAULT 0,"+
                    " h_hsbaoluu numeric(10,2) DEFAULT 0, h_hsdochai numeric(10,2) DEFAULT 0, h_hsphucapdacbiet numeric(10,2) DEFAULT 0,"+
                    " h_hsdacthu numeric(10,2) DEFAULT 0, h_hsluudong numeric(10,2) DEFAULT 0, h_hsthuhut numeric(10,2) DEFAULT 0,"+
                    " h_hsuudai numeric(10,2) DEFAULT 0, h_pctienan numeric(12,2) DEFAULT 0, h_pctienxang numeric(12,2) DEFAULT 0,"+
                    " h_pctiendienthoai numeric(12,2) DEFAULT 0, h_pckhac numeric(12,2) DEFAULT 0, h_tongluonghesopc numeric(15,2) DEFAULT 0,"+
                    " computer character varying(50), username character varying(20), ngayud date DEFAULT sysdate) WITH ( OIDS=FALSE );\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".heso_nv  OWNER TO " + sUserID + ";\n";
                    s_Sql += "alter table " + sSchema + ".heso_nv add constraint pk_heso_nv primary key(manhanvien, idkhoaphong, mmyy);\n";
                    s_Sql += "alter table " + sSchema + ".heso_nv add constraint fk_heso_nv_dmnhanvien FOREIGN key(manhanvien) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
                }
                //Thuy 30/09/15
                r_Col = dtAllColumn.Select("table_name='h_heso_nv'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "drop table " + sSchema + ".h_heso_nv CASCADE;\n";
                }
                //Tú:17/09/2015
                r_Col = dtAllColumn.Select("table_name='l_dmnhomvitrisinhthiet'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".l_dmnhomvitrisinhthiet(idnhomvitrisinhthiet numeric(7,0),manhomvitrisinhthiet character varying(20)," +
                             "tennhomvitrisinhthiet text,tenkhongdau character varying(254),username character varying(20),computer character varying(50)," +
                             "ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_dmnhomvitrisinhthiet add constraint pk_l_dmnhomvitrisinhthiet primary key(idnhomvitrisinhthiet);\n";
                r_Col = dtAllColumn.Select("table_name='l_dmvitrisinhthiet'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".l_dmvitrisinhthiet(idvitrisinhthiet numeric(7,0),mavitrisinhthiet character varying(20),tenvitrisinhthiet text," +
                             "idnhomvitrisinhthiet numeric(7,0),tenkhongdau character varying(254),username character varying(20),computer character varying(50)," +
                             "ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_dmvitrisinhthiet add constraint pk_l_dmvitrisinhthiet primary key(idvitrisinhthiet);\n";
                s_Sql += "alter table " + sSchema + ".l_dmvitrisinhthiet add constraint pk_l_dmvitrisinhthiet_nhom foreign key(idnhomvitrisinhthiet) references " + sSchema + ".l_dmnhomvitrisinhthiet(idnhomvitrisinhthiet) on update restrict on delete restrict;\n";
                r_Col = dtAllColumn.Select("table_name='l_dmdungdich'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".l_dmdungdich(iddungdich numeric(7,0),madungdich character varying(20),tendungdich text," +
                             "username character varying(20),tenkhongdau character varying(254),computer character varying(50),ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_dmdungdich add constraint pk_l_dmdungdich primary key(iddungdich);\n";
                r_Col = dtAllColumn.Select("table_name='l_dmphuongphapnhuom'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".l_dmphuongphapnhuom(idphuongphapnhuom numeric(7,0),maphuongphapnhuom character varying(20),tenphuongphapnhuom text," +
                             "username character varying(20),tenkhongdau character varying(254),computer character varying(50),ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_dmphuongphapnhuom add constraint pk_l_dmphuongphapnhuom primary key(idphuongphapnhuom);\n";
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='giaiphaubenh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add giaiphaubenh numeric(1,0) default 0 not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='giaiphaubenh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add giaiphaubenh numeric(1,0) default 0 not null;\n";
                }
                //Thuy 17/09/15
                r_Col = dtAllColumn.Select("table_name='h_dmheso'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_dmheso( ma numeric(2,0) DEFAULT 0 NOT NULL, ten character varying(100), idnhib serial NOT NULL, CONSTRAINT pk_h_dmheso PRIMARY KEY (ma)) WITH ( OIDS=TRUE);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".h_dmheso  OWNER TO " + sUserID + ";\n";
                }
                r_Col = dtAllColumn.Select("table_name='bl_xuatnoiviends' and column_name='idylenhthuocds'");
                if (r_Col == null || r_Col.Length <= 0) //ThanhCuong - 22/05/2015
                {
                    s_Sql += "alter table " + Schema + ".bl_xuatnoiviends add idylenhthuocds numeric(30,0);\n";
                    s_Sql += "alter table " + sSchema + ".bl_xuatnoiviends alter column idylenhthuocds set default 0;\n";
                    s_Sql += "update " + sSchema + ".bl_xuatnoiviends set idylenhthuocds=0 where idylenhthuocds is null;\n";
                    s_Sql += "alter table " + sSchema + ".bl_xuatnoiviends alter column idylenhthuocds set not null;\n";
                }
                //Tú:21/09/2015
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='iddungdich'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add column iddungdich numeric(7,0);\n";
                    s_Sql += "update " + sSchema + ".b_chidinh set iddungdich=0 where iddungdich is null;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column iddungdich set default 0;\n";
                    s_Sql += "alter table " + sSchema + ".b_chidinh alter column iddungdich set not null;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='ngaydungdich'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add column ngaydungdich timestamp without time zone;\n";
                }
                r_Col = dtAllColumn.Select("table_name='b_chidinh' and column_name='tomtatlamsang'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_chidinh add column tomtatlamsang text;\n";
                }
                r_Col = dtAllColumn.Select("table_name='l_ketquagiaiphaubenh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".l_ketquagiaiphaubenh(idketquagiaiphaubenh numeric(30,0),sophieu character varying(20),maql numeric(30,0) default 0 not null," +
                             "madoituong numeric(3,0) default 0 not null,idkhoa numeric(30,0) default 0 not null,ngay timestamp without time zone,maicd character varying(10)," +
                             "chandoan text,daithe text,nguoipha character varying(4),ngaypha timestamp without time zone,somanh numeric(5,0) default 0 not null,vithe text," +
                             "nguoilamtieuban character varying(4),ngaylamtieuban timestamp without time zone,idchidinh numeric(30,0) default 0 not null,phuhop numeric(1,0) default 0 not null," +
                             "ketluan text,banluan text,mabsdoc character varying(4),ngaytra timestamp without time zone," +
                             "truongkhoa character varying(4),mmyy character varying(4) not null default to_char(sysdate, 'mmyy'::character varying)," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_ketquagiaiphaubenh add constraint pk_l_ketquagiaiphaubenh(idketquagiaiphaubenh);\n";
                r_Col = dtAllColumn.Select("table_name='l_ketquavitrisinhthiet'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".l_ketquavitrisinhthiet(idketquagiaiphaubenh numeric(30,0) default 0 not null," +
                             "idvitrisinhthiet numeric(7,0) default 0 not null,done numeric(1,0) default 0 not null,idchidinh numeric(30,0)," +
                             "nhuomhe numeric(1,0) default 0 not null,nhuomdacbiet numeric(1,0) default 0 not null," +
                             "mmyy character varying(4) not null default to_char(sysdate, 'mmyy'::character varying)," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_ketquavitrisinhthiet add constraint pk_l_ketquavitrisinhthiet(idchidinh,idvitrisinhthiet);\n";
                r_Col = dtAllColumn.Select("table_name='l_ketquahoamomiendich'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".l_ketquahoamomiendich(idketquagiaiphaubenh numeric(30,0),idvitrisinhthiet numeric(7,0) default 0 not null," +
                             "idchidinh numeric(30,0) default 0 not null,idphuongphapnhuom numeric(7,0) default 0 not null,duongtinh numeric(1,0) default 0 not null," +
                             "cuongdo numeric(1,0) default 0 not null,tyle numeric(7,2) default 0 not null,ghichu text," +
                             "mmyy character varying(4) not null default to_char(sysdate, 'mmyy'::character varying)," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_ketquahoamomiendich add constraint pk_l_ketquahoamomiendich(idketquagiaiphaubenh,idvitrisinhthiet,idphuongphapnhuom);\n";
                r_Col = dtAllColumn.Select("table_name='l_ketquachandoansinhthiet'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".l_ketquachandoansinhthiet(idketquagiaiphaubenh numeric(30,0),idvitrisinhthiet numeric(7,0) default 0 not null," +
                             "idchidinh numeric(30,0) default 0 not null,magiaiphaubenh character varying(10),chandoan text," +
                             "mmyy character varying(4) not null default to_char(sysdate, 'mmyy'::character varying)," +
                             "username character varying(20),computer character varying(50),ngayud timestamp without time zone default sysdate) with (oids=true);\n";
                }
                s_Sql += "alter table " + sSchema + ".l_ketquachandoansinhthiet add constraint pk_l_ketquachandoansinhthiet(idketquagiaiphaubenh,idvitrisinhthiet,idphuongphapnhuom);\n";
                r_Col = dtAllColumn.Select("table_name='l_hinhgiaiphaubenh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + SchemaImage + ".l_hinhgiaiphaubenh(idketquagiaiphaubenh numeric(30,0) not null default 0,stt numeric(2,0) not null default 0," +
                             "hinhanh blob,computer character varying(50),username character varying(20),ngayud timestamp without time zone default sysdate) with(oids=true);\n";
                }
                s_Sql += "alter table " + SchemaImage + ".l_hinhgiaiphaubenh add constraint pk_l_hinhgiaiphaubenh primary key (idketquagiaiphaubenh, stt);\n";
                //Thuy 15/10/15
                r_Col = dtAllColumn.Select("table_name='h_thongso'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_thongso(  id numeric(3,0) NOT NULL,  ten character varying(100)," +
                        "val numeric(3,0) DEFAULT 0 NOT NULL,  ngayapdung timestamp without time zone NOT NULL, computer character varying(50)," +
                        "username character varying(20), ngayud timestamp without time zone DEFAULT sysdate) WITH (OIDS=true);\n";
                }
                s_Sql +="alter TABLE " + sSchema + ".h_thongso OWNER TO " + sUserID + ";\n";
                s_Sql +="alter table " + sSchema + ".h_thongso add constraint pk_h_thongso primary key(id,ngayapdung);\n";
                //Thuy 16/10/15
                r_Col = dtAllColumn.Select("table_name='h_quatrinhcongtac' and column_name='donvicongtac'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".h_quatrinhcongtac add column donvicongtac numeric(3,0) default 0 not null;\n";
                    s_Sql += "alter table " + sSchema + ".h_quatrinhcongtac add constraint fk_quatrinhcongtac_dmkpbv FOREIGN key(donvicongtac) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
                }
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
                s_Sql = "";
                r_Col = dtAllColumn.Select("table_name='p_dmnhanvien_chuky'");
                if (r_Col == null || r_Col.Length <= 0) //linh - 22/09/2015
                {
                    s_Sql += " create table " + sSchemaImage + ".p_dmnhanvien_chuky (manhanvien character varying(4) NOT NULL," +
                            " chuky bytea, computer character varying(50), username character varying(20),ngayud timestamp without time zone default sysdate" +
                            " ) with (oids=true);\n";
                    s_Sql += " alter table " + sSchemaImage + ".p_dmnhanvien_chuky  owner to " + sUserID + ";\n";
                }
                s_Sql += " alter table " + sSchemaImage + ".p_dmnhanvien_chuky add constraint pk_p_dmnhanvien_chuky primary key (manhanvien);\n";
                r_Col = dtAllColumn.Select("table_name='p_lichhen_chidinh'");
                if (r_Col == null || r_Col.Length <= 0) //linh - 22/09/2015
                {
                    s_Sql += "create table " + Schema + ".p_lichhen_chidinh(idlichhen number(30),stt number(4) ,  idgiavienphi numeric(7,0) NOT NULL DEFAULT 0," +
                            " soluong numeric(12,4) NOT NULL DEFAULT 0,  ghichu text,  idkpnoithuchien numeric(3,0) NOT NULL DEFAULT 0,  " +
                            " idtrongoi numeric(7,0) NOT NULL DEFAULT 0," +
                            " ngayud timestamp without time zone DEFAULT sysdate,  username character varying(20),  computer character varying(50)," +
                            " mmyy character varying(4) NOT NULL DEFAULT to_char(sysdate, 'mmyy'::character varying)) with (oids=true);\n";
                    s_Sql += " alter table " + Schema + ".p_lichhen_chidinh  owner to " + sUserID + ";\n";
                }
                s_Sql += " alter table " + Schema + ".p_lichhen_chidinh add constraint pk_p_lichhen_chidinh primary key (idlichhen,stt);\n";
                r_Col = dtAllColumn.Select("table_name='b_dmgiavienphi' and column_name='giaiphaubenh'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add giaiphaubenh numeric(1,0) default 0 not null;\n";
                }
                //ThanhCuong - 02/10/2015
                s_Sql += "alter table " + sSchema + ".bl_theodoi alter column ngaydieuche set not null;\n";
                s_Sql += "alter table " + sSchema + ".bl_theodoi alter column handung set not null;\n";
                s_Sql += "alter table " + sSchema + ".bl_theodoi alter column ngaylaymau set not null;\n";
                //Tú:07/10/2015
                r_Col = dtAllColumn.Select("table_name='p_dmkhoaphongbenhvien' and column_name='makhoabhyt'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add makhoabhyt character varying(10);\n";
                }
                //Thuy 08/10/2015
                r_Col = dtAllColumn.Select("table_name='h_heso_baohiem'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_heso_baohiem( idloaibh numeric(2,0) default 0 not null, tenloaibh character varying(100) NOT NULL, mahopdong numeric(2,0) NOT NULL," +
                        "  hs_chucvu numeric(1,0) DEFAULT 0 not null, hs_vuotkhung numeric(1,0) DEFAULT 0 not null, hs_khuvuc numeric(1,0) DEFAULT 0 not null," +
                        " hs_trachnhiem numeric(1,0) DEFAULT 0 not null, hs_dochai numeric(1,0) DEFAULT 0 not null, luongkhoan numeric(1,0) DEFAULT 0 not null," +
                        "  hs_luongcb numeric(1,0) DEFAULT 0 not null, hs_baoluu numeric(1,0) DEFAULT 0 not null, ngayapdung timestamp without time zone NOT NULL, "+
                        " computer character varying(50), username character varying(20), ngayud timestamp without time zone DEFAULT sysdate) WITH ( OIDS=true);\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".h_heso_baohiem OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".h_heso_baohiem add constraint pk_h_heso_bh primary key (idloaibh,mahopdong,ngayapdung);\n";
                s_Sql += "alter table " + sSchema + ".h_heso_baohiem add constraint fk_h_heso_bh_dmhopdong FOREIGN key(mahopdong) references " + sSchema + ".h_dmhopdong(mahopdong);\n";
                r_Col = dtAllColumn.Select("table_name='p_dmthesmartcard'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".p_dmthesmartcard(idthe varchar2(30),sothe varchar2(30),tinhtrang int default 0 not null,mabenhvien varchar2(10)) with (oids = true );\n";
                    s_Sql += "ALTER TABLE " + sSchema + ".p_dmthesmartcard OWNER TO " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".p_dmthesmartcard add constraint pk_p_dmthesmartcard primary key (idthe);\n";
                s_Sql += "alter table " + sSchema + ".p_dmthesmartcard add constraint uk_p_dmthesmartcard_sothe unique (sothe);\n";
                s_Sql += "alter table " + sSchema + ".m_denghitra alter column mmyy set default to_char(sysdate, 'mmyy'::text);\n";
                s_Sql += "alter table " + sSchema + ".m_denghitra alter column mmyy set not null ;\n";
                s_Sql += "alter table " + sSchema + ".m_denghitract alter column mmyy set default to_char(sysdate, 'mmyy'::text);\n";
                s_Sql += "alter table " + sSchema + ".m_denghitract alter column mmyy set not null ;\n";
                //Tú:22/10/2015
                r_Col = dtAllColumn.Select("table_name='p_phieutruyendich'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "create table " + sSchema + ".p_phieutruyendich(idphieutruyendich numeric(30,0),ngay timestamp without time zone,maql numeric(30,0) not null default 0," +
                             "idkhoa numeric(30,0) not null default 0,idkhoaphong numeric(3,0) not null default 0,idbietduoc numeric(7,0) not null default 0," +
                             "soluong numeric(12,4) not null default 0,tocdogiot numeric(12,4) not null default 0,thoigianbatdau timestamp without time zone," +
                             "thoigianketthuc timestamp without time zone,mabs character varying(4),nguoithuchien character varying(4),username  character varying(20)," +
                             "computer character varying(50),ngayud timestamp without time zone not null default sysdate," +
                             "mmyy character varying(4) not null default to_char(sysdate, 'mmyy'::character varying)) with (oids = true );\n";
                    s_Sql += "alter table " + sSchema + ".p_phieutruyendich owner to " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".p_phieutruyendich add constraint pk_p_phieutruyendich primary key(idphieutruyendich);\n";
                //Tú:23/10/2015
                r_Col = dtAllColumn.Select("table_name='p_phieutruyendich' and column_name='losx'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "alter table " + sSchema + ".p_phieutruyendich add losx character varying(20);\n";
                }
                //Thuy 24/10/15
                r_Col = dtAllColumn.Select("table_name='h_dmthanhphanxuatthan'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_dmthanhphanxuatthan( id numeric(2,0) default 0 NOT NULL, ten text," +
                             "computer character varying(50), username character varying(20), ngayud timestamp without time zone DEFAULT sysdate," +
                             "idnhib serial NOT NULL) WITH (OIDS=TRUE);\n";
                    s_Sql += "alter table " + sSchema + ".h_dmthanhphanxuatthan owner to " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".h_dmthanhphanxuatthan add constraint pk_h_dmthanhphanxuatthan primary key(id);\n";

                r_Col = dtAllColumn.Select("table_name='h_dmnguongoc'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_dmnguongoc( id numeric(2,0) default 0 NOT NULL, ten text," +
                             "computer character varying(50), username character varying(20), ngayud timestamp without time zone DEFAULT sysdate," +
                             "idnhib serial NOT NULL) WITH (OIDS=TRUE);\n";
                    s_Sql += "alter table " + sSchema + ".h_dmnguongoc owner to " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".h_dmnguongoc add constraint pk_h_dmnguongoc primary key(id);\n";
                r_Col = dtAllColumn.Select("table_name='h_dmdaotaochinhtri'");
                if (r_Col == null || r_Col.Length <= 0)
                {
                    s_Sql += "CREATE TABLE " + sSchema + ".h_dmdaotaochinhtri( id numeric(2,0) default 0 NOT NULL, ten text," +
                             "computer character varying(50), username character varying(20), ngayud timestamp without time zone DEFAULT sysdate," +
                             "idnhib serial NOT NULL) WITH (OIDS=TRUE);\n";
                    s_Sql += "alter table " + sSchema + ".h_dmdaotaochinhtri owner to " + sUserID + ";\n";
                }
                s_Sql += "alter table " + sSchema + ".h_dmdaotaochinhtri add constraint pk_h_dmdaotaochinhtri primary key(id);\n";
                cmd = null;
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.CommandTimeout = 50000;
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
#else
                string s_Sql = "create table " + sSchema + ".m_dmnhomkho(idnhomkho number(2) default 0, tennhomkho nvarchar2(254), tenkhongdau varchar2(150), loai number(1) default 0 not null, " +
                "computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomkho add constraint pk_m_dmnhomkho primary key(idnhomkho);\n";

            s_Sql += "CREATE TABLE " + sSchema + ".p_dmuser(iddmuser NUMBER(5) DEFAULT 0,username varchar2(20) not null,tenuser NVARCHAR2(254) not null," +
                "matkhau VARCHAR2(20) not null,manhanvien varchar2(4),nhomuser number(1) default 3,khoaaccount number(1) default 0 not null," +
                "tenkhongdau VARCHAR2(150),computer varchar2(50),NGAYUD DATE DEFAULT sysdate,idnhomkho number(2) default 1 not null);\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add constraint pk_dmuser primary key(iddmuser);\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add constraint fk_dmuser_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add constraint un_dmuser_username unique(username) enable;\n";

            s_Sql += "create table " + sSchema + ".p_dmvungbenhvien(mavung varchar2(2),tenvung nvarchar2(150) not null,dongbo varchar2(100) default lpad('0',100,'0'),tenkhongdau varchar2(150)," +
               "ngayud date default sysdate,username varchar2(50),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmvungbenhvien add constraint pk_dmvungbenhvien primary key(mavung);\n";

            s_Sql += "create table " + sSchema + ".p_dmtinhthanh(matinhthanh varchar2(3),tentinhthanh nvarchar2(150) not null,mavung varchar2(2)," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhthanh add constraint pk_dmtinhthanh primary key(matinhthanh);\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhthanh add constraint fk_dmtinhthanh_dmvungbv foreign key(mavung) references " + sSchema + ".p_dmvungbenhvien(mavung);\n";

            s_Sql += "create table " + sSchema + ".p_dmquanhuyen(maquanhuyen varchar2(5),tenquanhuyen nvarchar2(150) not null,matinhthanh varchar2(3)," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmquanhuyen add constraint pk_dmquanhuyen primary key(maquanhuyen);\n";
            s_Sql += "alter table " + sSchema + ".p_dmquanhuyen add constraint fk_dmquanhuyen_dmtinhthanh foreign key(matinhthanh) references " + sSchema + ".p_dmtinhthanh(matinhthanh);\n";

            s_Sql += "create table " + sSchema + ".p_dmphuongxa(maphuongxa varchar2(7),tenphuongxa nvarchar2(150) not null,maquanhuyen varchar2(5),viettat varchar2(10)," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmphuongxa add constraint pk_dmphuongxa primary key(maphuongxa);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphuongxa add constraint fk_dmphuongxa_dmquanhuyen foreign key(maquanhuyen) references " + sSchema + ".p_dmquanhuyen(maquanhuyen);\n";

            s_Sql += "create table " + sSchema + ".p_dmcomputer(idcomputer number(5),tencomputer nvarchar2(150) not null,benhnhan varchar2(50)," +
                "duoc varchar2(50),vienphi varchar2(50),xetnghiem varchar2(50),cdha varchar2(50),mau varchar2(50),ttb varchar2(50)," +
                "tenkhongdau varchar2(150),keys varchar2(4000), license varchar2(4000),dongbo varchar2(100) default lpad('0',100,'0'),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmcomputer add constraint pk_dmcomputer primary key(idcomputer);\n";

            s_Sql += "create table " + sSchema + ".p_dmdantoc(madantoc varchar2(3),tendantoc nvarchar2(150) not null," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmdantoc add constraint pk_dmdantoc primary key(madantoc);\n";

            s_Sql += "create table " + sSchema + ".p_dmdoituong(madoituong number(2),tendoituong nvarchar2(150) not null,fieldgia varchar2(50)," +
                "chieudaisothe varchar2(50),nhapsothe number(1) default 0 not null,nhapngay number(1) default 0 not null,nhapnoidkkcb number(1) default 0 not null," +
                "mien number(1) default 0 not null,trasau number(1) default 0 not null,nhapcholam number(1) default 0 not null,tinhchenhlech number(1) default 0," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmdoituong add constraint pk_dmdoituong primary key(madoituong);\n";

            s_Sql += "create table " + sSchema + ".p_dmnghenghiep(manghenghiep varchar2(2),tennghenghiep nvarchar2(150) not null," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmnghenghiep add constraint pk_dmnghenghiep primary key(manghenghiep);\n";

            s_Sql += "create table " + sSchema + ".p_dmnghenghiepbenhvien(manghenghiep varchar2(3),tennghenghiep nvarchar2(150) not null," +
                "tenkhongdau varchar2(150),manghenghiepbo varchar2(2),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0')," +
                "computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmnghenghiepbenhvien add constraint pk_dmnghenghiepbv primary key(manghenghiep);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnghenghiepbenhvien add constraint fk_dmnnbv_dmnn foreign key(manghenghiepbo) references " + sSchema + ".p_dmnghenghiep(manghenghiep);\n";

            s_Sql += "create table " + sSchema + ".p_dmtuyenbenhvien(matuyenbenhvien varchar2(2),tentuyenbenhvien nvarchar2(150) not null," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmtuyenbenhvien add constraint pk_dmtuyenbv primary key(matuyenbenhvien);\n";

            s_Sql += "create table " + sSchema + ".p_dmloaibenhvien(maloaibenhvien varchar2(5),tenloaibenhvien nvarchar2(150) not null," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmloaibenhvien add constraint pk_dmloaibv primary key(maloaibenhvien);\n";

            s_Sql += "create table " + sSchema + ".p_dmbenhvien(mabenhvien varchar2(10),tenbenhvien nvarchar2(200) not null," +
                "diachi nvarchar2(254),dienthoai varchar2(50),matuyenbenhvien varchar2(2),maloaibenhvien varchar2(5)," +
                "hangbenhvien number(1) default 0 not null,matinhthanh varchar2(3),fax varchar2(20),mail varchar2(150)," +
                "masothue varchar2(12),nganhang nvarchar2(150),giamdoc nvarchar2(150),phogiamdoc nvarchar2(150),ketoan nvarchar2(150)," +
                "tenkhongdau varchar2(150),quantrimang nvarchar2(150),manoidkkcb varchar2(10),dongbo varchar2(100) default lpad('0',100,'0')," +
                "ngayud date default sysdate,username varchar2(50),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhvien add constraint pk_p_dmbenhvien primary key(mabenhvien,manoidkkcb);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhvien add constraint fk_dmbv_dmtuyenbv foreign key(matuyenbenhvien) references " + sSchema + ".p_dmtuyenbenhvien(matuyenbenhvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhvien add constraint fk_dmbv_dmloaibv foreign key(maloaibenhvien) references " + sSchema + ".p_dmloaibenhvien(maloaibenhvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhvien add constraint fk_dmbv_dmtt foreign key(matinhthanh) references " + sSchema + ".p_dmtinhthanh(matinhthanh);\n";

            s_Sql += "create table " + sSchema + ".p_dmchuongicd(idchuongicd number(2),tenchuongicd nvarchar2(200) not null," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmchuongicd add constraint pk_dmchuongicd primary key(idchuongicd);\n";

            s_Sql += "create table " + sSchema + ".p_dmnhomicd(idnhomicd number(3),tennhomicd nvarchar2(254) not null,idchuongicd number(2)," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomicd add constraint pk_dmnhomicd primary key(idnhomicd);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomicd add constraint fk_dmnhomicd_chuongicd foreign key(idchuongicd) references " + sSchema + ".p_dmchuongicd(idchuongicd);\n";

            s_Sql += "create table " + sSchema + ".p_dmicd(maicd varchar2(10),tenicd nvarchar2(500) not null,idnhomicd number(3)," +
                "tenkhongdau varchar2(2000),manhombaocao varchar2(10),sttnhombaocao varchar2(10),benhmantinh number(1) default 0 not null," +
                "ngayud date default sysdate,username varchar2(50),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmicd add constraint pk_dmicd primary key(maicd);\n";
            s_Sql += "alter table " + sSchema + ".p_dmicd add constraint fk_dmicd_dmnhomicd foreign key(idnhomicd) references " + sSchema + ".p_dmnhomicd(idnhomicd);\n";

            s_Sql += "create table " + sSchema + ".p_dmkhoaphong(makhoaphong varchar2(2),tenkhoaphong nvarchar2(150) not null," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphong add constraint pk_dmkhoaphong primary key(makhoaphong);\n";

            s_Sql += "create table " + sSchema + ".p_dmnhomkhoaphong(idnhomkhoaphong number(2),tennhomkhoaphong nvarchar2(150) not null," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomkhoaphong add constraint pk_dmnhomkp primary key(idnhomkhoaphong);\n";

            s_Sql += "create table " + sSchema + ".b_dmnhomvienphibhyt(idnhomvienphi number(3),tennhomvienphi nvarchar2(254),viettat varchar2(10) not null," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".b_dmnhomvienphibhyt add constraint pk_nhomvpbhyt primary key(idnhomvienphi);\n";
            s_Sql += "alter table " + sSchema + ".b_dmnhomvienphibhyt add constraint un_nhomvpbhyt_vietat unique(viettat) enable;\n";

            s_Sql += "create table " + sSchema + ".b_dmnhomvienphi(idnhomvienphi number(5),tennhomvienphi nvarchar2(254),idnhomvienphibhyt number(3)," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".b_dmnhomvienphi add constraint pk_nhomvp primary key(idnhomvienphi);\n";
            s_Sql += "alter table " + sSchema + ".b_dmnhomvienphi add constraint fk_nhomvp_nhomvpbhyt foreign key(idnhomvienphibhyt) references " + sSchema + ".b_dmnhomvienphibhyt(idnhomvienphi);\n";

            s_Sql += "create table " + sSchema + ".b_dmloaivienphi(idloaivienphi number(5),tenloaivienphi nvarchar2(254),idnhomvienphi number(5),maloaivienphi varchar2(10)," +
                "tenkhongdau varchar2(150),dongbo varchar2(100) default lpad('0',100,'0'),ngayud date default sysdate,username varchar2(50),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".b_dmloaivienphi add constraint pk_loaivp primary key(idloaivienphi);\n";
            s_Sql += "alter table " + sSchema + ".b_dmloaivienphi add constraint fk_loaivp_nhomvp foreign key(idnhomvienphi) references " + sSchema + ".b_dmnhomvienphi(idnhomvienphi);\n";

            s_Sql += "create table " + sSchema + ".b_dmgiavienphi(idgiavienphi number(7),tengiavienphi nvarchar2(500),idloaivienphi number(5)," +
                "mavp varchar2(20),dvt nvarchar2(50),bhyt number(5,2) default 0 not null,gia_th number(14,3) default 0 not null,gia_bh number(14,3) default 0 not null," +
                "gia_cs number(14,3) default 0 not null,gia_dv number(14,3) default 0 not null,gia_nn number(14,3) default 0 not null," +
                "gia_ksk number(14,3) default 0 not null,gia_vip number(14,3) default 0 not null,hide number(1) default 0 not null," +
                "kythuat number(1) default 0 not null,bhyt_traituyen number(5,2) default 0 not null," +
                "tenkhongdau varchar2(500),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add constraint pk_giavp primary key(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add constraint fk_giavp_loaivp foreign key(idloaivienphi) references " + sSchema + ".b_dmloaivienphi(idloaivienphi);\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add constraint uk_giavp_mavp unique(mavp) enable;\n";

            s_Sql += "create table " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong number(3),makhoaphong varchar2(3),tenkhoaphong nvarchar2(150) not null," +
                "makhoaphongbo varchar2(3),giuongkehoach number(3) default 0 not null,giuongthucke number(3) default 0 not null,sudung number(1) default 1 not null," +
                "idnhomkhoaphong number(2),idmavpcongkham number(7) default 0 not null,idmavptaikham number(7) default 0 not null,viettat varchar2(15)," +
                "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50),dauso number(1) default 0 not null);\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add constraint pk_dmkhoaphongbv primary key(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add constraint fk_dmkpbv_dmkp foreign key(makhoaphongbo) references " + sSchema + ".p_dmkhoaphong(makhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add constraint fk_dmkpbv_dmnhomkp foreign key(idnhomkhoaphong) references " + sSchema + ".p_dmnhomkhoaphong(idnhomkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add constraint fk_dmkpbv_dmgiavp_ck foreign key(idmavpcongkham) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add constraint fk_dmkpbv_dmgiavp_tk foreign key(idmavptaikham) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add constraint uk_dmkpbv_makp unique(makhoaphong) enable;\n";

            s_Sql += "create table " + sSchema + ".p_dmbenhan(idbenhan number(2), mabenhan varchar2(3) not null,tenbenhan nvarchar2(100) not null,sudung number(1)," +
                "tenkhongdau varchar2(150),loaibenhan number(1) default 0 not null,ngayud date default sysdate,username varchar2(50)," +
                "tiensubanthan nvarchar2(254),tiensugiadinh nvarchar2(254)," +
                "dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhan add constraint pk_dmbenhan primary key(idbenhan);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhan add constraint un_dmbenhan_maba unique(mabenhan) enable;\n";

            s_Sql += "create table " + sSchema + ".p_khoaphongbenhan(idkhoaphong number(3),idbenhan number(2)," +
               "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_khoaphongbenhan add constraint pk_khoaphongbanhan primary key(idkhoaphong,idbenhan);\n";
            s_Sql += "alter table " + sSchema + ".p_khoaphongbenhan add constraint fk_dmkpba_dmkhoaphong foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_khoaphongbenhan add constraint fk_dmkpba_dmbenhan foreign key(idbenhan) references " + sSchema + ".p_dmbenhan(idbenhan);\n";

            s_Sql += "create table " + sSchema + ".p_khoaphonggiavienphi(idkhoaphong number(3),idgiavienphi number(2)," +
               "tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_khoaphonggiavienphi add constraint pk_khoaphonggiavp primary key(idkhoaphong,idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".p_khoaphonggiavienphi add constraint fk_dmkpvp_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_khoaphonggiavienphi add constraint fk_dmkpvp_dmgiavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";

            s_Sql += "create table " + sSchema + ".p_thongso(id number(5),ten nvarchar2(254),dongbo varchar2(100) default lpad('0',100,'0')," +
                "diengiai nvarchar2(500),val nvarchar2(500),noidung nvarchar2(500),nhomthongso nvarchar2(500),loai number(1),benhvien number(1) default 0 not null," +
                "computer varchar2(50),ngayud date default sysdate, username varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_thongso add constraint pk_thongso primary key(id);\n";

            s_Sql += "CREATE TABLE " + sSchema + ".p_dmnhomnhanvien(idnhomnhanvien NUMBER(2) DEFAULT 0,tennhomnhanvien NVARCHAR2(254) not null,viettat VARCHAR2(10) not null," +
                "tenkhongdau varchar2(100),computer varchar2(50),username varchar2(20),NGAYUD DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomnhanvien add constraint pk_dmnhomnhanvien primary key(idnhomnhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomnhanvien add constraint fk_dmnhomnhanvien_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".p_dmnhanvien (manhanvien varchar2(4),tennhanvien nvarchar2(254) not null, phai number(1,0) default 0 not null," +
                "ngaysinh date,viettat varchar2(10),namsinh number(4) default 0 not null, dienthoai varchar2(50), didong varchar2(50), sonha nvarchar2(154), " +
                "thon nvarchar2(154), diachi nvarchar2(254),mail varchar2(154), matinhthanh varchar2(3),maquanhuyen varchar2(5), maphuongxa varchar2(7),madantoc varchar2(2)," +
                "masothue varchar2(15),socmnd varchar2(15),matkhau varchar(100), chuyenkhoa number(3,0) default 0, ngonngu number(2,0) default 0, " +
                "idnhomnhanvien number(3,0) default 0,dongbo varchar2(100) default lpad('0',100,'0')," +
                "bangcap nvarchar2(500), kinhnghiem nvarchar2(1000),hinh blob,tenkhongdau varchar2(150),computer varchar2(50), username varchar2(20),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add constraint pk_dmnhanvien primary key(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add constraint un_dmnhanvien_viettat unique(viettat) enable;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add constraint fk_dmnhanvien_dmtinhthanh foreign key(matinhthanh) references " + sSchema + ".p_dmtinhthanh(matinhthanh);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add constraint fk_dmnhanvien_dmquanhuyen foreign key(maquanhuyen) references " + sSchema + ".p_dmquanhuyen(maquanhuyen);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add constraint fk_dmnhanvien_dmphuongxa foreign key(maphuongxa) references " + sSchema + ".p_dmphuongxa(maphuongxa);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add constraint fk_dmnhanvien_dmdantoc foreign key(madantoc) references " + sSchema + ".p_dmdantoc(madantoc);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add constraint fk_dmnhanvien_dmnhomnv foreign key(idnhomnhanvien) references " + sSchema + ".p_dmnhomnhanvien(idnhomnhanvien);\n";
            //Tú:10/05/2014
            s_Sql += "create table " + sSchema + ".p_dmphai(idphai number(1,0), tenphai nvarchar2(50),computer varchar2(50),username varchar2(20),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphai add constraint pk_p_dmphai primary key(idphai);\n";
            s_Sql += "create table " + sSchema + ".p_dmnhommau(manhommau varchar2(3), tennhommau varchar2(100),computer varchar2(50),username varchar2(20),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhommau add constraint pk_p_dmnhommau primary key(manhommau);\n";
            s_Sql += "create table " + sSchema + ".p_dmnhomuser(idnhomuser number(3,0), tennhomuser nvarchar2(100),computer varchar2(50),username varchar2(20),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomuser add constraint pk_p_dmnhomuser primary key(idnhomuser);\n";
            s_Sql += "create table " + sSchema + ".b_dmloaikythuatvienphi(idloaikythuatvienphi number(3,0), tenloaikythuatvienphi nvarchar2(50),computer varchar2(50),username varchar2(20),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".b_dmloaikythuatvienphi add constraint pk_b_dmloaikythuatvienphi primary key(idloaikythuatvienphi);\n";
            s_Sql += "create table " + sSchema + ".p_dmtinhtrangthuchiencls(idtinhtrangthuchiencls number(3,0), tentinhtrangthuchiencls nvarchar2(50),computer varchar2(50),username varchar2(20),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhtrangthuchiencls add constraint pk_p_dmtinhtrangthuchiencls primary key(idtinhtrangthuchiencls);\n";
            s_Sql += "create table " + sSchema + ".p_dmloaibn(idloaibn number(3,0), tenloaibn nvarchar2(50),computer varchar2(50),username varchar2(20),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmloaibn add constraint pk_p_dmloaibn primary key(idloaibn);\n";
            s_Sql += "create table " + sSchema + ".p_dmnhantu(idnhantu number(1,0), tennhantu nvarchar2(50),computer varchar2(50),username varchar2(20),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhantu add constraint pk_p_dmnhantu primary key(idnhantu);\n";
            s_Sql += "create table " + sSchema + ".p_dmdentu(iddentu number(1,0), tendentu nvarchar2(50),computer varchar2(50),username varchar2(20),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmdentu add constraint pk_p_dmdentu primary key(iddentu);\n";
            s_Sql += "create table " + sSchema + ".b_dmfieldgia(mafieldgia varchar2(20), tenfieldgia nvarchar2(50),computer varchar2(50),username varchar2(20),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".b_dmfieldgia add constraint pk_b_dmfieldgia primary key(mafieldgia);\n";

            s_Sql += "create table " + sSchema + ".p_dmbenhnhan (mabn varchar2(14),hobenhnhan nvarchar2(50) not null,chulotbenhnhan nvarchar2(100)," +
                "tenbenhnhan nvarchar2(50) not null,ngaysinh date, namsinh number(4) default 0 not null, tuoi varchar2(4) not null, " +
                "phai number(1) default 0 not null,manghenghiep varchar2(3) not null, madantoc varchar2(2) not null, sonha varchar2(50), " +
                "thon nvarchar2(254), cholam nvarchar2(254), matinhthanh varchar2(3) not null, maquanhuyen varchar2(5) not null, maphuongxa varchar2(7) not null, " +
                "tenkhongdau nvarchar2(254), mmyy nvarchar2(254), hinh blob, tuvong number(1) default 0 not null, masothue varchar2(15), dainthe number(1) default 0," +
                "dienthoai varchar2(20),didong varchar2(20),dienthoaicoquan varchar2(20),mail varchar2(254),cmnd varchar2(15),nhommau varchar2(1)," +
                "sothe varchar2(20),manoidkkcb varchar2(10),tungay date,denngay date,traituyen number(1) default 0 not null,quanhe nvarchar2(20), hotennguoiquanhe nvarchar2(154)," +
                "diachinguoiquanhe nvarchar2(154),dienthoainguoiquanhe varchar2(50)," +
                "username varchar2(50) default 0, ngayud date default sysdate, computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add constraint pk_dmbenhnhan primary key(mabn);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add constraint fk_dmbenhnhan_dmnghenghiepbv foreign key(manghenghiep) references " + sSchema + ".p_dmnghenghiepbenhvien(manghenghiep);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add constraint fk_dmbenhnhan_dmdantoc foreign key(madantoc) references " + sSchema + ".p_dmdantoc(madantoc);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add constraint fk_dmbenhnhan_dmtinhthanh foreign key(matinhthanh) references " + sSchema + ".p_dmtinhthanh(matinhthanh);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add constraint fk_dmbenhnhan_dmquanhuyen foreign key(maquanhuyen) references " + sSchema + ".p_dmquanhuyen(maquanhuyen);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add constraint fk_dmbenhnhan_dmphuongxa foreign key(maphuongxa) references " + sSchema + ".p_dmphuongxa(maphuongxa);\n";

            string s_MMYY = DateTime.Now.ToString("MMyy");
            s_Sql += "create table " + sSchema + ".p_benhandt (mabn varchar2(14) not null,mavaovien number(30) default 0 not null, maql number(30) default 0 not null," +
                "idkhoaphong number(3), ngay date default sysdate not null, madoituong number(2) default 2 not null, " +
                "sovaovien varchar2(10), done number(2) default 0 not null, bnmoi number(1) default 0 not null, " +
                "noitiepdon number(2) default 0 not null, loaiba number(1) default 0 not null,mabs varchar2(4)," +
                "quatrinhbenhly nvarchar2(254),khambenhtoanthan nvarchar2(254)," +
                "khambenhcacbophan nvarchar2(254),chandoansobo nvarchar2(254),maicd varchar2(10),benhchinh nvarchar2(254),machuyenden number(30) default 0 not null," +
                "lydodieutri nvarchar2(254)  default ' ',username varchar2(20),	ngayud date default sysdate, computer varchar2(50)," +
                "mmyy generated always as (to_char(ngay,'MMyy'))) " +
                " partition by list (mmyy)(partition p_benhandt_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_benhandt add constraint pk_benhandt primary key(maql);\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add constraint fk_benhandt_dmbenhnhan foreign key(mabn) references " + sSchema + ".p_dmbenhnhan(mabn);\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add constraint fk_benhandt_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add constraint fk_benhandt_dmdoituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong);\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add constraint fk_benhandt_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add constraint fk_benhandt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".p_lienhe(mavaovien number(30) default 0 not null, tuoi varchar2(4), " +
               "giaychuyenvien number(1,0) default 0 not null,mabsgioithieu varchar2(4),manoigioithieu varchar2(10),sochuyenden varchar2(20)," +
               "quanhe nvarchar2(20),hotennguoiquanhe nvarchar2(154),diachinguoiquanhe nvarchar2(154),dienthoainguoiquanhe nvarchar2(50)," +
               "cholam nvarchar2(254),sonha varchar2(50),thon nvarchar2(254),matinhthanh varchar2(3) default '000'," +
               "maquanhuyen varchar2(5) default '00000',maphuongxa varchar2(7) default '0000000'," +
               "username varchar2(20),	ngayud date default sysdate, computer varchar2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
               " partition by list (mmyy)(partition p_lienhe_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_lienhe add constraint pk_lienhe primary key(mavaovien);\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add constraint fk_lienhe_dmnhanviengt foreign key(mabsgioithieu) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add constraint fk_lienhe_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".p_bhyt (id number(30) default 0 not null,maql number(30) default 0 not null, sothe varchar2(20), denngay date not null, " +
                "manoidkkcb varchar2(10) not null, tungay date, ngay1 date, ngay2 date, ngay3 date, ngaytrinh date, ngayduyet date," +
                "traituyen number(1) default 0 not null, manoicap number(7) default 0 ," +//Thuy 09.04.2014
                "username varchar2(20),ngayud date default sysdate,computer varchar2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_bhyt_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_bhyt add constraint pk_bhyt primary key(id);\n";
            s_Sql += "alter table " + sSchema + ".p_bhyt add constraint fk_bhyt_benhandt foreign key(maql) references " + sSchema + ".p_benhandt(maql);\n";

            s_Sql += "create sequence " + sSchema + ".seq_id increment by 1 start with 0 maxvalue 999 minvalue 0 cycle;\n";

            s_Sql += "create table " + sSchema + ".p_dmxutri(maxutri number(2),tenxutri nvarchar2(100),tenkhongdau varchar2(100)," +
                " ngayud date default sysdate,computer varchar2(50),username varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmxutri add constraint pk_dmxutri primary key(maxutri);\n";

            s_Sql += "create table " + sSchema + ".p_dmketquadieutri(idketqua number(1,0) default 0, ten nvarchar2(100) not null,tenkhongdau varchar2(100)," +
                 " computer varchar2(50),ngayud date default sysdate,username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".p_dmketquadieutri add constraint pk_ketqua primary key(idketqua);\n";

            s_Sql += "create table " + sSchema + ".p_dmtinhtrangrakhoa(idtinhtrangrakhoa number(1,0) default 0, ten nvarchar2(100) not null, ravien number(1,0) default 1 not null," +
                " tenkhongdau varchar2(100), computer varchar2(50),ngayud date default sysdate,username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhtrangrakhoa add constraint pk_tinhtrangrakhoa primary key(idtinhtrangrakhoa);\n";

            s_Sql += "create table " + sSchema + ".p_xuatvien(maql number(30,0) default 0, idkhoaphong number(3) default 0 not null, " +
                " ngay date default sysdate, idketqua number(1,0) default 1 not null, idtinhtrangrakhoa number(2,0) default 1 not null, benhchinh nvarchar2(500) default ' ', " +
                " maicd varchar2(9) not null, mabs varchar2(4) not null, soluutru nvarchar2(10) default ' ', traba number(1,0) default 0 not null, " +
                " idkhoaphongnhapvien number(3) default 0 not null,username varchar2(20), ngayud date default sysdate, computer varchar2(50),mmyy generated always as (to_char(ngayud,'MMyy'))) " +
                " partition by list (mmyy)(partition p_xuatvien_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_xuatvien add constraint pk_xuatvien primary key(maql);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add constraint fk_xuatvien_benhandt foreign key(maql) references " + sSchema + ".p_benhandt(maql);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add constraint fk_xuatvien_dmkhoaphong foreign key(idkhoaphong) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add constraint fk_xuatvien_dmicd foreign key(maicd) references " + sSchema + ".p_dmicd(maicd);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add constraint fk_xuatvien_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add constraint fk_xuatvien_ketqua foreign key(idketqua) references " + sSchema + ".p_dmketquadieutri(idketqua);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add constraint fk_xuatvien_ttrk foreign key(idtinhtrangrakhoa) references " + sSchema + ".p_dmtinhtrangrakhoa(idtinhtrangrakhoa);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add constraint fk_xuatvien_dmkhoaphongnv foreign key(idkhoaphongnhapvien) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add constraint fk_xuatvien_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "CREATE TABLE " + sSchema + ".p_xutridieutri (MAQL NUMBER(30,0) DEFAULT 0, MAXUTRI number(2) default 0 not null, NGAYUD DATE DEFAULT sysdate," +
                " computer varchar2(50), username varchar2(20),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_xuatvien_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_xutridieutri add constraint pk_xutridieutri primary key(maql,maxutri);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_xutridieutri add constraint fk_xutridieutri_xuatvien foreign key(maql) references " + sSchema + ".p_xuatvien(maql);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_xutridieutri add constraint fk_xutridieutri_dmxutri foreign key(maxutri) references " + sSchema + ".p_dmxutri(maxutri);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_xutridieutri add constraint fk_xutridieutri_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += " create table " + sSchema + ".b_chidinh (id number(30,0) default 0, maql number(30,0) default 0 not null, idkhoa number(30,0) default 0 not null, ngay date, " +
                " idkhoaphong number(3 ) default 0 not null, madoituong number(2,0) default 0 not null, idgiavienphi number(7,0) default 0 not null, soluong number(12,4) default 0 not null, " +
                " dongia number(15,4) default 0 not null, ghichu nvarchar2(254), tinhtrang number(1,0) default 0 not null, idkpnoithuchien number(3) default 0 not null, " +
                " paid number(1,0) default 0 not null, done number(1,0) default 0 not null, idchidinh number(30,0) default 0 not null, " +
                " idttrv number(30,0) default 0 not null, maicd varchar2(9 ), chandoan nvarchar2(254), mabs varchar2(4 ), loaiba number(1,0) default 3 not null, " +
                " ngaythuchien date, idtrongoi number(7,0) default 0 not null, hide number(1,0) default 0 not null,  duyet number(1,0) default 0 not null, " +
                " lanin number(2,0) default 0 not null, idduoc number(30,0) default 0 not null, ngayud date default sysdate, username varchar2(20), computer varchar2(50), " +
                " vuottran number(1,0) default 0 not null, idpttt number(30,0) default 0 not null,mmyy generated always as (to_char(ngayud,'MMyy'))) " +
                " partition by list (mmyy)(partition b_chidinh_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_chidinh add constraint pk_chidinh primary key(id);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_chidinh add constraint fk_chidinh_benhandt foreign key(maql) references " + sSchema + ".p_benhandt(maql);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_chidinh add constraint fk_chidinh_kpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_chidinh add constraint fk_chidinh_doituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_chidinh add constraint fk_chidinh_kpth foreign key(idkpnoithuchien) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_chidinh add constraint fk_chidinh_giavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_chidinh add constraint fk_chidinh_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";

            s_Sql += "create table " + sSchema + ".b_dmloaiquyenso(maloaiquyenso number(2),tenloaiquyenso nvarchar2(254)," +
                " tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50),dongbo varchar2(100) default lpad('0',100,'0')," +
                " computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".b_dmloaiquyenso add constraint pk_dmloaiquyenso primary key(maloaiquyenso);\n";

            s_Sql += "create table " + sSchema + ".b_dmquyenso(idquyenso number(5),tenquyenso nvarchar2(254),kyhieu nvarchar2(254),maloaiquyenso number(2)," +
                " tu number(10) default 0,den number(10) default 0,soghi number(10) default 0, ngaylinh date default sysdate,dangdung number(1) default 0," +
                " khambenh number(1) default 0,dichvu number(1) default 0,tenkhongdau varchar2(150),ngayud date default sysdate,username varchar2(50)," +
                " dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".b_dmquyenso add constraint pk_dmquyenso primary key(idquyenso);\n";
            s_Sql += "alter table " + sSchema + ".b_dmquyenso add constraint fk_quyenso_loaiquyenso foreign key(maloaiquyenso) references " + sSchema + ".b_dmloaiquyenso(maloaiquyenso);\n";

            s_Sql += "create table " + sSchema + ".m_dmnuoc(idnuoc number(5) default 0, tennuoc nvarchar2(254), tenkhongdau varchar2(150), ngayud DATE DEFAULT sysdate " +
                ",computer varchar2(50),username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".m_dmnuoc add constraint pk_m_dmnuoc primary key(idnuoc);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnuoc add constraint fk_nuoc_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmloai(idloai number(3) default 0, tenloai nvarchar2(254), tenkhongdau varchar2(150), idnhomkho number(2) default 0 not null " +
              ",computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmloai add constraint pk_m_dmloai primary key(idloai);\n";
            s_Sql += "alter table " + sSchema + ".m_dmloai add constraint fk_loai_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter table " + sSchema + ".m_dmloai add constraint fk_loai_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmnhomhang(idnhomhang number(2) default 0, tennhomhang nvarchar2(254), tenkhongdau varchar2(150)," +
             "computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomhang add constraint pk_m_dmnhomhang primary key(idnhomhang);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomhang add constraint fk_nhomhang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmhang(idhang number(5) default 0, tenhang nvarchar2(254), tenkhongdau varchar2(150), idnhomkho number(2) default 0 not null," +
                "idnhomhang number(2) default 0 not null,computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmhang add constraint pk_m_dmhang primary key(idhang);\n";
            s_Sql += "alter table " + sSchema + ".m_dmhang add constraint fk_hang_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter table " + sSchema + ".m_dmhang add constraint fk_hang_nhomhang foreign key(idnhomhang) references " + sSchema + ".m_dmnhomhang(idnhomhang);\n";
            s_Sql += "alter table " + sSchema + ".m_dmhang add constraint fk_hang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmdang(iddang number(2) default 0, tendang nvarchar2(50), tenkhongdau varchar2(30),ngayud DATE DEFAULT sysdate," +
                "computer varchar2(50),username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".m_dmdang add constraint pk_m_dmdang primary key(iddang);\n";
            s_Sql += "alter table " + sSchema + ".m_dmdang add constraint fk_dang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmduongdung(idduongdung number(3) default 0, tenduongdung nvarchar2(254), tenkhongdau varchar2(150),ngayud DATE DEFAULT sysdate," +
                "computer varchar2(50),username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".m_dmduongdung add constraint pk_m_dmduongdung primary key(idduongdung);\n";
            s_Sql += "alter table " + sSchema + ".m_dmduongdung add constraint fk_duongdung_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmnhomketoan(idnhomketoan number(2,0) default 0, manhomketoan varchar2(50), tennhomketoan nvarchar2(254), tenkhongdau varchar2(150)," +
               "ngayud DATE DEFAULT sysdate,computer varchar2(50),username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomketoan add constraint pk_m_dmnhomketoan primary key(idnhomketoan);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomketoan add constraint fk_nhomketoan_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmnhomin(idnhomin number(2) default 0, tennhomin nvarchar2(254), tenkhongdau varchar2(150), idnhomkho number(2) default 0 not null, " +
              "computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomin add constraint pk_m_dmnhomin primary key(idnhomin);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomin add constraint fk_nhomin_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomin add constraint fk_nhomin_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmnganhang(idnganhang number(3) default 0, tennganhang nvarchar2(254), tenkhongdau varchar2(150), sotaikhoan varchar(15), " +
                "masothue varchar2(15), dienthoai varchar2(50), fax varchar2(15), diachi nvarchar2(254)," +
                "computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnganhang add constraint pk_m_dmnganhang primary key(idnganhang);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnganhang add constraint fk_nganhang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmnhacungcap(idnhacungcap number(5) default 0, manhacungcap varchar2(50), tennhacungcap nvarchar2(254), tenkhongdau varchar2(150)," +
                " idnhomkho number(2) default 0 not null, sotaikhoan varchar(15), masothue varchar2(15), daidien nvarchar2(254), dienthoai varchar2(50), fax varchar2(15), diachi nvarchar2(254)," +
                "idnganhang number(3) default 0 not null,computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate);\n ";
            s_Sql += "alter table " + sSchema + ".m_dmnhacungcap add constraint pk_m_dmnhacungcap primary key(idnhacungcap);\n ";
            s_Sql += "alter table " + sSchema + ".m_dmnhacungcap add constraint fk_ncc_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n ";
            s_Sql += "alter table " + sSchema + ".m_dmnhacungcap add constraint fk_ncc_nganhang foreign key(idnganhang) references " + sSchema + ".m_dmnganhang(idnganhang);\n ";
            s_Sql += "alter table " + sSchema + ".m_dmnhacungcap add constraint fk_ncc_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmnhombietduoc(idnhombietduoc number(3) default 0, tennhombietduoc nvarchar2(254), tenkhongdau varchar2(150), idnhomkho number(2) default 0 not null, " +
                "idloaivienphi number(5) default 0 not null, ngayud DATE DEFAULT sysdate,computer varchar2(50),username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add constraint pk_m_dmnhombietduoc primary key(idnhombietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add constraint fk_nhombietduoc_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add constraint fk_nhombietduoc_loaivienphi foreign key(idloaivienphi) references " + sSchema + ".b_dmloaivienphi(idloaivienphi);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add constraint fk_nhombietduoc_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmhoatchat(idhoatchat number(7,0) default 0, mahoatchat varchar2(8), tenhoatchat nvarchar2(508), tenkhongdau varchar2(400)," +
                "ngayud DATE DEFAULT sysdate, RX_OTC number(1,0) default 1 not null, hamluong nvarchar2(100), dang nvarchar2(50), " +
                "idduongdung number(3) default 0 not null, sttbhyt varchar2(8), hoichan number(1,0) default 0 not null, cachdung nvarchar2(508),computer varchar2(50)," +
                "username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".m_dmhoatchat add constraint pk_m_dmhoatchat primary key(idhoatchat);\n";
            s_Sql += "alter table " + sSchema + ".m_dmhoatchat add constraint un_dmhoatchat_mahoatchat unique(mahoatchat) enable;\n";
            s_Sql += "alter table " + sSchema + ".m_dmhoatchat add constraint fk_hoatchat_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmnguon(idnguon number(2,0) default 0, tennguon nvarchar2(254), tenkhongdau varchar2(150), " +
                "idnhomkho number(2) default 0 not null,computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnguon add constraint pk_m_dmnguon primary key(idnguon);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnguon add constraint fk_nguon_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmkho(idkho number(3,0) default 0, tenkho nvarchar2(254), tenkhongdau varchar2(150), " +
                "idnhomkho number(2) default 0 not null,khotrungtam number(1) default 0 not null,thua number(1) default 0 not null,dutru number(1) default 0 not null," +
                "dongy number(1) default 0 not null,open number(1) default 0 not null,chuyenkho number(1) default 0 not null,idkhotra number(3,0) default 0 not null," +
                "khophache number(1) default 0 not null,idkhonguyenlieu number(3) default 0 not null," +
                "computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmkho add constraint pk_m_dmkho primary key(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_dmkho add constraint fk_kho_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".m_dmkho add constraint fk_kho_dmnhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";

            s_Sql += "create table " + sSchema + ".m_dmnhomphieu(idnhomphieu number(2,0) default 0, tennhomphieu nvarchar2(254), tenkhongdau varchar2(150), " +
                "kho varchar2(254),nguon varchar2(254),madoituong varchar2(254),computer varchar2(50),username varchar2(20), " +
                "ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomphieu add constraint pk_m_dmnhomphieu primary key(idnhomphieu);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomphieu add constraint fk_phieu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmphieu(idphieu number(3,0) default 0, tenphieu nvarchar2(254), tenkhongdau varchar2(150), " +
                "loai number(1) default 0 not null,idnhomphieu number(2) default 0 not null,kho varchar2(254), idnhomkho number(2) default 0 not null," +
                "computer varchar2(50), username varchar2(20), ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmphieu add constraint pk_m_dmphieu primary key(idphieu);\n";
            s_Sql += "alter table " + sSchema + ".m_dmphieu add constraint fk_dmphieu_nhomphieu foreign key(idnhomphieu) references " + sSchema + ".m_dmnhomphieu(idnhomphieu);\n";
            s_Sql += "alter table " + sSchema + ".m_dmphieu add constraint fk_dmphieu_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter table " + sSchema + ".m_dmphieu add constraint fk_dmphieu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmkhoaphong(idkhoaphong number(3,0) default 0, makhoaphong varchar2(10), tenkhoaphong nvarchar2(254), tenkhongdau varchar2(150)," +
                "idnhomkho varchar2(254),idkhoaphongbenhvien number(3,0) default 0 not null,idkho varchar2(254),tutruc varchar2(254),idnhomphieu varchar2(254)," +
                "idphieu varchar2(254),computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmkhoaphong add constraint pk_m_dmkhoaphong primary key(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_dmkhoaphong add constraint fk_dmkhoaphong_dmkpbenhvien foreign key(idkhoaphongBenhVien) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_dmkhoaphong add constraint fk_khoaphong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmbd(idbietduoc number(7,0) default 0, mabietduoc varchar2(15), tenbietduoc nvarchar2(254), tenkhongdau varchar2(150)," +
                "dang nvarchar2(50), hamluong nvarchar2(50), idnhombietduoc number(3) default 0 not null, " +
                "idloai number(3) default 0 not null, idhang number(5) default 0 not null, idnuoc number(5) default 0 not null," +
                "bhyt number(3) default 0 not null, tenhoatchat nvarchar2(2000), mahoatchat varchar2(1000),donvilinh nvarchar2(50)," +//Thuy 02/12/2014
                "idnhomkho number(2) default 0 not null, sodangky varchar2(20),dongia number(24,10) default 0 not null,soluongtoithieu number(10) default 0 not null," +
                "giaban number(18,4) default 0 not null,ngaytra number(3) default 0 not null,tutruc number(1) default 0 not null,idnhomin number(2) default 0 not null," +
                "duongdung nvarchar2(254),idnhacungcap number(5) default 0 not null,dangdonggoi nvarchar2(50),khongnhapmoi number(1) default 0 not null," +
                "phattron number(1) default 0 not null,soluongdonggoi number(7) default 1 not null,maatc varchar2(50)," +
                "giabhyt number(18,4) default 0 not null,kythuat number(1) default 0 not null,chenhlech number(1) default 0 not null,cachdung nvarchar2(254)," +
                "donvidung nvarchar2(50),thuoctheodon number(1) default 1 not null,idkho varchar2(254),locthan number(1) default 0 not null,cotrongkhoaduocbv number(1) default 0 not null," +
                "dienthoai varchar2(50),binhongia number(1) default 0 not null,mabenhvienapthau varchar2(50)," +
                "tenkhoahocvithuoc nvarchar2(254),tenkhoahocnguyenvatlieu nvarchar2(254),sttbyt varchar2(20),stt21 varchar2(50),stt6282 varchar2(50)," +
                "thanhphan nvarchar2(2000),chidinh nvarchar2(2000),chongchidinh nvarchar2(2000),chuy nvarchar2(2000),cothai nvarchar2(2000),tuongtac nvarchar2(2000)," +
                "ngoaiy nvarchar2(2000),lieuluong nvarchar2(2000));\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add constraint pk_m_dmbd primary key(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add constraint fk_dmbd_hang foreign key(idhang) references " + sSchema + ".m_dmhang(idhang);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add constraint fk_dmbd_loai foreign key(idloai) references " + sSchema + ".m_dmloai(idloai);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add constraint fk_dmbd_nhombietduoc foreign key(idnhombietduoc) references " + sSchema + ".m_dmnhombietduoc(idnhombietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add constraint fk_dmbd_nuoc foreign key(idnuoc) references " + sSchema + ".m_dmnuoc(idnuoc);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add constraint fk_dmbd_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add constraint fk_dmbd_nhomin foreign key(idnhomin) references " + sSchema + ".m_dmnhomin(idnhomin);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add constraint fk_dmbd_nhacungcap foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap);\n";

            s_Sql += "alter table " + sSchema + ".m_dmbd add tyle number(3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add giabandangky number(18,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add ngayapdung DATE;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add giathau number(18,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add ngoaithau number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add idloaithuocbyt number(3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add nguongoc nvarchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add hoichan number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add travo number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add computer varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add username varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add ngayud DATE DEFAULT sysdate;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add constraint fk_dmbd_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table  " + sSchema + ".b_hoantra(id number(30)  DEFAULT 0 not null, " +
                " diemthu number(2) default 0 not null, idquyenso number(5) DEFAULT 0 not null, sobienlai number(10) DEFAULT 0 not null," +
                " ngay date, maql number(30) DEFAULT 0 not null, idkhoa number(30) DEFAULT 0 not null, idkhoaphong number(3) DEFAULT 0 not null,  " +
                " sotien number(15,4) DEFAULT 0 not null,loai number(2) DEFAULT 0 not null,loaibn number(2) DEFAULT 0 not null," +
                " username varchar2(20), usernamenl varchar2(20)," +
                " ngayud date DEFAULT sysdate, DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'),COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition b_chidinh_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_hoantra add CONSTRAINT pk_b_hoantra PRIMARY KEY (id);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_hoantra add CONSTRAINT fk_b_hoantra_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_hoantra add CONSTRAINT fk_b_hoantra_benhandt FOREIGN KEY(maql) REFERENCES " + sSchema + ".p_benhandt(maql);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_hoantra add CONSTRAINT fk_b_hoantra_quyenso FOREIGN KEY(idquyenso) REFERENCES " + sSchema + ".b_dmquyenso(idquyenso);\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_hoantra add CONSTRAINT fk_b_hoantra_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table  " + sSchema + ".b_tamung(id number(30)  DEFAULT 0 not null, diemthu number(2) default 0 not null,      " +
                " maql number(30) DEFAULT 0 not null,  idkhoa number(30) DEFAULT 0 not null,  " +
                " idquyenso number(5) DEFAULT 0 not null,  sobienlai number(10) DEFAULT 0 not null,ngay date,  " +
                " loai number(2) DEFAULT 0 not null,  idkhoaphong number(3) DEFAULT 0 not null,  madoituong number(2) DEFAULT 0 not null," +
                " sotien number(15,4) DEFAULT 0 not null, done number(1) DEFAULT 0 not null, lanin number(2) DEFAULT 0 not null," +
                " loaibn number(2) DEFAULT 0 not null, idttrv number(30) DEFAULT 0 not null,  datru number(15,4) DEFAULT 0 not null," +
                " ketoan number(20) default 0 not null,idtonghop number(30) default 0 not null,lan number(5) default 1," +
                " username varchar2(20), usernamenl varchar2(20), ngayud date DEFAULT sysdate, " +
                " DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition b_tamung_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_tamung add CONSTRAINT pk_b_tamung PRIMARY KEY (id);\n";
            s_Sql += "alter table " + sSchema + ".b_tamung add CONSTRAINT fk_b_tamung_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".b_tamung add CONSTRAINT fk_b_tamung_benhandt FOREIGN KEY(maql) REFERENCES " + sSchema + ".P_BENHANDT(maql);\n";
            s_Sql += "alter table " + sSchema + ".b_tamung add CONSTRAINT fk_b_tamung_quyenso FOREIGN KEY(idquyenso) REFERENCES " + sSchema + ".b_dmquyenso(idquyenso);\n";
            s_Sql += "alter table " + sSchema + ".b_tamung add CONSTRAINT fk_b_tamung_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add masome varchar2(14);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add hotenme nvarchar2(100);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add namsinhme number(4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add manghenghiepme varchar2(3);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add tdvhme nvarchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add nhommaume varchar2(2);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add parame varchar2(11);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add hotenbo nvarchar2(100);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add namsinhbo number(4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add manghenghiepbo varchar2(3);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add tdvhbo nvarchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add dentu number(1) default 2 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add nhantu number(1) default 2 not null;\n";
            //end
            s_Sql += "CREATE TABLE " + sSchema + ".P_BENHKEMTHEO(ID NUMBER(30,0) DEFAULT 0 not null, MAQL NUMBER(30,0) DEFAULT 0 not null,CHANDOAN NVARCHAR2(254)," +
                " MAICD VARCHAR2(10), NGAYUD DATE DEFAULT sysdate, USERNAME VARCHAR2(50), DONGBO character varying(100) DEFAULT lpad('0',100,'0'),COMPUTER character varying(50),"+
                " mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition P_BENHKEMTHEO_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".P_BENHKEMTHEO add CONSTRAINT pk_cdkemtheo PRIMARY KEY (id);\n";
            s_Sql += "alter table " + sSchema + ".P_BENHKEMTHEO add CONSTRAINT uc_cdkemtheo UNIQUE (maql,maicd);\n";
            s_Sql += "alter table " + sSchema + ".P_BENHKEMTHEO add CONSTRAINT fk_BENHKEMTHEO_benhandt FOREIGN KEY (maql) REFERENCES " + sSchema + ".p_benhandt(maql);\n";
            s_Sql += "alter table " + sSchema + ".P_BENHKEMTHEO add CONSTRAINT fk_BENHKEMTHEO_dmicd FOREIGN KEY (maicd) REFERENCES " + sSchema + ".p_dmicd(maicd);\n";

            s_Sql += " CREATE TABLE " + sSchema + ".p_HIENDIEN (ID NUMBER(30) DEFAULT 0, MAQL NUMBER(30) DEFAULT 0 not null, idkhoaphong number(3) default 0  not null, " +
                " NGAY DATE default sysdate not null, idkhoaphongchuyenden number(3) default 0  not null, done NUMBER(1) DEFAULT 0 not null, GIUONG VARCHAR2(20), " +
                " MABS VARCHAR2(4), MAICD VARCHAR2(9), chandoan nvarchar2(254),username varchar2(20), computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_HIENDIEN add constraint pk_hiendien primary key(id);\n";
            s_Sql += "alter table " + sSchema + ".p_HIENDIEN add constraint fk_hiendien_benhandt foreign key(maql) references " + sSchema + ".p_benhandt(maql);\n";
            s_Sql += "alter table " + sSchema + ".p_HIENDIEN add constraint fk_hiendien_uk_maql unique(maql);\n";
            s_Sql += "alter table " + sSchema + ".p_HIENDIEN add constraint fk_hiendien_khoaphong  foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_HIENDIEN add constraint fk_hiendien_noichuyenden foreign key (idkhoaphongchuyenden) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_HIENDIEN add constraint fk_hiendien_dmbs foreign key (mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            //s_Sql += "alter table " + sSchema + ".p_HIENDIEN add constraint fk_hiendien_dmicd foreign key (maicd) references " + sSchema + ".p_dmicd(maicd);\n";
            s_Sql += "alter table " + sSchema + ".p_HIENDIEN add constraint fk_hiendien_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "alter table " + sSchema + ".p_benhandt add constraint uk_benhandt_mavaovien unique(mavaovien,maql);\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add trinhdovanhoa nvarchar2(100);\n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.trinhdovanhoa is 'dung trong benh an tam than';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add ngaybong date;\n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.ngaybong is 'dung trong benh an bong';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add para varchar2(11);\n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.para is 'dung trong benh an san khoa';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add ngaykinhcuoiki date;\n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.ngaykinhcuoiki is 'dung trong benh an san khoa';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add ngaysinhdukien date; \n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.ngaysinhdukien is 'dung trong benh an san khoa';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add dacdiemthai nvarchar2(500);\n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.dacdiemthai is 'dung trong benh an san khoa';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add nhanapmatphai varchar2(10);\n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.nhanapmatphai is 'dung trong benh an mat';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add nhanapmattrai varchar2(10);\n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.nhanapmattrai is 'dung trong benh an mat';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add thiluckhongkinhmatphai nvarchar2(30);\n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.thiluckhongkinhmatphai is 'dung trong benh an mat';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add thiluckhongkinhmattrai nvarchar2(30);\n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.thiluckhongkinhmattrai is 'dung trong benh an mat';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add thiluccokinhmatphai varchar2(10); \n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.thiluccokinhmatphai is 'dung trong benh an mat';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add thiluccokinhmattrai varchar2(10);\n";
            s_Sql += " comment on column " + sSchema + ".p_benhandt.thiluccokinhmattrai is 'dung trong benh an mat';\n";
            s_Sql += " alter table " + sSchema + ".p_benhandt add idkhoa number(30) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add idbenhan number(2) default 24 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add constraint fk_benhandt_benhan foreign key(idbenhan) references " + sSchema + ".p_dmbenhan;\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add soluutru varchar2(20);\n";

            s_Sql += "create table " + sSchema + ".p_nhapkhoa (id number(30) default 0, maql number(30) default 0 not null, idkhoaphong number(3) default 0 not null, " +
                "idbenhan number(3) default 0 not null, ngay date default sysdate not null, tuoivao varchar2(4), giuong varchar2(20), " +
                "idkhoachuyen number(3) default 0 not null, chandoan nvarchar2(500) not null, maicd varchar2(9) not null, mabs varchar2(4) not null, " +
                "lan number(3,0) default 0 not null, username varchar2(20), computer varchar2(50), ngayud date default sysdate,machuyenden number(30)  default 0 not null, " +//linh 25/7/14"+
                " mmyy generated always as (to_char(ngayud,'MMyy'))) " +
                " partition by list (mmyy)(partition p_nhapkhoa_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_nhapkhoa add constraint pk_nhapkhoa primary key(id);\n";
            s_Sql += "alter table " + sSchema + ".p_nhapkhoa add constraint fk_nhapkhoa_benhandt foreign key(maql) references " + sSchema + ".p_benhandt(maql);\n";
            s_Sql += "alter table " + sSchema + ".p_nhapkhoa add constraint fk_nhapkhoa_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_nhapkhoa add constraint fk_nhapkhoa_dmkpnc foreign key(idkhoachuyen) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_nhapkhoa add constraint fk_nhapkhoa_dmnv foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_nhapkhoa add constraint fk_nhapkhoa_dmicd foreign key(maicd) references " + sSchema + ".p_dmicd(maicd);\n";
            s_Sql += "alter table " + sSchema + ".p_nhapkhoa add constraint fk_nhapkhoa_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_dmloaithuocbyt(idloaithuocbyt number(3) default 0, tenloaithuocbyt nvarchar2(254), tenkhongdau varchar2(150), " +
                "computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmloaithuocbyt add constraint pk_m_dmloaithuocbyt primary key(idloaithuocbyt);\n";
            s_Sql += "alter table " + sSchema + ".m_dmloaithuocbyt add constraint fk_loaithuocbyt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";



            //Khương 15/3/2014
            s_Sql += "create table " + sSchema + ".r_dmloaicdha(idloaicdha number(2,0) default 0 not null, stt number(2,0) default 0 not null," +
                "tenloaicdha nvarchar2(254) not null,chuprieng number(1,0) default 0 not null,tutruc number(1,0) default 0 not null,kythuat number(1,0) default 0 not null," +
                "chuphinh number(1,0) default 0 not null,chonhinh number(1,0) default 0 not null,inhinh number(1,0) default 0 not null,locnhanvien number(1,0) default 0 not null," +
                "nhapsolan number(1,0) default 0 not null,traloirieng number(1,0) default 0 not null,sohinh number(2,0) default 0 not null,quanlyphim number(1,0) default 0 not null," +
                "quanlyvattu number(1,0) default 0 not null,batbuocnhapphim number(1,0) default 0 not null,nhapmota number(1,0) default 0 not null,nhapnhanvien2 number(1,0) default 0 not null," +
                "nhapidcls number(1,0) default 0 not null,tudongcapnhattutruc number(1,0) default 0 not null,makp_duoc number(3,0) default 0 not null,chontencoquan number(1,0) default 0 not null," +
                "readonly number(1,0) default 0 not null,tenkhongdau varchar2(150)," +
                "computer varchar2(50),ngayud date default sysdate,username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".r_dmloaicdha add constraint pk_r_loaicdha primary key(idloaicdha);\n";
            s_Sql += "alter table " + sSchema + ".r_dmloaicdha add constraint fk_r_loaicdha_dmkhoaphong foreign key(makp_duoc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".r_dmloaicdha add constraint fk_r_loaicdha_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".r_dmmay(idmay number(2,0) default 0 not null, stt number(2,0) default 0 not null," +
                "tenmay nvarchar2(254) not null,idloaicdha number(2,0) default 0 not null,readonly number(1,0) default 0 not null,tenkhongdau varchar2(150)," +
                " computer varchar2(50),ngayud date default sysdate,username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".r_dmmay add constraint pk_r_dmmay primary key(idmay);\n";
            s_Sql += "alter table " + sSchema + ".r_dmmay add constraint fk_dmmay_dmloaicdha foreign key(idloaicdha) references " + sSchema + ".r_dmloaicdha(idloaicdha);\n";
            s_Sql += "alter table " + sSchema + ".r_dmmay add constraint fk_dmmay_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".r_dmkythuat(idkythuat number(7,0) default 0 not null, MAKT VARCHAR2(6), TENKYTHUAT NVARCHAR2(500), IDLOAICDHA NUMBER(3,0) default 0 not null," +
                " IDFORM NUMBER(4,0) default 0 not null,TYLEBACSY NUMBER(10,4) default 0 not null,TYLENHANVIEN NUMBER(10,4) default 0 not null,TYLENHANVIEN1 NUMBER(10,4) default 0 not null,REPORT VARCHAR2(100), IDVP NUMBER(7,0) default 0 not null," +
                " MAPT VARCHAR2(6), KIEUMOTA NUMBER(1) default 0 not null,HIDE number(1,0) default 0 not null, computer varchar2(50),ngayud date default sysdate,username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".r_dmkythuat add constraint pk_r_dmkythuat primary key(idkythuat);\n";
            s_Sql += "alter table " + sSchema + ".r_dmkythuat add constraint fk_dmkythuatcdha_dmloaicdha foreign key(idloaicdha) references " + sSchema + ".r_dmloaicdha(idloaicdha);\n";
            s_Sql += "alter table " + sSchema + ".r_dmkythuat add constraint fk_dmkythuatcdha_dmgiavp foreign key(idvp) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".r_dmkythuat add constraint fk_dmkythuatcdha_user foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".r_dmmaumota(mabs VARCHAR2(4) not null, MAKT VARCHAR2(6) not null, idmau  NUMBER(3,0) default 0 not null," +
               " IDLOAICDHA NUMBER(3,0) default 0 not null, kythuatthuchien NVARCHAR2(1000),mota NCLOB,KETLUAN NVARCHAR2(1000)," +
               " DENGHI NVARCHAR2(1000),TENMAU NVARCHAR2(1000),computer varchar2(50),ngayud date default sysdate,username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".r_dmmaumota add constraint pk_r_dmmau primary key(mabs,MAKT,idmau);\n";
            s_Sql += "alter table " + sSchema + ".r_dmmaumota add constraint fk_dmmau_dmloaicdha foreign key(idloaicdha) references " + sSchema + ".r_dmloaicdha(idloaicdha);\n";
            s_Sql += "alter table " + sSchema + ".r_dmmaumota add constraint fk_dmmau_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".r_dmmaumota add constraint fk_dmmau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            //linh 17/3/14
            s_Sql += "alter table " + sSchema + ".p_hiendien add machuyenden number(30) default 0 not null;\n";

            s_Sql += "create table " + sSchema + ".p_xuatkhoa (id number(30) default 0, ngay date, idketqua number(1) default 0, idtinhtrangrakhoa number(2) default 0," +
                " chandoan nvarchar2(500), maicd varchar2(9 ), mabs varchar2(4 ), bienchung number(1) default 0, taibien number(1) default 0, " +
                " idkhoaphongchuyendi number(3) default 0 not null," +
                " giaiphau number(1) default 0, username varchar2(20), ngayud date default sysdate, computer varchar2(50)," +
                " mmyy generated always as (to_char(ngayud,'MMyy'))) " +
                " partition by list (mmyy)(partition p_xuatkhoa_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_xuatkhoa add constraint pk_xuatkhoa primary key(id);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_nhapkhoa foreign key(id) references " + sSchema + ".p_nhapkhoa(id);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_ketqua foreign key (idketqua) references " + sSchema + ".p_dmketquadieutri(idketqua);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_tinhtrang foreign key (idtinhtrangrakhoa) references " + sSchema + ".p_dmtinhtrangrakhoa(idtinhtrangrakhoa);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_dmbs foreign key (mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_dmkpbv foreign key (idkhoaphongchuyendi) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatkhoa add constraint fk_xuatkhoa_dmicd foreign key (maicd) references " + sSchema + ".p_dmicd(maicd);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add mabenhvienchuyendi varchar2(10);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add lamsang nvarchar2(2000);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add xetnghiem nvarchar2(2000); \n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add chandoan nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add thuoc nvarchar2(2000);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add tinhtrangchuyenvien nvarchar2(2000);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add vanchuyen nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add nguoidua nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add lydochuyenvien nvarchar2(500);\n";
            //linh 19/3/2014
            s_Sql += "alter table " + sSchema + ".p_thongso add diengiai nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_thongso add val nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_thongso add nhomthongso nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_thongso add noidung nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_thongso add loai number(1);\n";
            s_Sql += "create table " + sSchema + ".p_thongso_ext(id number(7), ma number(7), ten nvarchar2(500),val nvarchar2(500),constraint pk_thongso_ext primary key(id,ma)," +
                "constraint fk_thongso_thongso_ext foreign key(id) references " + sSchema + ".p_thongso(id));\n";

            //Cuong - 20/03/2014
            s_Sql += "create table " + sSchema + ".m_theodoi(idtheodoi number(30) default 0, idbietduoc number(7) default 0 not null, idnguon number(2) default 0 not null, " +
                " idhang number(5) default 0 not null, idnuoc number(5) default 0 not null, handung date, losx varchar2(20), idnhacungcap number(5) default 0 not null, " +
                " dongia number(12,4) default 0 not null, giaban number(12,4) default 0 not null, giagoc number(12,4) default 0 not null, vat number(3) default 0 not null, " +
                " chietkhau number(5,2) default 0 not null, khaiton number(1) default 0 not null, " +
                " computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate, mmyy generated always as (to_char(ngayud,'MMyy'))) " +
                " partition by list (mmyy)(partition m_theodoi_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_theodoi add constraint pk_m_theodoi primary key(idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".m_theodoi add constraint fk_theodoi_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_theodoi add constraint fk_theodoi_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon);\n";
            s_Sql += "alter table " + sSchema + ".m_theodoi add constraint fk_theodoi_dmhang foreign key(idhang) references " + sSchema + ".m_dmhang(idhang);\n";
            s_Sql += "alter table " + sSchema + ".m_theodoi add constraint fk_theodoi_dmnuoc foreign key(idnuoc) references " + sSchema + ".m_dmnuoc(idnuoc);\n";
            s_Sql += "alter table " + sSchema + ".m_theodoi add constraint fk_theodoi_dmnhacungcap foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap);\n";
            s_Sql += "alter table " + sSchema + ".m_theodoi add constraint fk_theodoi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //Cuong - 20/03/2014
            s_Sql += "create table " + sSchema + ".m_tonkhochitiet(mmyy varchar2(4), idkho number(3) default 0, idtheodoi number(30) default 0 not null, " +
                " soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                " soluongxuat number(30,8) default 0 not null, soluongkiemke number(30,8) default 0 not null, khoa number(1) default 0 not null, " +
                " computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate) " +
                " partition by list (mmyy)(partition m_tonkhochitiet_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_tonkhochitiet add constraint pk_m_tonkhochitiet primary key(mmyy,idkho,idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".m_tonkhochitiet add constraint fk_tonkhochitiet_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_tonkhochitiet add constraint fk_tonkhochitiet_theodoi foreign key(idtheodoi) references " + sSchema + ".m_theodoi(idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".m_tonkhochitiet add constraint fk_tonkhochitiet_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //Cuong - 20/03/2014
            s_Sql += "create table " + sSchema + ".m_tonkhotonghop(mmyy varchar2(4), idkho number(3) default 0, idbietduoc number(7) default 0 not null, " +
                " idnguon number(2) default 0 not null, soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                " soluongxuat number(30,8) default 0 not null, soluongyeucau number(30,8) default 0 not null, soluongkiemke number(30,8) default 0 not null, " +
                " computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate) " +
                " partition by list (mmyy)(partition m_tonkhotonghop_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_tonkhotonghop add constraint pk_m_tonkhotonghop primary key(mmyy,idkho,idbietduoc,idnguon);\n";
            s_Sql += "alter table " + sSchema + ".m_tonkhotonghop add constraint fk_tonkhotonghop_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_tonkhotonghop add constraint fk_tonkhotonghop_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_tonkhotonghop add constraint fk_tonkhotonghop_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon);\n";
            s_Sql += "alter table " + sSchema + ".m_tonkhotonghop add constraint fk_tonkhotonghop_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //Cuong - 20/03/2014
            s_Sql += "create table " + sSchema + ".m_tondau(mmyy varchar2(4), idkho number(3) default 0, idtheodoi number(30) default 0 not null, " +
                " soluong number(30,8) default 0 not null, computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate,idtutruc number(3) default 0 not null)" +
                " partition by list (mmyy)(partition m_tondau_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += " alter table " + sSchema + ".m_tondau add constraint pk_m_tondau primary key(mmyy,idkho,idtheodoi);\n";
            s_Sql += " alter table " + sSchema + ".m_tondau add constraint fk_tondau_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += " alter table " + sSchema + ".m_tondau add constraint fk_tondau_theodoi foreign key(idtheodoi) references " + sSchema + ".m_theodoi(idtheodoi);\n";
            s_Sql += " alter table " + sSchema + ".m_tondau add constraint fk_tondau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            //linh 20/3/2014
            s_Sql += "alter table " + sSchema + ".p_thongso add benhvien number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_thongso_ext modify ma number(7) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_thongso_ext add username varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".p_thongso_ext add computer varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".p_thongso_ext add ngayud date default sysdate;\n";
            //linh 21/3/2014
            s_Sql += "create table " + sSchema + ".l_dmsoxetnghiem(idsoxetnghiem number(2),tensoxetnghiem nvarchar2(154),masoxetnghiem varchar2(10)," +
                " tenkhongdau varchar2(100), username varchar2(20), computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmsoxetnghiem add constraint pk_soxn primary key(idsoxetnghiem);\n";
            s_Sql += "alter table " + sSchema + ".l_dmsoxetnghiem add constraint uk_soxn_ma unique(masoxetnghiem);\n";

            s_Sql += "create table " + sSchema + ".l_dmnhomxetnghiem(idnhomxetnghiem number(3),tennhomxetnghiem nvarchar2(154),manhomxetnghiem varchar2(10)," +
                "idsoxetnghiem number(2),tenkhongdau varchar2(150),username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmnhomxetnghiem add constraint pk_nhomxn primary key(idnhomxetnghiem);\n";
            s_Sql += "alter table " + sSchema + ".l_dmnhomxetnghiem add constraint fk_nhomxn_soxn foreign key(idsoxetnghiem) references " + sSchema + ".l_dmsoxetnghiem(idsoxetnghiem);\n";

            s_Sql += "create table " + sSchema + ".l_dmloaixetnghiem(idloaixetnghiem number(5),tenloaixetnghiem nvarchar2(154),maloaixetnghiem varchar2(10)," +
                "idnhomxetnghiem number(3),tenkhongdau varchar2(150)," +
                "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmloaixetnghiem add constraint pk_loaixn primary key(idloaixetnghiem);\n";
            s_Sql += "alter table " + sSchema + ".l_dmloaixetnghiem add constraint fk_loaixn_nhomxn foreign key(idnhomxetnghiem) references " + sSchema + ".l_dmnhomxetnghiem(idnhomxetnghiem);\n";

            s_Sql += "create table " + sSchema + ".l_dmxetnghiem(idxetnghiem number(7),tenxetnghiem nvarchar2(154),maxetnghiem varchar2(10),idloaixetnghiem number(5)," +
                "donvi nvarchar2(30),binhthuongnu varchar2(50),binhthuongnam varchar2(50),minnu number(10,5), maxnu number(10,5), minnam number(10,5)," +
                "maxnam number(10,5),stt number(7) default 1 not null,tenkhongdau varchar2(150)," +
                "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmxetnghiem add constraint pk_xn primary key(idxetnghiem);\n";
            s_Sql += "alter table " + sSchema + ".l_dmxetnghiem add constraint fk_xn_loaixn foreign key(idloaixetnghiem) references " + sSchema + ".l_dmloaixetnghiem(idloaixetnghiem);\n";

            s_Sql += "create table " + sSchema + ".l_dmvienphi(idvienphi number(7),idsoxetnghiem number(2),idgiavienphi number(6),tieuban number(3) default 0 not null," +
                "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmvienphi add constraint pk_vienphi primary key(idvienphi);\n";
            s_Sql += "alter table " + sSchema + ".l_dmvienphi add constraint fk_vp_soxn foreign key(idsoxetnghiem) references " + sSchema + ".l_dmsoxetnghiem(idsoxetnghiem);\n";
            s_Sql += "alter table " + sSchema + ".l_dmvienphi add constraint fk_vp_giavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";

            s_Sql += "create table " + sSchema + ".l_dmxetnghiemmap(idvienphi number(7),idxetnghiem number(7)," +
                "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmxetnghiemmap add constraint pk_xetnghiemmap primary key(idvienphi,idxetnghiem);\n";
            s_Sql += "alter table " + sSchema + ".l_dmxetnghiemmap add constraint fk_xnmap_xn foreign key(idxetnghiem) references " + sSchema + ".l_dmxetnghiem(idxetnghiem);\n";
            s_Sql += "alter table " + sSchema + ".l_dmxetnghiemmap add constraint fk_xnmap_vp foreign key(idvienphi) references " + sSchema + ".l_dmvienphi(idvienphi);\n";

            //linh 27/3/2014
            s_Sql += "create table " + sSchema + ".m_ylenhthuoc(idylenhthuoc number(30) default 0 not null,ngay date default sysdate not null, idkhoaphong number(3) default 0 not null," +
                "idtutruc number(3) default 0 not null,idphieu number(3) default 0 not null, trangthai number(1) default 0 not null, mmyy varchar2(4) not null," +
                "computer varchar2(50),ngayud date default sysdate,username varchar2(20)) " +
                " partition by list (mmyy)(partition m_ylenhthuoc_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_ylenhthuoc add constraint pk_m_ylenhthuoc primary key(idylenhthuoc);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuoc add constraint fk_ylenhthuoc_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuoc add constraint fk_ylenhthuoc_dmkhoaphong foreign key(idkhoaphong) references " + sSchema + ".m_dmkhoaphong (idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuoc add constraint fk_ylenhthuoc_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuoc add constraint fk_ylenhthuoc_dmphieu foreign key(idphieu) references " + sSchema + ".m_dmphieu (idphieu);\n";

            s_Sql += "create table " + sSchema + ".m_ylenhthuocds(idylenhthuocds number(30) default 0 not null,idylenhthuoc number(30) default 0 not null,maql number(30) default 0 not null," +
                "idkhoa number(30) default 0 not null,ghichu nvarchar2(154),songay number(2) default 0 not null, mmyy varchar2(4) not null," +
                "computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition m_ylenhthuocds_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocds add constraint pk_m_ylenhthuocds primary key(idylenhthuocds);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocds add constraint fk_ylenhthuocds_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocds add constraint fk_ylenhthuocds_ylenhthuoc foreign key(idylenhthuoc) references " + sSchema + ".m_ylenhthuoc(idylenhthuoc);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocds add constraint fk_ylenhthuocds_benhandt foreign key(maql) references " + sSchema + ".p_benhandt(maql);\n";

            s_Sql += "create table " + sSchema + ".m_ylenhthuocct(idylenhthuocds number(30) default 0 not null,stt number(3) default 1 not null,idbietduoc number(7) default 0 not null," +
                "madoituong number(2) default 2 not null,idkho number(3) default 0 not null,idnguon number(2) default 0 not null, soluongyeucau number(20,7) default 0 not null," +
                "soluongphat number(20,7) default 0 not null,cachdung nvarchar2(154), ghichu nvarchar2(154), mmyy varchar2(4) not null," +
                "computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition m_ylenhthuocct_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add constraint pk_m_ylenhthuocct primary key(idylenhthuocds,stt);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add constraint fk_ylenhthuocct_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add constraint fk_ylenhthuocct_ylenhthuocds foreign key(idylenhthuocds) references " + sSchema + ".m_ylenhthuocds(idylenhthuocds);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add constraint fk_ylenhthuocct_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add constraint fk_ylenhthuocct_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add constraint fk_ylenhthuocct_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add constraint fk_ylenhthuocct_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add constraint ck_ylenhthuocct_slyc check (soluongyeucau>0) enable;\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add constraint ck_ylenhthuocct_slphat_slyc check (soluongphat<=soluongyeucau) enable;\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add constraint ck_ylenhthuocct_slphat check (soluongphat>=0) enable;\n";

            s_Sql += "create table " + sSchema + ".m_thucxuattutruc(idylenhthuocds number(30) default 0 not null,stt number(3) default 1 not null,idtheodoi number(30) default 0 not null," +
                " madoituong number(3) default 2 not null,idkho number(3) default 0 not null, soluong number(15,7) default 0 not null," +
                " mmyy varchar2(4) not null,computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition m_thucxuattutruc_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_thucxuattutruc add constraint pk_m_thucxuattutruc primary key(idylenhthuocds,stt);\n";
            s_Sql += "alter table " + sSchema + ".m_thucxuattutruc add constraint fk_thucxuattutruc_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".m_thucxuattutruc add constraint fk_thucxuattutruc_ylenhthuocds foreign key(idylenhthuocds) references " + sSchema + ".m_ylenhthuocds(idylenhthuocds);\n";
            s_Sql += "alter table " + sSchema + ".m_thucxuattutruc add constraint fk_thucxuattutruc_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_thucxuattutruc add constraint fk_thucxuattutruc_dmdoituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong);\n";
            s_Sql += "alter table " + sSchema + ".m_thucxuattutruc add constraint fk_thucxuattutruc_theodoi foreign key(idtheodoi) references " + sSchema + ".m_theodoi(idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".m_thucxuattutruc add constraint ck_thucxuattutruc_soluong check (soluong>0) enable;\n";

            s_Sql += "create table " + sSchema + ".m_phieuduyet(idphieuduyet number(30) default 0 not null,ngay date default sysdate not null, idkhoaphong number(3) default 0 not null," +
                "idtutruc number(3) default 0 not null,idphieu number(3) default 0 not null, trangthai number(1) default 0 not null, mmyy varchar2(4) not null," +
                "noiphatsinh number(1) default 0,  computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition m_phieuduyet_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_phieuduyet add constraint pk_m_phieuduyet primary key(idphieuduyet);\n";
            s_Sql += "alter table " + sSchema + ".m_phieuduyet add constraint fk_phieuduyet_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".m_phieuduyet add constraint fk_phieuduyet_dmkp foreign key(idkhoaphong) references " + sSchema + ".m_dmkhoaphong (idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_phieuduyet add constraint fk_phieuduyet_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_phieuduyet add constraint fk_phieuduyet_dmphieu foreign key(idphieu) references " + sSchema + ".m_dmphieu (idphieu);\n";

            s_Sql += "create table " + sSchema + ".m_xuatnoiviends(idxuatnoiviends number(30) default 0 not null,idphieuduyet number(30) default 0 not null,maql number(30) default 0 not null," +
                "idkhoa number(30) default 0 not null,idylenhthuocds number(30) default 0 not null,ngayylenh date not null,ghichu nvarchar2(154), mmyy varchar2(4) not null," +
                "idktcao number(30) default 0 not null,computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition m_xuatnoiviends_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_xuatnoiviends add constraint pk_m_xuatnoiviends primary key(idxuatnoiviends);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoiviends add constraint fk_xuatnoiviends_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoiviends add constraint fk_xuatnoiviends_phieuduyet foreign key(idphieuduyet) references " + sSchema + ".m_phieuduyet(idphieuduyet);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoiviends add constraint fk_xuatnoiviends_ylenhthuocds foreign key(idylenhthuocds) references " + sSchema + ".m_ylenhthuocds(idylenhthuocds);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoiviends add constraint fk_xuatnoiviends_benhandt foreign key(maql) references " + sSchema + ".p_benhandt(maql);\n";

            s_Sql += "create table " + sSchema + ".m_xuatnoivienct(idxuatnoiviends number(30) default 0 not null,stt number(3) default 1 not null,idtheodoi number(30) default 0 not null," +
                " madoituong number(3) default 2 not null,idkho number(3) default 0 not null, soluong number(20,7) default 0 not null,cachdung nvarchar2(154), ghichu nvarchar2(154)," +
                " idktcao number(30) default 0 not null,mmyy varchar2(4) not null,computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition m_xuatnoivienct_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add constraint pk_m_xuatnoivienct primary key(idxuatnoiviends,stt);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add constraint fk_xuatnoivienct_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add constraint fk_xuatnoivienct_xuatnoiviends foreign key(idxuatnoiviends) references " + sSchema + ".m_xuatnoiviends(idxuatnoiviends);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add constraint fk_xuatnoivienct_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add constraint fk_xuatnoivienct_dmdoituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add constraint fk_xuatnoivienct_theodoi foreign key(idtheodoi) references " + sSchema + ".m_theodoi(idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add constraint ck_xuatnoivienct_soluong check (soluong>0) enable;\n";

            s_Sql += "create table " + sSchema + ".m_tienthuoc(idxuatnoiviends number(30) default 0 not null,stt number(3) default 1 not null,idbietduoc number(7) default 0 not null," +
                "madoituong number(3) default 2 not null,soluong number(15,7) default 0 not null,giaban number(24,8) default 0 not null," +
                "idttrv number(30) default 0 not null," +
                "mmyy varchar2(4) not null,computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition m_tienthuoc_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add constraint pk_m_tienthuoc primary key(idxuatnoiviends,stt);\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add constraint fk_tienthuoc_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add constraint fk_tienthuoc_xnvds foreign key(idxuatnoiviends) references " + sSchema + ".m_xuatnoiviends(idxuatnoiviends);\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add constraint fk_tienthuoc_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add constraint fk_tienthuoc_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong);\n";

            s_Sql += "create table " + sSchema + ".m_tontutrucchitiet(mmyy varchar2(4) not null,idkho number(3) default 0 not null,idtutruc number(3) not null,idtheodoi number(30) not null," +
                "soluongtondau number(24,8) default 0 not null,soluongnhap number(24,8) default 0 not null,soluongxuat number(24,8) default 0 not null," +
                "soluongkiemke number(24,8) default 0 not null,computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition m_tontutrucchitiet_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_tontutrucchitiet add constraint pk_m_tontutrucchitiet primary key(mmyy,idkho,idtutruc,idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".m_tontutrucchitiet add constraint fk_tontutrucchitiet_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_tontutrucchitiet add constraint fk_tontutrucchitiet_theodoi foreign key(idtheodoi) references " + sSchema + ".m_theodoi(idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".m_tontutrucchitiet add constraint fk_tontutrucchitiet_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_tontutrucchitiet add constraint ck_tontutrucchitiet_sln check (soluongnhap>=0) enable;\n";
            s_Sql += "alter table " + sSchema + ".m_tontutrucchitiet add constraint ck_tontutrucchitiet_slx check (soluongxuat>=0) enable;\n";
            s_Sql += "alter table " + sSchema + ".m_tontutrucchitiet add constraint ck_tontutrucchitiet_slkk check (soluongkiemke>=0) enable;\n";

            s_Sql += "create table " + sSchema + ".m_tontutructonghop(mmyy varchar2(4) not null,idkho number(2) not null,idtutruc number(3) not null,idbietduoc number(7) not null," +
                "idnguon number(3) not null,soluongtondau number(24,8) default 0 not null,soluongnhap number(24,8) default 0 not null,soluongxuat number(24,8) default 0 not null," +
                "soluongkiemke number(24,8) default 0 not null,computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition m_tontutructonghop_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_tontutructonghop add constraint pk_tontutructonghop primary key(mmyy,idkho,idtutruc,idbietduoc,idnguon);\n";
            s_Sql += "alter table " + sSchema + ".m_tontutructonghop add constraint fk_tontutructonghop_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_tontutructonghop add constraint fk_tontutructonghop_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon);\n ";
            s_Sql += "alter table " + sSchema + ".m_tontutructonghop add constraint fk_tontutructonghop_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_tontutructonghop add constraint fk_tontutructonghop_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_tontutructonghop add constraint ck_tontutructonghop_sln check (soluongnhap>=0) enable;\n";
            s_Sql += "alter table " + sSchema + ".m_tontutructonghop add constraint ck_tontutructonghop_slx check (soluongxuat>=0) enable;\n";
            s_Sql += "alter table " + sSchema + ".m_tontutructonghop add constraint ck_tontutructonghop_slkk check (soluongkiemke>=0) enable;\n";

            //linh 28/3/2014
            s_Sql += "alter table " + sSchema + ".p_dmuser add khoaphong varchar2(3000);\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add doituong varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add nhomkho varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add kho varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add nhomthuoc varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add duocthuhoi number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add duoctaosolieu number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add duocchuyensolieudutru number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add dmxuatkhac varchar2(100);\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add duocsuaphieunhap number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnuoc add ma varchar2(3);\n";

            //Cuong-24/03/2014 - đã sửa 02/04/2014
            s_Sql += "create table " + sSchema + ".m_nhapll(idnhap number(30) default 0, mmyy varchar2(4) not null, sophieu varchar2(20),  ngaynhap date, " +
                "sohoadon varchar2(254), ngayhoadon date, bienbankiemnhap varchar2(15), ngaykiem date, loai number(2) default 0 not null, " +
                "idkhoaphongduoc number(3,0) default 0 not null, nguoigiao nvarchar2(254), idnhacungcap number(5) default 0 not null, idkho number(3) default 0, " +
                "idnguon number(2) default 0 not null, no varchar2(254), co varchar2(10), paid number(1) default 0 not null, " +
                "lanin number(3) default 0 not null, computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate) " +
                " partition by list (mmyy)(partition m_nhapll_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_nhapll add constraint pk_m_nhapll primary key(idnhap);\n";
            s_Sql += "alter table " + sSchema + ".m_nhapll add constraint fk_nhapll_nhacungcap foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap);\n";
            s_Sql += "alter table " + sSchema + ".m_nhapll add constraint fk_nhapll_kho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_nhapll add constraint fk_nhapll_nguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon);\n";
            s_Sql += "alter table " + sSchema + ".m_nhapll add constraint fk_nhapll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //Cuong-24/03/2014
            s_Sql += "create table " + sSchema + ".m_nhapct(idnhap number(30) default 0, stt number(3) default 0 not null, mmyy varchar2(4) not null, " +
                "idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null, soluong1 number(30,8) default 0 not null, " +
                "soluong2 number(30,8) default 0 not null, tyle number(7,2) default 0 not null, computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate)" +
                " partition by list (mmyy)(partition m_nhapct_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_nhapct add constraint pk_m_nhapct primary key(idnhap,stt);\n";
            s_Sql += "alter table " + sSchema + ".m_nhapct add constraint fk_nhapct_nhapll foreign key(idnhap) references " + sSchema + ".m_nhapll(idnhap);\n";
            s_Sql += "alter table " + sSchema + ".m_nhapct add constraint fk_nhapct_theodoi foreign key(idtheodoi) references " + sSchema + ".m_theodoi(idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".m_nhapct add constraint fk_nhapct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            //thuy 01/04/2014
            s_Sql += "create table  " + sSchema + ".p_dmmucdodiung(id number(3) not null, ten nvarchar2(254),username varchar2(20)," +
                "ngayud date DEFAULT sysdate,DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmmucdodiung add CONSTRAINT pk_p_dmmucdodiung PRIMARY KEY (id);\n";

            s_Sql += "create table  " + sSchema + ".p_diungthuoc(mabn varchar2(14) not null, tenhoatchat nvarchar2(500)," +
                "idmucdo number(3) DEFAULT 0 not null,username varchar2(20),ngayud date DEFAULT sysdate," +
                "DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_diungthuoc add CONSTRAINT pk_p_diungthuoc PRIMARY KEY (mabn,tenhoatchat);\n";
            s_Sql += "alter table " + sSchema + ".p_diungthuoc add CONSTRAINT fk_p_diungthuoc_mucdodiung FOREIGN KEY(idmucdo) REFERENCES " + sSchema + ".p_dmmucdodiung(id);\n";
            s_Sql += "alter table " + sSchema + ".p_diungthuoc add CONSTRAINT fk_p_diungthuoc_dmbenhnhan FOREIGN KEY(mabn) REFERENCES " + sSchema + ".p_dmbenhnhan(mabn);\n";

            s_Sql += "create table  " + sSchema + ".p_dausinhton(id number(30)  DEFAULT 0 not null, maql number(30) default 0 not null," +
                "idkhoa number(30) DEFAULT 0 not null,mach number(5) default 0 not null,nhietdo number(7,2) default 0 not null ," +
                "huyetap varchar2(7),cannang number(7,2) default 0 not null, chieucao number(5) default 0 not null, " +
                "nhiptho number(5) default 0 not null, ngay date default sysdate,mabs varchar2(4),manv varchar2(4)," +
                "username varchar2(20),phong nvarchar2(20),giuong nvarchar2(20),ghichu nvarchar2(254),dienbien nvarchar2(254)," +
                "idylenhthuocds number(30) default 0 not null,ngayud date DEFAULT sysdate," +
                " DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_dausinhton_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_dausinhton add CONSTRAINT pk_p_dausinhton PRIMARY KEY (id);\n";
            s_Sql += "alter table " + sSchema + ".p_dausinhton add CONSTRAINT fk_p_dausinhton_benhandt FOREIGN KEY(maql) REFERENCES " + sSchema + ".p_benhandt(maql);\n";

            s_Sql += "create table  " + sSchema + ".p_benhmantinh(mabn varchar2(14) not null, ngay date default sysdate not null, chandoan nvarchar2(254)," +
                "maicd varchar2(10) DEFAULT 0 not null,ghichu nvarchar2(254),username varchar2(20),ngayud date DEFAULT sysdate," +
                "DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_benhmantinh_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_benhmantinh add CONSTRAINT pk_p_benhmantinh PRIMARY KEY (mabn,maicd);\n";
            s_Sql += "alter table " + sSchema + ".p_benhmantinh add CONSTRAINT fk_p_benhmantinh_dmbenhnhan FOREIGN KEY(mabn) REFERENCES " + sSchema + ".p_dmbenhnhan(mabn);\n";

            s_Sql += "create table  " + sSchema + ".p_benhtiensu(id number(30) default 0 not null, mabn varchar2(14) not null, ngay date default sysdate, chandoan nvarchar2(254)," +
                " maicd varchar2(10) DEFAULT 0 not null,ghichu nvarchar2(254),username varchar2(20),ngayud date DEFAULT sysdate," +
                " DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_benhtiensu_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_benhtiensu add CONSTRAINT pk_p_benhtiensu PRIMARY KEY (id);\n";
            s_Sql += "alter table " + sSchema + ".p_benhtiensu add CONSTRAINT fk_p_benhtiensu_dmbenhnhan FOREIGN KEY(mabn) REFERENCES " + sSchema + ".P_dmbenhnhan(mabn);\n";
            s_Sql += "alter table " + sSchema + ".p_benhtiensu add CONSTRAINT fk_p_benhtiensu_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";
            //Cuong-05/04/2014
            s_Sql += "create table " + sSchema + ".m_dmlydoxuat(idlydo number(2) default 0, tenlydo nvarchar2(254) , tenkhongdau varchar2(150), " +
                "computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmlydoxuat add constraint pk_m_dmlydoxuat primary key(idlydo);\n";
            s_Sql += "alter table " + sSchema + ".m_dmlydoxuat add constraint fk_dmlydoxuat_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_xuatll(idxuat number(30) default 0, mmyy varchar2(4) not null, sophieu varchar2(20),  ngay date not null, " +
                "loai number(2) default 0 not null,idkhoxuat number(3,0) default 0 not null, idkhonhap number(3,0) default 0 not null, idtutruc number(3) default 0 not null, " +
                "iddutrucap number(30) default 0 not null,lanin number(3) default 0 not null,idlydoxuat number(2) default 0 not null,ghichu nvarchar2(254), " +
                "computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate) " +
                " partition by list (mmyy)(partition m_xuatll_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_xuatll add constraint pk_m_xuatll primary key(idxuat);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatll add constraint fk_xuatll_dmkhoxuat foreign key(idkhoxuat) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatll add constraint fk_xuatll_dmkhonhap foreign key(idkhonhap) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatll add constraint fk_xuatll_dmkhoaphong foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatll add constraint fk_xuatll_dmlydoxuat foreign key(idlydoxuat) references " + sSchema + ".m_dmlydoxuat(idlydo);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatll add constraint fk_xuatll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_xuatct(idxuat number(30) default 0, stt number(3) default 0 not null, mmyy varchar2(4) not null, " +
                "idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null, " +
                "computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate) " +
                " partition by list (mmyy)(partition m_xuatct_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_xuatct add constraint pk_m_xuatct primary key(idxuat,stt);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatct add constraint fk_xuatct_theodoi foreign key(idtheodoi) references " + sSchema + ".m_theodoi(idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatct add constraint fk_xuatct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //end

            //linh 4/5/2014
            s_Sql += "alter table " + sSchema + ".l_dmsoxetnghiem add tenkhongdau varchar2(150);\n";
            s_Sql += "alter table " + sSchema + ".l_dmnhomxetnghiem add tenkhongdau varchar2(150);\n";
            s_Sql += "alter table " + sSchema + ".l_dmloaixetnghiem add tenkhongdau varchar2(150);\n";
            s_Sql += "alter table " + sSchema + ".l_dmxetnghiem add tenkhongdau varchar2(150);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".M_YLENHTHUOC ADD CONSTRAINT UK_YLENHTHUOC_ID UNIQUE (NGAY,IDKHOAPHONG,IDTUTRUC,IDPHIEU) ENABLE;\n";

            //linh 7/4/2014
            s_Sql += "alter table " + sSchema + ".m_dmkhoaphong add idkhoaphongbenhvien number(3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmkhoaphong add constraint fk_mdmkp_pdmkp foreign key(idkhoaphongbenhvien) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_dmphieu add idnhomkho number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmphieu add constraint fk_dmphieu_dmnhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter table " + sSchema + ".m_theodoi add vat number(3) default 0 not null;\n";

            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add solan number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add sovien number(5,2) default 0 not null;\n";

            //Tú:08/04/2014
            s_Sql += "create table " + sSchema + ".l_ketqua(idketqua number(30,0) default 0,sophieu number(30,0) default 0 not null,mabn varchar2(14)," +
                "maql number(30,0) default 0 not null,idkhoa number(30,0) default 0 not null,ngay date,idkhoaphong number(3) default 0 not null,mabschidinh varchar2(4)," +
                "loaibn number(1,0) default 0 not null,tinhtrang number(1,0) default 0 not null,maicd varchar2(10),chandoan nvarchar2(500)," +
                "madoituong number(2,0) default 0 not null,maktv varchar2(4),ngayra date,mabsdoc varchar2(4),ghichu nvarchar2(2000),nhanxet nvarchar2(2000)," +
                "ketluan nvarchar2(2000),denghi nvarchar2(2000),mabenhpham nvarchar2(254),stt varchar2(200),lanin number(3,0) default 0 not null," +
                "ngaylaymau date default sysdate,dalaymau number(1,0) default 0 not null,traketqua number(1,0) default 0 not null,id_khu number(1,0) default 0 not null," +
                "username varchar2(20),ngayud date default sysdate,computer varchar2(50),mainkey varchar2(15),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition l_ketqua_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14

            s_Sql += "alter table " + sSchema + ".l_ketqua add constraint pk_l_ketqua primary key(idketqua);\n" +
                //"alter table " + sSchema + ".l_ketqua add constraint fk_l_kq_dmbenhnhan foreign key(mabn) references " + sSchema + ".p_dmbenhnhan(mabn);\n" +
                "alter table " + sSchema + ".l_ketqua add constraint fk_l_kq_dmnhanvien_bschidinh foreign key(mabschidinh) references " + sSchema + ".p_dmnhanvien(manhanvien);\n" +
                "alter table " + sSchema + ".l_ketqua add constraint fk_l_kq_dmkhoaphongbenhvien foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n" +
                "alter table " + sSchema + ".l_ketqua add constraint fk_l_kq_dmdoituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong);\n";

            s_Sql += "create table " + sSchema + ".l_ketquachitiet(idketqua number(30,0) default 0,idxetnghiem number(7,0) default 0," +
                "idchidinh number(30,0) default 0 not null,idxuatnoivien number(30,0) default 0 not null,ketqua nvarchar2(2000),ketqua_ori nvarchar2(2000)," +
                "ghichu nvarchar2(2000),done number(1,0) default 0 not null,id_may number(5,0) default 0 not null,ketqua_hople number(1,0) default 0 not null," +
                "username varchar2(20),ngayud date default sysdate,computer varchar2(50),chaylai number(1,0) default 0 not null,lydochaylai nvarchar2(200)," +
                " ketquachaylai nvarchar2(2000),mmyy generated always as (to_char(ngayud,'MMyy')),mabschidinh varchar2(4),maicd varchar2(10),chandoan nvarchar2(254))" +//ThanhCuong - 01/04/2015
                " partition by list (mmyy)(partition l_ketquachitiet_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14

            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add constraint pk_l_ketquachitiet primary key(idketqua,idxetnghiem,idvienphi);\n" +
                "alter table " + sSchema + ".l_ketquachitiet add constraint fk_l_kqchitiet_l_dmxetnghiem foreign key(idxetnghiem) references " + sSchema + ".l_dmxetnghiem(idxetnghiem);\n" +
                "alter table " + sSchema + ".l_ketquachitiet add constraint fk_l_kqchitiet_l_ketqua foreign key(idketqua) references " + sSchema + ".l_ketqua(idketqua);\n" +
                "alter table " + sSchema + ".l_ketquachitiet add constraint fk_l_kqchitiet_b_chidinh foreign key(idchidinh) references " + sSchema + ".b_chidinh(id);\n";

            s_Sql += "alter table " + sSchema + ".p_dmuser add idsoxetnghiem varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".l_ketqua add username varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add username varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add computer varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".l_ketqua add computer varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".l_ketqua add constraint fk_l_kq_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add constraint fk_l_kqchitiet_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //end Tú
            //Thuy 10.04.2014
            s_Sql += "alter table " + sSchema + ".p_benhandt add lydodieutri nvarchar2(254) default ' ';\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add cholam nvarchar2(254);\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add sonha varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add thon nvarchar2(254);\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add matinhthanh varchar2(3) default '000';\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add maquanhuyen varchar2(5) default '00000';\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add maphuongxa varchar2(7) default '0000000';\n";
            //linh 10/4/2014
            s_Sql += "alter table " + sSchema + ".m_tondau add idtutruc number(3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_tondau add constraint fk_tondau_dmkp foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong);\n";
            //Thuy 10.04.2014
            s_Sql += "alter table " + sSchema + ".p_lienhe add maicdnoigioithieu varchar2(10);\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add chandoannoigioithieu nvarchar2(254);\n";
            //Thuy 14.04.2014
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add idnuoc number(5,0) default 0 not null;\n";
            s_Sql += "ALTER TABLE " + sSchema + ".P_DMBENHNHAN ADD CONSTRAINT FK_DMBENHNHAN_DMNUOC FOREIGN KEY (IDNUOC) REFERENCES " + sSchema + ".M_DMNUOC (IDNUOC) ENABLE;\n";
            //linh 17/4/14
            s_Sql += "alter table " + sSchema + ".m_ylenhthuoc add idphieuduyet varchar2(254);\n";
            //Tú 17/4/14
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add chenhlech number(1,0) default 0 not null;\n";
            //linh 17/4/14
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct drop constraint CK_YLENHTHUOCCT_SLPHAT_SLYC;\n";

            //Khuong 17/04/14
            s_Sql += "CREATE TABLE " + sSchema + ".r_ketquall(IDKETQUA NUMBER(30,0) DEFAULT 0,NGAY DATE DEFAULT sysdate,NGAYCHUP DATE DEFAULT sysdate,  " +
                "  MAQL NUMBER(30,0) DEFAULT 0  not null,LOAIBN NUMBER(1,0) DEFAULT 0,MABS VARCHAR2(4), MAKTV VARCHAR2(4), MAKTV1 VARCHAR2(4),  " +
                "  TINHTRANG NUMBER(2,0) DEFAULT 0,GHICHU NVARCHAR2(254), LANIN NUMBER(2,0) DEFAULT 0, MACANLAMSANG NUMBER(12,0) DEFAULT 0,  " +
                "  USERNAMECHUP VARCHAR2(20),COMPUTER VARCHAR2(50),USERNAME VARCHAR2(20), " +
                "  NGAYUD DATE DEFAULT sysdate,mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition r_ketquall_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14

            s_Sql += "alter table " + sSchema + ".r_ketquall add constraint pk_r_ketquall primary key(IDKETQUA);\n";

            s_Sql += "CREATE TABLE " + sSchema + ".R_KETQUACT (	IDKETQUA NUMBER(30,0) DEFAULT 0  not null,MAKT NUMBER(7,0) DEFAULT 0  not null,	SOLAN NUMBER(1,0) DEFAULT 0  not null," +
                "  DONGIA NUMBER(18,4) DEFAULT 0  not null,IDKHOA NUMBER(30,0) DEFAULT 0  not null,IDCHIDINH NUMBER(30,0) DEFAULT 0  not null,NGAYCHIDINH DATE DEFAULT sysdate," +
                "  TINHTRANGCHIDINH NUMBER(2,0) DEFAULT 0  not null, MABS VARCHAR2(4),MAKP NUMBER (3,0) DEFAULT 0  not null , MADOITUONG NUMBER(2,0) DEFAULT 0  not null, " +
                "  MAICD VARCHAR2(9),CHANDOAN NVARCHAR2(254), GHICHU NVARCHAR2(254),IDPTTT NUMBER(30,0) DEFAULT 0 not null," +
                "  IDXUATNOIVIENDS NUMBER(30,0) DEFAULT 0 not null,IDDUOC_TOA NUMBER(30,0) DEFAULT 0  not null,IDMAY NUMBER(3,0) DEFAULT 0 not null," +
                "  KYTHUAT NVARCHAR2(2000),MOTA NCLOB,KETLUAN NVARCHAR2(2000),DENGHI NVARCHAR2(1000),IDTTRV NUMBER(30,0) DEFAULT 0 not null," +
                "  IDCHIDINH_THEM VARCHAR2(200),NGAYUD DATE DEFAULT sysdate,KHONGTRALOIKETQUA NUMBER(1,0) DEFAULT 0 not null,mmyy generated always as (to_char(ngayud,'MMyy'))) " +
                " partition by list (mmyy)(partition R_KETQUACT_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14

            s_Sql += "alter table " + sSchema + ".r_ketquact add constraint pk_r_ketquact primary key(IDKETQUA,makt);\n";

            //Khuong 19/04/2014
            s_Sql += "alter table " + sSchema + ".r_dmloaicdha add constraint fk_dmloaicdha_dmkhoaphong foreign key(makp_duoc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".r_dmloaicdha add constraint fk_dmloaicdha_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "alter table " + sSchema + ".r_dmkythuat add constraint fk_dmkythuatcdha_dmloaicdha foreign key(idloaicdha) references " + sSchema + ".r_dmloaicdha(idloaicdha);\n";
            s_Sql += "alter table " + sSchema + ".r_dmkythuat add constraint fk_dmkythuatcdha_dmgiavp foreign key(idvp) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".r_dmkythuat add constraint fk_dmkythuatcdha_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".r_dmkythuat add constraint uk_r_dmkythuat_idvp unique(idvp);\n";

            s_Sql += "alter table " + sSchema + ".r_dmmaumota add constraint fk_dmmau_dmloaicdha foreign key(idloaicdha) references " + sSchema + ".r_dmloaicdha(idloaicdha);\n";
            s_Sql += "alter table " + sSchema + ".r_dmmaumota add constraint fk_dmmau_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".r_dmmaumota add constraint fk_dmmau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "alter table " + sSchema + ".r_dmmay add constraint fk_dmmay_dmloaicdha foreign key(idloaicdha) references " + sSchema + ".r_dmloaicdha(idloaicdha);\n";
            s_Sql += "alter table " + sSchema + ".r_dmmay add constraint fk_dmmay_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "alter table " + sSchema + ".r_ketquall add constraint fk_ketquall_benhandt foreign key(maql) references " + sSchema + ".p_benhandt(maql);\n";
            s_Sql += "alter table " + sSchema + ".r_ketquall add constraint fk_ketquall_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".r_ketquact add constraint fk_ketquall_ketquact foreign key(idketqua) references " + sSchema + ".r_ketquall(idketqua);\n";
            s_Sql += "alter table " + sSchema + ".r_ketquact add constraint fk_ketquact_chidinh foreign key(idchidinh) references " + sSchema + ".b_chidinh(id);\n";
            s_Sql += "alter table " + sSchema + ".r_ketquact add constraint fk_ketquact_dmkhoaphongbv foreign key(makp) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".r_ketquact add constraint fk_ketquact_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".r_ketquact add constraint fk_ketquact_dmmay foreign key(idmay) references " + sSchema + ".r_dmmay(idmay);\n";

            //Thuy 17/04/2014
            s_Sql += "alter table " + sSchema + ".p_lienhe add manghenghiep varchar2(3);\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add IDNUOC NUMBER(5,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add PHAI NUMBER(1,0) default 0 not null;\n";
            //linh 17/4/2014
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add huongthan number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add gaynghien number(1) default 0 not null;\n";

            //ThanhCuong - 20/04/2014
            s_Sql += "CREATE TABLE " + sSchema + ".p_toathuocll(idtoathuoc number(30) default 0, mmyy varchar2(4) not null, ngay DATE, maql NUMBER(30) DEFAULT 0 not null, " +
                "trangthai NUMBER(1) DEFAULT 0 not null, songay NUMBER(2) DEFAULT 0 not null, idduyet NUMBER(30) DEFAULT 0 not null, " +
                "idkhoaphong NUMBER(3), mabs varchar2(4), chandoan nvarchar2(254), maicd varchar2(10), lanin number(2) DEFAULT 0 not null, " +
                "idkythuatcao NUMBER(30) DEFAULT 0 not null, COMPUTER VARCHAR2(50)," +
                "USERNAME VARCHAR2(20), NGAYUD DATE DEFAULT sysdate)" +
                " partition by list (mmyy)(partition p_toathuocll_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_toathuocll add loidan nvarchar2(254);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocll add ghichu nvarchar2(254);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocll add idnhomphieu NUMBER(2,0) DEFAULT 0 not null;\n";//ThanhCuong - 23/04/2014
            s_Sql += "alter table " + sSchema + ".p_toathuocll add constraint pk_p_toathuocll primary key(idtoathuoc);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocll add constraint fk_toathuoc_benhandt foreign key(maql) references " + sSchema + ".p_benhandt(maql);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocll add constraint fk_toathuoc_khoaphong foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocll add constraint fk_toathuoc_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocll add constraint fk_toathuoc_dmnhomphieu foreign key(idnhomphieu) references " + sSchema + ".m_dmnhomphieu(idnhomphieu);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocll add constraint fk_toathuocll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "CREATE TABLE " + sSchema + ".p_toathuocct(idtoathuoc number(30) default 0, mmyy varchar2(4) not null, stt number(3) DEFAULT 0, madoituong number(2) default 0 not null, idbietduoc NUMBER(7) DEFAULT 0 not null, " +
                "idkho number(3) default 0 not null, soluongyeucau number(12,4) default 0 not null,soluongphat NUMBER(12,4) DEFAULT 0 not null, idnguon number(2) default 0 not null, " +
                "cachdung nvarchar2(254), sang character varying(10), trua character varying(10), chieu character varying(10), toi character varying(10), " +
                " ghichu nvarchar2(254), COMPUTER VARCHAR2(50),USERNAME VARCHAR2(20), NGAYUD DATE DEFAULT sysdate)" +
                " partition by list (mmyy)(partition p_toathuocct_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_toathuocct add songay NUMBER(2) DEFAULT 0 not null;\n";//ThanhCuong - 23/04/2014
            s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint pk_p_toathuocct primary key(idtoathuoc,stt);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint fk_toathuoc_doituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint fk_toathuocct_toathuocll foreign key(idtoathuoc) references " + sSchema + ".p_toathuocll(idtoathuoc);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint fk_toathuoc_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint fk_toathuoc_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint fk_toathuoc_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct add constraint fk_toathuocct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            //Tú:20/04/2014
            s_Sql += "create table " + sSchema + ".p_dmlydovaovien(idlydovaovien number(5,0),tenlydovaovien nvarchar2(200),username varchar2(20),ngayud date default sysdate,computer varchar(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmlydovaovien add constraint pk_dmlydovaovien primary key(idlydovaovien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmlydovaovien add constraint fk_dmlydovaovien_user foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add idlydodieutri number(5,0) default 0 not null;\n";
            //linh 19/4/14
            s_Sql += "alter table " + sSchema + ".m_ylenhthuoc add sophieu varchar2(20);\n";
            //Thuy 22/04/2014
            s_Sql += "alter table " + sSchema + ".p_benhandt modify para varchar2(11);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan modify parame varchar2(11);\n";
            //Thuy 23/4/14
            s_Sql += "create table  " + sSchema + ".b_tamungcd(id number(30)  DEFAULT 0 not null," +
                "maql number(30) DEFAULT 0 not null,  idkhoa number(30) DEFAULT 0 not null, idkhoaphong number(3) DEFAULT 0 not null, " +
                "ngay date default sysdate, madoituong number(2) DEFAULT 0 not null,loaibn number(2) DEFAULT 0 not null,idtamung number(30) default 0 not null," +
                "sotien number(15,4) DEFAULT 0 not null, done number(1) DEFAULT 0 not null,lan number(5) default 1 ," +
                "username varchar2(20), usernamenl varchar2(20), ngayud date DEFAULT sysdate, " +
                "DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition b_tamungcd_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_tamungcd add CONSTRAINT pk_b_tamungcd PRIMARY KEY (id);\n";
            s_Sql += "alter table " + sSchema + ".b_tamungcd add CONSTRAINT fk_b_tamungcd_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".b_tamungcd add CONSTRAINT fk_b_tamungcd_benhandt FOREIGN KEY(maql) REFERENCES " + sSchema + ".P_BENHANDT(maql);\n";
            s_Sql += "alter table " + sSchema + ".b_tamungcd add CONSTRAINT fk_b_tamungcd_dmdoituong FOREIGN KEY(madoituong) REFERENCES " + sSchema + ".p_dmdoituong(madoituong);\n";
            s_Sql += "alter table " + sSchema + ".b_tamungcd add CONSTRAINT fk_b_tamungcd_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table  " + sSchema + ".b_vienphi(idvienphi number(30)  DEFAULT 0 not null," +
                "maql number(30) DEFAULT 0 not null,  idkhoa number(30) DEFAULT 0 not null, idkhoaphong number(3) DEFAULT 0 not null, giuong varchar2(20)," +
                "ngayvao date not null, ngayra date not null, chandoan NVARCHAR2(254),maicd VARCHAR2(50), diemthu number(2) default 0 not null," +
                "loai number(2) default 0, idquyenso number(5) DEFAULT 0 not null, sobienlai number(10) default 0 not null," +
                "ngay date default sysdate, sotien number(15,4) DEFAULT 0 not null, sotientamung number(15,4) DEFAULT 0 not null," +
                "mien number(15,4) DEFAULT 0 not null,sotienbhyttra number(15,4) DEFAULT 0 not null, lanin number(2) DEFAULT 0 not null," +
                "idtonghop number(30) default 0 not null, chenhlech number(15,4) DEFAULT 0 not null,idquyensodv number(15,4) default 0 not null," +
                "sobienlaidv number(15,4) default 0 not null,username varchar2(20), usernamenl varchar2(20), miencs number(15,4) DEFAULT 0 not null," +
                "miendv number(15,4) DEFAULT 0 not null,miencs_ngaytt date,sophieu number(10) default 0 not null,ngayud date DEFAULT sysdate," +
                "DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50), mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition b_vienphi_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_vienphi add CONSTRAINT pk_b_vienphi PRIMARY KEY (idvienphi);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi add CONSTRAINT fk_b_vienphi_benhandt FOREIGN KEY(maql) REFERENCES " + sSchema + ".P_BENHANDT(maql);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi add CONSTRAINT fk_b_vienphi_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi add constraint fk_b_vienphi_dmquyenso foreign key(idquyenso) references " + sSchema + ".B_DMQUYENSO(idquyenso);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi add CONSTRAINT fk_b_vienphi_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";
            //linh 31/5/14  nếu có sửa đổi thì phải sửa cả table b_vienphictthuoc,b_vienphichuavuottra,b_thuocchuavuottran
            s_Sql += "create table  " + sSchema + ".b_vienphict(idvienphi number(30)  DEFAULT 0 not null, stt number(5) default 0 not null,ngay date default sysdate," +
                "idkhoaphong number(3) DEFAULT 0 not null, madoituong number(2) DEFAULT 0 not null," +
                "idgiavienphi number(7) default 0 not null,soluong number(15,4) default 0 not null," +
                "dongia number(15,4) default 0 not null, vat number(7,2) default 0 not null,sotien number(15,4) default 0 not null," +
                "sothe varchar2(20), giamua number(15,4) default 0 not null, tra number(15,4) default 0 not null," +
                "ngaytra date default sysdate,bhytduyet number(1) default 0 not null,bhyttra number(15,4),idtonghop number(30) default 0 not null," +
                "idkhoaphongthuchien number(3) default 0 not null, gia_bh number(15,4) default 0 not null, mien number(15,4) DEFAULT 0 not null," +
                "mabs varchar2(4),tylemien number(10,5) default 0 not null, ngayud date DEFAULT sysdate," +
                "DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition b_vienphict_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_vienphict add CONSTRAINT pk_b_vienphict PRIMARY KEY (idvienphi,stt);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict add CONSTRAINT fk_b_vienphict_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict add constraint fk_b_vienphict_dmdoituong foreign key (madoituong) references " + sSchema + ".P_DMDOITUONG(madoituong);\n";
            //s_Sql += "alter table " + sSchema + ".b_vienphict add constraint fk_b_vienphict_dmgiavienphi foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";//ThanhCuong - 02/10/2015
            s_Sql += "alter table " + sSchema + ".b_vienphict add constraint fk_b_vienphict_vienphi foreign key(idvienphi) references " + sSchema + ".b_vienphi(idvienphi);\n";
            //linh 23/4/14
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add stt number(2) default 0 not null;\n";
            //Tú:23/04/2014
            s_Sql += "alter table " + sSchema + ".p_dmxutri add phongluu number(1,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmxutri add ngoaitru number(1,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".l_ketqua add nguoilaymau varchar2(4);\n";

            //Thủy 24/04/2014
            s_Sql += "create table  " + sSchema + ".p_dmloaipttt(idloaipttt number(1) not null,tenloaipttt nvarchar2(254), username varchar2(20),ngayud date DEFAULT sysdate," +
            " DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmloaipttt add constraint pk_p_dmloaipttt primary key(idloaipttt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmloaipttt add constraint fk_p_dmloaipttt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table  " + sSchema + ".p_dmloainhompttt(idloainhompttt number(1) default 0 not null, tenloainhompttt nvarchar2(254), username varchar2(20),ngayud date DEFAULT sysdate," +
            " DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmloainhompttt add constraint pk_p_dmloainhompttt primary key(idloainhompttt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmloainhompttt add constraint fk_p_dmloainhompttt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table  " + sSchema + ".p_dmnhompttt(manhompttt varchar2(3),tennhompttt nvarchar2(254),idloainhompttt number(1) default 1 not null, username varchar2(20),ngayud date DEFAULT sysdate," +
            " DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhompttt add constraint pk_p_dmnhompttt primary key(manhompttt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhompttt add constraint fk_p_dmnhompttt_loainhompttt foreign key(idloainhompttt) references " + sSchema + ".p_dmloainhompttt(idloainhompttt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhompttt add constraint fk_p_dmnhompttt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table  " + sSchema + ".p_dmgaymegayte(idgaymegayte number(2) default 0 not null, tengaymegayte nvarchar2(254), username varchar2(20),ngayud date DEFAULT sysdate," +
            " DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmgaymegayte add constraint pk_p_dmgaymegayte primary key(idgaymegayte);\n";
            s_Sql += "alter table " + sSchema + ".p_dmgaymegayte add constraint fk_p_dmgaymegayte_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table  " + sSchema + ".p_dmphuongphappttt(maphuongphappttt varchar2(7) not null, tenphuongphappttt nvarchar2(254), " +
            " idloaipttt number(1) default 1 not null,manhompttt varchar2(3),idgiavienphi number(7,0) default 0 not null,username varchar2(20),ngayud date DEFAULT sysdate," +
            " DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add constraint pk_p_dmpttt primary key(maphuongphappttt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add constraint fk_p_dmpttt_dmgiavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add constraint fk_p_dmpttt_dmloaipttt foreign key(idloaipttt) references  " + sSchema + ".p_dmloaipttt(idloaipttt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add constraint fk_p_dmpttt_nhompttt foreign key(manhompttt) references " + sSchema + ".p_dmnhompttt(manhompttt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add constraint fk_p_dmpttt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //end Thủy
            //ThanhCuong - 25/04/2014
            s_Sql += "CREATE TABLE " + sSchema + ".m_duyetchiphi(idduyetchiphi number(30) default 0, mmyy varchar2(4) not null, ngay DATE default sysdate not null, maql NUMBER(30) DEFAULT 0 not null, " +
                "idquyenso number(5) default 0 not null, sobienlai number(10) default 0 not null,idkhoaphong number(3) default 0 not null," +
                "tongtienthuoc number(24,8) default 0 not null, tongtiencls number(24,8) default 0 not null, bntra number(24,8) default 0 not null, bhyttra number(24,8) default 0 not null," +
                "trangthai number(1) default 0 not null, idtonghop NUMBER(30) DEFAULT 0 not null, idkythuatcao NUMBER(30) DEFAULT 0 not null," +
                "idttrv NUMBER(30) DEFAULT 0 not null, COMPUTER VARCHAR2(50),USERNAME VARCHAR2(20), NGAYUD DATE DEFAULT sysdate)" +
                " partition by list (mmyy)(partition m_duyetchiphi_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add idnhomphieu NUMBER(2,0) DEFAULT 0 not null;\n";//ThanhCuong - 01/05/2014
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add constraint pk_m_duyetchiphi primary key(idduyetchiphi);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add constraint fk_duyetchiphi_benhandt foreign key(maql) references " + sSchema + ".p_benhandt(maql);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add constraint fk_duyetchiphi_khoaphong foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add constraint fk_duyetchiphi_dmnhomphieu foreign key(idnhomphieu) references " + sSchema + ".m_dmnhomphieu(idnhomphieu);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add constraint fk_duyetchiphi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "CREATE TABLE " + sSchema + ".m_duyetchiphithuoc(idduyetchiphi number(30) default 0, stt number(3) DEFAULT 0, mmyy varchar2(4), soluong NUMBER(12,4) DEFAULT 0 not null, " +
                "dongia number(12,4) default 0 not null, idtheodoi NUMBER(30) DEFAULT 0 not null, idkho number(3) default 0 not null, idtoathuoc NUMBER(30) DEFAULT 0 not null, " +
                "COMPUTER VARCHAR2(50),USERNAME VARCHAR2(20), NGAYUD DATE DEFAULT sysdate)" +
                " partition by list (mmyy)(partition m_duyetchiphithuoc_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add madoituong number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add constraint pk_m_duyetchiphithuoc primary key(idduyetchiphi,stt);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add constraint fk_duyetchiphithuoc_chiphi foreign key(idduyetchiphi) references " + sSchema + ".m_duyetchiphi(idduyetchiphi);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add constraint fk_duyetchiphithuoc_theodoi foreign key(idtheodoi) references " + sSchema + ".m_theodoi(idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add constraint fk_duyetchiphithuoc_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add constraint fk_duyetchiphithuoc_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "CREATE TABLE " + sSchema + ".m_duyetchiphicls(idduyetchiphi number(30) default 0, stt number(3) DEFAULT 0, mmyy varchar2(4), soluong NUMBER(12,4) DEFAULT 0 not null, " +
                "dongia number(12,4) default 0 not null, idgiavienphi NUMBER(7) DEFAULT 0 not null, idchidinh NUMBER(30) DEFAULT 0 not null, COMPUTER VARCHAR2(50)," +
                "USERNAME VARCHAR2(20), NGAYUD DATE DEFAULT sysdate)" +
                " partition by list (mmyy)(partition m_duyetchiphicls_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add madoituong number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add constraint pk_m_duyetchiphicls primary key(idduyetchiphi,stt);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add constraint fk_duyetchiphicls_chiphi foreign key(idduyetchiphi) references " + sSchema + ".m_duyetchiphi(idduyetchiphi);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add constraint fk_duyetchiphicls_dmvp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add constraint fk_duyetchiphicls_cd foreign key(idchidinh) references " + sSchema + ".b_chidinh(id);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add constraint fk_duyetchiphicls_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //End
            //linh 28/4/14
            s_Sql += " alter table " + sSchema + ".m_ylenhthuocct add idtheodoi number(30) default 0 not null;\n";//dành cho trường hợp hoàn trả
            //Tú:28/04/2014
            s_Sql += " create table " + sSchema + ".p_dmdiadiem(iddiadiem number(3,0) default 0,tendiadiem varchar2(50),stt number(3,0) default 0 not null,username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += " alter table " + sSchema + ".p_dmdiadiem add constraint pk_p_dmdiadiem primary key(iddiadiem);\n";
            s_Sql += " create table " + sSchema + ".p_dmbophan(idbophan number(1,0) default 0,tenbophan varchar2(50),stt number(5,0) default 0 not null,username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += " alter table " + sSchema + ".p_dmbophan add constraint pk_p_dmbophan primary key(idbophan);\n";
            s_Sql += " create table " + sSchema + ".p_dmnguyennhantainan(idnguyennhan number(2,0) default 0,tennguyennhan nvarchar2(254),stt number(3,0) default 0 not null,username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += " alter table " + sSchema + ".p_dmnguyennhantainan add constraint pk_p_dmnguyennhantainan primary key(idnguyennhan);\n";
            s_Sql += " create table " + sSchema + ".p_dmngodoc(idngodoc number(1,0) default 0,tenngodoc nvarchar2(50),stt number(3,0) default 0 not null,username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += " alter table " + sSchema + ".p_dmngodoc add constraint pk_p_dmngodoc primary key(idngodoc);\n";
            s_Sql += " create table " + sSchema + ".p_dmdienbien(iddienbien number(1,0) default 0,tendienbien nvarchar2(254),stt number(2,0) default 0 not null,username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += " alter table " + sSchema + ".p_dmdienbien add constraint pk_p_dmdienbien primary key(iddienbien);\n";
            s_Sql += " create table " + sSchema + ".p_dmxutritainan(idxutritainan number(1,0) default 0,tenxutritainan nvarchar2(254),stt number(2,0) default 0 not null,username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += " alter table " + sSchema + ".p_dmxutritainan add constraint pk_p_dmxutritainan primary key(idxutritainan);\n";
            s_Sql += " create table " + sSchema + ".p_tainanthuongtich(maql number(30,0) default 0,ngay date not null,iddiadiem number(1,0) default 0 not null,idbophan number(1,0) default 0 not null,idnguyennhan number(2,0) default 0 not null," +
                "idngodoc number(1,0) default 0 not null,iddienbien number(1,0) default 0 not null,idxutritainan number(1,0) default 0 not null,thon nvarchar2(254),matinhthanh varchar2(3)," +
                "maquanhuyen varchar2(5),maphuongxa varchar2(7),lydo nvarchar2(254),chandoan nvarchar2(254),dieutri nvarchar2(254),lucvao nvarchar2(254), " +
                "lucra nvarchar2(254),socap number(1,0) default 0,phuongtienvaovien nvarchar2(254),phuongtientainan nvarchar2(254),phuongtiengaytainan number(2,0) default 0 not null," +
                "phuongtiengaytainankhac nvarchar2(254),mubaohiem number(1,0) default 0 not null,gaiquai number(1,0) default 0 not null,bivo number(1,0) default 0 not null," +
                "loaimu nvarchar2(254),ruoubia number(1,0) default 0 not null,camquan number(1,0) default 0 not null,doconmau number(5,0) default 0 not null," +
                "doconhoitho number(5,0) default 0 not null,sonao number(1,0) default 0 not null,glassgow number(5,0) default 0 not null,cotsongco number(1,0) default 0 not null," +
                "chanthuongkhac number(1,0) default 0 not null,nhapvien number(1,0) default 0 not null,mocapcuu number(1,0) default 0 not null,tuvong number(1,0) default 0 not null," +
                "xinve number(1,0) default 0 not null,mabenhvien varchar2(10),manhanvien varchar2(4), " +
                "username varchar2(20),computer varchar2(50),ngayud date default sysdate,mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_tainanthuongtich_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += " alter table " + sSchema + ".p_tainanthuongtich add constraint pk_p_tainanthuongtich primary key(maql);\n";
            s_Sql += " alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmdiadiem foreign key(iddiadiem) references " + sSchema + ".p_dmdiadiem(iddiadiem);\n";
            s_Sql += " alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmbophan foreign key(idbophan) references " + sSchema + ".p_dmbophan(idbophan);\n";
            s_Sql += " alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmnguyennhantainan foreign key(idnguyennhan) references " + sSchema + ".p_dmnguyennhantainan(idnguyennhan);\n";
            s_Sql += " alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmngodoc foreign key(idngodoc) references " + sSchema + ".p_dmngodoc(idngodoc);\n";
            s_Sql += " alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmdienbien foreign key(iddienbien) references " + sSchema + ".p_dmdienbien(iddienbien);\n";
            s_Sql += " alter table " + sSchema + ".p_tainanthuongtich add constraint fk_p_tntt_dmxutritainan foreign key(idxutritainan) references " + sSchema + ".p_dmxutritainan(idxutritainan);\n";
            //linh 28/4/14
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add ngayylenh date;\n";//dành cho hoàn trả
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct modify ngayylenh date not null;\n";
            //linh 29/4/14
            s_Sql += "alter table " + sSchema + ".p_dmnguyennhantainan modify idnguyennhan number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_tainanthuongtich modify idnguyennhan number(2) default 0;\n";//Thuy 6/5/15 bỏ not null

            //Thuy 01/05/2014
            s_Sql += "create table  " + sSchema + ".p_dmmaupttt(mamaupttt varchar2(10) not null,tenmaupttt nvarchar2(254),maphuongphappttt VARCHAR2(7)," +
                "mabs varchar2(4),idkhoaphong number(3),noidung nvarchar2(254), idgiavienphi number(7), manvpt varchar2(4), manvphu1 varchar2(4), manvphu2 varchar2(4),manvgayme1 varchar2(4)," +
            "manvgayme2 varchar2(4), manvhoisuc varchar2(4), manvdungcu varchar2(4), manvphumo varchar2(4)," +
            "username varchar2(20),ngayud date DEFAULT sysdate,DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint pk_p_dmmaupttt primary key(mamaupttt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmgiavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmpppttt foreign key (maphuongphappttt) references " + sSchema + ".p_dmphuongphappttt(maphuongphappttt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmkhoaphongbv foreign key(idkhoaphong) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien1 foreign key(manvpt) references " + sSchema + ".P_DMNHANVIEN(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien2 foreign key (manvphu1) references " + sSchema + ".P_DMNHANVIEN(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien3 foreign key (manvphu2) references " + sSchema + ".P_DMNHANVIEN(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien4 foreign key (manvgayme1) references " + sSchema + ".P_DMNHANVIEN(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien5 foreign key (manvgayme2) references " + sSchema + ".P_DMNHANVIEN(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien6 foreign key (manvhoisuc) references " + sSchema + ".P_DMNHANVIEN(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien7 foreign key (manvdungcu) references " + sSchema + ".P_DMNHANVIEN(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmnhanvien8 foreign key (manvphumo) references " + sSchema + ".P_DMNHANVIEN(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add constraint fk_p_dmmaupttt_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table  " + sSchema + ".p_dmtinhhinhpt(idtinhhinhpt number(1) not null,tentinhhinhpt nvarchar2(254), " +
            "username varchar2(20),ngayud date DEFAULT sysdate,DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".P_DMTINHHINHPT add constraint pk_p_dmtinhhinhpt PRIMARY KEY (idtinhhinhpt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhhinhpt add CONSTRAINT fk_p_dmtinhhinhpt_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table  " + sSchema + ".p_dmtaibienpt(idtaibienpt number(1) not null,tentaibienpt nvarchar2(254)," +
            "username varchar2(20),ngayud date DEFAULT sysdate,DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmtaibienpt add CONSTRAINT pk_p_dmtaibienpt PRIMARY KEY (idtaibienpt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmtaibienpt add CONSTRAINT fk_p_dmtaibienpt_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table  " + sSchema + ".p_dmtuvongpt(idtuvongpt number(1) not null,tentuvongpt nvarchar2(254), " +
            "username varchar2(20),ngayud date DEFAULT sysdate,DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmtuvongpt add CONSTRAINT pk_p_dmtuvongpt PRIMARY KEY (idtuvongpt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmtuvongpt add CONSTRAINT fk_p_dmtuvongpt_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table  " + sSchema + ".p_dmphongmo(idphongmo number(2) not null,tenphongmo nvarchar2(254),idkhoaphong number(3)," +
            "username varchar2(20),ngayud date DEFAULT sysdate,DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmphongmo add CONSTRAINT pk_p_dmphongmo PRIMARY KEY (idphongmo);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphongmo add constraint fk_p_dmphongmo_dmkhoaphongbv foreign key (idkhoaphong) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphongmo add CONSTRAINT fk_p_dmphongmo_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".p_pttt(idpttt number(30) default 0 not null,maql number(30) default 0 not null,sophieu number(5) default 0 not null, " +
                " idkhoaphong number(3) default 0 not null,ngay date default sysdate,maicdtruoc varchar2(50),chandoantruoc nvarchar2(254),maicdsau varchar2(50), " +
                " chandoansau nvarchar2(254),maphuongphappttt varchar2(7),idgaymegayte number(2) default 0 not null,idtinhhinhpt number(1) default 0 not null, " +
                " maphauthuatvien varchar2(4),idtaibienpt number(1) default 0 not null,idtuvongpt number(1) default 0 not null,mamau varchar2(10),ngayketthuc " +
                " date default sysdate,manvphu1 varchar2(4),manvphu2 varchar2(4),manvgayme1 varchar2(4),manvgayme2 varchar2(4),manvhoisuc varchar2(4), " +
                " manvdungcu varchar2(4),noidungtuongtrinh nclob,phuongphapthucte nvarchar2(245), " +
                " idphongmo number(2) default 0 not null,somat number(1) default 0 not null,molaimienphi number(1) default 0 not null,idxuatnoivien " +
                " number(30) default 0 not null,idkhoa number(30) default 0 not null, " +
                " idgiavienphi number(7) default 0 not null,idloaipttt number(1) default 0 not null, " +
                " noisoi number(1) default 0 not null,idchidinh number(30) default 0 not null,ghichu nvarchar2(2000),lanin number(2)," +
                " username varchar2(20),ngayud date DEFAULT sysdate,DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_pttt_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_pttt add CONSTRAINT pk_p_pttt PRIMARY KEY (idpttt);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_benhandt foreign key (maql) references " + sSchema + ".p_benhandt(maql);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_khoaphongbv foreign key (idkhoaphong) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmgaymegayte foreign key (idgaymegayte) references  " + sSchema + ".P_DMGAYMEGAYTE(idgaymegayte);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmtinhhinhpt foreign key (idtinhhinhpt) references " + sSchema + ".P_DMTINHHINHPT(idtinhhinhpt);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmtaibienpt foreign key (idtaibienpt) references " + sSchema + ".P_DMTAIBIENPT(idtaibienpt);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmtuvongpt foreign key (idtuvongpt) references " + sSchema + ".P_DMTUVONGPT(idtuvongpt);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmphongmo foreign key (idphongmo) references " + sSchema + ".p_dmphongmo(idphongmo);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmgiavp foreign key (idgiavienphi) references " + sSchema + ".B_DMGIAVIENPHI(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmloaipttt foreign key (idloaipttt) references " + sSchema + ".p_dmloaipttt(idloaipttt);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien1 foreign key (maphauthuatvien) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien2 foreign key (manvphu1) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien3 foreign key (manvphu2) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien4 foreign key (manvgayme1) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien5 foreign key (manvgayme2) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien6 foreign key (manvhoisuc) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add constraint fk_p_pttt_dmnhanvien7 foreign key (manvdungcu) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add CONSTRAINT fk_p_pttt_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";
            //end Thủy
            //linh 29/4/14
            s_Sql += "alter table " + sSchema + ".p_dmnguyennhantainan modify idnguyennhan number(2) default 0;\n";//Thuy 6/5/15 bỏ not null
            s_Sql += "alter table " + sSchema + ".p_tainanthuongtich modify idnguyennhan number(2) default 0;\n";//Thuy 6/5/15 bỏ not null
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add ngayylenh date;\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct modify ngayylenh date not null;\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add ngayylenh date;\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc modify ngayylenh date not null;\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocll add mmyy varchar2(4);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct add mmyy varchar2(4);\n";
            //Tú: 01/05/2014
            s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add idkhoaphong number(3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add idkhoa number(30) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add madoituong number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add madoituong number(2) default 0 not null;\n";
            //Tú:05/05/2014
            s_Sql += "create table " + sSchema + ".p_dmnguyennhanchet(idnguyennhanchet number(1,0),tennguyennhanchet nvarchar2(254),username varchar2(20),computer varchar2(50)," +
                "ngayud date default sysdate not null);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnguyennhanchet add constraint pk_p_dmnguyennhanchet primary key(idnguyennhanchet);\n";
            s_Sql += "create table " + sSchema + ".p_dmtinhtranggpb(idtinhtranggpb number(1,0),tentinhtranggpb nvarchar2(254),username varchar2(20),computer varchar2(50)," +
                "ngayud date default sysdate not null);\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhtranggpb add constraint pk_p_dmtinhtranggpb primary key(idtinhtranggpb);\n";
            s_Sql += "create table " + sSchema + ".p_tuvong(maql number(30,0),ngaynhan date,ngaymo date,chandoan nvarchar2(254),maicd varchar2(10)," +
                "idnguyennhanchet number(1,0) default 0 not null,ghichu nvarchar2(254),idtinhtranggpb number(1,0) default 0 not null," +
                "khamtuthi number(1,0) default 0 not null,idkhoaphong number(3,0) default 0 not null,idkhoa number(30,0) default 0 not null," +
            "username varchar2(20),computer varchar2(50),ngayud date default sysdate not null);\n";
            s_Sql += "alter table " + sSchema + ".p_tuvong add constraint pk_p_tuvong primary key(maql);\n";
            s_Sql += "alter table " + sSchema + ".p_tuvong add constraint fk_p_tuvong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".p_tuvong add constraint fk_p_tuvong_dmnguyennhanchet foreign key(idnguyennhanchet) references " + sSchema + ".p_dmnguyennhanchet(idnguyennhanchet);\n";
            s_Sql += "alter table " + sSchema + ".p_tuvong add constraint fk_p_tuvong_dmtinhtranggpb foreign key(idtinhtranggpb) references " + sSchema + ".p_dmtinhtranggpb(idtinhtranggpb);\n";
            s_Sql += "alter table " + sSchema + ".p_tuvong add constraint fk_p_tuvong_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";

            //linh 5/5/14
            s_Sql += "create table " + sSchema + ".p_thongsothebhyt(id number(7),kitu varchar2(10),tuvitri number(2) default 0 not null,denvitri number(2) default 0 not null," +
                "bhyttra number(3),constraint pk_thongsobhyt primary key(id,kitu));\n";
            s_Sql += "alter table " + sSchema + ".p_tuvong add ngay date default sysdate not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmdoituong add loaigia number(1) default 0 not null;\n";

            //khuong 06/05/2014
            s_Sql += "create table " + sSchemaImage + ".r_hinhanh(idketqua number (30,0) default 0 not null, stt number (2,0) default 0 not null," +
                " hinhanh blob,  COMPUTER VARCHAR2(50),   USERNAME VARCHAR2(20),   NGAYUD DATE DEFAULT sysdate,mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition r_hinhanh_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchemaImage + ".r_hinhanh add constraint pk_r_hinhanh primary key(IDKETQUA,STT);\n";
            s_Sql += "grant references on " + sSchema + ".r_ketquall to " + sSchema + "_image;\n";
            s_Sql += "alter table " + sSchemaImage + ".r_hinhanh add constraint fk_hinhanh_ketquall foreign key(idketqua) references " + sSchema + ".r_ketquall(idketqua);\n";
            //ThanhCuong - 07/05/2014
            s_Sql += "alter table " + sSchema + ".m_nhapll add vat number(3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_nhapct add thanhtien number(24,4) default 0 not null;\n";
            //End
            //linh 9/5/14
            s_Sql += "alter table " + sSchema + ".b_dmnhomvienphibhyt add stt number(2) default 0 not null;\n";

            //Tú:12/05/2014
            s_Sql += " create table " + sSchema + ".p_dmbenhnhanhen(mabn varchar2(14),hobenhnhan nvarchar2(50) not null,chulotbenhnhan nvarchar2(100)," +
                     "tenbenhnhan nvarchar2(50) not null,ngaysinh date, namsinh number(4) default 0 not null, tuoi varchar2(4) not null," +
                     "phai number(1) default 0 not null,sonha varchar2(50),thon nvarchar2(254), cholam nvarchar2(254), matinhthanh varchar2(3) not null, " +
                     "maquanhuyen varchar2(5) not null,maphuongxa varchar2(7) not null,tenkhongdau nvarchar2(254), mmyy nvarchar2(254),dienthoai varchar2(20)," +
                     "didong varchar2(20),dienthoaicoquan varchar2(20),mail varchar2(254)," +
                     "username varchar2(50) default 0, ngayud date default sysdate, computer varchar2(50));\n";
            s_Sql += " alter table " + sSchema + ".p_dmbenhnhanhen add constraint pk_p_dmbenhnhanhen primary key(mabn);\n";
            s_Sql += " alter table " + sSchema + ".p_dmbenhnhanhen add constraint fk_dmbenhnhanhen_dmtinhthanh foreign key(matinhthanh) references " + sSchema + ".p_dmtinhthanh(matinhthanh);\n";
            s_Sql += " alter table " + sSchema + ".p_dmbenhnhanhen add constraint fk_dmbenhnhanhen_dmquanhuyen foreign key(maquanhuyen) references " + sSchema + ".p_dmquanhuyen(maquanhuyen);\n";
            s_Sql += " alter table " + sSchema + ".p_dmbenhnhanhen add constraint fk_dmbenhnhanhen_dmphuongxa foreign key(maphuongxa) references " + sSchema + ".p_dmphuongxa(maphuongxa);\n";

            s_Sql += " create table " + sSchema + ".p_lichhen(idlichhen number(30,0),macuochen varchar2(14),mabs varchar2(4),noihen nvarchar2(100),mabn varchar2(10)," +
                "idkhoaphong number(3),giobatdau varchar2(5),gioketthuc varchar2(5),ngay date default sysdate,ngaykham date default sysdate,noidung nvarchar2(250),slot number(3,0)," +
                "tinhtrang number(1,0) default 0,username varchar2(20),computer varchar2(50),ngayud date default sysdate,mmyy generated always as (to_char(ngay,'MMyy')))" +
                " partition by list (mmyy)(partition p_lichhen_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += " alter table " + sSchema + ".p_lichhen add constraint pk_p_lichhen primary key(idlichhen);\n";
            s_Sql += " alter table " + sSchema + ".p_lichhen add constraint un_p_lichhen unique(ngay,ngaykham,mabs,giobatdau) enable;\n";
            s_Sql += " alter table " + sSchema + ".p_lichhen add constraint fk_p_lichhen_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += " alter table " + sSchema + ".p_lichhen add constraint fk_p_lichhen_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += " alter table " + sSchema + ".p_lichhen add constraint fk_p_lichhen_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += " create table " + sSchema + ".p_lichlamviecbacsi(idlichlamviec number(30,0),mabs varchar2(4),giobatdau varchar2(5),gioketthuc varchar2(5),ngay date," +
                "noidung nvarchar2(254),slot number(3,0),username varchar2(20),computer varchar2(50),ngayud date default sysdate,mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_lichlamviecbacsi_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += " alter table " + sSchema + ".p_lichlamviecbacsi add constraint pk_p_lichlamviecbacsi primary key(idlichlamviec);\n";
            s_Sql += " alter table " + sSchema + ".p_lichlamviecbacsi add constraint un_p_lichlamviecbacsi unique(ngay,mabs,giobatdau) enable;\n";
            s_Sql += " alter table " + sSchema + ".p_lichlamviecbacsi add constraint fk_p_lichlv_dmnhanvien foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += " alter table " + sSchema + ".p_lichlamviecbacsi add constraint fk_p_lichlv_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            //linh 13/5/14
            s_Sql += "create table " + sSchema + ".m_sophieuduyet(mmyy varchar2(4), idphieuduyet number(30),idnhom number(3),sophieu number(5) default 0 not null,kihieu varchar2(20)," +
                " computer varchar2(50),username varchar2(20),ngayud date default sysdate)" +
                " partition by list (mmyy)(partition m_sophieuduyet_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += " alter table " + sSchema + ".m_sophieuduyet add constraint pk_m_sophieuduyet primary key(idphieuduyet,idnhom);\n";
            s_Sql += " alter table " + sSchema + ".m_sophieuduyet add constraint fk_m_sophieuduyet_phieuduyet foreign key(idphieuduyet) references " + sSchema + ".m_phieuduyet(idphieuduyet);\n";

            //Thuy 13/05/2014
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add kyrakhoa number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add kyravien number(1) default 0 not null;\n";

            s_Sql += "create table  " + sSchema + ".p_giayravien(maql number(30) default 0 not null,phuongphapdieutri nvarchar2(254)," +
                " loidanbacsi nVARCHAR2(254),manvkyravien varchar2(4),lanin number(2)," +
                " ketquagiaiphaubenhly nvarchar2(254), manhommau varchar2(3), rh varchar2(50), ngaytaikham date, taikham nvarchar2(254)," +
                " mabacsitaikham varchar2(4),chandoan nvarchar2(254),manvkyrakhoa varchar2(4),tinhtrangnguoibenhlucravien nvarchar2(254)," +
                " username varchar2(20),ngayud date DEFAULT sysdate,DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_giayravien_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14

            s_Sql += "alter table " + sSchema + ".p_giayravien add CONSTRAINT pk_p_giayravien PRIMARY KEY (maql);\n";
            s_Sql += "alter table " + sSchema + ".p_giayravien add constraint fk_p_giayravien_dmnhanvien1 foreign key (manvkyravien) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_giayravien add constraint fk_p_giayravien_dmnhommau foreign key (manhommau) references " + sSchema + ".p_dmnhommau(manhommau);\n";
            s_Sql += "alter table " + sSchema + ".p_giayravien add constraint fk_p_giayravien_dmnhanvien2 foreign key (mabacsitaikham) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_giayravien add constraint fk_p_giayravien_dmnhanvien3 foreign key (manvkyrakhoa) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_giayravien add CONSTRAINT fk_p_giayravien_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add sophieu varchar2(14) default 0 not null;\n";//ThanhCuong - 15/05/2014
            //Tú:14/05/2014
            s_Sql += "alter table " + sSchema + ".p_lichhen modify mabn varchar(14);\n";
            //Thuy 16/05/2014
            s_Sql += "alter table " + sSchema + ".p_dmnhommau modify tennhommau nvarchar2(100);\n";
            //ThanhCuong - 17/05/2014
            s_Sql += "alter table " + sSchema + ".m_xuatll add idnhacungcap number(5) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_xuatll add CONSTRAINT fk_m_xuatll_dmnhacungcap FOREIGN KEY(idnhacungcap) REFERENCES " + sSchema + ".m_dmnhacungcap(idnhacungcap);\n";
            //End
            //Tú:19/05/2014
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add idvienphi number(7,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add constraint pk_l_ketquachitiet primary key(idketqua,idxetnghiem,idvienphi);\n";
            //Thuy 19/05/2014
            s_Sql += "alter table " + sSchema + ".p_dausinhton add idpttt number(30) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_benhtiensu add loai number(1) default 0 not null;\n";
            //linh 19/5/14
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add idthesmartcard varchar2(40);\n";
            s_Sql += "update " + sSchema + ".p_dmbenhnhan set idthesmartcard=mabn where idthesmartcard is null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan modify idthesmartcard not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add constraint uk_dmnhannhan_idsmartcard unique(idthesmartcard);\n";
            //Tú:19/05/2014
            s_Sql += "create table " + sSchema + ".p_capmabenhnhan(mmyy varchar2(4),idkhoaphong number(3,0) default 0 not null,dauso number(1,0) default 0 not null," +
                     "giatri number(6,0) default 0 not null,username varchar2(20),computer varchar2(50),ngayud date default sysdate not null);\n";
            s_Sql += "alter table " + sSchema + ".p_capmabenhnhan add constraint pk_p_capmabenhnhan primary key(mmyy);\n";
            //Thuy 20/05/2014
            s_Sql += "alter table " + sSchema + ".p_xuatvien add idbenhtiensu number(30) default 0 not null;\n";
            //linh 22/5/14
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add idktcao number(30) default 0 not null;\n";
            //linh 23/5/14
            s_Sql += "create table " + sSchemaImage + ".p_dmbenhnhan_hinhanh ( mabn varchar2(14) not null, " +
                    " hinhanh blob,  COMPUTER VARCHAR2(50),   USERNAME VARCHAR2(20),   NGAYUD DATE DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchemaImage + ".p_dmbenhnhan_hinhanh add constraint pk_p_dmbenhnhan_hinhanh primary key(mabn);\n";
            s_Sql += "grant references on " + sSchema + ".p_dmbenhnhan to " + sSchemaImage + ";\n";
            //s_Sql += "alter table " + sSchemaImage + ".p_dmbenhnhan_hinhanh add constraint fk_dmbn_dmbenhnhan_hinhanh foreign key(mabn) references " + sSchema + ".p_dmbenhnhan(mabn);\n";
            s_Sql += "alter table " + sSchemaImage + ".p_dmbenhnhan_hinhanh drop constraint fk_dmbn_dmbenhnhan_hinhanh;\n";//ThanhCuong - 11/06/2015
            //Thuy 23/5/14
            s_Sql += "create table  " + sSchema + ".p_giaychuyenvien(maql number(30) default 0 not null,mabenhvien varchar2(10)," +
                "hangbv number(1,0),lamsang nvarchar2(1000), xetnghiem nvarchar2(1000), chandoan nvarchar2(500), thuoc nvarchar2(1000)," +
                "tinhtrang nvarchar2(500),lydochuyenvien nvarchar2(500),ngay date default sysdate,phuongtienvanchuyen nvarchar2(254)," +
                "nguoidua nvarchar2(500),lanin number(2) default 0,username varchar2(20),ngayud date DEFAULT sysdate,DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), " +
                "COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_giaychuyenvien_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add CONSTRAINT pk_p_giaychuyenvien PRIMARY KEY (maql);\n";
            s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add CONSTRAINT fk_p_giaychuyenvien_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username);\n";

            //Khuong 24/5/2014
            s_Sql += "alter table " + sSchemaImage + ".P_DMBENHNHAN_HINHANH add idhinhanh number(30) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaImage + ".P_DMBENHNHAN_HINHANH add stt number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaImage + ".P_DMBENHNHAN_HINHANH add loai number(3) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaImage + ".P_DMBENHNHAN_HINHANH add duongdan varchar(1024);\n";

            s_Sql += "alter table " + sSchemaImage + ".p_dmbenhnhan_hinhanh drop constraint pk_p_dmbenhnhan_hinhanh;\n";

            s_Sql += "alter table " + sSchemaImage + ".p_dmbenhnhan_hinhanh add constraint pk_p_dmbenhnhan_hinhanh primary key(mabn,loai,stt,idhinhanh);\n";

            s_Sql += "alter table " + sSchema + ".r_dmloaicdha add hinhdicom number(1) default 0 not null;\n";
            //linh 25/5/14
            s_Sql += "ALTER TABLE " + sSchema + ".P_DMBENHNHAN MODIFY (HOBENHNHAN NULL);\n";
            //linh 26/5/14
            s_Sql += "create table " + sSchema + ".s_dmchucnang(machucnang varchar2(50), tenchucnang nvarchar2(500),chucnangcha nvarchar2(500)," +
                "loaichucnang number(2) default 0 not null,benhvien number(1) default 0 not null);\n";
            s_Sql += "alter table " + sSchema + ".s_dmchucnang add computer varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".s_dmchucnang add ngayud date default sysdate not null;\n";
            s_Sql += "alter table " + sSchema + ".s_dmchucnang add username varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".s_dmchucnang add constraint pk_s_dmchucnang primary key(machucnang,loaichucnang);\n";
            s_Sql += "alter table " + sSchema + ".s_dmchucnang add constraint fk_s_dmchucnang_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".p_quyennguoidung(username varchar2(20),machucnang varchar2(50),loaichucnang number(2),computer varchar2(50)," +
                "ngayud date default sysdate,userphanquyen varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".p_quyennguoidung add constraint pk_p_quyennguoidung primary key(username,machucnang,loaichucnang);\n";
            s_Sql += "alter table " + sSchema + ".p_quyennguoidung add constraint fk_p_quyennguoidung_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".p_quyennguoidung add constraint fk_p_quyennguoidung_chucnang foreign key (machucnang,loaichucnang) references " + sSchema + ".s_dmchucnang(machucnang,loaichucnang);\n";
            s_Sql += "alter table " + sSchema + ".p_quyennguoidung add constraint fk_p_quyennguoidung_user foreign key (userphanquyen) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi modify bhyt_traituyen number(5,2) default 0;\n";
            //Thuy 26/5/14
            s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add sochuyenvien varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".p_giaychuyenvien modify sochuyenvien varchar2(50);\n";//ThanhCuong - 15/07/2015
            s_Sql += "alter table " + sSchema + ".m_xuatnoiviends drop column ngayylenh;\n";
            //ThanhCuong-27/05/2014
            s_Sql += "create table " + sSchema + ".m_sophieumau38(mabn varchar2(14),mavaovien number(30) default 0 not null, ngay date default sysdate not null, loaibenhan number(1) default 3 not null," +
                "sophieu number(12) default 0 not null, lanin number(5) default 1 not null,lydoinlai nvarchar2(254),lydohuy nvarchar2(254),computer varchar2(50)," +
                "ngayud date default sysdate not null,username varchar2(20),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                "partition by list (mmyy)(partition m_sophieumau38_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_sophieumau38 add mmyy varchar2(4);\n";
            s_Sql += "alter table " + sSchema + ".m_sophieumau38 add constraint pk_m_sophieumau38 primary key(mavaovien,ngay,loaibenhan);\n";
            s_Sql += "alter table " + sSchema + ".m_sophieumau38 add constraint fk_m_sophieumau38_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username);\n";
            //end
            //linh 28/5/14 nếu có sửa đổi thì phải sửa cả table b_vienphict,b_vienphichuavuottra,b_thuocchuavuottran
            s_Sql += "create table  " + sSchema + ".b_vienphictthuoc(idvienphi number(30)  DEFAULT 0 not null, stt number(5) default 0 not null,ngay date default sysdate," +
                "idkhoaphong number(3) DEFAULT 0 not null, madoituong number(2) DEFAULT 0 not null," +
                "idgiavienphi number(7) default 0 not null,soluong number(15,4) default 0 not null," +
                "dongia number(22,4) default 0 not null, vat number(7,2) default 0 not null,sotien number(22,4) default 0 not null," +
                "sothe varchar2(20), giamua number(22,4) default 0 not null, tra number(15,4) default 0 not null," +
                "ngaytra date default sysdate,bhytduyet number(1) default 0 not null,bhyttra number(15,4),idtonghop number(30) default 0 not null," +
                "idkhoaphongthuchien number(3) default 0 not null, gia_bh number(15,4) default 0 not null, mien number(15,4) DEFAULT 0 not null," +
                "mabs varchar2(4),tylemien number(5,2) default 0 not null, ngayud date DEFAULT sysdate," +
                "DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                "partition by list (mmyy)(partition b_vienphictthuoc_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add CONSTRAINT pk_vienphictthuoc PRIMARY KEY (idvienphi,stt);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add CONSTRAINT fk_vienphictthuoc_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add constraint fk_vienphictthuoc_dmdoituong foreign key (madoituong) references " + sSchema + ".P_DMDOITUONG(madoituong);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add constraint fk_vienphictthuoc_dmbd foreign key(idgiavienphi) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add constraint fk_vienphictthuoc_vienphi foreign key(idvienphi) references " + sSchema + ".b_vienphi(idvienphi);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add mabs varchar2(4);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict add username varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add username varchar2(20);\n";
            // nếu có sửa đổi thì phải sửa cả table b_vienphict,b_vienphictthuoc,b_thuocchuavuottran
            s_Sql += "create table  " + sSchema + ".b_vienphichuavuottran(idvienphi number(30)  DEFAULT 0 not null, stt number(5) default 0 not null,ngay date default sysdate," +
                "idkhoaphong number(3) DEFAULT 0 not null, madoituong number(2) DEFAULT 0 not null," +
                "idgiavienphi number(7) default 0 not null,soluong number(15,4) default 0 not null," +
                "dongia number(22,4) default 0 not null, vat number(7,2) default 0 not null,sotien number(22,4) default 0 not null," +
                "sothe varchar2(20), giamua number(22,4) default 0 not null, tra number(15,4) default 0 not null," +
                "ngaytra date default sysdate,bhytduyet number(1) default 0 not null,bhyttra number(15,4),idtonghop number(30) default 0 not null," +
                "idkhoaphongthuchien number(3) default 0 not null, gia_bh number(15,4) default 0 not null, mien number(15,4) DEFAULT 0 not null," +
                "mabs varchar2(4),tylemien number(5,2) default 0 not null,username varchar2(20), ngayud date DEFAULT sysdate," +
                "DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                "partition by list (mmyy)(partition b_vienphichuavuottran_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran add CONSTRAINT b_vienphicvt PRIMARY KEY (idvienphi,stt);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran add CONSTRAINT fk_vienphicvt_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran add constraint fk_vienphicvt_dmdt foreign key (madoituong) references " + sSchema + ".P_DMDOITUONG(madoituong);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran add constraint fk_vienphicvt_dmgiavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran add constraint fk_vienphicvt_vienphi foreign key(idvienphi) references " + sSchema + ".b_vienphi(idvienphi);\n";
            // nếu có sửa đổi thì phải sửa cả table b_vienphict,b_vienphictthuoc,b_vienphichuavuottran
            s_Sql += "create table  " + sSchema + ".b_thuocchuavuottran(idvienphi number(30)  DEFAULT 0 not null, stt number(5) default 0 not null,ngay date default sysdate," +
                "idkhoaphong number(3) DEFAULT 0 not null, madoituong number(2) DEFAULT 0 not null," +
                "idgiavienphi number(7) default 0 not null,soluong number(15,4) default 0 not null," +
                "dongia number(22,4) default 0 not null, vat number(7,2) default 0 not null,sotien number(22,4) default 0 not null," +
                "sothe varchar2(20), giamua number(22,4) default 0 not null, tra number(15,4) default 0 not null," +
                "ngaytra date default sysdate,bhytduyet number(1) default 0 not null,bhyttra number(15,4),idtonghop number(30) default 0 not null," +
                "idkhoaphongthuchien number(3) default 0 not null, gia_bh number(15,4) default 0 not null, mien number(15,4) DEFAULT 0 not null," +
                "mabs varchar2(4),tylemien number(5,2) default 0 not null,username varchar2(20), ngayud date DEFAULT sysdate," +
                "DONGBO VARCHAR2(100) DEFAULT lpad('0',100,'0'), COMPUTER VARCHAR2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                "partition by list (mmyy)(partition b_thuocchuavuottran_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran add CONSTRAINT b_thuoccvt PRIMARY KEY (idvienphi,stt);\n";
            s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran add CONSTRAINT fk_thuoccvt_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran add constraint fk_thuoccvt_dmdoituong foreign key (madoituong) references " + sSchema + ".P_DMDOITUONG(madoituong);\n";
            s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran add constraint fk_thuoccvt_dmbd foreign key(idgiavienphi) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran add constraint fk_thuoccvt_vienphi foreign key(idvienphi) references " + sSchema + ".b_vienphi(idvienphi);\n";
            //linh 2905/14
            s_Sql += "create table " + sSchema + ".s_useroption (username varchar2(20),loaioption number(3),val varchar2(50),userphanquyen varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".s_useroption add constraint pk_useroption primary key(username,loaioption);\n";
            s_Sql += "alter table " + sSchema + ".s_useroption add constraint fk_useroptiondmuser foreign key (username) references " + sSchema + ".p_dmuser(username);\n";
            //Tú:29/05/2014
            s_Sql += "create table " + sSchema + ".b_solienhoadon(id number(2),reportname varchar2(100),solien number(2,0) default 1 not null,noidung nvarchar2(2000));\n";
            s_Sql += "alter table " + sSchema + ".b_solienhoadon add constraint pk_b_solienhoadon primary key(id);\n";
            //linh 30/5/14
            s_Sql += "alter table " + sSchema + ".p_dmicd add tentienganh varchar2(500);\n";
            //linh 31/5/14
            s_Sql += "create table " + sSchema + ".p_nhomquyenloibhyt(idnhomquyenloi number(2),tennhomquyenloi nvarchar2(50),tuvitri number(2) default 0 not null," +
                "denvitri number(2) default 0 not null);\n";
            s_Sql += "alter table " + sSchema + ".p_nhomquyenloibhyt add constraint pk_p_nhomquyenloibhyt primary key(idnhomquyenloi);\n";
            s_Sql += "alter table " + sSchema + ".p_thongsothebhyt add nhomquyenloi number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_thongso add hide number(1) default 0 not null;\n";
            //Tú:04/06/2014
            s_Sql += "create table " + sSchema + ".l_dmviettat(idviettat number(5,0),maviettat varchar2(20),tenviettat nvarchar2(254)," +
                "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmviettat add constraint pk_l_dmviettat primary key(idviettat);\n";

            s_Sql += "create table " + sSchema + ".p_dmgoiygioitinh(id number(5,0),ten nvarchar2(100),idphai number(1,0) default 0,username varchar2(20)," +
                "computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmgoiygioitinh add constraint pk_p_dmgoiygioitinh primary key(id);\n";
            s_Sql += "alter table " + sSchema + ".p_dmgoiygioitinh add constraint fk_p_dmgoiygioitinh_dmphai foreign key(idphai) references " + sSchema + ".p_dmphai(idphai);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add nhanmaildutrumuahang number(1) default 0 not null;\n";//ThanhCuong-10/06/2014
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add nhanmailbaohettonkho number(1) default 0 not null;\n";//Thủy 11/06/2014
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add nhanmailbaohetdate number(1) default 0 not null;\n";//Thủy 11/06/2014
            //ThanhCuong-11/06/2014
            s_Sql += "CREATE TABLE " + sSchema + ".m_dutrumuall(iddutrumua number(30) default 0, mmyy varchar2(4) not null, sophieu NUMBER(12,0) DEFAULT 0 not null, ngay date default sysdate not null, sothang number(2) default 0 not null," +
                "ghichu nvarchar2(254), trangthai number(1) default 0 not null, COMPUTER VARCHAR2(50), USERNAME VARCHAR2(20), NGAYUD DATE DEFAULT sysdate)" +
                " partition by list (mmyy)(partition m_dutrumuall_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_dutrumuall add constraint pk_m_dutrumuall primary key(iddutrumua);\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuall add constraint fk_dutrumuall_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "CREATE TABLE " + sSchema + ".m_dutrumuact(iddutrumua number(30) default 0, mmyy varchar2(4) not null, idbietduoc number(7,0) default 0 not null, " +
                "soluongdutru number(30,8) default 0 not null,soluongduyet number(30,8) default 0 not null,idduyetdutrumua number(30) default 0 not null, " +
                "soluongxuat number(30,8) default 0 not null,soluongton number(30,8) default 0 not null," +
                "COMPUTER VARCHAR2(50), USERNAME VARCHAR2(20), NGAYUD DATE DEFAULT sysdate)" +
                " partition by list (mmyy)(partition m_dutrumuact_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_dutrumuact add constraint pk_m_dutrumuact primary key(iddutrumua,idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact add constraint fk_dutrumuact_dutrumuall foreign key(iddutrumua) references " + sSchema + ".m_dutrumuall(iddutrumua);\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact add constraint fk_dutrumuact_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact add constraint fk_dutrumuact_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_duyetdutrumuall(idduyetdutrumua number(30) default 0, mmyy varchar2(4) not null, sophieu varchar2(20), ngay date default sysdate not null, " +
                "ghichu nvarchar2(254),computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate)" +
                " partition by list (mmyy)(partition m_duyetdutrumuall_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_duyetdutrumuall add constraint pk_m_duyetdutrumuall primary key(idduyetdutrumua);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetdutrumuall add constraint fk_duyetdutrumuall_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_duyetdutrumuact(idduyetdutrumua number(30) default 0, stt number(5) default 0 not null, mmyy varchar2(4) not null, idbietduoc number(7,0) default 0 not null, " +
                "soluong number(30,8) default 0 not null,computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate)" +
                " partition by list (mmyy)(partition m_duyetdutrumuact_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".m_duyetdutrumuact add constraint pk_m_duyetdutrumuact primary key(idduyetdutrumua,stt);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetdutrumuact add constraint fk_duyetdutrumuact_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetdutrumuact add constraint fk_duyetdutrumuact_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan modify manghenghiepbo varchar2(3);\n";//Thuy 13/06/14
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan modify manghenghiepme varchar2(3);\n";
            //Tú:13/06/2014
            s_Sql += "alter table " + sSchema + ".b_vienphi add idhoantra number(30,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict add idhoantra number(30,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add idhoantra number(30,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_tamung add idhoantra number(30,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi add loaibn number(2,0) default 0 not null;\n";
            //ThanhCuong-16/06/2014 
            s_Sql += "alter table " + sSchema + ".m_nhapct add idduyetdutrumua number(30) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetdutrumuact add soluongnhap number(30,8) default 0 not null;\n";
            //Tú:17/06/2014
            s_Sql += "alter table " + sSchema + ".p_dmuser add loaibn varchar2(20);\n";
            s_Sql += "create table " + sSchema + ".p_thongsotylegiaban(id number(7,0),stt number(5,0),giamuatu number(20,4),giamuaden number(20,4),tyle number(5,2)," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_thongsotylegiaban add constraint pk_p_thongsotylegiaban primary key(id,stt);\n";
            s_Sql += "alter table " + sSchema + ".p_thongsotylegiaban add constraint fk_p_thongsotylegiaban_thongso foreign key(id) references " + sSchema + ".p_thongso(id);\n";

                #region ThanhCuong-18/06/2014-Kho máu
            s_Sql += "create table " + sSchema + ".bl_dmnguon(idnguon number(2,0) default 0, tennguon nvarchar2(254), tenkhongdau varchar2(150), " +
                "idnhomkho number(2) default -1 not null,computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate,idnhib number);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmnguon add constraint pk_bl_dmnguon primary key(idnguon);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmnguon add constraint fk_blnguonmau_dmnhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmnguon add constraint fk_blnguonmau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_dmnhomin(idnhomin number(2) default 0, tennhomin nvarchar2(254), tenkhongdau varchar2(150), idnhomkho number(2) default -1 not null " +
             ",computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate,idnhib number);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmnhomin add constraint pk_bl_dmnhomin primary key(idnhomin);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmnhomin add constraint fk_blmaunhomin_maunhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmnhomin add constraint fk_blmaunhomin_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_dmloaimau(idloai number(3) default 0, tenloai nvarchar2(254), tenkhongdau varchar2(150), idnhomkho number(2) default -1 not null " +
             ",nhom varchar2(3),computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate,idnhib number);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmloaimau add constraint pk_bl_dmloaimau primary key(idloai);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmloaimau add constraint fk_blloaimau_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmloaimau add constraint fk_blloaimau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_dmthetich(idthetich number(2) default 0, tenthetich nvarchar2(254), tenkhongdau varchar2(150), idnhomkho number(2) default -1 not null " +
            ",thetich number(5) default 0 not null,dvt nvarchar2(50),computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate,idnhib number);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmthetich add constraint pk_bl_dmthetich primary key(idthetich);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmthetich add constraint fk_blthetich_maunhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmthetich add constraint fk_blthetich_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_dmnhomrhd(idrhd number(2) default 0, tenrhd nvarchar2(254), tenkhongdau varchar2(150), " +
            "computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate,idnhib number);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmnhomrhd add constraint pk_bl_dmnhomrhd primary key(idrhd);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmnhomrhd add constraint fk_blnhomrhd_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_dmmau(idmau number(7,0) default 0, mamau varchar2(15), tenmau nvarchar2(254), tenkhongdau varchar2(150)," +
                "dang nvarchar2(254), idthetich number(2) default 0 not null, manhommau varchar2(3), " +
                "idloaimau number(3) default 0 not null, bhyt number(3) default 0 not null,dongia number(24,10) default 0 not null,idnhomin number(2) default 0 not null," +
                "hide number(1) default 0 not null, computer varchar2(50), username varchar2(20), ngayud DATE DEFAULT sysdate,idnhib number);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmmau add constraint pk_bl_dmmau primary key(idmau);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmmau add constraint fk_bldmmau_thetich foreign key(idthetich) references " + sSchema + ".bl_dmthetich(idthetich);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmmau add constraint fk_bldmmau_loaimau foreign key(idloaimau) references " + sSchema + ".bl_dmloaimau(idloai);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmmau add constraint fk_bldmmau_nhommau foreign key(manhommau) references " + sSchema + ".p_dmnhommau(manhommau);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmmau add constraint fk_bldmmau_maunhomin foreign key(idnhomin) references " + sSchema + ".bl_dmnhomin(idnhomin);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmmau add constraint fk_bldmmau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_dmnhacungcap(idnhacungcap number(5) default 0, manhacungcap varchar2(50), tennhacungcap nvarchar2(254), tenkhongdau varchar2(150)," +
            " dienthoai varchar2(50), diachi nvarchar2(254),computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate,idnhib number);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmnhacungcap add constraint pk_bl_dmnhacungcap primary key(idnhacungcap);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmnhacungcap add constraint fk_bldmnhacungcap_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_theodoi(mabichmau varchar2(20), idmau number(7) default 0 not null, idnguon number(2) default 0 not null, " +
                " ngaydieuche date not null, handung date not null, idnhacungcap number(5) default 0 not null,dongia number(12,4) default 0 not null, giaban number(12,4) default 0 not null, "+
                "khaiton number(1) default 0 not null, nguoicho nvarchar2(254), ngaylaymau date not null,nhiembenh number(1) default 0 not null, " +
                " computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate,idnhib number,mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition bl_theodoi_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += " alter table " + sSchema + ".bl_theodoi add constraint pk_bl_theodoi primary key(mabichmau);\n";
            s_Sql += " alter table " + sSchema + ".bl_theodoi add constraint fk_bltheodoi_dmmau foreign key(idmau) references " + sSchema + ".bl_dmmau(idmau);\n";
            s_Sql += " alter table " + sSchema + ".bl_theodoi add constraint fk_bltheodoi_dmnguon foreign key(idnguon) references " + sSchema + ".bl_dmnguon(idnguon);\n";
            s_Sql += " alter table " + sSchema + ".bl_theodoi add constraint fk_bltheodoi_dmnhacungcap foreign key(idnhacungcap) references " + sSchema + ".bl_dmnhacungcap(idnhacungcap);\n";
            s_Sql += " alter table " + sSchema + ".bl_theodoi add constraint fk_bltheodoi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_tonkhochitiet(mmyy varchar2(4) not null, idkho number(3) default 0, mabichmau varchar2(20), " +
                " soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                " soluongxuat number(30,8) default 0 not null, khoa number(1) default 0 not null, " +
                "computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate,idnhib number)" +
                " partition by list (mmyy)(partition bl_tonkhochitiet_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += " alter table " + sSchema + ".bl_tonkhochitiet add constraint pk_bl_tonkhochitiet primary key(mmyy,idkho,mabichmau);\n";
            s_Sql += " alter table " + sSchema + ".bl_tonkhochitiet add constraint fk_bltonkhochitiet_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += " alter table " + sSchema + ".bl_tonkhochitiet add constraint fk_bltonkhochitiet_theodoi foreign key(mabichmau) references " + sSchema + ".bl_theodoi(mabichmau);\n";
            s_Sql += " alter table " + sSchema + ".bl_tonkhochitiet add constraint fk_bltonkhochitiet_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_tonkhotonghop(mmyy varchar2(4) not null, idkho number(3) default 0, idmau number(7) default 0 not null, " +
                " idnguon number(2) default 0 not null, soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                " soluongxuat number(30,8) default 0 not null, soluongyeucau number(30,8) default 0 not null, " +
                " computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate,idnhib number)" +
                " partition by list (mmyy)(partition bl_tonkhotonghop_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += " alter table " + sSchema + ".bl_tonkhotonghop add constraint pk_bl_tonkhotonghop primary key(mmyy,idkho,idmau,idnguon);\n";
            s_Sql += " alter table " + sSchema + ".bl_tonkhotonghop add constraint fk_bltonkhotonghop_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += " alter table " + sSchema + ".bl_tonkhotonghop add constraint fk_bltonkhotonghop_dmmau foreign key(idmau) references " + sSchema + ".bl_dmmau(idmau);\n";
            s_Sql += " alter table " + sSchema + ".bl_tonkhotonghop add constraint fk_bltonkhotonghop_dmnguon foreign key(idnguon) references " + sSchema + ".bl_dmnguon(idnguon);\n";
            s_Sql += " alter table " + sSchema + ".bl_tonkhotonghop add constraint fk_bltonkhotonghop_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_tondau(mmyy varchar2(4) not null, idkho number(3) default 0, mabichmau varchar2(20), " +
                "soluong number(30,8) default 0 not null, computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate,idnhib number)" +
                "partition by list (mmyy)(partition bl_tondau_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += " alter table " + sSchema + ".bl_tondau add constraint pk_bl_tondau primary key(mmyy,idkho,mabichmau);\n";
            s_Sql += " alter table " + sSchema + ".bl_tondau add constraint fk_bltondau_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += " alter table " + sSchema + ".bl_tondau add constraint fk_bltondau_theodoi foreign key(mabichmau) references " + sSchema + ".bl_theodoi(mabichmau);\n";
            s_Sql += " alter table " + sSchema + ".bl_tondau add constraint fk_bltondau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_nhapll(idnhap number(30) default 0, mmyy varchar2(4) not null, sophieu varchar2(20), ngaynhap date, " +
                      " loai number(2) default 0 not null, idnhacungcap number(5) default 0 not null, idkho number(3) default 0, idnguon number(2) default 0,ghichu nvarchar2(254), computer varchar2(50)," +
                      "username varchar2(20), ngayud date DEFAULT sysdate,idnhib number);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_nhapll add constraint pk_bl_nhapll primary key(idnhap);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_nhapll add constraint fk_nhapll_nhacungcap foreign key(idnhacungcap) references " + sSchema + ".bl_dmnhacungcap(idnhacungcap);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_nhapll add constraint fk_nhapll_kho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_nhapll add constraint fk_nhapll_nguon foreign key(idnguon) references " + sSchema + ".bl_dmnguon(idnguon);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_nhapll add constraint fk_nhapll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_nhapct(idnhap number(30) default 0, stt number(3) default 0 not null, mmyy varchar2(4) not null, " +
              " mabichmau varchar2(20), soluong number(30,8) default 0 not null,ghichu nvarchar2(254), computer varchar2(50),username varchar2(20), " +
              "ngayud date DEFAULT sysdate,idnhib number);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_nhapct add constraint pk_bl_nhapct primary key(idnhap,stt);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_nhapct add constraint fk_nhapct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_xuatll(idxuat number(30) default 0, mmyy varchar2(4) not null, sophieu varchar2(20),  ngay date not null, " +
            "loai number(2) default 0 not null,idkhoxuat number(3,0) default 0 not null, idkhonhap number(3,0) default 0 not null, idlydoxuat number(2,0) default 0 not null, "+
                "idngoaivien number(5,0) default 0 not null, lanin number(3) default 0 not null,ghichu nvarchar2(254), " +
            "computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate,idnhib number) " +
            " partition by list (mmyy)(partition m_xuatll_0000 values('0000'));\n";
            s_Sql += "alter table " + sSchema + ".bl_xuatll add constraint pk_bl_xuatll primary key(idxuat);\n";
            s_Sql += "alter table " + sSchema + ".bl_xuatll add constraint fk_xuatll_dmkhoxuat foreign key(idkhoxuat) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".bl_xuatll add constraint fk_xuatll_dmkhonhap foreign key(idkhonhap) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".bl_xuatll add constraint fk_xuatll_dmlydoxuat foreign key(idlydoxuat) references " + sSchema + ".m_dmlydoxuat(idlydo);\n";
            s_Sql += "alter table " + sSchema + ".bl_xuatll add constraint fk_xuatll_dmngoaivien foreign key(idngoaivien) references " + sSchema + ".bl_dmngoaivien(idngoaivien);\n";
            s_Sql += "alter table " + sSchema + ".bl_xuatll add constraint fk_xuatll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_xuatct(idxuat number(30) default 0, stt number(3) default 0 not null, mmyy varchar2(4) not null, " +
                "mabichmau varchar2(20), soluong number(30,8) default 0 not null, computer varchar2(50),username varchar2(20), ngayud DATE DEFAULT sysdate,idnhib number) " +
                " partition by list (mmyy)(partition m_xuatct_0000 values('0000'));\n";
            s_Sql += "alter table " + sSchema + ".bl_xuatct add constraint pk_bl_xuatct primary key(idxuat,stt);\n";
            s_Sql += "alter table " + sSchema + ".bl_xuatct add constraint fk_xuatct_theodoi foreign key(mabichmau) references " + sSchema + ".bl_theodoi(mabichmau);\n";
            s_Sql += "alter table " + sSchema + ".bl_xuatct add constraint fk_xuatct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
                
            s_Sql += "create table " + sSchema + ".bl_khoasolieu(mmyy varchar2(4), done number(1) default 0 not null, " +
            " computer varchar2(50),username varchar2(20),ngayud date DEFAULT sysdate,idnhib number);\n";
            s_Sql += "alter table " + sSchema + ".bl_khoasolieu add constraint pk_bl_khoasolieu primary key(mmyy);\n";
                
            s_Sql += "create table " + sSchema + ".bl_dmngoaivien(idngoaivien number(5) default 0, tenngoaivien nvarchar2(254), tenkhongdau varchar2(150)" +
             ",computer varchar2(50),username varchar2(20),ngayud DATE DEFAULT sysdate,idnhib number);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmngoaivien add constraint pk_bl_dmngoaivien primary key(idngoaivien);\n";
            s_Sql += " alter table " + sSchema + ".bl_dmngoaivien add constraint fk_bldmngoaivien_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_ylenhmau(idylenhmau number(30) default 0 not null,ngay date default sysdate not null, idkhoaphong number(3) default 0 not null," +
                "idphieu number(3) default 0 not null, trangthai number(1) default 0 not null,idphieuduyet varchar2(254),sophieu varchar2(20), mmyy varchar2(4) not null," +
                "computer varchar2(50),ngayud date default sysdate,username varchar2(20)) " +
                " partition by list (mmyy)(partition bl_ylenhmau_0000 values('0000'));\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmau add constraint pk_bl_ylenhmau primary key(idylenhmau);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmau add constraint fk_ylenhmau_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmau add constraint fk_ylenhmau_dmkhoaphong foreign key(idkhoaphong) references " + sSchema + ".m_dmkhoaphong (idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmau add constraint fk_ylenhmau_dmphieu foreign key(idphieu) references " + sSchema + ".m_dmphieu (idphieu);\n";

            s_Sql += "create table " + sSchema + ".bl_ylenhmauds(idylenhmauds number(30) default 0 not null,idylenhmau number(30) default 0 not null,maql number(30) default 0 not null," +
                "idkhoa number(30) default 0 not null,solandatruyen number(3) default 0 not null,ghichu nvarchar2(254),taibien number(1) default 0 not null, mmyy varchar2(4) not null,computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition bl_ylenhmauds_0000 values('0000'));\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauds add constraint pk_bl_ylenhmauds primary key(idylenhmauds);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauds add constraint fk_ylenhmauds_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauds add constraint fk_ylenhmauds_ylenhmau foreign key(idylenhmau) references " + sSchema + ".bl_ylenhmau(idylenhmau);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauds add constraint fk_ylenhmauds_benhandt foreign key(maql) references " + sSchema + ".p_benhandt(maql);\n";

            s_Sql += "create table " + sSchema + ".bl_ylenhmauct(idylenhmauds number(30) default 0 not null,stt number(3) default 1 not null,idmau number(7) default 0 not null," +
                "madoituong number(2) default 2 not null,idkho number(3) default 0 not null,idnguon number(2) default 0 not null, soluongyeucau number(20,7) default 0 not null," +
                "soluongphat number(20,7) default 0 not null, ghichu nvarchar2(154), mmyy varchar2(4) not null," +
                "computer varchar2(50),ngayud date default sysdate,username varchar2(20),ngayylenh date not null, mabichmau varchar2(20),idkey number(30,0) default 0 not null)" +
                " partition by list (mmyy)(partition bl_ylenhmauct_0000 values('0000'));\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauct add constraint pk_bl_ylenhmauct primary key(idylenhmauds,stt);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauct add constraint fk_ylenhmauct_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauct add constraint fk_ylenhmauct_ylenhmauds foreign key(idylenhmauds) references " + sSchema + ".bl_ylenhmauds(idylenhmauds);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauct add constraint fk_ylenhmauct_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauct add constraint fk_ylenhmauct_dmnguon foreign key(idnguon) references " + sSchema + ".bl_dmnguon(idnguon);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauct add constraint fk_ylenhmauct_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauct add constraint fk_ylenhmauct_dmbd foreign key(idmau) references " + sSchema + ".bl_dmmau(idmau);\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauct add constraint ck_ylenhmauct_slyc check (soluongyeucau>0) enable;\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauct add constraint ck_ylenhmauct_slphat_slyc check (soluongphat<=soluongyeucau) enable;\n";
            s_Sql += "alter table " + sSchema + ".bl_ylenhmauct add constraint ck_ylenhmauct_slphat check (soluongphat>=0) enable;\n";

            s_Sql += "create table " + sSchema + ".bl_phieuduyet(idphieuduyet number(30) default 0 not null,ngay date default sysdate not null, idkhoaphong number(3) default 0 not null," +
                      " idnhomphieu number(2) default -1 not null, trangthai number(1) default 0 not null, lanin number(3) default 0 not null, mmyy varchar2(4) not null,  " +
                      " computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                      " partition by list (mmyy)(partition bl_phieuduyet_0000 values('0000'));\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyet add constraint pk_bl_phieuduyet primary key(idphieuduyet);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyet add constraint fk_phieuduyet_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyet add constraint fk_phieuduyet_dmkhoaphong foreign key(idkhoaphong) references " + sSchema + ".m_dmkhoaphong (idkhoaphong);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyet add constraint fk_phieuduyet_dmphieu foreign key(idphieu) references " + sSchema + ".m_dmphieu (idphieu);\n";

            s_Sql += "create table " + sSchema + ".bl_xuatnoiviends(idxuatnoiviends number(30) default 0 not null,idphieuduyet number(30) default 0 not null,maql number(30) default 0 not null, " +
                  " idkhoa number(30) default 0 not null,idylenhmauds number(30) default 0 not null,ngayylenh date not null,ghichu nvarchar2(254), mmyy varchar2(4) not null,  " +
                  " computer varchar2(50),ngayud date default sysdate,username varchar2(20))  " +
                  " partition by list (mmyy)(partition bl_xuatnoiviends_0000 values('0000'));\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoiviends add constraint pk_bl_xuatnoiviends primary key(idxuatnoiviends);\n";

            s_Sql += "create table " + sSchema + ".bl_xuatnoivienct(idxuatnoiviends number(30) default 0 not null,stt number(3) default 1 not null,mabichmau varchar2(20)," +
                  " madoituong number(3) default 2 not null,idkho number(3) default 0 not null, soluong number(20,7) default 0 not null, ghichu nvarchar2(254),mmyy varchar2(4) not null," +
                  "soluongdinhnhom number(3) default 0 not null,sophanungcheo number(3) default 0 not null,cheo1 nvarchar2(254),cheo2 nvarchar2(254),cheocoombs nvarchar2(254)," +
                  "dongia number(12,4) default 0 not null,idttrv number(30) default 0 not null,idmaugoc number(7) default 0 not null,tygiausd number(24,4) default 0 not null," +
                  "computer varchar2(50),ngayud date default sysdate,username varchar2(20),idkey number(30) default 0 not null) partition by list (mmyy)(partition bl_xuatnoivienct_0000 values('0000'));\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoivienct add constraint pk_bl_xuatnoivienct primary key(idxuatnoiviends,stt);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoivienct add constraint fk_xuatnoivienct_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoivienct add constraint fk_xuatnoivienct_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoivienct add constraint fk_xuatnoivienct_dmdoituong foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_xuatnoivienct add constraint ck_xuatnoivienct_soluong check (soluong>0);\n";

            s_Sql += "create table " + sSchema + ".bl_phieuduyetkho(idphieuduyet number(30) default 0, idkho number(3) default 0, trangthai number(1) default 0 not null,mmyy varchar2(4) not null, " +
                "ngayud date DEFAULT sysdate, computer varchar2(50),username varchar2(20));\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyetkho add constraint pk_m_phieuduyetkho primary key(idphieuduyet,idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyetkho add constraint fk_phieuduyetkho_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_phieuduyetkho add constraint fk_phieuduyetkho_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_dangduyet(idkhoaphong number(3,0),ngay date default sysdate not null," +
                 "username varchar2(20),computer varchar2(50),ngayud date default sysdate not null,idnhib number);\n";
            s_Sql += "alter table " + sSchema + ".bl_dangduyet add constraint pk_m_dangduyet primary key(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".bl_dangduyet add idnhib number;\n";
            s_Sql += "update  " + sSchema + ".bl_dangduyet set idnhib =rownum where idnhib is null;\n";

             s_Sql += "create table " + sSchema + ".bl_dmmautd(idmau number(7,0) default 0, idmautd number(7,0) default 0,soluong number(12,4) default 1 not null," +
                        " computer varchar2(50),username varchar2(20),ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_dmmautd add constraint pk_bl_dmmautd primary key(idmau,idmautd);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_dmmautd add constraint fk_dmmautd_dmmau foreign key(idmau) references " + sSchema + ".bl_dmmau(idmau);\n";
            s_Sql += "alter TABLE " + sSchema + ".bl_dmmautd add constraint fk_dmmautd_dmmau1 foreign key(idmautd) references " + sSchema + ".bl_dmmau(idmau);\n";
            s_Sql += "alter table " + sSchema + ".bl_dmmautd add constraint fk_dmmautd_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".bl_goikemtheo(idgoikemtheo number(7,0),tengoikemtheo nvarchar2(254),tenkhongdau varchar2(150),idloaimau number(3),noiphatsinh number(1) default 0 not null,"+
                "username varchar2(20),computer varchar2(50),ngayud date default sysdate,idnhib number);\n";
            s_Sql += "alter table " + sSchema + ".bl_goikemtheo add constraint pk_bl_goikemtheo primary key(idgoikemtheo,idloaimau,noiphatsinh);\n";
            s_Sql += "alter table " + sSchema + ".bl_goikemtheo add constraint fk_bl_goikemtheo_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "update  " + sSchema + ".bl_goikemtheo set idnhib =rownum where idnhib is null;\n";

            s_Sql += "create table " + sSchema + ".bl_goikemtheoct(idgoikemtheo number(7,0),idgiavienphi number(7,0),soluong number(12,4) default 0 not null,madoituong number(2,0) default 0 not null,idnguon number(2,0) default 0 not null," +
                                "gia_th number(14,3) default 0 not null,gia_bh number(14,3) default 0 not null,gia_cs number(14,3) default 0 not null,gia_dv number(14,3) default 0 not null," +
                                "gia_nn number(14,3) default 0 not null,gia_ksk number(14,3) default 0 not null,gia_vip number(14,3) default 0 not null,username varchar2(20)," +
                                     "computer varchar2(50),ngayud date default sysdate,idnhib number);\n";
            s_Sql += "alter table " + sSchema + ".bl_goikemtheoct add constraint pk_bl_goikemtheoct primary key(idgoikemtheo,idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".bl_goikemtheoct add constraint fk_bl_goikemtheoct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "update  " + sSchema + ".bl_goikemtheoct set idnhib =rownum where idnhib is null;\n";
                #endregion end kho máu

                #region ThanhCuong-18/06/2014-Trang Thiết Bị

            s_Sql += "create table " + sSchema + ".e_dmdang(iddang number(2) default 0, tendang nvarchar2(50), tenkhongdau varchar2(30),ngayud DATE DEFAULT sysdate," +
                "computer varchar2(50),username varchar2(20));\n";
            s_Sql += " alter table " + sSchema + ".e_dmdang add constraint pk_e_dmdang primary key(iddang);\n";
            s_Sql += " alter table " + sSchema + ".e_dmdang add constraint fk_TTBdang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".e_dmhang(idhang number(5) default 0, tenhang nvarchar2(254), tenkhongdau varchar2(150), idnhomkho number(2) default 0 not null," +
            " idnhomhang number(2) default 0 not null,computer varchar2(50),username varchar2(20),ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmhang add constraint pk_e_dmhang primary key(idhang);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmhang add constraint fk_TTBhang_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmhang add constraint fk_TTBhang_nhomhang foreign key(idnhomhang) references " + sSchema + ".m_dmnhomhang(idnhomhang);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmhang add constraint fk_TTBhang_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "drop TABLE " + sSchema + ".e_dmnhomttb cascade;\n";
            s_Sql += "create table " + sSchema + ".e_dmnhom(idnhom number(3) default 0, tennhom nvarchar2(254), tenkhongdau varchar2(150), idnhomkho number(2) default 0 not null," +
            " ngayud date DEFAULT sysdate,computer varchar2(50),username varchar2(20));\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmnhom add constraint pk_e_dmnhom primary key(idnhom);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmnhom add constraint fk_e_nhomttb_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmnhom add constraint fk_e_nhom_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".e_dmloai(idloai number(3) default 0, tenloai nvarchar2(254), tenkhongdau varchar2(150), idnhomkho number(2) default 0 not null," +
            " computer varchar2(50),username varchar2(20),ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmloai add constraint pk_e_dmloai primary key(idloai);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmloai add constraint fk_e_loai_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmloai add constraint fk_e_loai_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".e_dmttb(idttb number(7,0) default 0, mattb varchar2(15), tenttb nvarchar2(254), tenkhongdau varchar2(150)," +
            " dang nvarchar2(254), model varchar2(50), sohieu varchar2(50), idnhomttb number(1) default 1 not null, idnhom number(3) default 0 not null," +
            " idloai number(3) default 0 not null, idhang number(5) default 0 not null, idnuoc number(5) default 0 not null," +
            " idnhomkho number(2) default 0 not null, computer varchar2(50),username varchar2(20),ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint pk_e_dmttb primary key(idttb);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint fk_dmttb_hang foreign key(idhang) references " + sSchema + ".e_dmhang(idhang);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint fk_dmttb_loai foreign key(idloai) references " + sSchema + ".e_dmloai(idloai);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint fk_dmttb_nhomttb foreign key(idnhomttb) references " + sSchema + ".e_dmnhom(idnhom);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint fk_dmttb_nuoc foreign key(idnuoc) references " + sSchema + ".m_dmnuoc(idnuoc);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmttb add constraint fk_dmttb_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter table " + sSchema + ".e_dmttb add constraint fk_dmttb_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".e_dmnguon(idnguon number(2,0) default 0, tennguon nvarchar2(254), tenkhongdau varchar2(150), " +
            " idnhomkho number(2) default 0 not null,computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmnguon add constraint pk_e_dmnguon primary key(idnguon);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmnguon add constraint fk_ttbnguon_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".e_dmkho(idkho number(3,0) default 0, tenkho nvarchar2(254), tenkhongdau varchar2(150)," +
            " idnhomkho number(2) default 0 not null,khotrungtam number(1) default 0 not null,thua number(1) default 0 not null,chuyenkho number(1) default 0 not null," +
            "computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmkho add constraint pk_e_dmkho primary key(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmkho add constraint fk_ttbkho_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_dmkho add constraint fk_ttbkho_dmnhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";

            s_Sql += "create table " + sSchema + ".e_theodoi(idtheodoi number(30) default 0, mmyy varchar2(4) not null, idttb number(7) default 0 not null, idnguon number(2) default 0 not null," +
                " idhang number(5) default 0 not null, idnuoc number(5) default 0 not null, ngaysanxuat date, ngaysudung date, " +
                " ngaytinhkhauhao date, sohieu varchar2(50), soquyetdinh varchar2(50), idnhacungcap number(5) default 0 not null," +
                " giamua number(30,4) default 0 not null, nguyengia number(30,4) default 0 not null, tienchietkhau number(30,4) default 0 not null, tienvanchuyen number(30,4) default 0 not null, " +
                " chiphikhac number(30,4) default 0 not null, vat number(3) default 0 not null, phanbo number(3) default 0 not null, tylekhauhaothang number(10,4) default 0 not null," +
                " sotienkhauhaothang number(30,4) default 0 not null, tylekhauhaonam number(10,4) default 0 not null, sotienkhauhaonam number(30,4) default 0 not null, thoigiansudung number(3) default 0 not null, " +
                " giatriconlai number(30,4) default 0 not null, khaiton number(1) default 0 not null, " +
                " computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate)" +
                " partition by list (mmyy)(partition a_theodoi_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint pk_e_theodoi primary key(idtheodoi,mmyy);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmttb foreign key(idttb) references " + sSchema + ".e_dmttb(idttb);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmnguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmhang foreign key(idhang) references " + sSchema + ".e_dmhang(idhang);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmnuoc foreign key(idnuoc) references " + sSchema + ".m_dmnuoc(idnuoc);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmnhacungcap foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_theodoi add constraint fk_e_theodoi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".e_theodoi modify tylekhauhaothang number(10,4) default 0;\n";
            s_Sql += "alter table " + sSchema + ".e_theodoi modify tylekhauhaonam number(10,4) default 0;\n";

            s_Sql += "create table " + sSchema + ".e_tonkhochitiet(mmyy varchar2(4), idkho number(3) default 0, idtheodoi number(30) default 0 not null, " +
                " soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                " soluongxuat number(30,8) default 0 not null,  computer varchar2(50),username varchar2(20), " +
                " ngayud date DEFAULT sysdate)" +
                " partition by list (mmyy)(partition a_tonkhochitiet_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter TABLE " + sSchema + ".e_tonkhochitiet add constraint pk_e_tonkhochitiet primary key(mmyy,idkho,idtheodoi);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_tonkhochitiet add constraint fk_e_tonkhochitiet_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_tonkhochitiet add constraint fk_e_tonkhochitiet_theodoi foreign key(idtheodoi,mmyy) references " + sSchema + ".e_theodoi(idtheodoi,mmyy);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_tonkhochitiet add constraint fk_e_tonkhochitiet_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".e_tonkhotonghop(mmyy varchar2(4), idkho number(3) default 0, idttb number(7) default 0 not null, " +
                " idnguon number(2) default 0 not null, soluongtondau number(30,8) default 0 not null, soluongnhap number(30,8) default 0 not null, " +
                " soluongxuat number(30,8) default 0 not null, soluongyeucau number(30,8) default 0 not null," +
                " computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate)" +
                " partition by list (mmyy)(partition a_tonkhotonghop_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter TABLE " + sSchema + ".e_tonkhotonghop add constraint pk_e_tonkhotonghop primary key(mmyy,idkho,idttb,idnguon);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_tonkhotonghop add constraint fk_e_tonkhotonghop_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_tonkhotonghop add constraint fk_e_tonkhotonghop_dmttb foreign key(idttb) references " + sSchema + ".e_dmttb(idttb);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_tonkhotonghop add constraint fk_e_tonkhotonghop_dmnguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_tonkhotonghop add constraint fk_e_tonkhotonghop_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".e_tondau(mmyy varchar2(4), idkho number(3) default 0, idtutruc number(3) default 0, idtheodoi number(30) default 0 not null, " +
                " soluong number(30,8) default 0 not null, computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate)" +
                " partition by list (mmyy)(partition a_tondau_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".e_tondau add constraint pk_e_tondau primary key(mmyy,idkho,idtutruc,idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".e_tondau add constraint fk_e_tondau_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".e_tondau add constraint fk_e_tondau_theodoi foreign key(idtheodoi,mmyy) references " + sSchema + ".e_theodoi(idtheodoi,mmyy);\n";
            s_Sql += "alter table " + sSchema + ".e_tondau add constraint fk_e_tondau_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".e_tontutrucchitiet(mmyy varchar2(4) not null,idkho number(3) not null,idtutruc number(3) not null,idtheodoi number(30) not null,  " +
                " soluongtondau number(24,8) default 0 not null,soluongnhap number(24,8) default 0 not null,soluongxuat number(24,8) default 0 not null," +
                " computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition a_tontutrucchitiet_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add constraint pk_e_tontutrucchitiet primary key(mmyy,idkho,idtutruc,idtheodoi);\n";
            s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add constraint fk_e_tontutrucchitiet_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add constraint fk_e_tontutrucchitiet_theodoi foreign key(idtheodoi,mmyy) references " + sSchema + ".e_theodoi(idtheodoi,mmyy);\n";
            s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add constraint fk_e_tontutrucchitiet_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add constraint ck_e_tontutrucchitiet_sln check (soluongnhap>=0);\n";
            s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add constraint ck_e_tontutrucchitiet_slx check (soluongxuat>=0);\n";

            s_Sql += "create table " + sSchema + ".e_tontutructonghop(mmyy varchar2(4) not null,idkho number(2) not null,idtutruc number(3) not null,idttb number(7) not null, " +
                " idnguon number(3) not null,soluongtondau number(24,8) default 0 not null,soluongnhap number(24,8) default 0 not null,soluongxuat number(24,8) default 0 not null,  " +
                " computer varchar2(50),ngayud date default sysdate,username varchar2(20))" +
                " partition by list (mmyy)(partition a_tontutructonghop_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint pk_ttbtontutructonghop primary key(mmyy,idkho,idtutruc,idttb,idnguon);\n";
            s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint fk_e_tontutructonghop_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho);\n";
            s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint fk_e_tontutructonghop_dmnguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon);\n";
            s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint fk_e_tontutructonghop_dmttb foreign key(idttb) references " + sSchema + ".e_dmttb(idttb);\n";
            s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint fk_e_tontutructonghop_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint ck_e_tontutructonghop_sln check (soluongnhap>=0);\n";
            s_Sql += "alter table " + sSchema + ".e_tontutructonghop add constraint ck_e_tontutructonghop_slx check (soluongxuat>=0);\n";

            s_Sql += "create table " + sSchema + ".e_nhapll(idnhap number(30) default 0, mmyy varchar2(4) not null, sophieu varchar2(20),  ngaynhap date DEFAULT sysdate not null, " +
                " sohoadon varchar2(254), ngayhoadon date, loai number(2) default 0 not null, idkhoaphongduoc number(3,0) default 0 not null, idnhacungcap number(5) default 0 not null, idkho number(3) default 0,   " +
                " idnguon number(2) default 0 not null, paid number(1) default 0 not null, lanin number(3) default 0 not null, idnhomttb number(3) default 0 not null, computer varchar2(50),username varchar2(20), " +
                " ngayud date DEFAULT sysdate)" +
                " partition by list (mmyy)(partition a_nhapll_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint pk_e_nhapll primary key(idnhap);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint fk_e_nhapll_nhacungcap foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint fk_e_nhapll_kho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint fk_e_nhapll_khoaphong foreign key(idkhoaphongduoc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint fk_e_nhapll_nguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint fk_e_nhapll_nhomttb foreign key(idnhomttb) references " + sSchema + ".e_dmnhom(idnhom);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_nhapll add constraint fk_e_nhapll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".e_nhapct(idnhap number(30) default 0, stt number(3) default 0 not null, mmyy varchar2(4) not null, " +
                " idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null, computer varchar2(50),username varchar2(20), " +
                " ngayud date DEFAULT sysdate)" +
                " partition by list (mmyy)(partition a_nhapct_0000 values('0000'));\n";//linh 1/7/14
            s_Sql += "alter TABLE " + sSchema + ".e_nhapct add constraint pk_e_nhapct primary key(idnhap,stt);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_nhapct add constraint fk_e_nhapct_nhapll foreign key(idnhap) references " + sSchema + ".e_nhapll(idnhap);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_nhapct add constraint fk_e_nhapct_theodoi foreign key(idtheodoi,mmyy) references " + sSchema + ".e_theodoi(idtheodoi,mmyy);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_nhapct add constraint fk_e_nhapct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".e_xuatll(idxuat number(30) default 0, mmyy varchar2(4) not null, sophieu varchar2(20),  ngay date not null,  " +
              " loai number(2) default 0 not null,idkhoxuat number(3,0) default 0 not null, idkhonhap number(3,0) default 0 not null, idtutruc number(3) default 0 not null,  " +
              " idnhomttb number(3) default 0 not null,lanin number(3) default 0 not null,ghichu nvarchar2(500),computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate)" +
                ";\n";
            s_Sql += "alter TABLE " + sSchema + ".e_xuatll add constraint pk_e_xuatll primary key(idxuat);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_xuatll add constraint fk_ttbxuatll_dmkhoxuat foreign key(idkhoxuat) references " + sSchema + ".e_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_xuatll add constraint fk_ttbxuatll_dmkhonhap foreign key(idkhonhap) references " + sSchema + ".e_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_xuatll add constraint fk_ttbxuatll_dmkhoaphong foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_xuatll add constraint fk_ttbxuatll_nhomttb foreign key(idnhomttb) references " + sSchema + ".e_dmnhom(idnhom);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_xuatll add constraint fk_ttbxuatll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".e_xuatct(idxuat number(30) default 0, stt number(3) default 0 not null, mmyy varchar2(4) not null, " +
              " idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null, " +
              " computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".e_xuatct add constraint pk_e_xuatct primary key(idxuat,stt);\n";

                #endregion end Trang Thiết Bị

            //Tú:23/06/2014
            s_Sql += "create table " + sSchema + ".p_dmloaiphong(idloaiphong number(2,0) default 0,stt number(2,0) default 0,maloaiphong varchar2(10)," +
                     "tenloaiphong nvarchar2(254),username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmloaiphong add constraint pk_p_dmloaiphong primary key(idloaiphong);\n";
            s_Sql += "alter table " + sSchema + ".p_dmloaiphong add constraint fk_p_dmloaiphong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".p_dmphong(idphong number(5,0),stt number(5,0) default 0,idkhoaphong number(3,0) default 0,maphong varchar2(10)," +
                     "tenphong nvarchar2(254),idloaiphong number(2,0) default 0,idloaivienphi number(3,0),dichvu number(1,0) default 0,username varchar2(20)," +
                     "computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphong add constraint pk_p_dmphong primary key(idphong);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphong add constraint fk_p_dmphong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphong add constraint fk_p_dmphong_dmkpbenhvien foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphong add constraint fk_p_dmphong_dmloaiphong foreign key(idloaiphong) references " + sSchema + ".p_dmloaiphong(idloaiphong);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphong add constraint fk_p_dmphong_dmloaivienphi foreign key(idloaivienphi) references " + sSchema + ".b_dmloaivienphi(idloaivienphi);\n";

            s_Sql += "create table " + sSchema + ".p_dmgiuong(idgiuong number(7,0),stt number(7,0) default 0,idphong number(5,0) default 0,magiuong varchar2(20)," +
                     "tengiuong nvarchar2(254),bhyt number(7,2) default 0,gia_th number(10,0) default 0,gia_bh number(10,0) default 0,gia_cs number(10,0) default 0," +
                     "gia_dv number(10,0) default 0,gia_nn number(12,2) default 0,soluong number(3,0) default 0,gia_ksk number(10,0) default 0," +
                     "gia_vip number(10,0) default 0,tinhtrang number(1,0) default 0,username varchar2(20),computer varchar2(50),ngayud date default sysdate," +
                     "block number(7,0) default 0);\n";
            s_Sql += "alter table " + sSchema + ".p_dmgiuong add constraint pk_p_dmgiuong primary key(idgiuong);\n";
            s_Sql += "alter table " + sSchema + ".p_dmgiuong add constraint fk_p_dmgiuong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".p_dmgiuong add constraint fk_p_dmgiuong_dmphong foreign key(idphong) references " + sSchema + ".p_dmphong(idphong);\n";
            s_Sql += "alter table " + sSchema + ".p_dmgiuong add constraint fk_p_dmgiuong_dmgiavienphi foreign key(idgiuong) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";

            s_Sql += "create table " + sSchema + ".p_theodoigiuong(idtheodoigiuong number(30,0),idkhoaphong number(3,0)," +
                " maql number(30,0) default 0,idkhoa number(30,0) default 0,madoituong number(2,0) default 0,idgiuong number(7,0) default 0,tungay date," +
                " denngay date,soluong number(20,2) default 0,dongia number(12,2) default 0,username varchar2(20),computer varchar2(50)," +
                " ngayud date default sysdate,mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_theodoigiuong_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_theodoigiuong add constraint fk_p_theodoigiuong_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".p_theodoigiuong add constraint fk_p_theodoigiuong_dmgiuong foreign key(idgiuong) references " + sSchema + ".p_dmgiuong(idgiuong);\n";
            s_Sql += "alter table " + sSchema + ".p_theodoigiuong add constraint fk_p_theodoigiuong_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            //linh 25/6/14
            s_Sql += "alter table " + sSchema + ".b_dmnhomvienphi add manhomvienphi varchar2(10);\n";
            s_Sql += "update " + sSchema + ".b_dmnhomvienphi set manhomvienphi=to_char(idnhomvienphi) where manhomvienphi is null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi modify mavp varchar2(10);\n";
            //Tú:27/06/2014
            s_Sql += "alter table " + sSchema + ".p_theodoigiuong modify soluong number(20,0);\n";
            s_Sql += "alter table " + sSchema + ".p_theodoigiuong add idchidinh number(30,0);\n";
            //Tú:30/06/2014
            s_Sql += "alter table " + sSchema + ".r_dmkythuat modify makt varchar2(10);\n";
            //Thuy 3/7/14
            s_Sql += "create table " + sSchema + ".p_dmchucnangekipmo" +
            "( " +
            "idchucnang number(2) NOT NULL, " +
            "tenchucnang varchar2(100)," +
            "username varchar2(20)," +
            "ngayud date DEFAULT sysdate," +
            "dongbo varchar2(100) default lpad('0',100,'0')," +
            "computer varchar2(50)" +
            ");\n";
            s_Sql += "alter table " + sSchema + ".p_dmchucnangekipmo add CONSTRAINT pk_p_dmchucnangekipmo PRIMARY KEY (idchucnang);\n";
            s_Sql += "alter table " + sSchema + ".p_dmchucnangekipmo add CONSTRAINT fk_p_dmchucnangekipmo_dmuser FOREIGN KEY (username) REFERENCES " + sSchema + ".p_dmuser (username);\n";

            s_Sql += "create table " + sSchema + ".p_thanhvienekipmo" +
            "( " +
            "idchucnang number(2) not null," +
            "idpttt number(30,0) DEFAULT 0 NOT NULL," +
            "manhanvien varchar2(4) NOT NULL," +
            "ghichu nvarchar2(500)," +
            "mmyy generated always as (to_char(ngayud,'MMyy')) ," +
            "username varchar2(20)," +
            "ngayud date DEFAULT sysdate," +
            "dongbo varchar2(100) default lpad('0',100,'0')," +
            "computer varchar2(50)" +
            ") partition by list (mmyy)(partition p_thanhvienekipmo_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add CONSTRAINT pk_p_thanhvienekipmo PRIMARY KEY (idchucnang,idpttt,manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add CONSTRAINT fk_thanhvienekipmo_chucnang FOREIGN KEY (idchucnang) REFERENCES " + sSchema + ".p_dmchucnangekipmo (idchucnang);\n";
            s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add CONSTRAINT fk_thanhvienekipmo_nhanvien FOREIGN KEY (manhanvien) REFERENCES " + sSchema + ".p_dmnhanvien (manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add CONSTRAINT fk_p_thanhvienekipmo_dmuser FOREIGN KEY (username) REFERENCES " + sSchema + ".p_dmuser (username);\n";
            //
            //linh 5/7/14
            s_Sql += "alter table " + sSchema + ".r_dmmay add loaimay number(1) default 0 not null;\n";
            //ThanhCuong - 07/07/2014
            s_Sql += "create table " + sSchema + ".m_dutrucapll(iddutrucap number(30) default 0, " +
                "mmyy varchar2(4) DEFAULT to_char(sysdate,'mmyy') not null, sophieu varchar2(20), " +
                "ngay date, idkhoxuat number(3) default 0, idkhonhap number(3) default 0, done number(1) default 0 not null, " +
                " ghichu nvarchar2(254), computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate)" +
                " partition by list (mmyy)(partition b_chuyensolieu_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter TABLE " + sSchema + ".m_dutrucapll add constraint pk_m_dutrucapll primary key(iddutrucap);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_dutrucapll add constraint fk_dutrucapll_khoxuat foreign key(idkhoxuat) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_dutrucapll add constraint fk_dutrucapll_khonhap foreign key(idkhonhap) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_dutrucapll add constraint fk_dutrucapll_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_dutrucapll add ghichu nvarchar2(254);\n";

            s_Sql += "create table " + sSchema + ".m_dutrucapct(iddutrucap number(30) default 0, " +
                "mmyy varchar2(4) DEFAULT to_char(sysdate,'mmyy') not null, " +
                "idbietduoc number(7,0) default 0 not null, soluongdutru number(30,8) default 0 not null, soluongduyet number(30,8) default 0 not null, " +
                "idduyetdutrucap number(30) default 0 not null, computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate)" +
                " partition by list (mmyy)(partition b_chuyensolieu_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter TABLE " + sSchema + ".m_dutrucapct add constraint pk_m_dutrucapct primary key(iddutrucap,idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_dutrucapct add constraint fk_dutrucapct_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_dutrucapct add constraint fk_dutrucapct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //end

            //Tú:08/07/2014
            s_Sql += "create table " + sSchema + ".b_chuyensolieu(idchuyensolieu number(30,0) default 0,mmyy generated always as (to_char(ngayud,'MMyy'))," +
                     "ngay date default sysdate,mavaovien number(30,0) default 0,maql number(30,0) default 0,idkhoa number(30,0) default 0," +
                     "ngayvaovien date,ngayravien date,idkhoaphong number(3,0),maicd varchar2(10),chandoan nvarchar2(254)," +
                     "sotien number(15,4) default 0,tamung number(10,0) default 0,bhyttra number(15,4) default 0,mien number(15,4) default 0,done number(1,0) default 0," +
                     "idttrv number(30,0) default 0,vuottran number(1,0) default 0,username varchar2(20),computer varchar2(50)," +
                     "ngayud date default sysdate) " +
                     "partition by list (mmyy)(partition b_chuyensolieu_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".b_chuyensolieu add constraint pk_b_chuyensolieu primary key(idchuyensolieu);\n";
            s_Sql += "alter table " + sSchema + ".b_chuyensolieu add constraint fk_b_chuyensolieu_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".b_chuyensolieu add constraint fk_b_chuyensolieu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            //Tú:10/07/2014
            s_Sql += "create table " + sSchema + ".p_dmphucappttt(idchucnang number(2,0),idloaipttt number(1,0) default 0,idloainhompttt number(1,0) default 0," +
                     "sotien number(14,3) default 0,ghichu nvarchar2(500),username varchar2(20),ngayud date default sysdate," +
                     "dongbo varchar2(100) default lpad('0',100,'0'),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".p_dmphucappttt add constraint pk_p_dmphucappttt primary key(idchucnang);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphucappttt add constraint fk_p_dmphucappttt_loaipttt foreign key(idloaipttt) references " + sSchema + ".p_dmloaipttt(idloaipttt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphucappttt add constraint fk_p_dmphucappttt_nhompttt foreign key(idloainhompttt) references " + sSchema + ".p_dmloainhompttt(idloainhompttt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmphucappttt add constraint fk_p_dmphucappttt_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add ngayduyet date;\n";
            s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add sotien number(14,3) default 0;\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add ngayduyet date;\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add duyetphucap number(1,0) default 0;\n";

            //Tú:12/07/2014
            s_Sql += "create table " + sSchema + ".b_goivienphi(idgoivienphi number(7,0),idgiavienphi number(7,0),soluong number(5,2),username varchar2(20)," +
                     "computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".b_goivienphi add constraint pk_b_goivienphi primary key(idgoivienphi,idgiavienphi);\n";
            //s_Sql += "alter table " + sSchema + ".b_goivienphi add constraint fk_b_goivienphi_giavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".b_goivienphi add constraint fk_b_goivienphi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add goivienphi number(1,0) default 0;\n";
            //Tú:14/07/2014
            s_Sql += "alter table " + sSchema + ".b_goivienphi add madoituong number(2,0) default 0;\n";
            s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_th number(14,3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_bh number(14,3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_cs number(14,3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_dv number(14,3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_nn number(14,3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_ksk number(14,3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_goivienphi add gia_vip number(14,3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_goivienphi add idnguon number(2,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmnhomvienphi modify idnhomvienphi number(5) default 0;\n";//linh 15/7/14
            s_Sql += "alter table " + sSchema + ".b_dmloaivienphi modify idnhomvienphi number(5) default 0;\n";//linh 15/7/14
            //linh17/7/14
            s_Sql += "create table " + sSchema + ".bc_report(idreport number(30) default 0 not null,tenreport varchar2(200),tieude nvarchar2(2000),sql nvarchar2(2000)," +
                "columntitle nvarchar2(2000),username varchar2(20)," +
                "computer character varying(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".bc_report add constraint pk_bc_report primary key(idreport);\n";
            //Tú:15/07/2014
            s_Sql += "alter table " + sSchema + ".r_dmmaumota modify makt varchar2(10);\n";

            s_Sql += "create table " + sSchema + ".bc_control(idreport number(30) default 0 not null,stt number(4) default 0 not null," +
                "controltype  varchar2(200),controlname  varchar2(200),controltext  varchar2(200),controltop number(4) default 0 not null," +
                "controlleft number(4) default 0 not null,controlwidth number(4) default 0 not null,controlheight number(4) default 0 not null," +
                "controlindex number(4) default 0 not null, controldefault nvarchar2(2000),username varchar2(20)," +
                "computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".bc_control add constraint pk_bc_control primary key(idreport,stt);\n";
            s_Sql += "alter table " + sSchema + ".bc_control add constraint fk_control_report foreign key(idreport) references " + sSchema + ".bc_report(idreport);\n";
            //ThanhCuong - 18/07/2014 - dùng xuất bán khách hàng
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add hoten nvarchar2(254);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add diachi nvarchar2(254);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add hotenbacsy nvarchar2(254);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd modify donvilinh nvarchar2(50);\n";
            s_Sql += "create table " + sSchema + ".m_dmbdtd(idbietduoc number(7) default 0, idbietduoctd number(7) default 0," +
                "computer varchar2(50),username varchar2(20),ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_dmbdtd add constraint pk_m_dmbdtd primary key(idbietduoc,idbietduoctd);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_dmbdtd add constraint fk_dmbdtd_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_dmbdtd add constraint fk_dmbdtd_dmbd1 foreign key(idbietduoctd) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbdtd add constraint fk_dmbdtd_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add idbietduocgoc number(7) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add idtheodoi number(30) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add idbietduocgoc number(7) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add stt number(7,0) default 0 not null;\n";
            //end
            //linh 23/7/14
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan drop constraint fk_dmbenhnhan_dmbenhvien;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi modify mavp varchar2(20);\n";
            //linh 24/7/14
            s_Sql += "alter table " + sSchema + ".m_dmnhacungcap modify sotaikhoan varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhacungcap modify masothue varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".m_dmkhoaphong modify makhoaphong varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd modify sodangky varchar2(30);\n";
            //ThanhCuong-04/06/2014
            s_Sql += "create table " + sSchema + ".m_phatthuoc(idduyet number(30) default 0 not null,idkho number(3) default 0 not null,ngay date default sysdate not null," +
                "mmyy varchar2(4) not null,computer varchar2(50),ngayud date default sysdate,username varchar2(20)," +
                "constraint pk_m_phatthuoc primary key(idduyet,idkho), " +
                "constraint fk_phatthuoc_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username)," +
                "constraint fk_phatthuoc_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho (idkho));\n";
            //linh 29/7/14
            s_Sql += "alter table " + sSchema + ".p_toathuocct add solan character varying(10);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct add sovien character varying(10);\n";
            //ThanhCuong - 29/07/2014
            s_Sql += "alter table " + sSchema + ".m_phieuduyet add sophieu number(5) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_phieuduyet add lanin number(3) default 0 not null;\n";

            //linh 31/7/14
            s_Sql += "alter table " + sSchema + ".p_dmtinhthanh add matinhthanh_bh varchar2(2);\n";
            s_Sql += "alter table " + sSchema + ".p_dmquanhuyen add maquanhuyen_bh varchar2(2);\n";
            //ThanhCuong - 04/08/2014
            s_Sql += "alter table " + sSchema + ".b_chidinh add congkhamtiepdon number(1) default 0 not null;\n";

            //Thuy 29/7/14
            s_Sql += "create table " + sSchema + ".m_khoasolieu(mmyy varchar2(4), done number(1) default 0 not null, " +
            " computer varchar2(50),username varchar2(20),ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_khoasolieu add constraint pk_m_khoasolieu primary key(mmyy);\n";
            //linh 30/7/14
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add cachdung nvarchar2(254);\n";
            //linh 31/7/14
            s_Sql += "alter table " + sSchema + ".p_dmtinhthanh add matinhthanh_bh varchar2(2);\n";
            s_Sql += "alter table " + sSchema + ".p_dmquanhuyen add maquanhuyen_bh varchar2(2);\n";
            //ThanhCuong - 29/07/2014
            s_Sql += "alter table " + sSchema + ".m_phieuduyet add sophieu number(5) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_phieuduyet add lanin number(3) default 0 not null;\n";

            //ThanhCuong - 04/08/2014
            s_Sql += "alter table " + sSchema + ".b_chidinh add congkhamtiepdon number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct modify sang varchar2(10);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct modify trua varchar2(10);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct modify chieu varchar2(10);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct modify toi varchar2(10);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct modify sovien varchar2(10);\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct modify solan varchar2(10);\n";
            //Thuy 7/8/14
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add idkhoaphong number(3,0) default 0 not null;\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add bidanh nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add noisinh nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add matinh_noisinh character varying(3) default 000 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add maquanhuyen_noisinh character varying(5) default 000 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add maphuongxa_noisinh character varying(7) default 000 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add nguyenquan nvarchar2(200);\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add idnuoc number(5,0) default 0 not null;\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add noiohiennay nvarchar2(200);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add matinh_noio character varying(3) default 000 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add maquanhuyen_noio character varying(5) default 000 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add maphuongxa_noio character varying(7) default 000 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add ngaycapcmnd date DEFAULT sysdate;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add noicapcmnd nvarchar2(200);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add matongiao character varying(2);\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add mahocvan character varying(4);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add machucdanh character varying(2);\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add sotaikhoan character varying(20);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add idnganhang number(3,0) default 0 not null;\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add dienthoaicoquan character varying(50);\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add maviettat character varying(10);\n";
            s_Sql += " create table " + sSchema + ".h_ngoaingu(idngoaingu number(2,0) default 0 not null, manhanvien character varying(4), computer character varying(50)," +
            "username character varying(20),ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".h_ngoaingu add constraint pk_h_ngoaingu primary key(idngoaingu,manhanvien);\n";
            s_Sql += "alter TABLE " + sSchema + ".h_ngoaingu add constraint fk_h_ngoaingu_dmnhanvien foreign key(manhanvien) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter TABLE " + sSchema + ".h_ngoaingu add constraint fk_h_ngoaingu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "create table " + sSchema + ".h_dmchucvu(machucvu number(2,0) default 0 not null,tenchucvu nvarchar2(200),hesochucvu number(6,2),tenviettat nvarchar2(200), computer character varying(50)," +
            "username character varying(20),ngayud date default sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".h_dmchucvu add constraint pk_h_dmchucvu primary key(machucvu);\n";
            s_Sql += " alter TABLE " + sSchema + ".h_dmchucvu add constraint fk_h_dmchucvu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "create table " + sSchema + ".h_dmngoaingu(idngoaingu number(2,0) default 0 not null,tenngoaingu nvarchar2(200),computer character varying(50)," +
           "username character varying(20),ngayud date default sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".h_dmngoaingu add constraint pk_h_dmngoaingu primary key(idngoaingu);\n";
            s_Sql += " alter TABLE " + sSchema + ".h_dmngoaingu add constraint fk_h_dmngoaingu_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += " create table " + sSchema + ".h_dmtongiao(matongiao number(2,0) default 0 not null, tentongiao character varying(100));\n";
            s_Sql += "alter TABLE " + sSchema + ".h_dmtongiao add constraint pk_h_dmtongiao primary key(matongiao);\n";
            s_Sql += "create table " + sSchema + ".h_dmchucdanh(machucdanh number(2,0) default 0 not null, tenchucdanh character varying(200),tenviettat character varying(200), computer character varying(50),username character varying(20),ngayud date default sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".h_dmchucdanh add constraint pk_h_dmchucdanh primary key(machucdanh);\n";
            s_Sql += " alter TABLE " + sSchema + ".h_dmchucdanh add constraint fk_h_dmchucdanh_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += " create table " + sSchema + ".h_dmtrinhdovitinh(matrinhdovitinh number(2,0) default 0 not null, tentrinhdovitinh character varying(100));\n";
            s_Sql += "alter TABLE " + sSchema + ".h_dmtrinhdovitinh add constraint pk_h_dmtrinhdovitinh primary key(matrinhdovitinh);\n";
            s_Sql += "create table " + sSchema + ".h_dmchuyenmon(machuyenmon number(2,0) default 0 not null,tenchuyenmon nvarchar2(200),tenviettat nvarchar2(200),computer character varying(50)," +
            "username character varying(20),ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".h_dmchuyenmon add constraint pk_h_dmchuyenmon primary key(machuyenmon);\n";
            s_Sql += "alter TABLE " + sSchema + ".h_dmchuyenmon add constraint fk_h_dmchuyenmon_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "create table " + sSchema + ".h_dmhocvan(mahocvan character varying(3),tenhocvan character varying(100));\n";
            s_Sql += "alter TABLE " + sSchema + ".h_dmhocvan add constraint pk_h_dmhocvan primary key(mahocvan);\n";
            //Tú:09/08/2014
            s_Sql += "create table " + sSchema + ".p_capmathebhyt(id number(5,0),username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmdoituong add nhaptuyen number(1,0) default 0;\n";
            //ThanhCuong - 11/08/2014
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add congkhamtiepdon number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhacungcap add sodk varchar2(50);\n";
            s_Sql += "create table  " + sSchema + ".m_dmcachdung ( tencachdung nvarchar2(254), tenkhongdau varchar2(254), " +
                " COMPUTER varchar2(50), USERNAME varchar2(20), NGAYUD date DEFAULT sysdate);\n";
            s_Sql += "alter table  " + sSchema + ".m_dmcachdung add constraint pk_m_dmcachdung primary key(tenkhongdau);\n";
            //linh 11/8/14
            s_Sql += "create table " + sSchema + ".l_labthongso(idmay number(3) default 0, idxetnghiem number(7) default 0 not null,stt number(3),tenxetnghiem varchar2(254),computer varchar2(50)," +
                "ketqua nvarchar2(254),username varchar2(20),ngayud date default sysdate,maxetnghiem varchar2(20),nhapamtinhduongtinh number(1) default 0 not null," +
                "fieldtinhtudong varchar2(20),nhanthem number(5,2) default 1 not null);\n";//linh 14/8/14
            s_Sql += "alter table " + sSchema + ".l_labthongso add constraint pk_l_labthongso primary key(idmay,idxetnghiem);\n";
            //ThanhCuong - 13/08/2014
            s_Sql += "alter table " + sSchema + ".m_dutrucapct add idnguon number(2) default 0 not null;\n";
            s_Sql += "alter TABLE " + sSchema + ".m_dutrucapct add constraint fk_m_dutrucapct_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon);\n";
            //Tú:14/08/2014
            s_Sql += "alter table " + sSchema + ".b_goivienphi drop constraint fk_b_goivienphi_giavp;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh add idktcao number(30,0) default 0 not null;\n";
            //ThanhCuong - 15/08/2014
            s_Sql += "create table " + sSchema + ".m_denghi(iddenghi number(30) default 0 not null,sophieu varchar2(20),mmyy generated always as (to_char(ngayud,'MMyy')),ngaydenghi date default sysdate," +
                "trangthai number(1) default 0 not null,ghichu nvarchar2(254),computer varchar2(50),username varchar2(20),ngayud date default sysdate) "+
                "partition by list (mmyy)(partition m_denghi_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".m_denghi add constraint pk_m_denghi primary key(iddenghi);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_denghi add constraint fk_m_denghi_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            s_Sql += "create table " + sSchema + ".m_denghichitiet(iddenghi number(30) default 0 not null,mmyy generated always as (to_char(ngayud,'MMyy')),idnhap number(30) default 0 not null,mmyynhap varchar2(4) not null,ngaynhap date not null," +
                "tongtien number(24,8) default 0 not null,datra number(24,8) default 0 not null,tkno varchar2(50),tkco varchar2(50),computer varchar2(50),username varchar2(20),ngayud date default sysdate) " +
                "partition by list (mmyy)(partition m_denghichitiet_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".m_denghichitiet add constraint pk_m_denghichitiet primary key(iddenghi,idnhap);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_denghichitiet add constraint fk_m_denghichitiet_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //linh 18/8/14
            s_Sql += "alter table " + sSchema + ".p_dmphuongxa add hide number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmquanhuyen add hide number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhthanh add hide number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhvien add hide number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmnhomvienphi add hide number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmloaivienphi add hide number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add hide number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmloai add hide number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmhang add hide number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnuoc add hide number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add hide number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add hide number(1) default 0 not null;\n";
            //linh 19/8/14
            s_Sql += "alter table " + sSchema + ".m_dmnhacungcap modify fax varchar2(50);\n";
            //linh 25/8/14
            s_Sql += "alter table " + sSchema + ".p_dmbenhvien drop constraint pk_dmbenhvien;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhvien add constraint pk_p_dmbenhvien primary key(mabenhvien,manoidkkcb);\n";

            //Thanhcuong - 23/08/2014
            s_Sql += "create table " + sSchema + ".m_toamau(idtoamau number(7), tentoa nvarchar2(254), tenkhongdau varchar2(150),mabs varchar2(4), maicd varchar2(10), tutuoi number(2) default 0 not null," +
                " dentuoi number(2) default 0 not null,computer varchar2(50), phai number(1) default -1 not null,songay number(2) default 0 not null," +
                " ngayud date default sysdate not null,username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".m_toamau add constraint pk_m_toamau primary key(idtoamau);\n";
            s_Sql += "alter table " + sSchema + ".m_toamau add constraint fk_m_toamau_nhanvien foreign key (mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".m_toamau add constraint fk_m_toamau_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".m_toamau add phai number(1) default -1 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_toamau add songay number(2) default 0 not null;\n";//ThanhCuong - 26/08/2014
            s_Sql += "alter table " + sSchema + ".m_toamau add tenkhongdau varchar2(150);\n";//ThanhCuong - 26/08/2014

            s_Sql += "create table " + sSchema + ".m_toamauct(idtoamau number(7),idbietduoc number(7,0) default 0 not null, sang varchar2(10), trua varchar2(10), chieu varchar2(10), " +
                "toi varchar2(10), soluongyeucau number(12,4) default 0 not null,songay number(2) DEFAULT 0 not null, cachdung nvarchar2(254), ghichu nvarchar2(254)," +
                " computer varchar2(50),ngayud date default sysdate not null,username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".m_toamauct add constraint pk_m_toamauct primary key(idtoamau,idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_toamauct add constraint fk_m_toamauct_bietduoc foreign key (idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_toamauct add constraint fk_m_toamauct_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".m_toamauct add soluongyeucau number(12,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_toamauct add songay number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_toamauct add computer varchar2(50);\n";//ThanhCuong - 26/08/2014
            //Tú:25/08/2014
            s_Sql += "alter table " + sSchema + ".p_benhandt modify sovaovien varchar2(20);\n";
            //Tú:26/08/2014
            s_Sql += "alter table " + sSchema + ".p_dmdoituong add kho varchar2(20);\n";
            //linh 29/8/14
            s_Sql += "alter table " + Schema + ".m_theodoi add mmyy varchar2(4) default to_char(sysdate,'mmyy') not null;\n";
            //ThanhCuong - 01/09/2014
            s_Sql += "alter table " + sSchema + ".m_dmkhoaphong add hide number(1) default 0 not null;\n";
            //Tú:02/09/2014
            s_Sql += "alter table " + sSchema + ".b_dmloaiquyenso add dangdung number(1,0) default 0;\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien drop constraint fk_xuatvien_tinhtrangrakhoa;\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien drop constraint fk_xuatvien_dmkhoaphongnv;\n";
            s_Sql += "alter table " + sSchema + ".b_dmquyenso add nguoidung varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add tachchitiet number(1,0) default 0;\n";
            //ThanhCuong - 07/09/2014
            s_Sql += "alter table " + sSchema + ".p_toathuocct add duongdung nvarchar2(254);\n";
            //ThanhCuong - 21/09/2014
            s_Sql += "alter table " + sSchema + ".m_dmbd add tinhtheogiabhyt number(1) default 0 not null;\n";
            //Tú:26/08/2014
            s_Sql += "alter table " + sSchema + ".p_dmdoituong add kho character varying(20);\n";
            //ThanhCuong - 07/09/2014
            s_Sql += "alter table " + sSchema + ".p_toathuocct add duongdung nvarchar2(500);\n";
            //Thuy 11/9/14
            s_Sql += "alter table " + sSchema + ".b_vienphi add daduyet number(1,0);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi modify daduyet default 0;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi add ngayduyet date;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi modify ngayduyet DEFAULT null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi add sttduyet number(10,0);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi modify sttduyet default 0;\n";
            //linh 29/8/14
            s_Sql += "create table " + Schema + ".l_labketqua (idtraketqua varchar2(254),ngay timestamp default sysdate not null,stt number(6) default 0 not null," +
                " idxetnghiem number(7) default 0 not null,idmay number(3) default 0 not null,ketqua varchar2(50)," +
                " mmyy  generated always as (to_char(ngay,'MMyy')),computer varchar2(50),username varchar2(20))" +
                " partition by list (mmyy)(partition l_labketqua_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + Schema + ".l_labketqua add constraint pk_l_labketqua primary key(idtraketqua,ngay,stt);\n";
            //linh 7/9/14
            s_Sql += "alter table " + Schema + ".r_dmmay add vitristtlaymau number(3) default 0 not null;\n";
            s_Sql += "alter table " + Schema + ".r_dmmay add kituketthuc varchar2(10);\n";
            s_Sql += "alter table " + Schema + ".r_dmmay add kituphancach varchar2(10);\n";
            s_Sql += "alter table " + Schema + ".r_dmmay add ip number(1) default 0 not null;\n";
            s_Sql += "alter table " + Schema + ".b_dmloaiquyenso add dangdung number(1) default 0 not null;\n";
            //linh 19/9/14
            s_Sql += "alter table " + Schema + ".p_benhandt add sotientongchiphi number(24,8) default 0 not null;\n";
            s_Sql += "alter table " + Schema + ".p_benhandt add sotienbhyttra number(24,8) default 0 not null;\n";
            s_Sql += "alter table " + Schema + ".p_benhandt add sotienbntra number(24,8) default 0 not null;\n";
            s_Sql += "alter table " + Schema + ".p_benhandt add sotienmien number(24,8) default 0 not null;\n";
            s_Sql += "alter table " + Schema + ".p_benhandt add sotienhaophi number(24,8) default 0 not null;\n";
            s_Sql += "alter table " + Schema + ".p_benhandt add sotientamung number(24,8) default 0 not null;\n";
            s_Sql += "alter table " + Schema + ".p_benhandt add sotienkhac number(24,8) default 0 not null;\n";
            //Tú:23/09/2014
            s_Sql += "alter table " + Schema + ".p_dmkhoaphongbenhvien add capcuu number(1,0) default 0 not null;\n";
            //linh 25/9/14
            s_Sql += "create table " + sSchema + ".d_dmkhuhoso (idkhuhoso number(2),tenkhuhoso varchar2(150),ngayud date,computer varchar2(50)," +
                "username varchar2(20), tenkhongdau varchar2(100));\n";
            s_Sql += "alter table  " + sSchema + ".d_dmkhuhoso add constraint pk_dmkhuhoso primary key(idkhuhoso);\n";

            s_Sql += "create table " + sSchema + ".d_dmkehoso (idkehoso number(3),tenkehoso varchar2(150),ngayud date,computer varchar2(50)," +
               "username varchar2(20),idkhuhoso number(2) default 0 not null, tenkhongdau varchar2(100));\n";
            s_Sql += "alter table  " + sSchema + ".d_dmkehoso add constraint pk_dmkehoso primary key(idkehoso);\n";
            s_Sql += "alter table  " + sSchema + ".d_dmkehoso add constraint fk_dmke_khu foreign key(idkhuhoso) references " + sSchema + ".d_dmkhuhoso(idkhuhoso);\n";

            s_Sql += "create table " + sSchema + ".d_dmtanghoso (idtanghoso number(2),tentanghoso varchar2(150),ngayud date,computer varchar2(50)," +
                "username varchar2(20),idkehoso number(3) default 0 not null, tenkhongdau varchar2(100));\n";
            s_Sql += "alter table  " + sSchema + ".d_dmtanghoso add constraint pk_dmtanghoso primary key(idtanghoso);\n";
            s_Sql += "alter table  " + sSchema + ".d_dmtanghoso add constraint fk_dmtang_ke foreign key(idkehoso) references " + sSchema + ".d_dmkehoso(idkehoso);\n";

            s_Sql += "alter table " + sSchema + ".p_xuatvien add idtanghoso number(3);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien modify idtanghoso default 0;\n";
            s_Sql += "update " + sSchema + ".p_xuatvien set idtanghoso=0 where idtanghoso is null;\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien modify idtanghoso not null;\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add ghichuhoso varchar2(200);\n";
            s_Sql += "alter table " + Schema + ".m_theodoi add mmyy character varying(4) default to_char(sysdate,'mmyy') not null;\n";
            //Tú:28/09/2014
            s_Sql += "alter table " + sSchema + ".b_vienphi add nguoiduyet varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add madvkt varchar2(20);\n";
            //ThanhCuong - 01/09/2014
            s_Sql += "alter table " + sSchema + ".m_dmkhoaphong add hide number(1) default 0 not null;\n";
            //Tú:02/09/2014
            s_Sql += "alter table " + sSchema + ".b_dmloaiquyenso add dangdung number(1,0) default 0;\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien drop constraint fk_xuatvien_tinhtrangrakhoa;\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien drop constraint fk_xuatvien_dmkhoaphongnv;\n";
            s_Sql += "alter table " + sSchema + ".b_dmquyenso add nguoidung varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add tachchitiet number(1,0) default 0;\n";
            //ThanhCuong - 07/09/2014
            s_Sql += "alter table " + sSchema + ".p_toathuocct add duongdung nvarchar2(150);\n";
            //Thuy 11/9/14
            s_Sql += "alter table " + sSchema + ".b_vienphi add daduyet number(1,0);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi modify daduyet default 0;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi add ngayduyet date;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi modify ngayduyet DEFAULT null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi add sttduyet number(10,0);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi modify sttduyet default 0;\n";
            //ThanhCuong - 21/09/2014
            s_Sql += "alter table " + sSchema + ".m_dmbd add tinhtheogiabhyt number(1) default 0 not null;\n";
            s_Sql += "ALTER TABLE " + sSchema + ".p_dmbenhnhan  ADD CONSTRAINT ck_p_dmbenhnhan_mabn CHECK (mabn<>'');\n";
            s_Sql += "ALTER TABLE " + sSchema + ".p_hiendien ADD CONSTRAINT ck_hiendien_id CHECK (id<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".p_hiendien ADD CONSTRAINT ck_hiendien_maql CHECK (maql<>0);\n";
            s_Sql += "CREATE INDEX ind_hiendien_ngay ON " + sSchema + ".p_hiendien(ngay);\n";
            s_Sql += "CREATE INDEX ind_hiendien_idkhoaphong ON " + sSchema + ".p_hiendien(idkhoaphong);\n";
            s_Sql += "CREATE INDEX ind_hiendien_maql ON " + sSchema + ".p_hiendien(maql);\n";
            s_Sql += "CREATE INDEX ind_hiendien_id ON " + sSchema + ".p_hiendien(id);\n";
            s_Sql += "CREATE INDEX ind_capmabn_id ON " + sSchema + ".p_capmabenhnhan(mmyy);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".b_dmgiavienphi ADD CONSTRAINT ck_b_dmgiavienphi_ma CHECK (mavp<>'');\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_dmbd ADD CONSTRAINT ck_dmbd_ma CHECK (mabietduoc<>'');\n";
            //cuong 1/102014
            s_Sql += "alter table " + sSchema + ".m_nhapll add ghichu nvarchar2(254);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add dinhmucnhapnam number(20) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add danhapnam number(20) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add nam varchar2(2) default to_char(sysdate,'yy') not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add hoachat number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add vtth number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add khauhaotscd number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add chiphiquanly number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add thuetndn number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add conglaodongtructiep1 number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add conglaodongtructiep2 number(5,2) default 0 not null;\n";
            //ThanhCuong - 01/11/2014
            s_Sql += "alter table " + sSchema + ".b_chidinh add tygiausd number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add tygiausd number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add tygiausd number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add tygiausd number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict add tygiausd number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add tygiausd number(24,4) default 0 not null;\n";
            //ThanhCuong - 06/11/2014
            s_Sql += "alter table " + sSchema + ".m_toamauct add solan number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_toamauct add sovien number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_toamau add loai number(1) default 0 not null;\n";
            //Tú:25/10/2014
            s_Sql += "update " + sSchema + ".p_theodoigiuong set idchidinh=0 where idchidinh is null;\n";
            s_Sql += "alter table " + sSchema + ".p_theodoigiuong modify idchidinh default 0;\n";
            s_Sql += "alter table " + sSchema + ".p_theodoigiuong modify idchidinh not null;\n";
            //Tú:05/11/2014
            s_Sql += "alter table " + sSchema + ".p_lienhe add giaytokemtheo number(2,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add loaibnkham number(2,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add khamchuongtrinh number(1,0) default 0 not null;\n";
            //Tú:10/11/2014
            s_Sql += "alter table " + sSchema + ".p_dmnhomnhanvien add loai number(2,0) default 0 not null;\n";
            //ThanhCuong - 10/11/2014
            s_Sql += "alter table " + sSchema + ".m_theodoi add sodangky varchar2(30);\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add matbang number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add conglaodongtructiepnn1 number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add conglaodongtructiepnn2 number(5,2) default 0 not null;\n";
            //Tú:24/11/2014
            s_Sql += "alter table " + sSchema + ".p_giayravien add chandoankemtheo nvarchar2(1000);\n";
            //Tú:06/10/2014
            s_Sql += "alter table " + sSchema + ".p_xuatvien add chuyenvientheoyeucau number(1,0);\n"; 
            s_Sql += "alter table " + sSchema + ".p_xuatvien  modify chuyenvientheoyeucau number(1,0) default 0;\n";
            s_Sql += "update " + sSchema + ".p_xuatvien set chuyenvientheoyeucau=0 where chuyenvientheoyeucau is null;\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien modify chuyenvientheoyeucau not null;\n";
            s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add chuyenvientheoyeucau number(1,0);\n";
            s_Sql += "alter table " + sSchema + ".p_giaychuyenvien modify chuyenvientheoyeucau default 0;\n";
            s_Sql += "update " + sSchema + ".p_giaychuyenvien set chuyenvientheoyeucau=0 where chuyenvientheoyeucau is null;\n";
            s_Sql += "alter table " + sSchema + ".p_giaychuyenvien modify chuyenvientheoyeucau not null;\n";
            //Tú:10/10/2014
            s_Sql += "alter table " + sSchema + ".m_dmbd add madvkt varchar2(20);\n";
            //ThanhCuong - 22/10/2014
            s_Sql += "alter table " + sSchema + ".m_nhapll add ghichu nvarchar2(254);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add dinhmucnhapnam number(20) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add danhapnam number(20) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add nam varchar2(2) default to_char(sysdate,'yy') not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add hoachat number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add vtth number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add khauhaotscd number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add chiphiquanly number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add thuetndn number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add conglaodongtructiep1 number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add conglaodongtructiep2 number(5,2) default 0 not null;\n";
            //Tú:25/10/2014
            s_Sql += "alter table " + sSchema + ".p_theodoigiuong modify idchidinh default 0;\n";
            s_Sql += "update " + sSchema + ".p_theodoigiuong set idchidinh=0 where idchidinh is null;\n";
            s_Sql += "alter table " + sSchema + ".p_theodoigiuong modify idchidinh not null;\n";
            //ThanhCuong - 01/11/2014
            s_Sql += "alter table " + sSchema + ".b_chidinh add tygiausd number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add tygiausd number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add tygiausd number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add tygiausd number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict add tygiausd number(24,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add tygiausd number(24,4) default 0 not null;\n";
            //Tú:05/11/2014
            s_Sql += "alter table " + sSchema + ".p_lienhe add giaytokemtheo number(2,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add loaibnkham number(2,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add khamchuongtrinh number(1,0) default 0 not null;\n";
            //ThanhCuong - 06/11/2014
            s_Sql += "alter table " + sSchema + ".m_toamauct add solan number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_toamauct add sovien number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_toamau add loai number(1) default 0 not null;\n";
            //Tú:10/11/2014
            s_Sql += "alter table " + sSchema + ".p_dmnhomnhanvien add loai number(2,0) default 0 not null;\n";
            //ThanhCuong - 10/11/2014
            s_Sql += "alter table " + sSchema + ".m_theodoi add sodangky character varying(30);\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add matbang number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add conglaodongtructiepnn1 number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add conglaodongtructiepnn2 number(5,2) default 0 not null;\n";
            //Tú:24/11/2014
            s_Sql += "alter table " + sSchema + ".p_giayravien add chandoankemtheo nvarchar2(1000);\n";
            //linh 25/11/14
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add mamemonelink varchar2(50);\n";
            s_Sql += "update " + sSchema + ".p_dmbenhnhan set mamemonelink=mabn where mamemonelink is null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan modify mamemonelink not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add constraint uk_dmbenhnhan_mamemonelink unique(mamemonelink) ;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add ngaycapcmnd date;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add noicapcmnd varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan modify idthesmartcard varchar2(20);\n";
            //ThanhCuong - 25/11/2014
            s_Sql += "create table " + sSchema + ".p_dmnoilamviec(idnoilamviec number(7) default 0, tennoilamviec nvarchar2(100), " +
                "tenkhongdau varchar2(200),ngayud date DEFAULT sysdate, computer varchar2(50),username varchar2(20));\n";
            s_Sql += "alter TABLE " + sSchema + ".p_dmnoilamviec add constraint pk_p_dmnoilamviec primary key(idnoilamviec);\n";
            s_Sql += "alter TABLE " + sSchema + ".p_dmnoilamviec add constraint fk_noilamviec_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //Tú:26/11/2014
            s_Sql += "alter table " + sSchema + ".p_lienhe add giaychungsinh number(1,0);\n";
            s_Sql += "update " + sSchema + ".p_lienhe set giaychungsinh=0 where giaychungsinh is null;\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe modify giaychungsinh not null;\n";

            //Thuy 26/11/2014
            s_Sql += "grant references on " + sSchema + ".p_dmnhanvien to " + sSchema + "_image;\n";
            s_Sql += " CREATE TABLE " + sSchemaImage + ".p_dmnhanvien_hinhanh (manhanvien varchar2(4) NOT NULL,stt number(2,0) default 0 not null," +
                    " hinhanh blob, computer varchar2(50), username varchar2(20),ngayud date DEFAULT sysdate," +
                    " duongdan varchar2(1024), CONSTRAINT pk_p_dmnhanvien_hinhanh PRIMARY KEY (manhanvien,stt), " +
                    " CONSTRAINT fk_dmnv_dmnhanvien_hinhanh FOREIGN KEY (manhanvien)" +
                    " REFERENCES " + sSchema + ".p_dmnhanvien(manhanvien));\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add machuyenmon number(2,0) default 0 not null;\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien modify mahocvan number(2,0);\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien modify mahocvan default 0;\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien modify mahocvan not null;\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add machucvu number(2,0);\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add ngaybonhiem date DEFAULT sysdate;\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add thoigianbonhiem number(2,0) default 0;\n";
            s_Sql += " alter table " + sSchema + ".p_dmnhanvien add ngaycongtac date DEFAULT sysdate;\n";
            s_Sql += " CREATE TABLE " + sSchema + ".h_dmhopdong ( mahopdong number(2,0) DEFAULT 0  NOT NULL,  tenhopdong nvarchar2(100)," +
                    "dongbhxh number(1,0) default 0 not null, buocthamgiabhtn number(1,0) default 0 not null ," +
                    "computer varchar2(50), username varchar2(20), ngayud date DEFAULT sysdate," +
                    "CONSTRAINT pk_h_dmhopdong PRIMARY KEY (mahopdong));\n";
            s_Sql += " CREATE TABLE " + sSchema + ".h_dmhinhthuclamviec(ma number(1,0) default 0 not null, ten nvarchar2(100), computer varchar2(50)," +
                     "username varchar2(20), ngayud date DEFAULT sysdate, CONSTRAINT pk_h_dmhinhthuclamviec PRIMARY KEY (ma));\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add bangiamdoc number(1,0) default 0 not null;\n";
            s_Sql += "CREATE TABLE " + sSchema + ".h_hopdong(idhopdong varchar2(4),manhanvien character varying(4),sohopdong varchar2(100)," +
                     "mahopdong number(2,0) default 0 not null, ngaykyhopdong date default sysdate," +
                     "ngaybatdauhieuluc date default sysdate,ngayhethieuluc date default sysdate," +
                     "luongcoban number(14,0) default 0 not null,luongchinhthuc number(14,0) default 0 not null, mahinhthuclamviec number(1,0) default 0 not null," +
                     "machucvu number(2,0), idkhoaphong number(3,0),nguoidaidienctyky nvarchar2(4), ngaynghiviec date," +
                     "sophep number(2,0) default 0, computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate," +
                     "CONSTRAINT pk_h_hopdong PRIMARY KEY (idhopdong));\n";
            s_Sql += "alter table " + sSchema + ".h_hopdong add constraint fk_hopdong_nhanvien foreign key(manhanvien) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".h_hopdong add constraint fk_hopdong_dmkhoaphong foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".h_hopdong add constraint fk_hopdong_dmhinhthuclv foreign key(mahinhthuclamviec) references " + sSchema + ".h_dmhinhthuclamviec(ma);\n";
            s_Sql += "alter table " + sSchema + ".h_hopdong add constraint fk_hopdong_dmchucvu foreign key(machucvu) references " + sSchema + ".h_dmchucvu(machucvu);\n";
            s_Sql += "alter table " + sSchema + ".h_hopdong add constraint fk_hopdong_dmnhanvien foreign key(nguoidaidienctyky) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "CREATE TABLE " + sSchema + ".h_phuluchopdong(idphuluchopdong varchar2(4),sophuluchopdong varchar2(100),tenphuluchopdong varchar2(200)," +
                "masohopdonggoc varchar2(4), mahopdong number(2,0) default 0 not null, ngaykyphuluchopdong date default sysdate," +
                "ngayhieulucphuluchopdong date default sysdate, ngaybatdauhieuluc date default sysdate," +
                "ngayhethieuluc date default sysdate, luongcoban number(14,0) default 0 not null, luongchinhthuc number(14,0) default 0 not null," +
                "mahinhthuclamviec number(1,0) default 0 not null, machucvu number(2,0), idkhoaphong number(3,0), nguoidaidienctyky varchar2(4)," +
                "sophep number(2,0),bhxh numeric(1,0) DEFAULT 0 not null, bhyt numeric(1,0) DEFAULT 0 not null, bhtn numeric(1,0) DEFAULT 0 not null, h_hsboiduonghienvat numeric(2,0) DEFAULT 0 not null," +
                "h_hsluong numeric(10,2) DEFAULT 0 not null, h_hschucvu numeric(10,2) DEFAULT 0 not null, h_hsvuotkhung numeric(10,2) DEFAULT 0 not null," +
                "h_hskiemnhiem numeric(10,2) DEFAULT 0 not null, h_hstrachnhiemcongviec numeric(10,2) DEFAULT 0 not null, h_hsphucapkhuvuc numeric(10,2) DEFAULT 0 not null," +
                "h_hsbaoluu numeric(10,2) DEFAULT 0 not null, h_hsdochai numeric(10,2) DEFAULT 0 not null, h_hsphucapdacbiet numeric(10,2) DEFAULT 0 not null,"+
                "h_hsdacthu numeric(10,2) DEFAULT 0 not null, h_hsluudong numeric(10,2) DEFAULT 0 not null, h_hsthuhut numeric(10,2) DEFAULT 0 not null,"+
                "h_hsuudai numeric(10,2) DEFAULT 0 not null, h_pctienan numeric(12,2) DEFAULT 0 not null, h_pctienxang numeric(12,2) DEFAULT 0 not null,"+//Thuy 30/09/15 
                "h_pctiendienthoai numeric(12,2) DEFAULT 0 not null, h_pckhac numeric(12,2) DEFAULT 0 not null,h_tongluonghesopc numeric(15,2) DEFAULT 0 not null,phuluchopdong numeric(1,0) default 0 not null,"+
                "computer varchar2(50), username varchar2(20),ngayud date DEFAULT sysdate," +
                " CONSTRAINT pk_h_phuluchopdong PRIMARY KEY (idphuluchopdong));\n";
            s_Sql += "alter table " + sSchema + ".h_phuluchopdong add constraint fk_hopdong_phuluchopdong foreign key(masohopdonggoc) references " + sSchema + ".h_hopdong(idhopdong);\n";
            s_Sql += "CREATE TABLE " + sSchema + ".h_dmnhomchamcong(ma varchar2(2) NOT NULL,ten nvarchar2(100),	ghichu nvarchar2(150)," +
                " CONSTRAINT h_dmnhomchamcong_pkey PRIMARY KEY (ma));\n";
            s_Sql += " CREATE TABLE " + sSchema + ".h_dmcalamviec(maca number(7) default 0  not null , tenca varchar2(20)," +
                "batdau varchar2(10), ketthuc varchar2(10), sophuttre number DEFAULT 0, sophutsom number DEFAULT 0," +
                "batdauvao varchar2(10), ketthucvao varchar2(10), batdaura varchar2(10), ketthucra varchar2(10)," +
                "sogio number(10,2) DEFAULT 0, manhom_chamcong varchar2(2), computer varchar2(50)," +
                "username varchar2(20), ngayud date DEFAULT sysdate, CONSTRAINT pk_dmcalamviec PRIMARY KEY (maca));\n";
            s_Sql += " alter table " + sSchema + ".h_dmcalamviec add constraint fk_calv_nhomchamcong foreign key(manhom_chamcong) references " + sSchema + ".h_dmnhomchamcong (ma);\n";
            s_Sql += " CREATE TABLE " + sSchema + ".h_dmtrangthaichamcong(ma varchar2(2) NOT NULL, ten nvarchar2(200), computer varchar2(50)," +
                "username varchar2(20), ngayud date DEFAULT sysdate, CONSTRAINT pk_dmtrangthaichamcong PRIMARY KEY (ma));\n";
            //Thuy 01/12/14
            s_Sql += "CREATE TABLE " + sSchema + ".h_chamcong (manhanvien character varying(4) not null, idkhoaphong numeric(3,0) default 0 not null," +
                " maca numeric DEFAULT 0 NOT NULL, ngay date, giovao date, giora date, matrangthaichamcong character varying(2) NOT NULL," +
                " computer character varying(50), username character varying(20), ngayud date, mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition h_chamcong_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter TABLE " + sSchema + ".h_chamcong add constraint pk_h_chamcong primary key(manhanvien, maca, giovao, idkhoaphong, mmyy);\n";
            s_Sql += "create table " + sSchema + ".b_dmnhomvienphibaocao(idnhomvienphi number(3),tennhomvienphi nvarchar2(150),tenkhongdau varchar2(100)," +
               "computer varchar2(50),ngayud date default sysdate not null,username varchar2(20));\n";
            s_Sql += "alter table " + sSchema + ".b_dmnhomvienphibaocao add constraint pk_nhomvienpphibc primary key(idnhomvienphi);\n";
            s_Sql += "alter table " + sSchema + ".b_dmloaivienphi add idnhomvienphibaocao number(3) default 0;\n";
            //Tú:02/12/2014
            s_Sql += "alter table " + sSchema + ".p_giayravien add ngayravien date;\n";
            s_Sql += "create table " + sSchema + ".m_dmtuongtac(mahoatchat1 VARCHAR2(8),tenhoatchat1 NVARCHAR2(508),mahoatchat2 VARCHAR2(8)," +
                    "tenhoatchat2 NVARCHAR2(508),tacdung nvarchar2(1000),computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmtuongtac add constraint pk_m_dmtuongtac primary key(tenhoatchat1,tenhoatchat2);\n";
            //linh 5/12/14
            s_Sql += "create table " + sSchema + ".p_vienphi_phongthuchien(idgiavienphi number(7),idkhoaphongbenhvien number(3),username varchar2(20)," +
                "computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_vienphi_phongthuchien add constraint pk_vienphi_phongthuchien primary key(idgiavienphi,idkhoaphongbenhvien);\n";
            s_Sql += "alter table " + sSchema + ".p_vienphi_phongthuchien add constraint fk_vienphi_giavienphi foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".p_vienphi_phongthuchien add constraint fk_vienphi_khoaphong foreign key(idkhoaphongbenhvien) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh add stt number(5);\n";
            s_Sql += "update " + sSchema + ".b_chidinh set stt=0 where stt is null;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh modify stt default 0;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh modify stt not null;\n";
            s_Sql += "ALTER TABLE " + sSchema + ".p_benhandt ADD CONSTRAINT ck_p_benhandt_mabn CHECK (mabn<>'');\n";
            //s_Sql += "ALTER TABLE " + sSchema + ".p_benhandt ADD CONSTRAINT ck_p_benhandt_maql CHECK (maql<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".p_nhapkhoa ADD CONSTRAINT ck_p_nhapkhoa_maql CHECK (maql<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".p_nhapkhoa ADD CONSTRAINT ck_p_nhapkhoa_id CHECK (id<>0);\n";

            s_Sql += "ALTER TABLE " + sSchema + ".m_ylenhthuoc  ADD CONSTRAINT ck_m_ylenhthuoc_idylenhthuoc CHECK (idylenhthuoc<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_ylenhthuocds ADD CONSTRAINT ck_m_ylenhthuocds_idylenhthuoc CHECK (idylenhthuoc<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_ylenhthuocds ADD CONSTRAINT ck_m_ylenhthuocds_idylthuocds CHECK (idylenhthuocds<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_ylenhthuocct ADD CONSTRAINT ck_m_ylenhthuocct_idylthuocds CHECK (idylenhthuocds<>0);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocds add constraint fk_ylenhthuocds_ylenhthuoc foreign key(idylenhthuoc) references " + sSchema + ".m_ylenhthuoc(idylenhthuoc);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add constraint fk_ylenhthuocct_ylenhthuocds foreign key(idylenhthuocds) references " + sSchema + ".m_ylenhthuocds(idylenhthuocds);\n";
            s_Sql += "alter table " + sSchema + ".m_thucxuattutruc add constraint fk_thucxuattutruc_ylenhthuocds foreign key(idylenhthuocds) references " + sSchema + ".m_ylenhthuocds(idylenhthuocds);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_phieuduyet  ADD CONSTRAINT ck_phieuduyet_idphieuduyet CHECK (idphieuduyet<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_xuatnoiviends ADD CONSTRAINT ck_xuatnoiviends_idphieuduyet CHECK (idphieuduyet<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_xuatnoiviends ADD CONSTRAINT ck_xuatnoiviends_idylthuocds CHECK (idylenhthuocds<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_xuatnoiviends ADD CONSTRAINT ck_xuatnoiviends_xuatnvds CHECK (idxuatnoiviends<>0);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoiviends add constraint fk_xuatnoiviends_phieuduyet foreign key(idphieuduyet) references " + sSchema + ".m_phieuduyet(idphieuduyet);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_xuatnoivienct ADD CONSTRAINT ck_xuatnoivienct_xuatnvds CHECK (idxuatnoiviends<>0);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add constraint fk_xuatnoivienct_xuatnoiviends foreign key(idxuatnoiviends) references " + sSchema + ".m_xuatnoiviends(idxuatnoiviends);\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add constraint fk_tienthuoc_xuatnoiviends foreign key(idxuatnoiviends) references " + sSchema + ".m_xuatnoiviends(idxuatnoiviends);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatct add constraint fk_xuatct_xuatll foreign key(idxuat) references " + sSchema + ".m_xuatll(idxuat);\n";
            s_Sql += "alter table " + sSchema + ".m_nhapct add constraint fk_nhapct_nhapll foreign key(idnhap) references " + sSchema + ".m_nhapll(idnhap);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_nhapct ADD CONSTRAINT ck_m_nhapct_soluong CHECK (soluong>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_nhapct ADD CONSTRAINT ck_m_nhapct_idnhap CHECK (idnhap<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".m_nhapll ADD CONSTRAINT ck_m_nhapll_idnhap CHECK (idnhap<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".b_chidinh ADD CONSTRAINT ck_b_chidinh_id CHECK (id<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".b_chidinh ADD CONSTRAINT ck_b_chidinh_maql CHECK (maql<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".b_chidinh ADD CONSTRAINT ck_b_chidinh_soluong CHECK (soluong>0);\n";

            s_Sql += "ALTER TABLE " + sSchema + ".b_vienphi ADD CONSTRAINT ck_b_vienphi_idvienphi CHECK (idvienphi<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".b_vienphict ADD CONSTRAINT ck_b_vienphict_idvienphi CHECK (idvienphi<>0);\n";
            s_Sql += "ALTER TABLE " + sSchema + ".b_vienphictthuoc ADD CONSTRAINT ck_b_vienphictthuoc_idvienphi CHECK (idvienphi<>0);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict add constraint fk_vienphict_vienphi foreign key(idvienphi) references " + sSchema + ".b_vienphi(idvienphi);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add constraint fk_vienphictthuoc_vienphi foreign key(idvienphi) references " + sSchema + ".b_vienphi(idvienphi);\n";
            s_Sql += "CREATE INDEX ind_hiendien_ngay ON " + sSchema + ".p_hiendien(ngay);\n";
            s_Sql += "create index ind_benhandt on " + sSchema + ".p_benhandt(mmyy);\n";
            s_Sql += "create index ind_benhandt_maql on " + sSchema + ".p_benhandt(maql);\n";
            s_Sql += "create index ind_benhandt_mavv on " + sSchema + ".p_benhandt(mavaovien);\n";
            s_Sql += "create index ind_benhandt_mabn on " + sSchema + ".p_benhandt(mabn);\n";
            s_Sql += "create index ind_benhandt_ngay on " + sSchema + ".p_benhandt(ngay);\n";
            s_Sql += "create index ind_benhandt_idkhoaphong on " + sSchema + ".p_benhandt(idkhoaphong);\n";
            s_Sql += "create index ind_lienhe on " + sSchema + ".p_lienhe(mmyy);\n";
            s_Sql += "create index ind_lienhe_mavaovien on " + sSchema + ".p_lienhe(mavaovien);\n";
            s_Sql += "create index ind_bhyt on " + sSchema + ".p_bhyt(mmyy);\n";
            s_Sql += "create index ind_bhyt_maql on " + sSchema + ".p_bhyt(maql);\n";
            s_Sql += "create index ind_bhyt_id on " + sSchema + ".p_bhyt(id);\n";
            s_Sql += "create index ind_nhapkhoa on " + sSchema + ".p_nhapkhoa(mmyy);\n";
            s_Sql += "create index ind_nhapkhoa_maql on " + sSchema + ".p_nhapkhoa(maql);\n";
            s_Sql += "create index ind_nhapkhoa_ngay on " + sSchema + ".p_nhapkhoa(ngay);\n";
            s_Sql += "create index ind_nhapkhoa_idkhoaphong on " + sSchema + ".p_nhapkhoa(idkhoaphong);\n";
            s_Sql += "create index ind_xuatkhoa on " + sSchema + ".p_xuatkhoa(mmyy);\n";
            s_Sql += "create index ind_xuatkhoa_ngay on " + sSchema + ".p_xuatkhoa(ngay);\n";
            s_Sql += "create index ind_xuatkhoa_id on " + sSchema + ".p_xuatkhoa(id);\n";
            s_Sql += "create index ind_xuatvien on " + sSchema + ".p_xuatvien(mmyy);\n";
            s_Sql += "create index ind_xuatvien_maql on " + sSchema + ".p_xuatvien(maql);\n";
            s_Sql += "create index ind_xuatvien_ngay on " + sSchema + ".p_xuatvien(ngay);\n";
            s_Sql += "create index ind_xuatvien_idkhoaphong on " + sSchema + ".p_xuatvien(idkhoaphong);\n";
            s_Sql += "create index ind_dausinhton on " + sSchema + ".p_dausinhton(mmyy);\n";
            s_Sql += "create index ind_dausinhton_id on " + sSchema + ".p_dausinhton(id);\n";
            s_Sql += "create index ind_dausinhton_maql on " + sSchema + ".p_dausinhton(maql);\n";
            s_Sql += "create index ind_dausinhton_ngay on " + sSchema + ".p_dausinhton(ngay);\n";
            s_Sql += "create index ind_benhkemtheo on " + sSchema + ".p_benhkemtheo(mmyy);\n";
            s_Sql += "create index ind_benhkemtheo_id on " + sSchema + ".p_benhkemtheo(id);\n";
            s_Sql += "create index ind_benhkemtheo_maql on " + sSchema + ".p_benhkemtheo(maql);\n";
            s_Sql += "create index ind_benhmantinh on " + sSchema + ".p_benhmantinh(mmyy);\n";
            s_Sql += "create index ind_benhmantinh_mabn on " + sSchema + ".p_benhmantinh(mabn);\n";
            s_Sql += "create index ind_benhmantinh_ngay on " + sSchema + ".p_benhmantinh(ngay);\n";
            s_Sql += "create index ind_benhtiensu on " + sSchema + ".p_benhtiensu(mmyy);\n";
            s_Sql += "create index ind_benhtiensu_id on " + sSchema + ".p_benhtiensu(id);\n";
            s_Sql += "create index ind_benhtiensu_mabn on " + sSchema + ".p_benhtiensu(mabn);\n";
            s_Sql += "create index ind_benhtiensu_ngay on " + sSchema + ".p_benhtiensu(ngay);\n";
            s_Sql += "create index ind_giaychuyenvien on " + sSchema + ".p_giaychuyenvien(mmyy);\n";
            s_Sql += "create index ind_giaychuyenvien_maql on " + sSchema + ".p_giaychuyenvien(maql);\n";
            s_Sql += "create index ind_giaychuyenvien_ngay on " + sSchema + ".p_giaychuyenvien(ngay);\n";
            s_Sql += "create index ind_giayravien on " + sSchema + ".p_giayravien(mmyy);\n";
            s_Sql += "create index ind_giayravien_maql on " + sSchema + ".p_giayravien(maql);\n";
            s_Sql += "create index ind_lichhen on " + sSchema + ".p_lichhen(mmyy);\n";
            s_Sql += "create index ind_lichhen_idlichhen on " + sSchema + ".p_lichhen(idlichhen);\n";
            s_Sql += "create index ind_lichhen_macuochen on " + sSchema + ".p_lichhen(macuochen);\n";
            s_Sql += "create index ind_lichhen_mabenhnhan on " + sSchema + ".p_lichhen(mabn);\n";
            s_Sql += "create index ind_tainanthuongtich on " + sSchema + ".p_tainanthuongtich(mmyy);\n";
            s_Sql += "create index ind_tainanthuongtich_maql on " + sSchema + ".p_tainanthuongtich(maql);\n";
            s_Sql += "create index ind_tainanthuongtich_idkp on " + sSchema + ".p_tainanthuongtich(idkhoaphong);\n";
            s_Sql += "create index ind_tainanthuongtich_ngay on " + sSchema + ".p_tainanthuongtich(ngay);\n";
            s_Sql += "create index ind_pttt on " + sSchema + ".p_pttt(mmyy);\n";
            s_Sql += "create index ind_pttt_idpttt on " + sSchema + ".p_pttt(idpttt);\n";
            s_Sql += "create index ind_pttt_maql on " + sSchema + ".p_pttt(maql);\n";
            s_Sql += "create index ind_pttt_idkhoaphong on " + sSchema + ".p_pttt(idkhoaphong);\n";
            s_Sql += "create index ind_pttt_ngay on " + sSchema + ".p_pttt(ngay);\n";
            s_Sql += "create index ind_theodoigiuong on " + sSchema + ".p_theodoigiuong(mmyy);\n";
            s_Sql += "create index ind_theodoigiuong_id on " + sSchema + ".p_theodoigiuong(idtheodoigiuong);\n";
            s_Sql += "create index ind_theodoigiuong_maql on " + sSchema + ".p_theodoigiuong(maql);\n";
            s_Sql += "create index ind_theodoigiuong_idkhoaphong on " + sSchema + ".p_theodoigiuong(idkhoaphong);\n";
            s_Sql += "create index ind_theodoigiuong_tungay on " + sSchema + ".p_theodoigiuong(tungay);\n";
            s_Sql += "create index ind_toathuocll on " + sSchema + ".p_toathuocll(mmyy);\n";
            s_Sql += "create index ind_toathuocll_idtoathuoc on " + sSchema + ".p_toathuocll(idtoathuoc);\n";
            s_Sql += "create index ind_toathuocll_maql on " + sSchema + ".p_toathuocll(maql);\n";
            s_Sql += "create index ind_toathuocll_idkhoaphong on " + sSchema + ".p_toathuocll(idkhoaphong);\n";
            s_Sql += "create index ind_toathuocll_ngay on " + sSchema + ".p_toathuocll(ngay);\n";
            s_Sql += "create index ind_toathuocct on " + sSchema + ".p_toathuocct(mmyy);\n";
            s_Sql += "create index ind_toathuocct_idtoathuoc on " + sSchema + ".p_toathuocct(idtoathuoc);\n";
            s_Sql += "create index ind_toathuocct_idkho on " + sSchema + ".p_toathuocct(idkho);\n";
            s_Sql += "create index ind_toathuocct_idbietduoc on " + sSchema + ".p_toathuocct(idbietduoc);\n";
            s_Sql += "create index ind_xutridieutri on " + sSchema + ".p_xutridieutri(mmyy);\n";
            s_Sql += "create index ind_xutridieutri_maql on " + sSchema + ".p_xutridieutri(maql);\n";
            s_Sql += "create index ind_xutridieutri_maxutri on " + sSchema + ".p_xutridieutri(maxutri);\n";
            s_Sql += "create index ind_ketquall on " + sSchema + ".r_ketquall(mmyy);\n";
            s_Sql += "create index ind_ketquall_idketqua on " + sSchema + ".r_ketquall(idketqua);\n";
            s_Sql += "create index ind_ketquall_ngay on " + sSchema + ".r_ketquall(ngay);\n";
            s_Sql += "create index ind_ketquall_maql on " + sSchema + ".r_ketquall(maql);\n";
            s_Sql += "create index ind_ketquact on " + sSchema + ".r_ketquact(mmyy);\n";
            s_Sql += "create index ind_ketquact_idketqua on " + sSchema + ".r_ketquact(idketqua);\n";
            s_Sql += "create index ind_ketquact_makt on " + sSchema + ".r_ketquact(makt);\n";
            s_Sql += "create index ind_ketquact_makp on " + sSchema + ".r_ketquact(makp);\n";
            s_Sql += "create index ind_dutrumuall on " + sSchema + ".m_dutrumuall(mmyy);\n";
            s_Sql += "create index ind_dutrumuall_iddutrumua on " + sSchema + ".m_dutrumuall(iddutrumua);\n";
            s_Sql += "create index ind_dutrumuall_sophieu on " + sSchema + ".m_dutrumuall(sophieu);\n";
            s_Sql += "create index ind_dutrumuall_ngay on " + sSchema + ".m_dutrumuall(ngay);\n";
            s_Sql += "create index ind_dutrumuact on " + sSchema + ".m_dutrumuact(mmyy);\n";
            s_Sql += "create index ind_dutrumuact_iddutrumua on " + sSchema + ".m_dutrumuact(iddutrumua);\n";
            s_Sql += "create index ind_dutrumuact_idbietduoc on " + sSchema + ".m_dutrumuact(idbietduoc);\n";
            s_Sql += "create index ind_duyetchiphi on " + sSchema + ".m_duyetchiphi(mmyy);\n";
            s_Sql += "create index ind_duyetchiphi_id on " + sSchema + ".m_duyetchiphi(idduyetchiphi);\n";
            s_Sql += "create index ind_duyetchiphi_ngay on " + sSchema + ".m_duyetchiphi(ngay);\n";
            s_Sql += "create index ind_duyetchiphi_maql on " + sSchema + ".m_duyetchiphi(maql);\n";
            s_Sql += "create index ind_duyetchiphi_idkhoaphong on " + sSchema + ".m_duyetchiphi(idkhoaphong);\n";
            s_Sql += "create index ind_duyetchiphicls on " + sSchema + ".m_duyetchiphicls(mmyy);\n";
            s_Sql += "create index ind_duyetchiphicls_id on " + sSchema + ".m_duyetchiphicls(idduyetchiphi);\n";
            s_Sql += "create index ind_duyetchiphicls_idgiavp on " + sSchema + ".m_duyetchiphicls(idgiavienphi);\n";
            s_Sql += "create index ind_duyetchiphicls_idchidinh on " + sSchema + ".m_duyetchiphicls(idchidinh);\n";
            s_Sql += "create index ind_duyetchiphithuoc on " + sSchema + ".m_duyetchiphithuoc(mmyy);\n";
            s_Sql += "create index ind_duyetchiphithuoc_idduyetcp on " + sSchema + ".m_duyetchiphithuoc(idduyetchiphi);\n";
            s_Sql += "create index ind_duyetchiphithuoc_idkho on " + sSchema + ".m_duyetchiphithuoc(idkho);\n";
            s_Sql += "create index ind_duyetchiphithuoc_idtoa on " + sSchema + ".m_duyetchiphithuoc(idtoathuoc);\n";
            s_Sql += "create index ind_duyetdutrumuall on " + sSchema + ".m_duyetdutrumuall(mmyy);\n";
            s_Sql += "create index ind_duyetdutrumuall_idduyetdtm on " + sSchema + ".m_duyetdutrumuall(idduyetdutrumua);\n";
            s_Sql += "create index ind_duyetdutrumuall_sophieu on " + sSchema + ".m_duyetdutrumuall(sophieu);\n";
            s_Sql += "create index ind_duyetdutrumuall_ngay on " + sSchema + ".m_duyetdutrumuall(ngay);\n";
            s_Sql += "create index ind_duyetdutrumuact on " + sSchema + ".m_duyetdutrumuact(mmyy);\n";
            s_Sql += "create index ind_duyetdutrumuact_idduyetdtm on " + sSchema + ".m_duyetdutrumuact(idduyetdutrumua);\n";
            s_Sql += "create index ind_duyetdutrumuact_idbietduoc on " + sSchema + ".m_duyetdutrumuact(idbietduoc);\n";
            s_Sql += "create index ind_nhapll on " + sSchema + ".m_nhapll(mmyy);\n";
            s_Sql += "create index ind_nhapll_idnhap on " + sSchema + ".m_nhapll(idnhap);\n";
            s_Sql += "create index ind_nhapll_sophieu on " + sSchema + ".m_nhapll(sophieu);\n";
            s_Sql += "create index ind_nhapll_ngaynhap on " + sSchema + ".m_nhapll(ngaynhap);\n";
            s_Sql += "create index ind_nhapct on " + sSchema + ".m_nhapct(mmyy);\n";
            s_Sql += "create index ind_nhapct_idnhap on " + sSchema + ".m_nhapct(idnhap);\n";
            s_Sql += "create index ind_phieuduyet on " + sSchema + ".m_phieuduyet(mmyy);\n";
            s_Sql += "create index ind_phieuduyet_idphieuduyet on " + sSchema + ".m_phieuduyet(idphieuduyet);\n";
            s_Sql += "create index ind_phieuduyet_ngay on " + sSchema + ".m_phieuduyet(ngay);\n";
            s_Sql += "create index ind_phieuduyet_idkhoaphong on " + sSchema + ".m_phieuduyet(idkhoaphong);\n";
            s_Sql += "create index ind_phieuduyet_idtutruc on " + sSchema + ".m_phieuduyet(idtutruc);\n";
            s_Sql += "create index ind_sophieuduyet on " + sSchema + ".m_sophieuduyet(mmyy);\n";
            s_Sql += "create index ind_sophieuduyet_idphieuduyet on " + sSchema + ".m_sophieuduyet(idphieuduyet);\n";
            s_Sql += "create index ind_sophieuduyet_idnhom on " + sSchema + ".m_sophieuduyet(idnhom);\n";
            s_Sql += "create index ind_sophieuduyet_sophieu on " + sSchema + ".m_sophieuduyet(sophieu);\n";
            s_Sql += "create index ind_sophieumau38 on " + sSchema + ".m_sophieumau38(mmyy);\n";
            s_Sql += "create index ind_sophieumau38_mabn on " + sSchema + ".m_sophieumau38(mabn);\n";
            s_Sql += "create index ind_sophieumau38_mavaovien on " + sSchema + ".m_sophieumau38(mavaovien);\n";
            s_Sql += "create index ind_sophieumau38_ngay on " + sSchema + ".m_sophieumau38(ngay);\n";
            s_Sql += "create index ind_sophieumau38_loaibenhan on " + sSchema + ".m_sophieumau38(loaibenhan);\n";
            s_Sql += "create index ind_theodoi on " + sSchema + ".m_theodoi(mmyy);\n";
            s_Sql += "create index ind_theodoi_idtheodoi on " + sSchema + ".m_theodoi(idtheodoi);\n";
            s_Sql += "create index ind_theodoi_idbietduoc on " + sSchema + ".m_theodoi(idbietduoc);\n";
            s_Sql += "create index ind_theodoi_idnuoc on " + sSchema + ".m_theodoi(idnuoc);\n";
            s_Sql += "create index ind_theodoi_idhang on " + sSchema + ".m_theodoi(idhang);\n";
            s_Sql += "create index ind_theodoi_idnguon on " + sSchema + ".m_theodoi(idnguon);\n";
            s_Sql += "create index ind_theodoi_idnhacc on " + sSchema + ".m_theodoi(idnhacungcap);\n";
            s_Sql += "create index ind_xuatnoiviends on " + sSchema + ".m_xuatnoiviends(mmyy);\n";
            s_Sql += "create index ind_xuatnoiviends_idxuatnvds on " + sSchema + ".m_xuatnoiviends(idxuatnoiviends);\n";
            s_Sql += "create index ind_xuatnoiviends_idphieuduyet on " + sSchema + ".m_xuatnoiviends(idphieuduyet);\n";
            s_Sql += "create index ind_xuatnoiviends_idylenhtds on " + sSchema + ".m_xuatnoiviends(idylenhthuocds);\n";
            s_Sql += "create index ind_xuatnoiviends_maql on " + sSchema + ".m_xuatnoiviends(maql);\n";
            s_Sql += "create index ind_xuatnoivienct on " + sSchema + ".m_xuatnoivienct(mmyy);\n";
            s_Sql += "create index ind_xuatnoivienct_idtheodoi on " + sSchema + ".m_xuatnoivienct(idtheodoi);\n";
            s_Sql += "create index ind_xuatnoivienct_idxuatnvds on " + sSchema + ".m_xuatnoivienct(idxuatnoiviends);\n";
            s_Sql += "create index ind_xuatnoivienct_idkho on " + sSchema + ".m_xuatnoivienct(idkho);\n";
            s_Sql += "create index ind_xuatnoivienct_madoituong on " + sSchema + ".m_xuatnoivienct(madoituong);\n";
            s_Sql += "create index ind_thucxuattutruc on " + sSchema + ".m_thucxuattutruc(mmyy);\n";
            s_Sql += "create index ind_thucxuattutruc_idtheodoi on " + sSchema + ".m_thucxuattutruc(idtheodoi);\n";
            s_Sql += "create index ind_thucxuattutruc_idylenhtds on " + sSchema + ".m_thucxuattutruc(idylenhthuocds);\n";
            s_Sql += "create index ind_thucxuattutruc_idkho on " + sSchema + ".m_thucxuattutruc(idkho);\n";
            s_Sql += "create index ind_tienthuoc on " + sSchema + ".m_tienthuoc(mmyy);\n";
            s_Sql += "create index ind_tienthuoc_idxuatnoiviends on " + sSchema + ".m_tienthuoc(idxuatnoiviends);\n";
            s_Sql += "create index ind_tienthuoc_idbietduoc on " + sSchema + ".m_tienthuoc(idbietduoc);\n";
            s_Sql += "create index ind_tienthuoc_madoituong on " + sSchema + ".m_tienthuoc(madoituong);\n";
            s_Sql += "create index ind_tondau on " + sSchema + ".m_tondau(mmyy);\n";
            s_Sql += "create index ind_tondau_idtheodoi on " + sSchema + ".m_tondau(idtheodoi);\n";
            s_Sql += "create index ind_tondau_idkho on " + sSchema + ".m_tondau(idkho);\n";
            s_Sql += "create index ind_tondau_idtutruc on " + sSchema + ".m_tondau(idtutruc);\n";
            s_Sql += "create index ind_tonkhochitiet on " + sSchema + ".m_tonkhochitiet(mmyy);\n";
            s_Sql += "create index ind_tonkhochitiet_idtheodoi on " + sSchema + ".m_tonkhochitiet(idtheodoi);\n";
            s_Sql += "create index ind_tonkhochitiet_idkho on " + sSchema + ".m_tonkhochitiet(idkho);\n";
            s_Sql += "create index ind_tonkhotonghop on " + sSchema + ".m_tonkhotonghop(mmyy);\n";
            s_Sql += "create index ind_tonkhotonghop_idbietduoc on " + sSchema + ".m_tonkhotonghop(idbietduoc);\n";
            s_Sql += "create index ind_tonkhotonghop_idkho on " + sSchema + ".m_tonkhotonghop(idkho);\n";
            s_Sql += "create index ind_tonkhotonghop_idnguon on " + sSchema + ".m_tonkhotonghop(idnguon);\n";
            s_Sql += "create index ind_tontutrucchitiet on " + sSchema + ".m_tontutrucchitiet(mmyy);\n";
            s_Sql += "create index ind_tontutrucchitiet_idtheodoi on " + sSchema + ".m_tontutrucchitiet(idtheodoi);\n";
            s_Sql += "create index ind_tontutrucchitiet_idkho on " + sSchema + ".m_tontutrucchitiet(idkho);\n";
            s_Sql += "create index ind_tontutrucchitiet_idtutruc on " + sSchema + ".m_tontutrucchitiet(idtutruc);\n";
            s_Sql += "create index ind_tontutructonghop on " + sSchema + ".m_tontutructonghop(mmyy);\n";
            s_Sql += "create index ind_tontutructonghop_idbd on " + sSchema + ".m_tontutructonghop(idbietduoc);\n";
            s_Sql += "create index ind_tontutructonghop_idkho on " + sSchema + ".m_tontutructonghop(idkho);\n";
            s_Sql += "create index ind_tontutructonghop_idtutruc on " + sSchema + ".m_tontutructonghop(idtutruc);\n";
            s_Sql += "create index ind_tontutructonghop_idnguon on " + sSchema + ".m_tontutructonghop(idnguon);\n";
            s_Sql += "create index ind_xuatll on " + sSchema + ".m_xuatll(mmyy);\n";
            s_Sql += "create index ind_xuatll_idxuat on " + sSchema + ".m_xuatll(idxuat);\n";
            s_Sql += "create index ind_xuatll_sophieu on " + sSchema + ".m_xuatll(sophieu);\n";
            s_Sql += "create index ind_xuatll_ngay on " + sSchema + ".m_xuatll(ngay);\n";
            s_Sql += "create index ind_xuatll_loai on " + sSchema + ".m_xuatll(loai);\n";
            s_Sql += "create index ind_xuatll_idkhoxuat on " + sSchema + ".m_xuatll(idkhoxuat);\n";
            s_Sql += "create index ind_xuatll_idkhonhap on " + sSchema + ".m_xuatll(idkhonhap);\n";
            s_Sql += "create index ind_xuatll_idtutruc on " + sSchema + ".m_xuatll(idtutruc);\n";
            s_Sql += "create index ind_xuatct on " + sSchema + ".m_xuatct(mmyy);\n";
            s_Sql += "create index ind_xuatct_idxuat on " + sSchema + ".m_xuatct(idxuat);\n";
            s_Sql += "create index ind_xuatct_idtheodoi on " + sSchema + ".m_xuatct(idtheodoi);\n";
            s_Sql += "create index ind_ylenhthuoc on " + sSchema + ".m_ylenhthuoc(mmyy);\n";
            s_Sql += "create index ind_ylenhthuoc_idylenhthuoc on " + sSchema + ".m_ylenhthuoc(idylenhthuoc);\n";
            s_Sql += "create index ind_ylenhthuoc_ngay on " + sSchema + ".m_ylenhthuoc(ngay);\n";
            s_Sql += "create index ind_ylenhthuoc_idkhoaphong on " + sSchema + ".m_ylenhthuoc(idkhoaphong);\n";
            s_Sql += "create index ind_ylenhthuoc_idtutruc on " + sSchema + ".m_ylenhthuoc(idtutruc);\n";
            s_Sql += "create index ind_ylenhthuoc_idphieu on " + sSchema + ".m_ylenhthuoc(idphieu);\n";
            s_Sql += "create index ind_ylenhthuocds on " + sSchema + ".m_ylenhthuocds(mmyy);\n";
            s_Sql += "create index ind_ylenhthuocds_idylenhthuoc on " + sSchema + ".m_ylenhthuocds(idylenhthuoc);\n";
            s_Sql += "create index ind_ylenhthuocds_idylenhtds on " + sSchema + ".m_ylenhthuocds(idylenhthuocds);\n";
            s_Sql += "create index ind_ylenhthuocds_maql on " + sSchema + ".m_ylenhthuocds(maql);\n";
            s_Sql += "create index ind_ylenhthuocct on " + sSchema + ".m_ylenhthuocct(mmyy);\n";
            s_Sql += "create index ind_ylenhthuocct_idylenhthuocds on " + sSchema + ".m_ylenhthuocct(idylenhthuocds);\n";
            s_Sql += "create index ind_ylenhthuocct_idbietduoc on " + sSchema + ".m_ylenhthuocct(idbietduoc);\n";
            s_Sql += "create index ind_ylenhthuocct_madoituong on " + sSchema + ".m_ylenhthuocct(madoituong);\n";
            s_Sql += "create index ind_ylenhthuocct_idkho on " + sSchema + ".m_ylenhthuocct(idkho);\n";
            s_Sql += "create index ind_ylenhthuocct_idnguon on " + sSchema + ".m_ylenhthuocct(idnguon);\n";
            s_Sql += "create index ind_hoantra on " + sSchema + ".b_hoantra(mmyy);\n";
            s_Sql += "create index ind_hoantra_id on " + sSchema + ".b_hoantra(id);\n";
            s_Sql += "create index ind_hoantra_ngay on " + sSchema + ".b_hoantra(ngay);\n";
            s_Sql += "create index ind_hoantra_idkhoaphong on " + sSchema + ".b_hoantra(idkhoaphong);\n";
            s_Sql += "create index ind_hoantra_maql on " + sSchema + ".b_hoantra(maql);\n";
            s_Sql += "create index ind_hoantra_idquyenso on " + sSchema + ".b_hoantra(idquyenso);\n";
            s_Sql += "create index ind_tamung on " + sSchema + ".b_tamung(mmyy);\n";
            s_Sql += "create index ind_tamung_id on " + sSchema + ".b_tamung(id);\n";
            s_Sql += "create index ind_tamung_ngay on " + sSchema + ".b_tamung(ngay);\n";
            s_Sql += "create index ind_tamung_idkhoaphong on " + sSchema + ".b_tamung(idkhoaphong);\n";
            s_Sql += "create index ind_tamung_maql on " + sSchema + ".b_tamung(maql);\n";
            s_Sql += "create index ind_tamung_idquyenso on " + sSchema + ".b_tamung(idquyenso);\n";
            s_Sql += "create index ind_tamung_madoituong on " + sSchema + ".b_tamung(madoituong);\n";
            //linh 8/12/14
            s_Sql += "create index ind_tamungcd on " + sSchema + ".b_tamungcd(mmyy);\n";
            s_Sql += "create index ind_tamungcd_id on " + sSchema + ".b_tamungcd(id);\n";
            s_Sql += "create index ind_tamungcd_ngay on " + sSchema + ".b_tamungcd(ngay);\n";
            s_Sql += "create index ind_tamungcd_idkhoaphong on " + sSchema + ".b_tamungcd(idkhoaphong);\n";
            s_Sql += "create index ind_tamungcd_maql on " + sSchema + ".b_tamungcd(maql);\n";
            s_Sql += "create index ind_tamungcd_madoituong on " + sSchema + ".b_tamungcd(madoituong);\n";
            s_Sql += "create index ind_chidinh on " + sSchema + ".b_chidinh(mmyy);\n";
            s_Sql += "create index ind_chidinh_id on " + sSchema + ".b_chidinh(id);\n";
            s_Sql += "create index ind_chidinh_ngay on " + sSchema + ".b_chidinh(ngay);\n";
            s_Sql += "create index ind_chidinh_idkhoaphong on " + sSchema + ".b_chidinh(idkhoaphong);\n";
            s_Sql += "create index ind_chidinh_maql on " + sSchema + ".b_chidinh(maql);\n";
            s_Sql += "create index ind_chidinh_madoituong on " + sSchema + ".b_chidinh(madoituong);\n";
            s_Sql += "create index ind_thuocchuavuottran on " + sSchema + ".b_thuocchuavuottran(mmyy);\n";
            s_Sql += "create index ind_thuocchuavuottran_idvp on " + sSchema + ".b_thuocchuavuottran(idvienphi);\n";
            s_Sql += "create index ind_thuocchuavuottran_ngay on " + sSchema + ".b_thuocchuavuottran(ngay);\n";
            s_Sql += "create index ind_thuocchuavuottran_idkp on " + sSchema + ".b_thuocchuavuottran(idkhoaphong);\n";
            s_Sql += "create index ind_thuocchuavuottran_madt on " + sSchema + ".b_thuocchuavuottran(madoituong);\n";
            s_Sql += "create index ind_thuocchuavuottran_idgiavp on " + sSchema + ".b_thuocchuavuottran(idgiavienphi);\n";
            s_Sql += "create index ind_vienphichuavuottran on " + sSchema + ".b_vienphichuavuottran(mmyy);\n";
            s_Sql += "create index ind_vienphichuavuottran_idvp on " + sSchema + ".b_vienphichuavuottran(idvienphi);\n";
            s_Sql += "create index ind_vienphichuavuottran_ngay on " + sSchema + ".b_vienphichuavuottran(ngay);\n";
            s_Sql += "create index ind_vienphichuavuottran_idkp on " + sSchema + ".b_vienphichuavuottran(idkhoaphong);\n";
            s_Sql += "create index ind_vienphichuavuottran_madoituong on " + sSchema + ".b_vienphichuavuottran(madoituong);\n";
            s_Sql += "create index ind_vienphi on " + sSchema + ".b_vienphi(mmyy);\n";
            s_Sql += "create index ind_vienphi_idvienphi on " + sSchema + ".b_vienphi(idvienphi);\n";
            s_Sql += "create index ind_vienphi_ngay on " + sSchema + ".b_vienphi(ngay);\n";
            s_Sql += "create index ind_vienphi_idkhoaphong on " + sSchema + ".b_vienphi(idkhoaphong);\n";
            s_Sql += "create index ind_vienphi_maql on " + sSchema + ".b_vienphi(maql);\n";
            s_Sql += "create index ind_vienphict on " + sSchema + ".b_vienphict(mmyy);\n";
            s_Sql += "create index ind_vienphict_idvienphi on " + sSchema + ".b_vienphict(idvienphi);\n";
            s_Sql += "create index ind_vienphict_ngay on " + sSchema + ".b_vienphict(ngay);\n";
            s_Sql += "create index ind_vienphict_idkhoaphong on " + sSchema + ".b_vienphict(idkhoaphong);\n";
            s_Sql += "create index ind_vienphict_madoituong on " + sSchema + ".b_vienphict(madoituong);\n";
            s_Sql += "create index ind_vienphictthuoc on " + sSchema + ".b_vienphictthuoc(mmyy);\n";
            s_Sql += "create index ind_vienphictthuoc_idvienphi on " + sSchema + ".b_vienphictthuoc(idvienphi);\n";
            s_Sql += "create index ind_vienphictthuoc_ngay on " + sSchema + ".b_vienphictthuoc(ngay);\n";
            s_Sql += "create index ind_vienphictthuoc_idkhoaphong on " + sSchema + ".b_vienphictthuoc(idkhoaphong);\n";
            s_Sql += "create index ind_vienphictthuoc_madoituong on " + sSchema + ".b_vienphictthuoc(madoituong);\n";
            s_Sql += "create index ind_ketqua on " + sSchema + ".l_ketqua(mmyy);\n";
            s_Sql += "create index ind_ketqua_idketqua on " + sSchema + ".l_ketqua(idketqua);\n";
            s_Sql += "create index ind_ketqua_ngay on " + sSchema + ".l_ketqua(ngay);\n";
            s_Sql += "create index ind_ketqua_maql on " + sSchema + ".l_ketqua(maql);\n";
            s_Sql += "create index ind_ketqua_sophieu on " + sSchema + ".l_ketqua(sophieu);\n";
            s_Sql += "create index ind_ketqua_loaibn on " + sSchema + ".l_ketqua(loaibn);\n";
            s_Sql += "create index ind_ketquachitiet on " + sSchema + ".l_ketquachitiet(mmyy);\n";
            s_Sql += "create index ind_ketquachitiet_idketqua on " + sSchema + ".l_ketquachitiet(idketqua);\n";
            s_Sql += "create index ind_ketquachitiet_idxetnghiem on " + sSchema + ".l_ketquachitiet(idxetnghiem);\n";
            s_Sql += "create index ind_ketquachitiet_idvienphi on " + sSchema + ".l_ketquachitiet(idvienphi);\n";
            s_Sql += "create index ind_thanhvienekipmo on " + sSchema + ".p_thanhvienekipmo(mmyy);\n";
            s_Sql += "create index ind_thanhvienekipmo_idpttt on " + sSchema + ".p_thanhvienekipmo(idpttt);\n";
            s_Sql += "create index ind_thanhvienekipmo_idchucnang on " + sSchema + ".p_thanhvienekipmo(idchucnang);\n";
            s_Sql += "create index ind_thanhvienekipmo_manhanvien on " + sSchema + ".p_thanhvienekipmo(manhanvien);\n";
            s_Sql += "create index ind_chuyensolieu on " + sSchema + ".b_chuyensolieu(mmyy);\n";
            s_Sql += "create index ind_chuyensolieu_idchuyensl on " + sSchema + ".b_chuyensolieu(idchuyensolieu);\n";
            s_Sql += "create index ind_chuyensolieu_idkhoaphong on " + sSchema + ".b_chuyensolieu(idkhoaphong);\n";
            s_Sql += "create index ind_dutrucapll on " + sSchema + ".m_dutrucapll(mmyy);\n";
            s_Sql += "create index ind_dutrucapll_iddutrucap on " + sSchema + ".m_dutrucapll(iddutrucap);\n";
            s_Sql += "create index ind_dutrucapll_ngay on " + sSchema + ".m_dutrucapll(ngay);\n";
            s_Sql += "create index ind_dutrucapll_idkhoxuat on " + sSchema + ".m_dutrucapll(idkhoxuat);\n";
            s_Sql += "create index ind_dutrucapll_idkhonhap on " + sSchema + ".m_dutrucapll(idkhonhap);\n";
            s_Sql += "create index ind_dutrucapct on " + sSchema + ".m_dutrucapct(mmyy);\n";
            s_Sql += "create index ind_dutrucapct_iddutrucap on " + sSchema + ".m_dutrucapct(iddutrucap);\n";
            s_Sql += "create index ind_phatthuoc on " + sSchema + ".m_phatthuoc(mmyy);\n";
            s_Sql += "create index ind_phatthuoc_idduyet on " + sSchema + ".m_phatthuoc(idduyet);\n";
            s_Sql += "create index ind_phatthuoc_idkho on " + sSchema + ".m_phatthuoc(idkho);\n";
            s_Sql += "create index ind_denghi on " + sSchema + ".m_denghi(mmyy);\n";
            s_Sql += "create index ind_denghi_iddenghi on " + sSchema + ".m_denghi(iddenghi);\n";
            s_Sql += "create index ind_denghi_sophieu on " + sSchema + ".m_denghi(sophieu);\n";
            s_Sql += "create index ind_denghi_ngaydenghi on " + sSchema + ".m_denghi(ngaydenghi);\n";
            s_Sql += "create index ind_denghichitiet on " + sSchema + ".m_denghichitiet(mmyy);\n";
            s_Sql += "create index ind_denghichitiet_iddenghi on " + sSchema + ".m_denghichitiet(iddenghi);\n";
            s_Sql += "create index ind_labketqua on " + sSchema + ".l_labketqua(mmyy);\n";
            s_Sql += "create index ind_labketqua_idtraketqua on " + sSchema + ".l_labketqua(idtraketqua);\n";
            s_Sql += "create index ind_labketqua_idxetnghiem on " + sSchema + ".l_labketqua(idxetnghiem);\n";
            s_Sql += "create index ind_labketqua_idmay on " + sSchema + ".l_labketqua(idmay);\n";
            s_Sql += "create index ind_labketqua_ngay on " + sSchema + ".l_labketqua(ngay);\n";
            s_Sql += "create index ind_ketquagiaiphaubenh_ngay on " + sSchema + ".l_ketquagiaiphaubenh(ngay);\n";
            s_Sql += "create index ind_ketquagiaiphaubenh_idchidinh on " + sSchema + ".l_ketquagiaiphaubenh(idchidinh);\n";
            //Thuy 08/12/14
            s_Sql += "alter table " + sSchema + ".p_giaychuyenvien rename column lydochuyenvien to huongdieutri;\n";
            //ThanhCuong - 09/12/2014
            s_Sql += " alter table " + sSchema + ".m_xuatnoivienct add soluongyeucau number(20,7);\n";
            s_Sql += "update " + sSchema + ".m_xuatnoivienct set soluongyeucau=0 where soluongyeucau is null;\n";
            s_Sql += " alter table " + sSchema + ".m_xuatnoivienct modify soluongyeucau default 0;\n";
            s_Sql += " alter table " + sSchema + ".m_xuatnoivienct modify soluongyeucau not null;\n";
            //
            //linh 0/12/14
            s_Sql += "alter table " + sSchema + ".b_chidinh add iddotchidinh number(30) default 0 not null;\n";
            //Thuy 10/12/14
            s_Sql += "create table " + sSchema + ".m_thauds(idthau number(30,0) default 0 not null,idnhomkho number(2) DEFAULT 0 not null," +
                "ngayquyetdinh date,soquyetdinh varchar2(50),dotthau nvarchar2(50),nam number(4,0),idnhacungcap number(5,0) default 0 not null," +
                "ghichu nvarchar2(500),username varchar2(20),computer varchar2(50),ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_thauds add constraint pk_m_thauds primary key(idthau);\n";
            s_Sql += "alter table " + sSchema + ".m_thauds add constraint fk_thauds_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter table " + sSchema + ".m_thauds add constraint fk_thauds_nhacc foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap);\n";
            s_Sql += "alter table " + sSchema + ".m_thauds add constraint fk_thauds_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "create table " + sSchema + ".m_thauct(idthau number(30,0) default 0 not null,stt number (3,0) default 0 not null,idbietduoc number(7) DEFAULT 0 not null," +
                "handung date,soluong number(30,8) DEFAULT 0 not null,dongia number(24,10) default 0 not null,vat number(3) DEFAULT 0 not null," +
                "giasauvat number(24,10) default 0 not null,ghichu nvarchar2(500),username varchar2(20),computer varchar2(50),ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_thauct add constraint pk_m_thauct primary key(idthau,stt);\n";
            s_Sql += "alter table " + sSchema + ".m_thauct add constraint fk_thauct_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_thauct add constraint fk_thauct_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";

            //Tú:11/12/2014
            s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add sohoso varchar2(50);\n";
            //Tú:11/12/2014
            s_Sql += "alter table " + sSchema + ".m_dmkho add khochuongtrinh number(1,0) default 0 not null;\n";
            //linh 12/12/14
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add donvitinh nvarchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add csbt nvarchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add cantren number(10);\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add canduoi number(10);\n";
            s_Sql += "alter table " + sSchema + ".l_ketqua modify nguoilaymau varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".l_ketqua add iddotchidinh number(30);\n";
            s_Sql += "alter table " + sSchema + ".l_ketqua modify iddotchidinh default 0 ;\n";
            s_Sql += "update " + sSchema + ".l_ketqua set iddotchidinh=0 where iddotchidinh is null;\n";
            s_Sql += "alter table " + sSchema + ".l_ketqua modify iddotchidinh not null;\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add mayxetnghiem nvarchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add batthuong number(1);\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet modify batthuong default 0;\n";
            s_Sql += "update " + sSchema + ".l_ketquachitiet set batthuong=0 where batthuong is null;\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet modify batthuong not null;\n";
            //Tú:12/12/2014
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add tylethuocvattu number(5,2) default 0 not null;\n";
            //linh 12/12/14
            s_Sql += "alter table " + sSchema + ".p_dmuser modify matkhau varchar2(500);\n";
            //ThanhCuong - 13/12/2014
            s_Sql += "create table " + sSchema + ".p_goitiepdon(khu number(3) default 0 not null,stt number (7) default 0 not null," +
                "quay number (3) default 0 not null,trangthai number (1) default 0 not null, ngay date DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_goitiepdon add constraint pk_p_goitiepdon primary key(khu,stt);\n";
            //Thuy 15/12/14
            s_Sql += "alter table " + sSchema + ".m_thauds add mmyy character varying(4);\n";
            s_Sql += "alter table " + sSchema + ".m_thauct add mmyy character varying(4);\n";
            //Tu 15/12/14
            s_Sql += "alter table " + sSchema + ".b_dmloaiquyenso add loaithu number(1,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add sotiendinhmucdieutri number(9) default 0 not null;\n";//Thuy 16/12/14
            //Tú:18/12/2014
            s_Sql += "alter table " + sSchema + ".b_hoantra add constraint ck_b_hoantra_id check (id<>0);\n";
            //ThanhCuong - 22/12/2014
            s_Sql += "alter table " + sSchema + ".p_benhandt add tomtatcls nvarchar2(254);\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add daxulythuoc nvarchar2(254);\n";
            //Tú:22/12/2014
            s_Sql += "alter table " + sSchema + ".p_xuatvien add thanhtoan number(1,0);\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien modify thanhtoan default 0;\n";
            s_Sql += "update " + sSchema + ".p_xuatvien set thanhtoan=0 where thanhtoan is null;\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien modify thanhtoan not null;\n";
            //ThanhCuong - 23/12/2014
            s_Sql += "create table " + sSchema + ".m_phieuduyetkho(idphieuduyet number(30) default 0, idkho number(3) default 0, trangthai number(1) default 0 not null,mmyy varchar2(4) not null, " +
                "ngayud date DEFAULT sysdate, computer varchar2(50),username varchar2(20));\n";
            s_Sql += "alter TABLE " + sSchema + ".m_phieuduyetkho add constraint pk_m_phieuduyetkho primary key(idphieuduyet,idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_phieuduyetkho add constraint fk_phieuduyetkho_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_phieuduyetkho add constraint fk_phieuduyetkho_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //Thuy 24/12/14
            s_Sql += "alter table " + sSchema + ".p_benhkemtheo add idkhoa numeric(30,0);\n";
            s_Sql += "alter table " + sSchema + ".p_benhkemtheo modify idkhoa default 0;\n";
            s_Sql += "update " + sSchema + ".p_benhkemtheo set idkhoa=0 where idkhoa is null;\n";
            s_Sql += "alter table " + sSchema + ".p_benhkemtheo modify idkhoa not null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi add sohoadonnganhang varchar2(20);\n";//linh 24/12/14
            //Tú:25/12/2014
            s_Sql += "alter table " + sSchema + ".p_giayravien add chandoantruoc nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_giayravien add chandoansau nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_giayravien add phuongthucvocam nvarchar2(500);\n";
            s_Sql += "alter table " + sSchema + ".p_giayravien add luoctrinhpt nvarchar2(1000);\n";
            s_Sql += "alter table " + sSchema + ".p_giayravien add ngaypt date;\n";
            //ThanhCuong - 26/12/2014
            s_Sql += "alter table " + sSchema + ".p_thongsothebhyt add ngayapdung date;\n";
            s_Sql += "update " + sSchema + ".p_thongsothebhyt set ngayapdung=to_date('01/01/2000','dd/MM/yyyy') where ngayapdung is null;\n";
            s_Sql += "alter table " + sSchema + ".p_thongsothebhyt drop constraint pk_thongsobhyt;\n";
            s_Sql += "alter table " + sSchema + ".p_thongsothebhyt add constraint pk_thongsobhyt primary key(id,kitu,nhomquyenloi,ngayapdung);\n";
            //ThanhCuong - 30/12/2014
            s_Sql += "create table " + sSchema + ".p_thongsotylecacdichvu(id number(7),idbietduoc number(7),bhyt number(3),ngayapdung date default sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".p_thongsotylecacdichvu add constraint pk_thongsotylecacdichvu primary key(id,idbietduoc,ngayapdung);\n";
            //linh 3/1/15
            s_Sql += "alter table " + sSchema + ".m_dmtuongtac add mucdo number(1) default 0;\n";
            s_Sql += "alter table " + sSchema + ".p_dausinhton add ylenh nvarchar2(1000);\n";//Thuy 5/1/14
            //Tú:05/01/2015
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet drop constraint pk_l_ketquachitiet;\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add constraint pk_l_ketquachitiet_new primary key(idketqua, idxetnghiem, idvienphi,idchidinh);\n";
            //ThanhCuong - 05/01/2015 
            s_Sql += "alter table " + sSchema + ".p_thongsotylegiaban add idnhomkho number(2) default 0 not null;\n";
            s_Sql += "alter TABLE " + sSchema + ".p_thongsotylegiaban add constraint fk_thongsotylegiaban_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho);\n";
            s_Sql += "alter table " + sSchema + ".p_dausinhton add loai numeric(1,0) default 0 not null;\n";//Thuy 5/1/14
            //ThanhCuong - 06/01/2015
            s_Sql += "create table " + sSchema + ".p_thongsotyletraituyen(id number(7),loaiba number(1),tyle number(3),ngayapdung date default sysdate);\n";
            s_Sql += "alter TABLE " + sSchema + ".p_thongsotyletraituyen add constraint pk_thongsotyletraituyen primary key(id,loaiba,ngayapdung);\n";
            //Tú:05/01/2015
            s_Sql += "alter table " + sSchema + ".p_dmuser add idloaicdha varchar2(50);\n";
            //Thuy 7/1/15
            s_Sql += "create table " + sSchema + ".p_hoichan(idhoichan number(30,0) DEFAULT 0,maql numeric(30,0) default 0,ngay date DEFAULT sysdate," +
                    "chutoa character varying(4),thuki character varying(4),quatrinhbenhly nvarchar2(1000),ketluan nvarchar2(1000),huongdieutri nvarchar2(1000)," +
                    "computer character varying(50),NGAYUD date DEFAULT sysdate,username character varying(20),mmyy generated always as (to_char(ngay,'MMyy')))" +
                    " partition by list (mmyy)(partition p_hoichan_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter TABLE " + sSchema + ".p_hoichan add CONSTRAINT pk_p_hoichan PRIMARY KEY (idhoichan);\n";
            //Linh 7/1/15
            s_Sql += "create table " + sSchema + ".m_theodoidulieu (idtheodoidulieu number(30),ngaylamviec date default sysdate," +
                " solieuthang varchar2(4),thaotac nvarchar2(500),ngayud date default sysdate," +
                " username varchar2(50), computer varchar2(50),mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition m_theodoidulieu_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += " alter table " + sSchema + ".m_theodoidulieu add constraint pk_theodoidulieu primary key(idtheodoidulieu);\n";
            //linh 7/1/15
            s_Sql += "create table " + sSchema + ".m_dmnhombaocao(idnhombaocao number(2), tennhombaocao nvarchar2(150),username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombaocao add constraint pk_dmnhombaocao primary key(idnhombaocao);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add idnhombaocao number(2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add constraint pk_dmnhombaocao foreign key(idnhombaocao) references " + sSchema + ".m_dmnhombaocao(idnhombaocao);";
            //Thuy 8/1/15
            s_Sql += "create table " + sSchema + ".p_hoichan_thanhvien" +
            "( " +
            "idhoichan number(30,0) DEFAULT 0 NOT NULL," +
            "manhanvien varchar2(4) NOT NULL," +
            "mmyy generated always as (to_char(ngayud,'MMyy')) ," +
            "username varchar2(20)," +
            "ngayud date DEFAULT sysdate," +
            "dongbo varchar2(100) default lpad('0',100,'0')," +
            "computer varchar2(50)" +
            ") partition by list (mmyy)(partition p_hoichan_thanhvien_" + s_MMYY + " values('" + s_MMYY + "'));\n";//linh 1/7/14
            s_Sql += "alter table " + sSchema + ".p_hoichan_thanhvien add CONSTRAINT pk_p_hoichan_thanhvien PRIMARY KEY (idhoichan,manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_hoichan_thanhvien add CONSTRAINT fk_p_hoichan_thanhvien_hoichan FOREIGN KEY (idhoichan) REFERENCES " + sSchema + ".p_hoichan (idhoichan);\n";
            s_Sql += "alter table " + sSchema + ".p_hoichan_thanhvien add CONSTRAINT fk_thanhvienekipmo_nhanvien FOREIGN KEY (manhanvien) REFERENCES " + sSchema + ".p_dmnhanvien (manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_hoichan_thanhvien add CONSTRAINT fk_p_hoichan_thanhvien_dmuser FOREIGN KEY (username) REFERENCES " + sSchema + ".p_dmuser (username);\n";
            s_Sql += "alter table " + sSchema + ".p_hoichan add idkhoaphong number(3,0) default 0 not null;\n";
            //Tú:09/01/2015
            s_Sql += "create table " + sSchema + ".b_dmgiavienphi_old as select * from " + sSchema + ".b_dmgiavienphi where 1=0;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_old add ngaythaydoi date;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_old add constraint pk_b_dmgiavienphi_old primary key(idgiavienphi,ngaythaydoi);\n";
            s_Sql += "create table " + sSchema + ".b_dmgiavienphi_new as select * from " + sSchema + ".b_dmgiavienphi where 1=0;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_new add dacapnhat number(1,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_new add constraint pk_b_dmgiavienphi_new primary key(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".b_dmquyenso add dungchung number(1) default 0;\n";//ThanhCuong - 10/01/2015
            s_Sql += "update " + sSchema + ".b_dmquyenso set dungchung=0 where dungchung is null;\n";//ThanhCuong - 10/01/2015
            s_Sql += "alter table " + sSchema + ".b_dmquyenso modify dungchung not null;\n";//ThanhCuong - 10/01/2015
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add khu number(1) default 0;\n";//ThanhCuong - 13/01/2015
            s_Sql += "update " + sSchema + ".p_dmkhoaphongbenhvien set khu=0 where khu is null;\n";//ThanhCuong - 13/01/2015
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien modify khu not null;\n";//ThanhCuong - 13/01/2015
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add idkhu number(3) default 0;\n";//ThanhCuong - 13/01/2015
            s_Sql += "update " + sSchema + ".p_dmkhoaphongbenhvien set idkhu=0 where idkhu is null;\n";//ThanhCuong - 13/01/2015
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien modify idkhu not null;\n";//ThanhCuong - 13/01/2015
            s_Sql += "alter table " + sSchema + ".p_goitiepdon add makhoaphong varchar2(3);\n";//ThanhCuong - 13/01/2015
            //Tú:15/01/2015
            s_Sql += "alter table " + sSchema + ".p_benhandt add doituongkcb number(1,0);\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt modify doituongkcb default 0;\n";
            s_Sql += "update " + sSchema + ".p_benhandt set doituongkcb=0 where doituongkcb is null;\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt modify doituongkcb not null;\n";
            //ThanhCuong - 18/01/2015
            s_Sql += "alter table " + sSchema + ".r_ketquall add idphongthuchien number(3);\n";
            s_Sql += "alter table " + sSchema + ".r_ketquall modify idphongthuchien default 0;\n";
            s_Sql += "update " + sSchema + ".r_ketquall set idphongthuchien=0 where idphongthuchien is null;\n";
            s_Sql += "alter table " + sSchema + ".r_ketquall modify idphongthuchien not null;\n";
            //linh 17/1/15
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add khangsinh number(1) default 0;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add vattu number(1) default 0;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add hoachat number(1) default 0;\n";
            //ThanhCuong - 20/01/2015
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add stt number(7);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi modify stt default 0;\n";
            s_Sql += "update " + sSchema + ".m_duyetchiphi set stt=0 where stt is null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi modify stt not null;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh add sttvienphi number(7);\n";
            s_Sql += "update " + sSchema + ".b_chidinh set sttvienphi=0 where sttvienphi is null;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh modify sttvienphi default 0;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh modify sttvienphi not null;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh add trangthaigoivp number(1);\n";
            s_Sql += "update " + sSchema + ".b_chidinh set trangthaigoivp=0 where trangthaigoivp is null;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh modify trangthaigoivp default 0;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh modify trangthaigoivp not null;\n";
            //linh 
            s_Sql += "create table " + sSchema + ".p_phatstttiepdon (ngay date default sysdate not null, stt number(5) default 0 not null,loaibn number(3) default 0 not null, " +
                "mmyy generated always as (to_char(ngay,'MMyy')),computer varchar2(50)) partition by list (mmyy)(partition p_phatstttiepdon_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".p_phatstttiepdon add constraint pk_p_phatstttiepdon primary key(ngay,loaibn,stt);\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add loaiba varchar2(50);\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add idkhoaphongchidinh varchar2(2000);\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh add idphongthutien number(3);\n";
            s_Sql += "update " + sSchema + ".b_chidinh set idphongthutien=0 where idphongthutien is null;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh modify idphongthutien default 0;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh modify idphongthutien not null;\n";
            //ThanhCuong - 20/01/2015
            s_Sql += "alter table " + sSchema + ".b_chidinh add trangthaigoicls number(1);\n";
            s_Sql += "update " + sSchema + ".b_chidinh set trangthaigoicls=0 where trangthaigoicls is null;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh modify trangthaigoicls default 0;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh modify trangthaigoicls not null;\n";
            //linh 24/01/2015
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add sttvienphi number(3);\n";
            s_Sql += "update " + sSchema + ".m_duyetchiphi set sttvienphi=0 where sttvienphi is null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi modify sttvienphi default 0;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi modify sttvienphi not null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add trangthaigoivp number(3);\n";
            s_Sql += "update " + sSchema + ".m_duyetchiphi set sttvienphi=0 where trangthaigoivp is null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi modify trangthaigoivp default 0;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi modify trangthaigoivp not null;\n";
            //linh 28/1/15
            s_Sql += "alter table " + Schema + ".p_dmcomputer add goi number(1) default 0 not null;\n";
            s_Sql += "alter table " + Schema + ".p_dmcomputer add ipservergoi varchar2(100);\n";
            s_Sql += "alter table " + Schema + ".p_dmcomputer add portgoi number(4) default 0;\n";
            s_Sql += "alter table " + Schema + ".p_dmcomputer add khu varchar2(50);\n";//ThanhCuong - 20/01/2015
            s_Sql += "alter table " + Schema + ".p_dmcomputer add quay number(3) default 0;\n";//ThanhCuong - 20/01/2015
            s_Sql += "ALTER TABLE " + Schema + ".p_dmcomputer  ADD CONSTRAINT uk_computer UNIQUE (tencomputer);\n";
            //Tú:02/02/2015
            s_Sql += "create table " + sSchema + ".l_xetnghiemchuyenmau(idketqua number(30,0),idchidinh number(30,0),idgiavienphi number(7,0) default 0 not null," +
                     "mabenhvien varchar2(10),username varchar2(20),computer varchar2(50),ngayud date default sysdate," +
                     "mmyy generated always as (to_char(ngayud,'MMyy'))) partition by list (mmyy)(partition l_xetnghiemchuyenmau_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".l_xetnghiemchuyenmau add constraint pk_l_xetnghiemchuyenmau primary key(idketqua,idchidinh);\n";

            //Tú:21/01/2015
            s_Sql += "alter table " + sSchema + ".b_vienphict add idktcao number(30,0);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict modify idktcao default 0;\n";
            s_Sql += "update " + sSchema + ".b_vienphict set idktcao=0 where idktcao is null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict modify idktcao not null;\n";

            s_Sql += "alter table " + sSchema + ".b_vienphict add goiktcao number(1,0);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict modify goiktcao default 0;\n";
            s_Sql += "update " + sSchema + ".b_vienphict set goiktcao=0 where goiktcao is null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict modify goiktcao not null;\n";

            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add idktcao number(30,0);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc modify idktcao default 0;\n";
            s_Sql += "update " + sSchema + ".b_vienphictthuoc set idktcao=0 where idktcao is null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc modify idktcao not null;\n";

            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add goiktcao number(1,0);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc modify goiktcao default 0;\n";
            s_Sql += "update " + sSchema + ".b_vienphictthuoc set goiktcao=0 where goiktcao is null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc modify goiktcao not null;\n";
            //Tú:22/01/2015
            s_Sql += "alter table " + sSchema + ".p_dmicd add ngoaidinhsuat number(1,0) default 0 not null;\n";
            //Tú:23/01/2015
            s_Sql += "create table " + sSchema + ".p_dmnhomtranbhyt(idnhomtranbhyt number(3,0),tennhomtranbhyt nvarchar2(254),mathe varchar2(254)," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomtranbhyt add constraint pk_p_dmnhomtranbhyt primary key(idnhomtranbhyt);\n";
            //Tú:29/01/2015
            s_Sql += "create table " + sSchema + ".b_bhytxuattoan(idbhytxuattoan number(30,0),thang number(2,0),nam number(4,0),mabn varchar2(14),hoten nvarchar2(254)," +
                     "namsinh number(4,0),gioitinh varchar2(10),sothe varchar2(20),manoidkkcb varchar2(20),maicd varchar2(10)," +
                     "ngayvao date,ngayra date,songaydieutri number(4,0),tongchiphi number(20,4),xetnghiem number(20,4)," +
                     "cdha number(20,4),thuoc number(20,4),mau number(20,4),pttt number(20,4),vtytth number(20,4),vtyttt number(20,4),dvktc number(20,4)," +
                     "thuock number(20,4),congkham number(20,4),tiengiuong number(20,4),cpvc number(20,4),tongtien number(20,4),bntra number(20,4)," +
                     "bhyttra number(20,4),ngoaiquyds number(20,4),lydovv nvarchar2(254),benhkhac nvarchar2(254),noikcb nvarchar2(254),namqt number(4,0),thangqt number(4,0)," +
                     "tungay date,denngay date,diachi nvarchar2(254),idkhoaphong number(3,0),khoathanhtoan nvarchar2(254),tyle number(5,2)," +
                     "nhomdangky nvarchar2(254),tuyen nvarchar2(254),nhomquyenloi number(2,0),nhomthe nvarchar2(254),tainangt number(1,0),loaibc number(1,0),username varchar2(20)," +
                     "computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".b_bhytxuattoan add constraint pk_b_bhytxuattoan primary key(idbhytxuattoan);\n";
            s_Sql += "alter table " + Schema + ".b_dmgiavienphi add khamsuckhoe number(1) default 0 not null;\n";

            s_Sql += "alter table " + sSchema + ".m_theodoidulieu modify thaotac varchar2(500);\n";

            s_Sql += "alter table " + sSchema + ".p_lichhen add ngaykham date;\n";//Thuy 5/2/15
            s_Sql += "alter table " + sSchema + ".p_lichhen modify ngaykham default sysdate;\n";//Thuy 5/2/15
            //ThanhCuong - 09/02/2015
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct modify soluongyeucau number(20,7);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct modify soluongyeucau default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct modify soluongyeucau not null;\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct modify soluongphat number(20,7);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct modify soluongphat default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct modify soluongphat not null;\n";
            //Tú:11/02/2015
            s_Sql += "alter table " + sSchema + ".b_vienphict add haophi number(15,4);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict modify haophi default 0;\n";
            s_Sql += "update " + sSchema + ".b_vienphict set haophi=0 where haophi is null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict modify haophi not null;\n";

            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add haophi number(15,4);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc modify haophi default 0;\n";
            s_Sql += "update " + sSchema + ".b_vienphictthuoc set haophi=0 where haophi is null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc modify haophi not null;\n";

            s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran add haophi number(15,4);\n";
            s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran modify haophi default 0;\n";
            s_Sql += "update " + sSchema + ".b_vienphichuavuottran set haophi=0 where haophi is null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran modify haophi not null;\n";

            s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran add haophi number(15,4);\n";
            s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran modify haophi default 0;\n";
            s_Sql += "update " + sSchema + ".b_thuocchuavuottran set haophi=0 where haophi is null;\n";
            s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran modify haophi not null;\n";
            //Linh 12/2/15
            s_Sql += "alter table " + sSchema + ".p_bhyt add ngaygiahan date;\n";
            //linh 25/2/15
            s_Sql += "create table " + sSchema + ".l_dmongxetnghiem (idongxetnghiem number(1) default 0 ,maongxetnghiem varchar2(3)," +
                "tenongxetnghiem nvarchar2(100),computer varchar2(100),username varchar2(50),ngayud date default sysdate,tenkhongdau varchar2(150));\n";
            s_Sql += "alter table " + sSchema + ".l_dmongxetnghiem add constraint pk_dmongxetnghiem primary key (idongxetnghiem);\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add idongxetnghiem number(1) default 0 not null;\n";
            //ThanhCuong - 05/03/2015
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add matramgoirobo varchar2(10);\n";//ThanhCuong - 05/03/2015
            //linh 6/3/15
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add sttbyt varchar2(20);\n";
            //Thuy 6/3/15
            s_Sql += "alter table " + Schema + ".p_lichhen add chandoan nvarchar2(500);\n";
            s_Sql += "alter table " + Schema + ".p_lichhen add sothe varchar2(20);\n";
            //Tú:09/03/2015
            s_Sql += "alter table " + Schema + ".b_dmgiavienphi add stt21 varchar2(50);\n";
            s_Sql += "alter table " + Schema + ".b_dmgiavienphi_new add sttbyt varchar2(20);\n";
            s_Sql += "alter table " + Schema + ".b_dmgiavienphi_new add stt21 varchar2(50);\n";
            s_Sql += "alter table " + Schema + ".m_dmbd add tenbietduocbyt nvarchar2(500);\n";
            //ThanhCuong - 12/03/2015 
            s_Sql += "alter table " + sSchema + ".p_phatstttiepdon add quay number(3) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_phatstttiepdon add trangthai number(1) default 0 not null;\n";
            //linh 12/2/15
            s_Sql += "update " + sSchema + ".b_vienphict set mien=sotien where mien=0 and madoituong in(select madoituong from " + sSchema + ".p_dmdoituong where mien=1);\n";
            s_Sql += "update " + sSchema + ".b_vienphictthuoc set mien=sotien where mien=0 and madoituong in(select madoituong from " + sSchema + ".p_dmdoituong where mien=1);\n";
            s_Sql += "update " + sSchema + ".b_vienphict set haophi=sotien where haophi=0 and madoituong in(5);\n";
            s_Sql += "update " + sSchema + ".b_vienphictthuoc set haophi=sotien where haophi=0 and madoituong in(5);\n";
            //Tú:12/03/2015
            s_Sql += "alter table " + sSchema + ".p_lichhen add mavaovien number(30,0);\n";
            s_Sql += "alter table " + sSchema + ".p_lichhen modify mavaovien default 0;\n";
            s_Sql += "update " + sSchema + ".p_lichhen set mavaovien=0 where mavaovien is null;\n";
            s_Sql += "alter table " + sSchema + ".p_lichhen modify mavaovien not null;\n";
            s_Sql += "alter table " + Schema + ".p_hoichan add tenhoichan nvarchar2(500);\n";//Thuy 16/3/15
            //Tú:17/03/2015
            s_Sql += "alter table " + Schema + ".m_ylenhthuocct add idkey number(30,0);\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct modify idkey default 0;\n";
            s_Sql += "update " + sSchema + ".m_ylenhthuocct set idkey=0 where idkey is null;\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct modify idkey not null;\n";
            s_Sql += "alter table " + Schema + ".m_xuatnoivienct add idkey number(30,0);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct modify idkey default 0;\n";
            s_Sql += "update " + sSchema + ".m_xuatnoivienct set idkey=0 where idkey is null;\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct modify idkey not null;\n";
            //Tú:19/03/2015
            s_Sql += "create table " + sSchema + ".p_benhnhantheodoi(mabn varchar2(14),sothe varchar2(20),username varchar2(50)," +
                     "computer varchar2(50),ngayud date default sysdate not null);\n";
            s_Sql += "alter table " + sSchema + ".p_benhnhantheodoi add constraint pk_p_benhnhantheodoi primary key(mabn,sothe);\n";
            s_Sql += "alter table " + sSchema + ".p_benhnhantheodoi add constraint fk_p_benhnhantd_dmbenhnhan foreign key(mabn) references " + Schema + ".p_dmbenhnhan(mabn);\n";
            s_Sql += "alter table " + Schema + ".b_dmgiavienphi add ghichu number(1,0) default 0 not null;\n";//Thuy 23/3/15
            //ThanhCuong -24/03/2015
            s_Sql += "alter table " + Schema + ".l_dmxetnghiem add binhthuongte varchar2(50);\n";
            s_Sql += "alter table " + Schema + ".l_dmxetnghiem add minte numeric(10,5);\n";
            s_Sql += "alter table " + Schema + ".l_dmxetnghiem add maxte numeric(10,5);\n";
            //Thuy 28/3/15
            s_Sql += " create table " + Schema + ".p_vudieutri(idvudieutri number(30) default 0, ngay date DEFAULT sysdate, loaibieu varchar(100)," +
                "computer character varying(50),username character varying(20),ngayud date DEFAULT sysdate,mmyy generated always as (substr(idvudieutri,3,2)||substr(idvudieutri,1,2)))" +
                " partition by list (mmyy)(partition p_vudieutri_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += " alter table " + Schema + ".p_vudieutri add constraint pk_p_vudieutri primary key (idvudieutri);\n";
            s_Sql += "create table " + Schema + ".p_vudieutrichitiet(idvudieutri number(30) default 0, " +
                "noidung nvarchar2(1000),key numeric(5), " +
                "v01 numeric(24,8) default 0 not null,v02 numeric(24,8) default 0 not null,v03 numeric(24,8) default 0 not null," +
                "v04 numeric(24,8) default 0 not null,v05 numeric(24,8) default 0 not null,v06 numeric(24,8) default 0 not null," +
                "v07 numeric(24,8) default 0 not null,v08 numeric(24,8) default 0 not null,v09 numeric(24,8) default 0 not null," +
                "v10 numeric(24,8) default 0 not null," +
                "v11 numeric(24,8) default 0 not null,v12 numeric(24,8) default 0 not null,v13 numeric(24,8) default 0 not null," +
                "v14 numeric(24,8) default 0 not null,v15 numeric(24,8) default 0 not null,v16 numeric(24,8) default 0 not null," +
                "v17 numeric(24,8) default 0 not null,v18 numeric(24,8) default 0 not null,v19 numeric(24,8) default 0 not null," +
                "v20 numeric(24,8) default 0 not null," +
                "v21 numeric(24,8) default 0 not null,v22 numeric(24,8) default 0 not null,v23 numeric(24,8) default 0 not null," +
                "v24 numeric(24,8) default 0 not null,v25 numeric(24,8) default 0 not null,v26 numeric(24,8) default 0 not null," +
                "v27 numeric(24,8) default 0 not null,v28 numeric(24,8) default 0 not null,v29 numeric(24,8) default 0 not null," +
                "v30 numeric(24,8) default 0 not null," +
                "computer character varying(50),username character varying(20),ngayud date DEFAULT sysdate,mmyy generated always as (substr(idvudieutri,3,2)||substr(idvudieutri,1,2)))" +
                " partition by list (mmyy)(partition p_vudieutrichitiet_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            //ThanhCuong - 28/03/2015
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct modify soluong number(20,7);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct modify soluong default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct modify soluong not null;\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct modify soluongyeucau number(20,7);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct modify soluongyeucau default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct modify soluongyeucau not null;\n";
            //Tú:31/03/2015
            s_Sql += "alter table " + sSchema + ".m_dmbd modify idloaithuocbyt number(3,0);\n";
            //Tú:01/04/2015
            s_Sql += "create table " + sSchema + ".p_hoichanphauthuat_ekip(idhoichanphauthuat number(30,0),manhanvien varchar2(4)," +
                   " username varchar2(20),computer varchar2(50),ngayud date default sysdate not null,mmyy generated always as (to_char(ngayud,'MMyy')))" +
                   " partition by list (mmyy)(partition p_hoichanphauthuat_ekip_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat_ekip add constraint pk_p_hoichanphauthuat_ekip primary key(idhoichanphauthuat,manhanvien);\n";
            s_Sql += "create table " + sSchema + ".p_hoichanphauthuat(idhoichanphauthuat number(30,0),maql number(30,0) default 0 not null,ngay date," +
                   "idkhoa number(30,0) default 0 not null,idkhoaphong number(3,0) default 0 not null,dienbien nvarchar2(1000),hc nvarchar2(254)," +
                   "hst nvarchar2(254),bc nvarchar2(254),md nvarchar2(254),mc nvarchar2(254),nhommau nvarchar2(254),ure nvarchar2(254),creatinin nvarchar2(254)," +
                   "glucoza nvarchar2(254),protit nvarchar2(254),howell nvarchar2(254),prothrobin nvarchar2(254),nuoctieu nvarchar2(254),xquang nvarchar2(254)," +
                   "sieuam nvarchar2(254),dientim nvarchar2(254),phanungthuoc nvarchar2(500),phuongphapphauthuat nvarchar2(500),phuongphapvocam nvarchar2(500)," +
                   "khokhan nvarchar2(500),dutrumau nvarchar2(254)," +
                   "username varchar2(20),computer varchar2(50),ngayud date default sysdate not null,mmyy generated always as (to_char(ngayud,'MMyy')))" +
                   " partition by list (mmyy)(partition p_hoichanphauthuat_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat add constraint pk_p_hoichanphauthuat primary key(idhoichanphauthuat);\n";
            //ThanhCuong - 01/04/2015
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add mabschidinh varchar2(4);\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add maicd varchar2(10);\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add chandoan nvarchar2(254);\n";
            //
            //Tú:02/04/2015
            s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat_ekip add idchucnang numeric(2,0) default 0 not null;\n";
            s_Sql += "update " + sSchema + ".p_hoichanphauthuat_ekip set idchucnang=0 where idchucnang is null or idchucnang='';\n";
            s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat_ekip modify idchucnang default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat_ekip modify idchucnang not null;\n";
            s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat add ngaymo date;\n";
            //linh 2/4/15
            s_Sql += " create table " + sSchema + ".p_phieusoket15(idphieusoket number(30),maql number(30) default 0 not null, idkhoaphongbenhvien number(3) default 0 not null," +
                "dienbienlamsang varchar2(500),xetnghiemcanlamsang varchar2(500),quatrinhdieutri varchar2(500),danhgiaketqua varchar2(500),huongdieutri varchar2(500)," +
                "mabsdieutri varchar2(4) default '0000' not null,mabstruongkhoa varchar2(4),username varchar2(50),computer varchar2(50)," +
                "ngayud date default sysdate,mmyy generated always as (to_char(ngayud,'MMyy')))" +
                " partition by list (mmyy)(partition p_phieusoket15_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += " alter table " + sSchema + ".p_phieusoket15 add constraint pk_phieusoket15 primary key(idphieusoket);\n";
            s_Sql += " alter table " + sSchema + ".p_phieusoket15 add constraint fk_phieusoket15_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += " alter table " + sSchema + ".p_phieusoket15 add constraint fk_phieusoket15_dmbsdt foreign key(mabsdieutri) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += " alter table " + sSchema + ".p_phieusoket15 add constraint fk_phieusoket15_dmtruongkhoa foreign key(mabstruongkhoa) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            //ThanhCuong - 03/04/2015
            s_Sql += "alter table " + sSchema + ".p_dmuser modify nhomthuoc varchar2(500);\n";
            s_Sql += "create table " + sSchema + ".m_denghitra(iddenghitra number(30) default 0, mmyy generated always as (to_char(ngayud,'MMyy')), sophieu varchar2(20),  ngay date not null,  " +
              " trangthai number(1) default 0 not null,idkhoxuat number(3,0) default 0 not null, idkhonhap number(3,0) default 0 not null, ghichu nvarchar2(254)," +
              " computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate)"+
               " partition by list (mmyy)(partition m_denghitra_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter TABLE " + sSchema + ".m_denghitra add constraint pk_m_denghitra primary key(iddenghitra);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_denghitra add constraint fk_denghitra_dmkhoxuat foreign key(idkhoxuat) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_denghitra add constraint fk_denghitra_dmkhonhap foreign key(idkhonhap) references " + sSchema + ".m_dmkho(idkho);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_denghitra add constraint fk_denghitra_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            //s_Sql += "alter TABLE " + sSchema + ".m_denghitra add constraint ck_denghitra_iddenghitra check (iddenghitra<>0) enable;\n";//Thuy 15/05/15

            s_Sql += "create table " + sSchema + ".m_denghitract(iddenghitra number(30) default 0, stt number(3) default 0 not null, mmyy generated always as (to_char(ngayud,'MMyy'))," +
              " idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null, computer varchar2(50),username varchar2(20), ngayud date DEFAULT sysdate)"+
               " partition by list (mmyy)(partition m_denghitract_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter TABLE " + sSchema + ".m_denghitract add constraint pk_m_denghitract primary key(iddenghitra,stt);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatll add iddenghitra number(30);\n";
            s_Sql += "alter TABLE " + sSchema + ".m_xuatll add constraint fk_xuatll_denghitra foreign key(iddenghitra) references " + sSchema + ".m_denghitra(iddenghitra);\n";
            s_Sql += "alter table " + sSchema + ".m_xuatll modify iddenghitra set default 0 ;\n";
            s_Sql += "update " + sSchema + ".m_xuatll set iddenghitra=0 where iddenghitra is null;\n";
            s_Sql += "alter table " + sSchema + ".m_xuatll modify iddenghitra not null;\n";
            s_Sql += "alter TABLE " + sSchema + ".m_denghitract add constraint ck_denghitra_iddenghitract check (iddenghitra<>0) enable;\n";
            //Tú:06/04/2015
            s_Sql += "alter table " + sSchema + ".m_dmkho add khomau number(1,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_toamauct add madoituong number(2) default 0 not null;\n";//ThanhCuong - 07/04/2015
            //Tú:08/04/2015
            s_Sql += "update " + sSchema + ".l_ketquachitiet a set mabschidinh=(select mabschidinh from " + sSchema + ".l_ketqua b where b.idketqua=a.idketqua) where mabschidinh is null or mabschidinh='';\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet modify mabschidinh default '0000' ;\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet modify mabschidinh not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmkho add duyettudong number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add ma nvarchar2(20);\n";//linh 10/4/15
            s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add nuocsanxuat nvarchar2(200);\n";//linh 10/4/15
            s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add dactrungkythuat nvarchar2(200);\n";//linh 10/4/15
            s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add nguonkinhphi nvarchar2(200);\n";//linh 10/4/15
            //Tú:14/04/2015
            s_Sql += "alter table " + sSchema + ".b_chidinh add barcode varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh add ngaycapphat date;\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add xutri varchar2(254);\n";
            //linh 15/4/15
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add vitamin number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add corticoid number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add thuocme number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add phacheyhct number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add dichtruyen number(1) default 0 not null;\n";
            //ThanhCuong - 15/04/2015
            s_Sql += "alter table " + sSchema + ".m_dutrumuact add dongia number(12,4);\n";
            s_Sql += "update " + sSchema + ".m_dutrumuact set dongia=0 where dongia is null;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact modify dongia default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact modify dongia not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact add idhang number(5);\n";
            s_Sql += "update " + sSchema + ".m_dutrumuact set idhang=0 where idhang is null;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact modify idhang default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact modify idhang not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact add idnuoc number(5);\n";
            s_Sql += "update " + sSchema + ".m_dutrumuact set idnuoc=0 where idnuoc is null;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact modify idnuoc default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact modify idnuoc not null;\n";
            //Tú:21/04/2015
            s_Sql += "create table " + sSchema + ".r_dmnhombaocao(idnhombaocao number(2,0) not null,stt number(2) default 0 not null,tennhombaocao nvarchar2(150)," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".r_dmnhombaocao add constraint pk_r_dmnhombaocao primary key (idnhombaocao);\n";
            s_Sql += "alter table " + sSchema + ".r_dmkythuat add idnhombaocao number(2) default 0 not null;\n";
            //ThanhCuong - 25/04/2015
            s_Sql += "alter table " + sSchema + ".m_thauds add tungay date;\n";
            s_Sql += "alter table " + sSchema + ".m_thauds add denngay date;\n";
            //Tú:04/05/2015
            s_Sql += "alter table " + sSchema + ".m_dmnhombaocao add idbaocao number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add idnhombaocao number(2) default 0 not null;\n";
            //Tú:07/05/2015
            s_Sql += "alter table " + sSchema + ".p_hiendien drop constraint fk_hiendien_dmicd;\n";
            //ThanhCuong - 05/05/2015
            s_Sql += "alter table " + sSchema + ".m_thauct add idhang number(5);\n";
            s_Sql += "update " + sSchema + ".m_thauct set idhang=0 where idhang is null;\n";
            s_Sql += "alter table " + sSchema + ".m_thauct modify idhang default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_thauct modify idhang not null;\n";
            s_Sql += "alter table " + sSchema + ".m_thauct add idnuoc number(5);\n";
            s_Sql += "update " + sSchema + ".m_thauct set idnuoc=0 where idnuoc is null;\n";
            s_Sql += "alter table " + sSchema + ".m_thauct modify idnuoc default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_thauct modify idnuoc not null;\n";
            //Tú:09/05/2015
            s_Sql += "alter table " + sSchema + ".m_dmbd add phimxquang number(1,0) default 0 not null;\n";
            //ThanhCuong - 11/05/2015
            s_Sql += "alter table " + sSchema + ".m_thauct add soluongdanhap number(30,7);\n";
            s_Sql += "update " + sSchema + ".m_thauct set soluongdanhap=0 where soluongdanhap is null;\n";
            s_Sql += "alter table " + sSchema + ".m_thauct modify soluongdanhap default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_thauct modify soluongdanhap not null;\n";
            s_Sql += "alter table " + sSchema + ".m_thauds add conhoatdong number(1);\n";
            s_Sql += "update " + sSchema + ".m_thauds set conhoatdong=0 where conhoatdong is null;\n";
            s_Sql += "alter table " + sSchema + ".m_thauds modify conhoatdong default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_thauds modify conhoatdong not null;\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add uutien number(1);\n";
            s_Sql += "update " + sSchema + ".p_lienhe set uutien=0 where uutien is null;\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe modify uutien default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe modify uutien not null;\n";
            //Tú:11/05/2015
            s_Sql += "alter table " + sSchema + ".p_benhandt add dieutrikethop number(1,0);\n";
            s_Sql += "update " + sSchema + ".p_benhandt set dieutrikethop=0 where dieutrikethop is null;\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt modify dieutrikethop default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt modify dieutrikethop not null;\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add idkhoaphongchidinh number(3,0);\n";
            s_Sql += "update " + sSchema + ".p_benhandt set idkhoaphongchidinh=0 where idkhoaphongchidinh is null;\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt modify idkhoaphongchidinh default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt modify idkhoaphongchidinh not null;\n";
            //linh 12/5/15
            s_Sql += "alter table " + sSchema + ".config add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmcomputer add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmdoituong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnghenghiepbenhvien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmvungbenhvien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhthanh add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnghenghiep add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomicd add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmtuyenbenhvien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_dmloaivienphi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmloaibenhvien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomkhoaphong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_dmnhomvienphi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmchuongicd add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhvien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_khoaphongbenhan add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_khoaphonggiavienphi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomnhanvien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_thongso add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmdantoc add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhan add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmquanhuyen add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_xutridieutri add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_dmloaiquyenso add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmketquadieutri add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhtrangrakhoa add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmxutri add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_lienhe add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmphuongxa add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_bhyt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmdang add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmhang add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmduongdung add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomketoan add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomhang add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnganhang add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_dmquyenso add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmloai add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmhoatchat add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomphieu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmkhoaphong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmkho add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnguon add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomin add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomkho add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmicd add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_hoantra add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmphieu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_hiendien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmloaithuocbyt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_nhapkhoa add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_benhkemtheo add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_tamung add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_benhandt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnuoc add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_theodoi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_xuatvien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".r_dmloaicdha add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_xuatkhoa add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".r_dmkythuat add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".r_dmmaumota add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_tonkhochitiet add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".r_dmmay add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_tonkhotonghop add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhacungcap add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuoc add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_thucxuattutruc add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_dmnhomxetnghiem add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_phieuduyet add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoiviends add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_thongso_ext add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_tondau add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocds add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_dmxetnghiem add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_dmloaixetnghiem add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_dmvienphi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_dmxetnghiemmap add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_dmsoxetnghiem add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_nhapll add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_tontutrucchitiet add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_tienthuoc add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_nhapct add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmmucdodiung add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_benhmantinh add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_diungthuoc add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_tontutructonghop add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_benhtiensu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dausinhton add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_xuatnoivienct add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".r_ketquall add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".r_ketquact add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_xuatct add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmlydoxuat add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_xuatll add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocct add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachitiet add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmuser add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocll add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_ketqua add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_toathuocct add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmloainhompttt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmlydovaovien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhompttt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmgaymegayte add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmphuongphappttt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_tamungcd add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmloaipttt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmmaupttt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphicls add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmdiadiem add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmtuvongpt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmtaibienpt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhhinhpt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnguyennhanchet add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmphongmo add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_thongsothebhyt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhtranggpb add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_tuvong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomuser add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_pttt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmphai add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_tainanthuongtich add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_dmloaikythuatvienphi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmtinhtrangthuchiencls add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmloaibn add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhantu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmdentu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_dmfieldgia add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_sophieuduyet add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhanhen add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_lichhen add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_lichlamviecbacsi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_sophieumau38 add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhommau add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_capmabenhnhan add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".s_dmchucnang add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_quyennguoidung add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_giaychuyenvien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_giayravien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuall add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrumuact add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".s_useroption add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_solienhoadon add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_nhomquyenloibhyt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetdutrumuall add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetdutrumuact add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_dmviettat add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmgoiygioitinh add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphict add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_thongsotylegiaban add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphichuavuottran add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_thuocchuavuottran add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmkho add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bl_dmthetich add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bl_tonkhotonghop add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bl_dmloaimau add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bl_theodoi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhomphieu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bl_dmnguon add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bl_dmnhomin add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmphieu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bl_tonkhochitiet add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bl_dmnhomrhd add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bl_dmnhacungcap add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bl_dmmau add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bl_tondau add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_dmdang add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_tonkhochitiet add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_theodoi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_tontutructonghop add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_tonkhotonghop add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_nhapll add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_dmloai add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_nhapct add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_tontutrucchitiet add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_xuatll add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_tondau add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_xuatct add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_dmkho add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_dmnhom add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmloaiphong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_theodoigiuong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmphong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_thanhvienekipmo add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrucapll add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmgiuong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dutrucapct add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmchucnangekipmo add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_chuyensolieu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmphucappttt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_goivienphi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbdtd add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_phatthuoc add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_khoasolieu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bc_report add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".bc_control add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_ngoaingu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmngoaingu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmtongiao add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmchucdanh add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmchucvu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmtrinhdovitinh add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmchuyenmon add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmhocvan add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_capmathebhyt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_denghichitiet add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_denghi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmcachdung add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_labthongso add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_labketqua add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".d_dmkhuhoso add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".d_dmkehoso add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".d_dmtanghoso add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_toamau add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnoilamviec add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_hopdong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmhopdong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_phuluchopdong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmhinhthuclamviec add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_dmnhomvienphibaocao add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmnhomchamcong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmcalamviec add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".h_dmtrangthaichamcong add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_toamauct add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_thauds add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_vienphi_phongthuchien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_thauct add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_phieuduyetkho add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_hoichan add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_theodoidulieu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_thongsotylecacdichvu add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmtuongtac add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_thongsotyletraituyen add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_goitiepdon add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombaocao add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_new add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_hoichan_thanhvien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_old add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_xetnghiemchuyenmau add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_phatstttiepdon add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_vudieutri add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_vudieutrichitiet add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhomtranbhyt add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".b_bhytxuattoan add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".l_dmongxetnghiem add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_benhnhantheodoi add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_hoichanphauthuat_ekip add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_phieusoket15 add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_denghitra add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".m_denghitract add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".r_dmnhombaocao add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmnguyennhantainan add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_dmhang add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_dmttb add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmbophan add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmngodoc add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmdienbien add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".p_dmxutritainan add idnhib number;\n";
            s_Sql += "alter table " + sSchema + ".e_dmnguon add idnhib number;\n";
            s_Sql += "update  " + sSchema + ".P_TUVONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_THONGSOTHEBHYT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMBENHNHANHEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_CAPMABENHNHAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".S_DMCHUCNANG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_QUYENNGUOIDUNG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".S_USEROPTION set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_SOLIENHOADON set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_NHOMQUYENLOIBHYT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_DMVIETTAT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMGOIYGIOITINH set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_THONGSOTYLEGIABAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".m_dmkho set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BL_DMNGUON set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BL_DMNHOMIN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BL_DMLOAIMAU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BL_DMTHETICH set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BL_DMNHOMRHD set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BL_DMMAU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".m_dmnhomphieu set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".m_dmphieu set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BL_DMNHACUNGCAP set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_DMDANG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_DMHANG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".e_dmnhom set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_DMLOAI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_DMTTB set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_DMNGUON set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_DMKHO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_XUATLL set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_XUATCT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMLOAIPHONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMPHONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMGIUONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMCHUCNANGEKIPMO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMPHUCAPPTTT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_GOIVIENPHI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BC_REPORT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BC_CONTROL set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMBDTD set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_PHATTHUOC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_KHOASOLIEU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_NGOAINGU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMCHUCVU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMNGOAINGU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMTONGIAO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMCHUCDANH set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMTRINHDOVITINH set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMCHUYENMON set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMHOCVAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_CAPMATHEBHYT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMCACHDUNG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_LABTHONGSO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DENGHI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DENGHICHITIET set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_TOAMAU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_TOAMAUCT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".D_DMKHUHOSO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".D_DMKEHOSO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".D_DMTANGHOSO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNOILAMVIEC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMHOPDONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMHINHTHUCLAMVIEC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_HOPDONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_PHULUCHOPDONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMNHOMCHAMCONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMCALAMVIEC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_DMTRANGTHAICHAMCONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_DMNHOMVIENPHIBAOCAO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMTUONGTAC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_VIENPHI_PHONGTHUCHIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_THAUDS set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_THAUCT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_GOITIEPDON set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_PHIEUDUYETKHO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_THONGSOTYLECACDICHVU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMNHOMBAOCAO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_DMGIAVIENPHI_OLD set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_DMGIAVIENPHI_NEW set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMCOMPUTER set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNHOMTRANBHYT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_BHYTXUATTOAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_DMONGXETNGHIEM set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_BENHNHANTHEODOI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DENGHITRA set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DENGHITRACT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".R_DMNHOMBAOCAO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_DMNHOM set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMNHOMKHO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMUSER set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMVUNGBENHVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMTINHTHANH set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMQUANHUYEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMPHUONGXA set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMDANTOC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMDOITUONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNGHENGHIEP set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNGHENGHIEPBENHVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMTUYENBENHVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMLOAIBENHVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMBENHVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMCHUONGICD set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNHOMICD set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMICD set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMKHOAPHONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNHOMKHOAPHONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_DMNHOMVIENPHIBHYT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_DMNHOMVIENPHI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_DMLOAIVIENPHI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_DMGIAVIENPHI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMKHOAPHONGBENHVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMBENHAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_KHOAPHONGBENHAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_KHOAPHONGGIAVIENPHI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_THONGSO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNHOMNHANVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNHANVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMPHAI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNHOMMAU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNHOMUSER set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_DMLOAIKYTHUATVIENPHI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMTINHTRANGTHUCHIENCLS set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMLOAIBN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNHANTU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMDENTU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_DMFIELDGIA set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMBENHNHAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMXUTRI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMKETQUADIEUTRI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMTINHTRANGRAKHOA set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_DMLOAIQUYENSO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_DMQUYENSO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMNUOC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMLOAI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMNHOMHANG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMHANG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMDANG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMDUONGDUNG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMNHOMKETOAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMNHOMIN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMNGANHANG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMNHACUNGCAP set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMNHOMBIETDUOC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMHOATCHAT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMNGUON set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMKHO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMNHOMPHIEU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMPHIEU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMKHOAPHONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMBD set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_HIENDIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMLOAITHUOCBYT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".R_DMLOAICDHA set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".R_DMMAY set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".R_DMKYTHUAT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".R_DMMAUMOTA set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_THONGSO_EXT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_DMSOXETNGHIEM set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_DMNHOMXETNGHIEM set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_DMLOAIXETNGHIEM set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_DMXETNGHIEM set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_DMVIENPHI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_DMXETNGHIEMMAP set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMMUCDODIUNG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DIUNGTHUOC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DMLYDOXUAT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMLYDOVAOVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMLOAIPTTT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMLOAINHOMPTTT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNHOMPTTT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMGAYMEGAYTE set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMPHUONGPHAPPTTT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMDIADIEM set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMBOPHAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNGUYENNHANTAINAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNGODOC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMDIENBIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMXUTRITAINAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMMAUPTTT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMTINHHINHPT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMTAIBIENPT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMTUVONGPT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMPHONGMO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMNGUYENNHANCHET set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DMTINHTRANGGPB set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_SOPHIEUDUYET set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_GIAYRAVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_GIAYCHUYENVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_SOPHIEUMAU38 set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_VIENPHICTTHUOC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_VIENPHICHUAVUOTTRAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_THUOCCHUAVUOTTRAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DUTRUMUALL set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DUTRUMUACT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_TAINANTHUONGTICH set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_PTTT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_LICHHEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_LICHLAMVIECBACSI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_NHAPLL set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_NHAPCT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_DAUSINHTON set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_BENHMANTINH set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_BENHTIENSU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_XUATLL set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_XUATCT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_KETQUA set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_KETQUACHITIET set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".R_KETQUALL set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".R_KETQUACT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_TOATHUOCLL set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_TOATHUOCCT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_TAMUNGCD set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_VIENPHI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_VIENPHICT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DUYETCHIPHI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DUYETCHIPHITHUOC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DUYETCHIPHICLS set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_XUATKHOA set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_THEODOI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_TONKHOCHITIET set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_TONKHOTONGHOP set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_TONDAU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_YLENHTHUOC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_YLENHTHUOCDS set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_YLENHTHUOCCT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_THUCXUATTUTRUC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_PHIEUDUYET set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_XUATNOIVIENDS set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_XUATNOIVIENCT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_TIENTHUOC set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_TONTUTRUCCHITIET set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_TONTUTRUCTONGHOP set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_HOICHANPHAUTHUAT_EKIP set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_HOICHANPHAUTHUAT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_PHIEUSOKET15 set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DUYETDUTRUMUALL set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DUYETDUTRUMUACT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BL_THEODOI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BL_TONKHOCHITIET set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BL_TONKHOTONGHOP set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".BL_TONDAU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_THEODOI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_TONKHOCHITIET set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_TONKHOTONGHOP set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_TONDAU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_TONTUTRUCCHITIET set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_TONTUTRUCTONGHOP set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_NHAPLL set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".E_NHAPCT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".H_CHAMCONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_HOICHAN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_THEODOIDULIEU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_HOICHAN_THANHVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_PHATSTTTIEPDON set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_XETNGHIEMCHUYENMAU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_VUDIEUTRI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_VUDIEUTRICHITIET set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_THEODOIGIUONG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_THANHVIENEKIPMO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DUTRUCAPLL set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".M_DUTRUCAPCT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_CHUYENSOLIEU set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".L_LABKETQUA set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_BENHANDT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_LIENHE set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_BHYT set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_XUATVIEN set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_XUTRIDIEUTRI set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_CHIDINH set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_HOANTRA set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".B_TAMUNG set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_BENHKEMTHEO set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_NHAPKHOA set idnhib =rownum where idnhib is null;\n";
            s_Sql += "update  " + sSchema + ".P_THONGSOTYLETRAITUYEN set idnhib =rownum where idnhib is null;\n";
            //Tú:13/05/2015
            s_Sql += "alter table " + sSchema + ".l_dmvienphi add hesotest number(5,2) default 0 not null;\n";
             //ThanhCuong - 15/05/2015
            s_Sql += "create table " + sSchema + ".m_cosotutruc(idtutruc number(3,0) default 0 not null,idbietduoc number(7,0) default 0 not null,"+
                "soluong number(30,7) default 0 not null,mmyy varchar2(4) DEFAULT to_char(sysdate,'mmyy') not null ," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate)"+
                " partition by list (mmyy)(partition m_cosotutruc_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".m_cosotutruc add constraint pk_m_cosotutruc primary key(idtutruc,idbietduoc,mmyy);\n";
            s_Sql += "alter table " + sSchema + ".m_cosotutruc add constraint fk_cosotutruc_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".m_cosotutruc add constraint fk_cosotutruc_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
            s_Sql += "alter table " + sSchema + ".m_cosotutruc add constraint fk_cosotutruc_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong);\n";
            //ThanhCuong - 18/05/2015
            s_Sql += "alter table " + sSchema + ".m_nhapll add idthau number(30,0);\n";
            s_Sql += "update " + sSchema + ".m_nhapll set idthau=0 where idthau is null;\n";
            s_Sql += "alter table " + sSchema + ".m_nhapll modify idthau default 0 ;\n";
            s_Sql += "alter table " + sSchema + ".m_nhapll modify idthau not null;\n";
            //Tú:18/05/2015
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add thuocphongxa number(1,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_new add thuocphongxa number(1,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi_old add thuocphongxa number(1,0) default 0 not null;\n";
            //Tú:19/05/2015
            s_Sql += "create table " + sSchema + ".m_dangduyet(idkhoaphong number(3,0),ngay date default sysdate not null," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate not null,idnhib number);\n";
            s_Sql += "alter table " + sSchema + ".m_dangduyet add constraint pk_m_dangduyet primary key(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".m_dangduyet add idnhib number;\n";
            s_Sql += "update  " + sSchema + ".m_dangduyet set idnhib =rownum where idnhib is null;\n";
            //Thuy 19/05/15
            s_Sql += "alter table " + sSchema + ".p_xuatvien modify soluutru nvarchar2(15);\n";
            //Tú:19/05/2015
            s_Sql += "create table " + sSchema + ".m_dmnhombietduoc40(idnhombietduoc40 number(5,0),tennhombietduoc40 nvarchar2(500),username varchar2(20)," +
                     "computer varchar2(50),ngayud date default sysdate not null,idnhib number);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc40 add constraint pk_m_nhombietduoc40 primary key(idnhombietduoc40);\n";
            s_Sql += "alter table " + sSchema + ".m_dmnhombietduoc40 add idnhib number;\n";
            s_Sql += "update  " + sSchema + ".m_dmnhombietduoc40 set idnhib =rownum where idnhib is null;\n";
            s_Sql += "create table " + sSchema + ".m_dmloaibietduoc40(idloaibietduoc40 number(5,0),tenloaibietduoc40 nvarchar2(500),"+
                     "idnhombietduoc40 number(5,0) default 0 not null," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate not null,idnhib number);\n";
            s_Sql += "alter table " + sSchema + ".m_dmloaibietduoc40 add constraint pk_m_loaibietduoc40 primary key(idloaibietduoc40);\n";
            s_Sql += "alter table " + sSchema + ".m_dmloaibietduoc40 add constraint fk_m_loaibietduoc40_nhom foreign key(idnhombietduoc40) references " + sSchema + ".m_dmnhombietduoc40(idnhombietduoc40);\n";
            s_Sql += "alter table " + sSchema + ".m_dmloaibietduoc40 add idnhib number;\n";
            s_Sql += "update  " + sSchema + ".m_dmloaibietduoc40 set idnhib =rownum;\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add idloaibietduoc40 numeric(5,0) default 0 not null;\n";
            //Thuy 19/05/2015
            s_Sql += "alter table " + sSchema + ".m_theodoi add thanhtien number(24,8) default 0;\n";
            //Tú:23/05/2015
            s_Sql += "alter table " + sSchema + ".m_dmbd add sttbd22 varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".m_dmbd add stthc22 varchar2(20);\n";
            s_Sql += "alter table " + sSchema + ".e_dmloai add idnhom number(3,0) default 0 not null;\n";//ThanhCuong 23/05/2015
            s_Sql += "alter table " + sSchema + ".e_dmloai add constraint fk_e_loai_nhom foreign key(idnhom) references " + sSchema + ".e_dmnhom(idnhom);\n";
            //ThanhCuong - 26/05/2015
            s_Sql += "create table " + sSchema + ".m_maicdthuoc(maicd varchar2(10),idbietduoc number(7,0),soluong number(30,0),idnhib number);\n";
            s_Sql += "alter table " + sSchema + ".m_maicdthuoc add constraint pk_m_maicdthuoc primary key(maicd,idbietduoc);\n";
            s_Sql += "update  " + sSchema + ".m_maicdthuoc set idnhib =rownum;\n";
            //Tú:09/06/2015
            s_Sql += "alter table " + sSchema + ".p_bhyt add bhyt5nam number(1,0) default 0 not null;\n";
            //Tú:22/06/2015
            s_Sql += "alter table " + sSchema + ".p_dmicd add hide number(1,0) default 0 not null;\n";
            //linh 23/6/15
            s_Sql += "create table " + sSchema + ".s_ngonngu(name nvarchar2(2000),value_en nvarchar2(2000),value_fr nvarchar2(2000)," +
                "value_ja nvarchar2(2000),value_ko nvarchar2(2000),value_de nvarchar2(2000),value_cn nvarchar2(2000),"+
                "value_ca nvarchar2(2000),comment nvarchar2(2000),idnhib number);\n";
            s_Sql += "alter table " + sSchema + ".s_ngonngu add constraint pk_s_ngonngu primary key(name);\n";
            //Tú:26/06/2015
            s_Sql += "create table " + sSchema + ".m_trukhotam(idtrukhotam number(30,0),idduyetchiphi number(30,0) default 0 not null," +
                     "mmyy varchar2(4) default to_char(sysdate,'mmyy') not null,ngay date default sysdate not null," +
                     "idtheodoitam number(30,0) default 0 not null,idbietduoc number(7,0) default 0 not null,idkho number(3,0) default 0 not null," +
                     "idnguon number(2,0) default 0 not null,soluong number(12,4) default 0 not null," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate not null) " +
                     "partition by list (mmyy)(partition m_trukhotam_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".m_trukhotam add constraint pk_m_trukhotam_idtrukhotam primary key(idtrukhotam);\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphithuoc add idtheodoitam number(30,0) default 0 not null;\n";
            //Tú:29/06/2015
            s_Sql += "alter table " + sSchema + ".d_dmtanghoso modify idtanghoso number(3,0);\n";
            //Tú:30/06/2015
            s_Sql += "alter table " + sSchema + ".m_trukhotam add dongia numeric(12,4) default 0 not null;\n";
            //Tú:30/06/2015
            s_Sql += "alter table " + sSchema + ".m_trukhotam add column stt number(3,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_dmkho add loaiba varchar2(50);\n";//ThanhCuong - 30/06/2015
            //Tú:01/07/2015
            s_Sql += "create table " + sSchema + ".l_dmhoachatxetnghiem(idgiavienphi number(7,0),idbietduoc number(7,0),dinhmuc number(12,4)," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmhoachatxetnghiem add constraint pk_l_dmhoachatxetnghiem primary key(idgiavienphi,idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".l_dmhoachatxetnghiem add constraint fk_l_dmhoachatxetnghiem_giavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql += "alter table " + sSchema + ".l_dmhoachatxetnghiem add constraint fk_l_dmhoachatxetnghiem_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
            s_Sql += "alter table " + sSchema + ".l_dmhoachatxetnghiem add constraint ck_l_dmhoachatxetnghiem_idgiavp check (idgiavienphi<>0);\n";
            //Tú:20/07/2015
            s_Sql += "alter table " + sSchema + ".p_dmgiuong modify soluong number(5,0);\n";
            //linh 21/7/15
            s_Sql += "create table " + sSchema + ".b_dmloaitiente (idloaitiente number(1),tenloaitiente varchar2(100),tenkhongdau varchar2(100)," +
                        "ngayud date default sysdate,username varchar2(50),computer varchar2(50));\n";
            s_Sql += "alter table " + sSchema + ".b_dmloaitiente add constraint pk_loaitiente primary key(idloaitiente);\n";
            s_Sql += "create table " + sSchema + ".b_tygiangoaite (idngoaite number(2),idloaitientrongnuoc number(2),sotien number(12,4) default 0 not null,ngay date default sysdate," +
                    " computer varchar2(50), username varchar2(50),ngayud date default sysdate );\n";
            s_Sql += "alter table " + sSchema + ".b_tygiangoaite add constraint pk_tygiangoaite primary key (idngoaite ,idloaitientrongnuoc,ngay);\n";
            s_Sql += "create table " + sSchema + ".b_thuchitiente(idvienphi number(30),idloaitiente number(2),loaigiaodich int default 0 not null,soluong number(8) default 0 not null," +
                " menhgia number(9) default 0 not null,tygia number(9) default 1 not null,thanhtien number(15,4) default 0 not null, ngayud date default sysdate,"+
                " computer varchar2(50),username varchar2(50),mmyy varchar2(4)) "+
                " partition by list (mmyy)(partition b_thuchitiente_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".b_thuchitiente add constraint pk_thuchitiente primary key(idvienphi,idloaitiente,loaigiaodich,menhgia);\n";
            s_Sql += "alter table " + sSchema + ".b_thuchitiente add constraint fk_thuchitiente_loaitiente foreign key(idloaitiente) references " + sSchema + ".b_dmloaitiente(idloaitiente);\n";
            //Tú:29/07/2015
            s_Sql += "create table " + sSchema + ".p_lichchaythan(idlichchaythan number(30),maql number(30),idkhoa number(30),ngay date default sysdate not null," +
                     "idmay number(2,0),ca number(2),mabs varchar2(4),idkhoaphong number(3,0),loai number(1,0),trangthai number(1,0),giuong varchar2(20)," +
                     "ghichu nvarchar2(254),mmyy varchar2(4),username varchar2(20),computer varchar2(50)," +
                     "ngayud date default sysdate not null) " +
                     " partition by list (mmyy)(partition p_lichchaythan_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".p_lichchaythan add constraint pk_p_lichchaythan primary key(idlichchaythan);\n";
            s_Sql += "alter table " + sSchema + ".p_lichchaythan add constraint fk_p_lichchaythan_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".p_lichchaythan add constraint fk_p_lichchaythan_dmmay foreign key(idmay) references " + sSchema + ".r_dmmay(idmay);\n";
            //Tú:03/08/2015
            s_Sql += "alter table " + sSchema + ".m_dmbd add thuocchaythan number(1,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_ylenhthuocds add idlichchaythan number(30,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_lichchaythan add ngaychay date;\n";
            s_Sql += "alter table " + sSchema + ".p_lichchaythan add idmaychay number(2,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_lichchaythan add cachay number(2,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_lichchaythan add mabschay varchar2(4);\n";
            //Thuy 11/8/15
            s_Sql += "CREATE TABLE " + sSchema + ".h_chamcong(manhanvien character varying(4) NOT NULL, idkhoaphong numeric(3,0) NOT NULL,"+
                "mmyy varchar2(4) DEFAULT to_char(sysdate,'mmyy') not null," +
                     "n1 character varying(2), n2 character varying(2), n3 character varying(2), n4 character varying(2), n5 character varying(2),"+
                "n6 character varying(2), n7 character varying(2), n8 character varying(2), n9 character varying(2),"+
                "n10 character varying(2), n11 character varying(2), n12 character varying(2), n13 character varying(2),"+
                "n14 character varying(2), n15 character varying(2), n16 character varying(2), n17 character varying(2),"+
                "n18 character varying(2), n19 character varying(2), n20 character varying(2), n21 character varying(2),"+
                "n22 character varying(2), n23 character varying(2), n24 character varying(2), n25 character varying(2),"+
                "n26 character varying(2), n27 character varying(2), n28 character varying(2), n29 character varying(2),"+
                "n30 character varying(2), n31 character varying(2), computer character varying(50), username character varying(20), ngayud date DEFAULT sysdate) "+
                "partition by list (mmyy)(partition h_chamcong_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".h_chamcong add constraint pk_h_chamcong primary key(manhanvien,idkhoaphong,mmyy);\n";
            //Tú:12/08/2015
            s_Sql += "create table " + Schema + ".b_quyettoanbhyt as select * from " + Schema + ".b_vienphi where 1=0;\n";
            s_Sql += "alter table " + Schema + ".b_quyettoanbhyt add constraint pk_quyettoanbhyt primary key(idvienphi);\n";
            s_Sql += "create table " + Schema + ".b_quyettoanbhytct as select * from " + Schema + ".b_vienphict where 1=0;\n";
            s_Sql += "alter table " + Schema + ".b_quyettoanbhytct add constraint pk_quyettoanbhytct primary key(idvienphi,stt);\n";
            s_Sql += "create table " + Schema + ".b_quyettoanbhytctthuoc as select * from " + Schema + ".b_vienphictthuoc where 1=0;\n";
            s_Sql += "alter table " + Schema + ".b_quyettoanbhytctthuoc add constraint pk_quyettoanbhytctthuoc primary key(idvienphi,stt);\n";
            s_Sql += "alter table " + Schema + ".b_vienphi add daquyettoan number(1,0) default 0 not null;\n";
            s_Sql += "alter table " + Schema + ".b_vienphi add ngayquyettoan timestamp without time zone;\n";
            s_Sql += "alter table " + Schema + ".b_vienphi add nguoiquyettoan varchar2(20);\n";
            //Thuy 11/8/15
            s_Sql += "CREATE TABLE " + sSchema + ".h_quatrinhcongtac( id numeric(3,0) default 0 not null, manhanvien character varying(4) NOT NULL,"+
                "noidungcongtac nvarchar2(500), hsluong numeric(6,2), machucvu numeric(2,0), tungay date," +
                     "denngay date, machucdanh numeric(2,0), ghichu nvarchar2(500), computer character varying(50),"+
                "username character varying(20), ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".h_quatrinhcongtac add constraint pk_h_quatrinhcongtac primary key(id,manhanvien);\n";
            //ThanhCuong - 18/08/2015
            s_Sql += "alter table " + sSchema + ".m_dmbd add icd10 nvarchar2(254);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan add rhd varchar2(10);\n";
            s_Sql += "alter table " + sSchema + ".p_dmbenhnhan modify nhommau varchar2(3);\n";
            //Tú:20/08/2015
            s_Sql += "alter table " + sSchema + ".b_chidinh add paidtamung numeric(1,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".m_duyetchiphi add paidtamung numeric(1,0) default 0 not null;\n";
            //Tú:27/08/2015
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add songayhentraketqua number(3,0) default 0 not null;\n";
            //Thuy 28/8/15
            s_Sql += "CREATE TABLE " + sSchema + ".h_ThongTinBaoHiem ( manhanvien varchar2(4) NOT NULL, SoLD varchar2(10),"+
                "NgayCapSoLD date, NoiCapSoLD nvarchar2(500), matinhthanhCapSoLD varchar2(3),ChuyenTuCoQuan nvarchar2(500)," +
                "ngaychuyen date, SoDKLD varchar2(10), ngaydksudunglaodong date, SoBHXH varchar2(50),"+
                "ngaycapBHXH date,noicapBHXH varchar2(3),sothangkhongtinhBHXH numeric(2,0) default 0,tongthoigiantinhBHXH numeric(3,0) default 0,"+
                "sotheBHYT varchar2(25),ngaycaptheBHYT date,noicaptheBHYT varchar2(3),thoihantungay date,"+
                "thoihandenngay date,mabvdangkitheBHYT varchar2(10),BHTN numeric(1,0) default 0,BHNT numeric(1,0) default 0,"+
                "bhkhac numeric(1,0) default 0,computer varchar2(50),  username varchar2(20), ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".h_ThongTinBaoHiem add constraint pk_h_ThongTinBaoHiem primary key(manhanvien);\n";
            //Thuy 29/8/15
            s_Sql += "CREATE TABLE " + sSchema + ".h_chamcongngoaigio(  id numeric(10,0) not null, manhanvien character varying(4) NOT NULL," +
                "idkhoaphong numeric(3,0) NOT NULL, ngay date, giobatdau date, gioketthuc date," +
                "ngaybatdau date, ngayketthuc date, letet numeric(1,0) DEFAULT 0 not null, t7cn numeric(1,0) DEFAULT 0 not null," +
                "congviec nvarchar2(500),computer character varying(50), username character varying(20)," +
                "ngayud date DEFAULT sysdate, mmyy generated always as (to_char(ngayud,'MMyy')))" +
                "partition by list (mmyy)(partition h_chamcongngoaigio_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".h_chamcongngoaigio add constraint pk_h_chamcongngoaigio primary key(id,manhanvien,mmyy);\n";
            s_Sql += "alter table " + sSchema + ".h_chamcongngoaigio add constraint fk_h_chamcongngoaigio_dmnv FOREIGN key(manhanvien) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add stt number(3) default 0 not null;\n";
            //Tú:03/09/2015
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add yeucau number(1,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add tachtrongbaocao number(3) default 0 not null;\n";
            //Tú:04/09/2015
            s_Sql += "alter table " + sSchema + ".p_dmdoituong add tylegiaban number(12,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".p_dmdoituong add giabanlaytruocvat number(1,0) default 0 not null;\n";
            s_Sql += "create table " + sSchema + ".m_theodoidoituong(idtheodoi number(30,0),madoituong number(2,0),giaban number(12,4)," +
                     "username varchar2(50),computer varchar2(50),ngayud date default sysdate, mmyy generated always as (to_char(ngayud,'MMyy')))" +
                     "partition by list (mmyy)(partition m_theodoidoituong_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".m_theodoidoituong add constraint pk_m_theodoidoituong primary key(idtheodoi,madoituong);\n";
            s_Sql += "create table " + sSchema + ".s_thongbao(idthongbao number(30),tenthongbao nvarchar2(500),noidung NCLOB,ngaythongbao date default sysdate not null," +
                        "username varchar2(50),computer varchar2(50),ngayud date default sysdate ,username_sua varchar2(4000),username_xoa varchar2(4000)," +
                        "username_doc varchar2(4000);\n";
            s_Sql += "alter table " + sSchema + ".s_thongbao add constraint pk_thongbao primary key(idthongbao);\n";
            //Tú:10/09/2015
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add xetnghiemcoban number(1,0) default 0 not null;\n";
            //ThanhCuong - 14/09/2015
            s_Sql += "alter table " + sSchema + ".m_dmphieu add idkey numeric(3,0) default 0 not null;\n";
            //Tú:16/09/2015
            s_Sql += "alter table " + sSchema + ".b_vienphict add bhyt number(5,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_vienphictthuoc add bhyt number(5,2) default 0 not null;\n";
            //Tú:17/09/2015
            s_Sql += "create table " + sSchema + ".l_dmnhomvitrisinhthiet(idnhomvitrisinhthiet number(7,0),manhomvitrisinhthiet varchar2(20),tennhomvitrisinhthiet nvarchar2(254)," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmnhomvitrisinhthiet add constraint pk_l_dmnhomvitrisinhthiet primary key(idnhomvitrisinhthiet);\n";
            s_Sql += "create table " + sSchema + ".l_dmvitrisinhthiet(idvitrisinhthiet number(7,0),mavitrisinhthiet varchar2(20),tenvitrisinhthiet nvarchar2(254)," +
                     "idnhomvitrisinhthiet number(7,0),username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmvitrisinhthiet add constraint pk_l_dmvitrisinhthiet primary key(idvitrisinhthiet);\n";
            s_Sql += "alter table " + sSchema + ".l_dmvitrisinhthiet add constraint pk_l_dmvitrisinhthiet_nhom foreign key(idnhomvitrisinhthiet) references " + sSchema + ".l_dmnhomvitrisinhthiet(idnhomvitrisinhthiet);\n";
            s_Sql += "create table " + sSchema + ".l_dmdungdich(iddungdich number(7,0),madungdich varchar2(20),tendungdich nvarchar2(254)," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmdungdich add constraint pk_l_dmdungdich primary key(iddungdich);\n";
            s_Sql += "create table " + sSchema + ".l_dmphuongphapnhuom(idphuongphapnhuom number(7,0),maphuongphapnhuom varchar2(20),tenphuongphapnhuom nvarchar2(254)," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate);\n";
            s_Sql += "alter table " + sSchema + ".l_dmphuongphapnhuom add constraint pk_l_dmphuongphapnhuom primary key(idphuongphapnhuom);\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add giaiphaubenh number(1,0) default 0 not null;\n";
            //Thuy 17/09/15
            s_Sql += "CREATE TABLE " + sSchema + ".h_dmheso( ma numeric(2,0) DEFAULT 0 NOT NULL, ten character varying(100), idnhib number);\n";
            s_Sql += "alter table " + sSchema + ".h_dmheso add constraint pk_h_dmheso primary key(ma);\n";
            s_Sql += "alter table " + Schema + ".bl_xuatnoiviends add idylenhthuocds numeric(30,0) default 0 not null;\n";//ThanhCuong - 19/09/2015
            //Tú:21/09/2015
            s_Sql += "alter table " + sSchema + ".b_chidinh add column dungdich number(7,0) default 0 not null;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh add column ngaydungdich date;\n";
            s_Sql += "alter table " + sSchema + ".b_chidinh add column tomtatlamsang nvarchar2(1000);\n";
            s_Sql += "create table " + sSchema + ".l_ketquagiaiphaubenh(idketquagiaiphaubenh number(30,0),sophieu varchar2(20),maql number(30,0) default 0 not null," +
                     "madoituong number(3,0) default 0 not null,idkhoa number(30,0) default 0 not null,ngay date,maicd varchar2(10),chandoan nvarchar2(254),"+
                     "daithe nvarchar2(254),nguoipha varchar2(4),ngaypha date,somanh number(5,0) default 0 not null,vithe nvarchar2(254),nguoilamtieuban varchar2(4),"+
                     "ngaylamtieuban date,idchidinh numeric(30,0) default 0 not null,phuhop number(1,0) default 0 not null,ketluan nvarchar2(254),banluan nvarchar2(254),"+
                     "mabsdoc varchar2(4),ngaytra date,truongkhoa varchar2(4),username varchar2(20),computer varchar2(50),ngayud date default sysdate," +
                     "mmyy generated always as (to_char(ngayud,'MMyy')))" +
                     "partition by list (mmyy)(partition l_ketquagiaiphaubenh_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".l_ketquagiaiphaubenh add constraint pk_l_ketquagiaiphaubenh(idketquagiaiphaubenh);\n";
            s_Sql += "create table " + sSchema + ".l_ketquavitrisinhthiet(idketquagiaiphaubenh number(30,0) default 0 not null,idvitrisinhthiet number(7,0) default 0 not null," +
                     "done number(1,0) default 0 not null,idchidinh number(30,0),nhuomhe numeric(1,0) default 0 not null,nhuomdacbiet numeric(1,0) default 0 not null," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate,"+
                     "mmyy generated always as (to_char(ngayud,'MMyy')))" +
                     "partition by list (mmyy)(partition l_ketquavitrisinhthiet_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".l_ketquavitrisinhthiet add constraint pk_l_ketquavitrisinhthiet(idchidinh,idvitrisinhthiet);\n";
            s_Sql += "create table " + sSchema + ".l_ketquahoamomiendich(idketquagiaiphaubenh number(30,0),idvitrisinhthiet number(7,0) default 0 not null," +
                     "idchidinh number(30,0) default 0 not null,idphuongphapnhuom number(7,0) default 0 not null,duongtinh number(1,0) default 0 not null," +
                     "cuongdo number(1,0) default 0 not null,tyle number(7,2) default 0 not null,ghichu nvarchar2(500)," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate),"+
                     "mmyy generated always as (to_char(ngayud,'MMyy')))" +
                     "partition by list (mmyy)(partition l_ketquahoamomiendich_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".l_ketquahoamomiendich add constraint pk_l_ketquahoamomiendich(idketquagiaiphaubenh,idvitrisinhthiet,idphuongphapnhuom);\n";
            s_Sql += "create table " + sSchema + ".l_ketquachandoansinhthiet(idketquagiaiphaubenh number(30,0),idvitrisinhthiet number(7,0) default 0 not null," +
                     "idchidinh number(30,0) default 0 not null,magiaiphaubenh varchar2(10)," +
                     "username varchar2(20),computer varchar2(50),ngayud date default sysdate),"+
                     "mmyy generated always as (to_char(ngayud,'MMyy')))" +
                     "partition by list (mmyy)(partition l_ketquachandoansinhthiet_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".l_ketquachandoansinhthiet add constraint pk_l_ketquachandoansinhthiet(idketquagiaiphaubenh,idvitrisinhthiet,idphuongphapnhuom);\n";
            s_Sql += "create table " + SchemaImage + ".l_hinhgiaiphaubenh(idketquagiaiphaubenh number(30,0) not null default 0,stt number(2,0) not null default 0," +
                     "hinhanh blob,computer varchar2(50),username varchar2(20),ngayud date default sysdate);\n";
            s_Sql += "alter table " + SchemaImage + ".l_hinhgiaiphaubenh add constraint pk_l_hinhgiaiphaubenh primary key (idketquagiaiphaubenh, stt);\n";

            s_Sql += "alter table " + sSchema + ".bl_xuatnoiviends add idylenhthuocds numeric(30,0) default 0 not null;\n";//ThanhCuong - 19/09/2015
            s_Sql += "grant references on " + sSchema + ".p_dmnhanvien to " + sSchemaImage + ";\n";
            s_Sql += "CREATE TABLE " + sSchemaImage + ".p_dmnhanvien_chuky (manhanvien varchar2(4) NOT NULL," +//linh 22/9/15
                    " chuky blob, computer varchar2(50), username varchar2(20),ngayud date DEFAULT sysdate" +
                    " CONSTRAINT pk_p_dmnhanvien_chuky PRIMARY KEY (manhanvien), " +
                    " CONSTRAINT fk_dmnv_dmnhanvien_chuky FOREIGN KEY (manhanvien) REFERENCES " + sSchema + ".p_dmnhanvien(manhanvien));\n";
            s_Sql += " create table " + sSchema + ".p_lichhen_chidinh(idlichhen number(30),stt number(4) ,  idgiavienphi number(7,0) DEFAULT 0 NOT NULL ," +
                    " soluong number(12,4) DEFAULT 0 NOT NULL ,  ghichu nvarchar2(500),  idkpnoithuchien number(3,0)  DEFAULT 0 NOT NULL,  " +
                    " idtrongoi number(7,0) DEFAULT 0 NOT NULL , ngayud date DEFAULT sysdate not null,  username varchar2(20),  computer varchar2(50)," +
                    " mmyy generated always as (substr( lpad(idlichhen,4),3,2)||substr( lpad(idlichhen,4),1,2))) " +
                    " partition by list (mmyy)(partition p_lichhen_chidinh_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql +=" alter table " + sSchema + ".p_lichhen_chidinh add constraint fk_p_lichhen_chidinh_lichhen foreign key (idlichhen) references " + sSchema + ".p_lichhen(idlichhen);\n";
            s_Sql +=" alter table " + sSchema + ".p_lichhen_chidinh add constraint fk_p_lichhen_chidinh_giavp foreign key (idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi);\n";
            s_Sql +=" alter table " + sSchema + ".p_lichhen_chidinh add constraint fk_p_lichhen_chidinh_dmkpbv foreign key (idkpnoithuchien) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
            s_Sql += "alter table " + sSchema + ".b_dmgiavienphi add giaiphaubenh numeric(1,0) default 0 not null;\n";
            //Tú:07/10/2015
            s_Sql += "alter table " + sSchema + ".p_dmkhoaphongbenhvien add makhoabhyt varchar2(10);\n";
            //Thuy 09/10/15
            s_Sql += "CREATE TABLE " + sSchema + ".h_heso_baohiem( idloaibh numeric(2,0) DEFAULT 0 NOT NULL , tenloaibh character varying(100) NOT NULL,";
            s_Sql += " mahopdong numeric(2,0) NOT NULL, hs_chucvu numeric(1,0) DEFAULT 0 NOT NULL, hs_vuotkhung numeric(1,0) DEFAULT 0 NOT NULL,";
            s_Sql += " hs_khuvuc numeric(1,0) DEFAULT 0 NOT NULL, hs_trachnhiem numeric(1,0) DEFAULT 0 NOT NULL, hs_dochai numeric(1,0) DEFAULT 0 NOT NULL,";
            s_Sql += " luongkhoan numeric(1,0) DEFAULT 0 NOT NULL, hs_luongcb numeric(1,0) DEFAULT 0 NOT NULL, hs_baoluu numeric(1,0) DEFAULT 0 NOT NULL,";
            s_Sql += " ngayapdung date DEFAULT sysdate, computer character varying(50), username character varying(20), ngayud date DEFAULT sysdate);\n";
            s_Sql += " alter table " + sSchema + ".h_heso_baohiem add constraint pk_h_heso_baohiem primary key(idloaibh, mahopdong, ngayapdung);\n";
            s_Sql += " alter table " + sSchema + ".h_heso_baohiem add constraint fk_h_heso_baohiem_dmhopdong FOREIGN key(mahopdong) references " + sSchema + ".h_dmhopdong(mahopdong);\n";
            s_Sql += "create table " + sSchema + ".p_dmthesmartcard(idthe varchar2(30),sothe varchar2(30),tinhtrang numeric(1,0) default 0 not null,mabenhvien varchar2(10));\n";
            s_Sql += "alter table " + sSchema + ".p_dmthesmartcard add constraint pk_p_dmthesmartcard primary key (idthe);\n";
            s_Sql += "alter table " + sSchema + ".p_dmthesmartcard add constraint uk_p_dmthesmartcard_sothe unique (sothe);\n";
            s_Sql += "alter table " + sSchema + ".p_dmnhanvien add matrinhdovitinh numeric(2,0) DEFAULT 0 NOT NULL;\n";//ThanhCuong - 13/10/2015
            //Thuy 15/10/15
            s_Sql += "CREATE TABLE " + sSchema + ".h_thongso(id numeric(3,0)  DEFAULT 0 NOT NULL,  ten character varying(500),"+
                    " val numeric(3,0) DEFAULT 0 NOT NULL,  ngayapdung date DEFAULT sysdate, computer character varying(50),"+
                    " username character varying(20), ngayud date DEFAULT sysdate);\n";
            s_Sql += "alter table " + sSchema + ".h_thongso add constraint pk_h_thongso primary key(id,ngayapdung);\n";
            //Tú:22/10/2015
            s_Sql += "create table " + sSchema + ".p_phieutruyendich(idphieutruyendich number(30,0),ngay date,maql number(30,0) not null default 0," +
                     "idkhoa number(30,0) not null default 0,idkhoaphong number(3,0) not null default 0,idbietduoc number(7,0) not null default 0," +
                     "soluong number(12,4) not null default 0,tocdogiot number(12,4) not null default 0,thoigianbatdau date," +
                     "thoigianketthuc date,mabs varchar2(4),nguoithuchien varchar2(4),username varchar2(20)," +
                     "computer varchar2(50),ngayud date not null default sysdate,mmyy generated always as (to_char(ngayud,'MMyy'))) " +
                     "partition by list (mmyy)(partition p_phieutruyendich_" + s_MMYY + " values('" + s_MMYY + "'));\n";
            s_Sql += "alter table " + sSchema + ".p_phieutruyendich add constraint pk_p_phieutruyendich primary key(idphieutruyendich);\n";
            //Tú:23/10/2015
            s_Sql += "alter table " + sSchema + ".p_phieutruyendich add losx varchar2(20);\n";
            //Thuy 24/10/15
            s_Sql +="CREATE TABLE " + sSchema + ".h_dmthanhphanxuatthan(id numeric(2,0) DEFAULT 0 NOT NULL, ten CHARACTER VARYING(200),"+
                    "computer character varying(50), username character varying(20), ngayud date DEFAULT sysdate);\n";
            s_Sql +="alter table " + sSchema + ".h_dmthanhphanxuatthan add constraint pk_dmthanhphanxuatthan primary key(id);\n";
            s_Sql +="CREATE TABLE " + sSchema + ".h_dmnguongoc( id numeric(2,0) DEFAULT 0 NOT NULL, ten CHARACTER VARYING(200),"+
                    "computer character varying(50), username character varying(20), ngayud date DEFAULT sysdate);\n";
            s_Sql +="alter table " + sSchema + ".h_dmnguongoc add constraint pk_h_dmnguongoc primary key(id);\n";
            s_Sql +=" CREATE TABLE " + sSchema + ".h_dmdaotaochinhtri( id numeric(2,0) DEFAULT 0 NOT NULL, ten CHARACTER VARYING(200),"+
                    "computer character varying(50), username character varying(20), ngayud date DEFAULT sysdate);\n";
            s_Sql +="alter table " + sSchema + ".h_dmdaotaochinhtri add constraint pk_h_dmdaotaochinhtri primary key(id);\n";
            s_Sql += "\nexit;\n";
            string s_Path = "tao.sql";
            if (File.Exists(s_Path))
            {
                File.Delete(s_Path);
            }
            FileStream stream = new FileStream(s_Path, FileMode.CreateNew, FileAccess.Write);
            StreamWriter writer = new StreamWriter(stream);
            writer.Write(s_Sql);
            writer.Close();
            stream.Dispose();
            writer.Dispose();
            string s_FileName = "sqlplus.exe";
            string s_Argument = sSchema + "/" + sPassword + "@" + sHost + " @" + System.Environment.CurrentDirectory + "\\" + s_Path;
            new Run(s_FileName, s_Argument, true).Launch();
            if (File.Exists(s_Path))
            {
                File.Delete(s_Path);
            }
#endif
            }
        }
        //linh 17/9/14
        public const string TABLESPACETRACKING = "medilinktracking";

        void CreateTableTracking(MDBConnection mdbCon)
        {

#if POSTGRESQL
            string s_Table_Evn = "";
            string s_Table = "";
            string s_Sql = "";
            string s_Pre = "evn_";
            s_Table = DanhMucTable.b_tamung.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql = "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150), " +
                " evn_event varchar2(50), tenkhoaphong varchar2(150), " +
                " tenquyenso varchar2(150), tendoituong varchar2(150), mabn varchar2(14)," +
                " hotenbenhnhan varchar2(150),	diachi varchar2(254),gioitinh varchar2(10),namsinh number(4) default 0 not null," +
                " id number(30)  DEFAULT 0 not null, diemthu number(2) default 0 not null," +
                " maql number(30) DEFAULT 0 not null,  idkhoa number(30) DEFAULT 0 not null," +
                " idquyenso number(5) DEFAULT 0 not null,  sobienlai number(10) DEFAULT 0 not null,ngay timestamp without time zone," +
                " loai number(2) DEFAULT 0 not null,  idkhoaphong number(3) DEFAULT 0 not null,  madoituong number(2) DEFAULT 0 not null," +
                " sotien number(15,4) DEFAULT 0 not null, done number(1) DEFAULT 0 not null, lanin number(2) DEFAULT 0 not null," +
                " loaibn number(2) DEFAULT 0 not null, idttrv number(30) DEFAULT 0 not null,  datru number(15,4) DEFAULT 0 not null," +
                " ketoan number(20) default 0 not null,idtonghop number(30) default 0 not null,lan number(5) default 1," +
                " username varchar2(20), usernamenl varchar2(20), ngayud timestamp without time zone DEFAULT sysdate," +
                " DONGBO varchar2(100) DEFAULT lpad('0',100,'0'), COMPUTER varchar2(50),mmyy varchar2(4))" +
                " WITH (OIDS=FALSE)" +
                " TABLESPACE " + TABLESPACETRACKING + ";\n";
            s_Table = DanhMucTable.b_vienphi.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null," +
                " evn_event varchar2(50), tenkhoaphongthanhtoan varchar2(150), tenquyenso varchar2(150),idvienphi number(30)  DEFAULT 0 not null," +
                " mabn varchar2(14),hotenbenhnhan varchar2(254), gioitinh varchar2(20), namsinh number(4), diachi varchar2(254)," +
                " maql number(30) DEFAULT 0 not null,  idkhoa number(30) DEFAULT 0 not null, idkhoaphongthanhtoan number(3) DEFAULT 0 not null, giuong varchar2(20)," +
                " ngayvao timestamp without time zone not null, ngayra timestamp without time zone not null, chandoan TEXT,maicd varchar2(50), diemthu number(2) default 0 not null," +
                " loai number(2) default 0, idquyenso number(5) DEFAULT 0 not null, sobienlai number(10) default 0 not null," +
                " ngaythanhtoan timestamp without time zone default sysdate, sotientong number(15,4) DEFAULT 0 not null, sotientamung number(15,4) DEFAULT 0 not null," +
                " sotienmien number(15,4) DEFAULT 0 not null,sotienbhyttra number(15,4) DEFAULT 0 not null, lanin number(2) DEFAULT 0 not null," +
                " chenhlech number(15,4) DEFAULT 0 not null,idquyensodv number(15,4) default 0 not null," +
                " sobienlaidv number(15,4) default 0 not null,username varchar2(20), usernamenl varchar2(20), miencs number(15,4) DEFAULT 0 not null," +
                " miendv number(15,4) DEFAULT 0 not null,miencs_ngaytt timestamp without time zone,sophieu number(10) default 0 not null,mmyy varchar2(4)," +
                " tenkhoaphong varchar2(150), tendoituong varchar2(150), tenbacsi varchar2(150),tenvienphi  varchar2(500)," +
                " stt number(5) default 0 not null,ngay timestamp without time zone default sysdate," +
                " idkhoaphong number(3) DEFAULT 0 not null, madoituong number(2) DEFAULT 0 not null," +
                " idgiavienphi number(7) default 0 not null,soluong number(15,4) default 0 not null," +
                " dongia number(15,4) default 0 not null, vat number(7,2) default 0 not null,sotien number(15,4) default 0 not null," +
                " sothe varchar2(20), giamua number(15,4) default 0 not null, tra number(15,4) default 0 not null," +
                " ngaytra timestamp without time zone default sysdate,bhytduyet number(1) default 0 not null,bhyttra number(15,4),idtonghop number(30) default 0 not null," +
                " idkhoaphongthuchien number(3) default 0 not null, gia_bh number(15,4) default 0 not null, mien number(15,4) DEFAULT 0 not null," +
                " mabs varchar2(4),tylemien number(10,5) default 0 not null)" +
                " WITH (OIDS=FALSE)" +
                " TABLESPACE " + TABLESPACETRACKING + ";\n";
            s_Table = DanhMucTable.b_hoantra.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150)," +
                " evn_event varchar2(50), mabn varchar2(14), hotenbenhnhan varchar2(200), diachi varchar2(254)," +
                " gioitinh varchar2(20),namsinh number(4) default 0 not null,id number(30)  DEFAULT 0 not null, diemthu number(2) default 0 not null, idquyenso number(5) DEFAULT 0 not null, " +
                " sobienlai number(10) DEFAULT 0 not null,ngay timestamp without time zone, maql number(30) DEFAULT 0 not null, idkhoa number(30) DEFAULT 0 not null, idkhoaphong number(3) DEFAULT 0 not null, " +
                " sotien number(15,4) DEFAULT 0 not null,loai number(2) DEFAULT 0 not null,loaibn number(2) DEFAULT 0 not null,username varchar2(20), usernamenl varchar2(20)," +
                " ngayud timestamp without time zone DEFAULT sysdate, DONGBO varchar2(100) DEFAULT lpad('0',100,'0'),COMPUTER varchar2(50),mmyy varchar2(4))" +
                " WITH (OIDS=FALSE)" +
                " TABLESPACE " + TABLESPACETRACKING + ";\n";
            s_Table = DanhMucTable.p_benhandt.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150)," +
                " evn_event varchar2(50),mabn varchar2(14) not null, hotenbenhnhan varchar2(200), diachi varchar2(254)," +
                " gioitinh varchar2(20),namsinh number(4) default 0 not null,tenkhoaphong varchar2(150),tendoituong varchar2(100),tenbacsy varchar2(150)," +
                " mavaovien number(30) default 0 not null, maql number(30) default 0 not null," +
                " idkhoaphong number(3), ngay timestamp without time zone default sysdate not null, madoituong number(2) default 2 not null, " +
                " sovaovien varchar2(20), done number(2) default 0 not null, bnmoi number(1) default 0 not null, " +
                " noitiepdon number(2) default 0 not null, loaiba number(1) default 0 not null,mabs varchar2(4)," +
                " quatrinhbenhly text,khambenhtoanthan text,khambenhcacbophan text,chandoansobo text,maicd varchar2(10),benhchinh text,machuyenden number(30) default 0 not null," +
                " lydodieutri text not null default ' ',username varchar2(20), computer varchar2(50)," +
                " dentu number(1) default 2 not null,nhantu number(1) default 2 not null)" +
                " WITH (OIDS=false)" +
                " TABLESPACE " + TABLESPACETRACKING + ";\n";
            //Thuy 19/12/14
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column trinhdovanhoa text;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column ngaybong timestamp without time zone;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column para character varying(11);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column ngaykinhcuoiki timestamp without time zone;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column ngaysinhdukien timestamp without time zone;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column dacdiemthai text;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column nhanapmatphai character varying(10);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column nhanapmattrai character varying(10);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column thiluckhongkinhmatphai text;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column thiluckhongkinhmattrai text;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column thiluccokinhmatphai character varying(10);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column thiluccokinhmattrai character varying(10);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column idkhoa numeric(30,0) NOT NULL DEFAULT 0;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column idbenhan numeric(2,0) NOT NULL DEFAULT 24;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column soluutru character varying(20);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column idlydodieutri numeric(5,0) NOT NULL DEFAULT 0;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column mmyy character varying(4) NOT NULL DEFAULT to_char(sysdate, 'mmyy'::character varying);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column sotientongchiphi numeric(24,8) NOT NULL DEFAULT 0;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column sotienbhyttra numeric(24,8) NOT NULL DEFAULT 0;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column sotienbntra numeric(24,8) NOT NULL DEFAULT 0;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column sotienmien numeric(24,8) NOT NULL DEFAULT 0;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column sotienhaophi numeric(24,8) NOT NULL DEFAULT 0;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column sotientamung numeric(24,8) NOT NULL DEFAULT 0;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column sotienkhac numeric(24,8) NOT NULL DEFAULT 0;\n";
            s_Sql += "alter table " + SchemaTracking + "." + s_Table_Evn + " add column sonhapvien character varying(20);\n";
            s_Table = DanhMucTable.b_chidinh.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150)," +
                " evn_event varchar2(50),mabn varchar2(14) not null, hotenbenhnhan varchar2(200), diachi varchar2(254)," +
                " gioitinh varchar2(20),namsinh number(4) default 0 not null,tenkhoaphong varchar2(150),tendoituong varchar2(100),tenbacsy varchar2(150)," +
                " tenvienphi varchar2(250),id number(30,0) default 0, maql number(30,0) default 0 not null, idkhoa number(30,0) default 0 not null, ngay timestamp without time zone, " +
                " idkhoaphong number(3 ) default 0 not null, madoituong number(2,0) default 0 not null, idgiavienphi number(7,0) default 0 not null, soluong number(12,4) default 0 not null, " +
                " dongia number(15,4) default 0 not null, ghichu text, tinhtrang number(1,0) default 0 not null, idkpnoithuchien number(3) default 0 not null, " +
                " paid number(1,0) default 0 not null, done number(1,0) default 0 not null, idchidinh number(30,0) default 0 not null, " +
                " idttrv number(30,0) default 0 not null, maicd varchar2(9 ), chandoan text, mabs varchar2(4 ), loaiba number(1,0) default 3 not null, " +
                " ngaythuchien timestamp without time zone, idtrongoi number(7,0) default 0 not null, hide number(1,0) default 0 not null,  duyet number(1,0) default 0 not null, " +
                " lanin number(2,0) default 0 not null, idduoc number(30,0) default 0 not null,username varchar2(20), computer varchar2(50), " +
                " vuottran number(1,0) default 0 not null, idpttt number(30,0) default 0 not null)" +
                " WITH (OIDS=false)" +
                " TABLESPACE " + TABLESPACETRACKING + ";\n";
            //ThanhCuong - 15/10/2014
            s_Table = "m_nhap";// DanhMucTable.m_nhapll.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null," +
               " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null," +
               " evn_event varchar2(50),tenkhoaphongduoc varchar2(150),tennhacungcap varchar2(250),tenkhonhap varchar2(150),tennguonnhap varchar2(150)," +
               " mabietduoc varchar2(15),tenbietduoc varchar2(250),tenhang varchar2(250),tennuoc varchar2(250)," +
               "idnhap number(30) default 0, mmyy varchar2(4) not null, sophieu varchar2(20), ngaynhap timestamp without time zone, " +
              " sohoadon varchar2(254), ngayhoadon timestamp without time zone, bienbankiemnhap varchar2(15), ngaykiem timestamp without time zone, loai number(2) default 0 not null," +
              " idkhoaphongduoc number(3,0) default 0 not null, nguoigiao varchar2(150), idnhacungcap number(5) default 0 not null, idkho number(3) default 0,   " +
              " idnguon number(2) default 0 not null, no varchar2(254), co varchar2(10), paid number(1) default 0 not null," +
              " lanin number(3) default 0 not null, computer varchar2(50),username varchar2(20),stt number(3) default 0 not null," +
              " idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null, soluong1 number(30,8) default 0 not null," +
              " soluong2 number(30,8) default 0 not null, tyle number(7,2) default 0 not null, idbietduoc number(7) default 0 not null," +
                " idhang number(5) default 0 not null, idnuoc number(5) default 0 not null, handung timestamp without time zone, losx varchar2(20), " +
                " dongia number(12,4) default 0 not null, giaban number(12,4) default 0 not null, giagoc number(12,4) default 0 not null, vat number(3) default 0 not null," +
                " chietkhau number(5,2) default 0 not null)" +
               " WITH (OIDS=FALSE)" +
               " TABLESPACE " + TABLESPACETRACKING + ";\n";
            //Thủy 15/12/2014
            s_Table = "m_thau";
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null," +
               " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null," +
               " evn_event varchar2(50),idnhacungcap numeric(5,0) default 0 not null,tennhacungcap varchar2(250),tennhomkho varchar2(150)," +
               " idthau number(30) default 0, mmyy varchar2(4) not null, soquyetdinh varchar2(20), ngayquyetdinh timestamp without time zone, " +
              " dotthau varchar2(50), nam numeric(4,0), ghichu nvarchar2(500), computer varchar2(50),username varchar2(20),stt number(3) default 0 not null," +
              " idbietduoc number(7,0),handung timestamp default sysdate not null, soluong number(30,8) default 0 not null,dongia number(24,10) default 0 not null," +
              "vat number(3) default 0 not null,giasauvat number(24,10) default 0 not null, ghichuct nvarchar2(500),tungay timestamp without time zone,denngay timestamp without time zone)" +
               " WITH (OIDS=FALSE)" +
               " TABLESPACE " + TABLESPACETRACKING + ";\n";
            s_Table = "m_thuhoi";
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null," +
               " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null," +
               " evn_event varchar2(50),mmyy varchar2(4),tennhomkho varchar2(150),tenkhoaphong varchar2(250),tentutruc varchar2(250),tenphieu varchar2(150)," +
               " tennhomphieu varchar2(250),idphieuduyet number(30),idnhomkho number(2,0),ngayduyet timestamp without time zone default sysdate not null, idkhoaphong number(3) default 0 not null," +
               " idtutruc number(3) default 0 not null,idphieu number(3) default 0 not null,idnhomphieu number(2) default 0 not null)" +
               " WITH (OIDS=FALSE)" +
               " TABLESPACE " + TABLESPACETRACKING + ";\n";
            s_Table = DanhMucTable.m_duyetchiphi.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null," +
               " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null," +
               " evn_event varchar2(50),mabn varchar2(14) not null, hotenbenhnhan varchar2(200), diachi varchar2(254),gioitinh varchar2(20)," +
               " namsinh number(4) default 0 not null,tenkhoaphong varchar2(150),tenkho varchar2(150),mavp varchar2(20),tengiavienphi varchar2(254),idduyetchiphi number(30) default 0,mmyy varchar2(4) not null" +
               ",ngayduyet timestamp without time zone default sysdate not null,maql number(30) DEFAULT 0 not null,idquyenso number(5) default 0 not null, sobienlai number(10) default 0 not null" +
               ",idkhoaphong number(3) default 0 not null,tongtienthuoc number(24,8) default 0 not null, tongtiencls number(24,8) default 0 not null, bntra number(24,8) default 0 not null" +
               ",bhyttra number(24,8) default 0 not null,trangthai number(1) default 0 not null, idtonghop number(30) DEFAULT 0 not null,idkythuatcao number(30) DEFAULT 0 not null," +
               " idttrv number(30) DEFAULT 0 not null,COMPUTER varchar2(50),USERNAME varchar2(20),sttthuoc number(3) DEFAULT 0,soluongthuoc number(12,4) DEFAULT 0 not null, " +
               " dongiathuoc number(12,4) default 0 not null,idtheodoi number(30) DEFAULT 0 not null,idkho number(3) default 0 not null,idtoathuoc number(30) DEFAULT 0 not null,sttcls number(3) DEFAULT 0," +
               " soluongcls number(12,4) DEFAULT 0 not null,dongiacls number(12,4) default 0 not null,idgiavienphi number(7) DEFAULT 0 not null,idchidinh number(30) DEFAULT 0 not null," +
               " idbietduoc number(7) default 0 not null,mabietduoc varchar2(15),tenbietduoc varchar2(254),idnhomphieu number(2) DEFAULT 0 not null,tennhomphieu varchar2(254))" +
               " WITH (OIDS=FALSE)" +
               " TABLESPACE " + TABLESPACETRACKING + ";\n";
            //Thủy 16/12/2014
            s_Table = DanhMucTable.p_xuatkhoa.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null, evn_mmyy varchar2(4) " +
                "default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null, evn_event varchar2(50)," +
                "idxuatkhoa numeric(30,0) default 0 not null,ngay timestamp without time zone,idketqua numeric(1,0),idtinhtrangrakhoa numeric(2,0),chandoan text,maicd character varying(9)," +
                "mabs character varying(4), bienchung numeric(1,0), taibien numeric(1,0), idkhoaphongchuyendi number(3,0) default 0,giaiphau numeric(1,0), mmyy varchar2(4) not null, " +
                "computer varchar2(50),username varchar2(20)) WITH (OIDS=FALSE) TABLESPACE " + TABLESPACETRACKING + ";\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column tenketqua character varying(100);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column tentinhtrangrakhoa character varying(100);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column tenbacsi character varying(200);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column tenkhoaphongchuyendi character varying(200);\n";
            //Thuy 22/12/14
            s_Table = DanhMucTable.p_xuatvien.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null, evn_mmyy varchar2(4) " +
            " default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null, evn_event varchar2(50),maql numeric(30,0) default 0 not null,idkhoaphong numeric(3,0) default 0,ngay timestamp without time zone,idketqua numeric(1,0),idtinhtrangrakhoa numeric(2,0),benhchinh text,maicd character varying(9)," +
            " mabs character varying(4), soluutru text,traba numeric(1,0) default 0 not null,idkhoaphongnhapvien number(3,0) default 0,username varchar2(20),ngayud timestamp default sysdate not null,computer character varying(50),mabenhvienchuyendi character varying(10),lamsang text,xetnghiem text,chandoan text, thuoc text, tinhtrangchuyenvien text,vanchuyen text,nguoidua text," +
            " lydochuyenvien text,idbenhtiensu numeric(30,0)default 0 not null,mmyy character varying(4),idtanghoso numeric(3,0) default 0 not null,ghichuhoso character varying(200),chuyenvientheoyeucau numeric(1,0)) WITH (OIDS=FALSE) TABLESPACE " + TABLESPACETRACKING + ";\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column tenbacsi character varying(200);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column tenkhoaphong character varying(500);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column tenketqua character varying(100);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column tentinhtrangrakhoa character varying(100);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column tenbenhvienchuyendi character varying(500);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add column tenkhoaphongnhapvien character varying(200);\n";
            //Thuy 23/12/14
            s_Table = DanhMucTable.p_nhapkhoa.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null, evn_mmyy varchar2(4) " +
                " default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null, evn_event varchar2(50)," +
                " idnhapkhoa numeric(30,0) default 0 not null,maql numeric(30,0) default 0 not null,idkhoaphong numeric(3,0) default 0, tenkhoaphong character varying(100)," +
                " idbenhan numeric(3,0) default 0,tenbenhan character varying(100),ngay timestamp without time zone,tuoivao character varying(4),giuong character varying(60)," +
                " tengiuong character varying(100),idkhoachuyen numeric(3,0),tenkhoachuyen character varying(100),chandoan text,maicd character varying(9)," +
                " mabs character varying(4), tenbacsy character varying(100),lan numeric(3,0) default 0,ngayud timestamp default sysdate not null,machuyenden numeric(30,0)," +
                " computer varchar2(50),username varchar2(20), mmyy varchar2(4) not null) WITH (OIDS=FALSE) TABLESPACE " + TABLESPACETRACKING + ";\n";
            //ThanhCuong - 24/09/2015
            s_Table = DanhMucTable.m_phatthuoc.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null," +
               " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null," +
               " evn_event varchar2(50),idduyetchiphi number(30) default 0,idkho number(3) default 0 not null,tenkho text" +
               ",ngayphat timestamp without time zone default sysdate not null,mmyy varchar2(4) not null,COMPUTER varchar2(50),USERNAME varchar2(20))" +
               " WITH (OIDS=FALSE) TABLESPACE " + TABLESPACETRACKING + ";\n";
            foreach (string s in s_Sql.Trim(';').Split(';'))
            {
                if (s.Trim() != "")
                {
                    try
                    {
                        MDBCommand cmd = new MDBCommand(s, mdbCon);
                        cmd.ExecuteNonQuery();
                        Application.DoEvents();
                    }
                    catch
                    {
                        continue;
                    }

                }
            }
#else
            string s_MMYY = DateTime.Now.ToString("MMyy");
            string s_Table_Evn = "";
            string s_Table = "";
            string s_Sql = "";
            string s_Pre = "evn_";
            s_Table = DanhMucTable.b_tamung.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql = "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay date default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150), " +
                " evn_event varchar2(50), tenkhoaphong varchar2(150), " +
                " tenquyenso varchar2(150), tendoituong varchar2(150), mabn varchar2(14)," +
                " hotenbenhnhan varchar2(150),	diachi varchar2(254),gioitinh varchar2(10),namsinh number(4) default 0 not null," +
                " id number(30)  DEFAULT 0 not null, diemthu number(2) default 0 not null," +
                " maql number(30) DEFAULT 0 not null,  idkhoa number(30) DEFAULT 0 not null," +
                " idquyenso number(5) DEFAULT 0 not null,  sobienlai number(10) DEFAULT 0 not null,ngay date," +
                " loai number(2) DEFAULT 0 not null,  idkhoaphong number(3) DEFAULT 0 not null,  madoituong number(2) DEFAULT 0 not null," +
                " sotien number(15,4) DEFAULT 0 not null, done number(1) DEFAULT 0 not null, lanin number(2) DEFAULT 0 not null," +
                " loaibn number(2) DEFAULT 0 not null, idttrv number(30) DEFAULT 0 not null,  datru number(15,4) DEFAULT 0 not null," +
                " ketoan number(20) default 0 not null,idtonghop number(30) default 0 not null,lan number(5) default 1," +
                " username varchar2(20), usernamenl varchar2(20), ngayud date DEFAULT sysdate," +
                " DONGBO varchar2(100) DEFAULT lpad('0',100,'0'), COMPUTER varchar2(50),mmyy varchar2(4))" +
                " partition by range (evn_ngay)" +
                " INTERVAL (NUMTOYMINTERVAL(1,'MONTH'))" +
                " STORE IN (" + TABLESPACETRACKING + ")" +
                " (partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";

            
            s_Table = DanhMucTable.b_hoantra.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay date default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150)," +
                " evn_event varchar2(50), mabn varchar2(14), hotenbenhnhan nvarchar2(200), diachi nvarchar2(254)," +
                " gioitinh varchar2(20),namsinh number(4) default 0 not null,id number(30)  DEFAULT 0 not null, diemthu number(2) default 0 not null, idquyenso number(5) DEFAULT 0 not null, " +
                " sobienlai number(10) DEFAULT 0 not null,ngay date, maql number(30) DEFAULT 0 not null, idkhoa number(30) DEFAULT 0 not null, idkhoaphong number(3) DEFAULT 0 not null, " +
                " sotien number(15,4) DEFAULT 0 not null,loai number(2) DEFAULT 0 not null,loaibn number(2) DEFAULT 0 not null,username varchar2(20), usernamenl varchar2(20)," +
                " ngayud date DEFAULT sysdate, DONGBO varchar2(100) DEFAULT lpad('0',100,'0'),COMPUTER varchar2(50),mmyy varchar2(4))" +
               " partition by range (evn_ngay)" +
                " INTERVAL (NUMTOYMINTERVAL(1,'MONTH'))" +
                " STORE IN (" + TABLESPACETRACKING + ")" +
                " (partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            s_Table = DanhMucTable.p_benhandt.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay date default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac nvarchar2(150)," +
                " evn_event varchar2(50),mabn varchar2(14) not null, hotenbenhnhan nvarchar2(200), diachi nvarchar2(254)," +
                " gioitinh varchar2(20),namsinh number(4) default 0 not null,tenkhoaphong varchar2(150),tendoituong varchar2(100),tenbacsy varchar2(150)," +
                " mavaovien number(30) default 0 not null, maql number(30) default 0 not null," +
                " idkhoaphong number(3), ngay date default sysdate not null, madoituong number(2) default 2 not null, " +
                " sovaovien varchar2(10), done number(2) default 0 not null, bnmoi number(1) default 0 not null, " +
                " noitiepdon number(2) default 0 not null, loaiba number(1) default 0 not null,mabs varchar2(4)," +
                " quatrinhbenhly nvarchar2(500),khambenhtoanthan nvarchar2(500),khambenhcacbophan nvarchar2(500),chandoansobo nvarchar2(500),maicd varchar2(10),benhchinh nvarchar2(500),machuyenden number(30) default 0 not null," +
                " lydodieutri nvarchar2(500) default ' ' not null,username varchar2(20), computer varchar2(50)," +
                " dentu number(1) default 2 not null,nhantu number(1) default 2 not null)" +
               " partition by range (evn_ngay)" +
                " INTERVAL (NUMTOYMINTERVAL(1,'MONTH'))" +
                " STORE IN (" + TABLESPACETRACKING + ")" +
                " (partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            //Thuy 19/12/14
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add trinhdovanhoa nvarchar2(200);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add ngaybong date;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add para character varying(11);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add ngaykinhcuoiki date;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add ngaysinhdukien date;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add dacdiemthai nvarchar2(100);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add nhanapmatphai character varying(10);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add nhanapmattrai character varying(10);\n";
            s_Sql += " alter table " + sSchemaTracking + "." + s_Table_Evn + " add thiluckhongkinhmatphai nvarchar2(100);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add thiluckhongkinhmattrai nvarchar2(100);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add thiluccokinhmatphai character varying(10);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add thiluccokinhmattrai character varying(10);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add idkhoa numeric(30,0) DEFAULT 0 NOT NULL ;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add idbenhan numeric(2,0) DEFAULT 24 NOT NULL;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add soluutru character varying(20);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add idlydodieutri numeric(5,0) DEFAULT 0 NOT NULL ;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add mmyy character varying(4) DEFAULT to_char(sysdate,'mmyy') NOT NULL;\n";
            s_Sql += " alter table " + sSchemaTracking + "." + s_Table_Evn + " add sotientongchiphi numeric(24,8) DEFAULT 0 NOT NULL;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add sotienbhyttra numeric(24,8) DEFAULT 0 NOT NULL;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add sotienbntra numeric(24,8) DEFAULT 0 NOT NULL;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add sotienmien numeric(24,8) DEFAULT 0 NOT NULL;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add sotienhaophi numeric(24,8) DEFAULT 0 NOT NULL;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add sotientamung numeric(24,8) DEFAULT 0 NOT NULL;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add sotienkhac numeric(24,8) DEFAULT 0 NOT NULL;\n";
            s_Table = DanhMucTable.b_chidinh.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay date default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac nvarchar2(150)," +
                " evn_event varchar2(50),mabn varchar2(14) not null, hotenbenhnhan nvarchar2(200), diachi nvarchar2(254)," +
                " gioitinh varchar2(20),namsinh number(4) default 0 not null,tenkhoaphong varchar2(150),tendoituong varchar2(100),tenbacsy varchar2(150)," +
                " tenvienphi varchar2(250),id number(30,0) default 0, maql number(30,0) default 0 not null, idkhoa number(30,0) default 0 not null, ngay date, " +
                " idkhoaphong number(3 ) default 0 not null, madoituong number(2,0) default 0 not null, idgiavienphi number(7,0) default 0 not null, soluong number(12,4) default 0 not null, " +
                " dongia number(15,4) default 0 not null, ghichu nvarchar2(500), tinhtrang number(1,0) default 0 not null, idkpnoithuchien number(3) default 0 not null, " +
                " paid number(1,0) default 0 not null, done number(1,0) default 0 not null, idchidinh number(30,0) default 0 not null, " +
                " idttrv number(30,0) default 0 not null, maicd varchar2(9 ), chandoan nvarchar2(500), mabs varchar2(4 ), loaiba number(1,0) default 3 not null, " +
                " ngaythuchien date, idtrongoi number(7,0) default 0 not null, hide number(1,0) default 0 not null,  duyet number(1,0) default 0 not null, " +
                " lanin number(2,0) default 0 not null, idduoc number(30,0) default 0 not null,username varchar2(20), computer varchar2(50), " +
                " vuottran number(1,0) default 0 not null, idpttt number(30,0) default 0 not null)" +
               " partition by range (evn_ngay)" +
                " INTERVAL (NUMTOYMINTERVAL(1,'MONTH'))" +
                " STORE IN (" + TABLESPACETRACKING + ")" +
                " (partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            //ThanhCuong - 15/10/2014
            s_Table = "m_nhap";// DanhMucTable.m_nhapll.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay date default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac nvarchar2(150),evn_stt number(5) default 0 not null," +
                " evn_event varchar2(50),tenkhoaphongduoc nvarchar2(150),tennhacungcap nvarchar2(250),tenkhonhap nvarchar2(150),tennguonnhap nvarchar2(150)," +
                " mabietduoc varchar2(15),tenbietduoc nvarchar2(250),tenhang nvarchar2(250),tennuoc nvarchar2(250)," +
                " idnhap number(30) default 0, mmyy varchar2(4) not null, sophieu varchar2(20), ngaynhap date, " +
                " sohoadon varchar2(254), ngayhoadon date, bienbankiemnhap varchar2(15), ngaykiem date, loai number(2) default 0 not null," +
                " idkhoaphongduoc number(3,0) default 0 not null, nguoigiao nvarchar2(150), idnhacungcap number(5) default 0 not null, idkho number(3) default 0,   " +
                " idnguon number(2) default 0 not null, no varchar2(254), co varchar2(10), paid number(1) default 0 not null," +
                " lanin number(3) default 0 not null, computer varchar2(50),username varchar2(20),stt number(3) default 0 not null," +
                " idtheodoi number(30) default 0 not null, soluong number(30,8) default 0 not null, soluong1 number(30,8) default 0 not null," +
                " soluong2 number(30,8) default 0 not null, tyle number(7,2) default 0 not null, idbietduoc number(7) default 0 not null," +
                " idhang number(5) default 0 not null, idnuoc number(5) default 0 not null, handung date, losx varchar2(20), " +
                " dongia number(12,4) default 0 not null, giaban number(12,4) default 0 not null, giagoc number(12,4) default 0 not null, vat number(3) default 0 not null," +
                " chietkhau number(5,2) default 0 not null)" +
                " partition by range (evn_ngay)" +
                " INTERVAL (NUMTOYMINTERVAL(1,'MONTH'))" +
                " STORE IN (" + TABLESPACETRACKING + ")" +
                " (partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            //Thủy 15/12/2014
            s_Table = "m_thau";
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null," +
               " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null," +
               " evn_event varchar2(50),idnhacungcap numeric(5,0) default 0 not null,tennhacungcap varchar2(250),idthau number(30) default 0, mmyy varchar2(4) not null,"+
                "soquyetdinh varchar2(20), ngayquyetdinh date,dotthau varchar2(50), nam numeric(4,0), ghichu nvarchar2(500), computer varchar2(50),username varchar2(20),"+
                "stt number(3) default 0 not null,idbietduoc number(7,0),handung timestamp default sysdate not null, soluong number(30,8) default 0 not null," +
              " dongia number(24,10) default 0 not null,vat number(3) default 0 not null,giasauvat number(24,10) default 0 not null, ghichuct nvarchar2(500),tungay date,denngay date)" +
              " partition by range (evn_ngay)" +
                " INTERVAL (NUMTOYMINTERVAL(1,'MONTH'))" +
                " STORE IN (" + TABLESPACETRACKING + ")" +
                " (partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            s_Table = "m_thuhoi";
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay date default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac nvarchar2(150),evn_stt number(5) default 0 not null," +
                " evn_event varchar2(50),mmyy varchar2(4),tennhomkho nvarchar2(150),tenkhoaphong nvarchar2(250),tentutruc nvarchar2(250),tenphieu nvarchar2(150)," +
                " tennhomphieu varchar2(250),idphieuduyet number(30),idnhomkho number(2,0),ngayduyet date default sysdate not null, idkhoaphong number(3) default 0 not null," +
                " idtutruc number(3) default 0 not null,idphieu number(3) default 0 not null,idnhomphieu number(2) default 0 not null)" +
                " partition by range (evn_ngay)" +
                " INTERVAL (NUMTOYMINTERVAL(1,'MONTH'))" +
                " STORE IN (" + TABLESPACETRACKING + ")" +
                " (partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            s_Table = DanhMucTable.m_duyetchiphi.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay date default sysdate not null," +
               " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null," +
               " evn_event varchar2(50),mabn varchar2(14) not null, hotenbenhnhan varchar2(200), diachi varchar2(254),gioitinh varchar2(20)," +
               " namsinh number(4) default 0 not null,tenkhoaphong varchar2(150),tenkho varchar2(150),mavp varchar2(20),tengiavienphi varchar2(254),idduyetchiphi number(30) default 0,mmyy varchar2(4) not null" +
               ",ngayduyet date default sysdate not null,maql number(30) DEFAULT 0 not null,idquyenso number(5) default 0 not null, sobienlai number(10) default 0 not null" +
               ",idkhoaphong number(3) default 0 not null,tongtienthuoc number(24,8) default 0 not null, tongtiencls number(24,8) default 0 not null, bntra number(24,8) default 0 not null" +
               ",bhyttra number(24,8) default 0 not null,trangthai number(1) default 0 not null, idtonghop number(30) DEFAULT 0 not null,idkythuatcao number(30) DEFAULT 0 not null," +
               " idttrv number(30) DEFAULT 0 not null,COMPUTER varchar2(50),USERNAME varchar2(20),sttthuoc number(3) DEFAULT 0,soluongthuoc number(12,4) DEFAULT 0 not null, " +
               " dongiathuoc number(12,4) default 0 not null,idtheodoi number(30) DEFAULT 0 not null,idkho number(3) default 0 not null,idtoathuoc number(30) DEFAULT 0 not null,sttcls number(3) DEFAULT 0," +
               " soluongcls number(12,4) DEFAULT 0 not null,dongiacls number(12,4) default 0 not null,idgiavienphi number(7) DEFAULT 0 not null,idchidinh number(30) DEFAULT 0 not null," +
               " idbietduoc number(7) default 0 not null,mabietduoc varchar2(15),tenbietduoc varchar2(254),idnhomphieu number(2) DEFAULT 0 not null,tennhomphieu varchar2(254))" +
               " partition by range (evn_ngay)" +
                " INTERVAL (NUMTOYMINTERVAL(1,'MONTH'))" +
                " STORE IN (" + TABLESPACETRACKING + ")" +
                " (partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            //Thuy 16/12/14
            s_Table = DanhMucTable.p_xuatkhoa.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql +="create table " + sSchemaTracking + ".evn_p_xuatkhoa(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null, "+
            " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),"+
            " evn_stt number(5) default 0 not null, evn_event varchar2(50),idxuatkhoa numeric(30,0) default 0 not null,ngay date,"+
            " idketqua numeric(1,0),idtinhtrangrakhoa numeric(2,0),chandoan nvarchar2(1000),maicd character varying(9),mabs character varying(4), bienchung numeric(1,0), "+
            " taibien numeric(1,0), idkhoaphongchuyendi number(3,0) default 0,giaiphau numeric(1,0), mmyy varchar2(4) not null, computer varchar2(50),"+
            " username varchar2(20))"+
            " partition by range (evn_ngay) INTERVAL (NUMTOYMINTERVAL(1,'MONTH')) STORE IN (" + TABLESPACETRACKING + ") "+
            " (partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add tenketqua character varying(100);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add tentinhtrangrakhoa character varying(100);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add tenbacsi character varying(100);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add tenkhoaphongchuyendi character varying(200);\n";
            s_Table = DanhMucTable.b_vienphi.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay date default sysdate not null," +
                " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac nvarchar2(150),evn_stt number(5) default 0 not null," +
                " evn_event varchar2(50), tenkhoaphongthanhtoan nvarchar2(150), tenquyenso nvarchar2(150),idvienphi number(30)  DEFAULT 0 not null," +
                " mabn varchar2(14),hotenbenhnhan varchar2(254), gioitinh varchar2(20), namsinh number(4), diachi varchar2(254)," +
                " maql number(30) DEFAULT 0 not null,  idkhoa number(30) DEFAULT 0 not null, idkhoaphongthanhtoan number(3) DEFAULT 0 not null, giuong varchar2(20)," +
                " ngayvao date not null, ngayra date not null, chandoan nvarchar2(254),maicd varchar2(50), diemthu number(2) default 0 not null," +
                " loai number(2) default 0, idquyenso number(5) DEFAULT 0 not null, sobienlai number(10) default 0 not null," +
                " ngaythanhtoan date default sysdate, sotientong number(15,4) DEFAULT 0 not null, sotientamung number(15,4) DEFAULT 0 not null," +
                " sotienmien number(15,4) DEFAULT 0 not null,sotienbhyttra number(15,4) DEFAULT 0 not null, lanin number(2) DEFAULT 0 not null," +
                " chenhlech number(15,4) DEFAULT 0 not null,idquyensodv number(15,4) default 0 not null," +
                " sobienlaidv number(15,4) default 0 not null,username varchar2(20), usernamenl varchar2(20), miencs number(15,4) DEFAULT 0 not null," +
                " miendv number(15,4) DEFAULT 0 not null,miencs_ngaytt date,sophieu number(10) default 0 not null,mmyy varchar2(4)," +
                " mabs varchar2(4),tylemien number(10,5) default 0 not null)" +
                " partition by range (evn_ngay)" +
                " INTERVAL (NUMTOYMINTERVAL(1,'MONTH'))" +
                " STORE IN (" + TABLESPACETRACKING + ")" +
                " (partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            //Thuy 20/12/14
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add tenkhoaphong nvarchar2(150);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add tendoituong nvarchar2(150);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add tenbacsi nvarchar2(150);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add tenvienphi  nvarchar2(500);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add stt number(5) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add ngay date default sysdate;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add idkhoaphong number(3) DEFAULT 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add madoituong number(2) DEFAULT 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add idgiavienphi number(7) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add soluong number(15,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add dongia number(15,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add vat number(7,2) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add sotien number(15,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add sothe varchar2(20);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add giamua number(15,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add tra number(15,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add ngaytra date default sysdate;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add bhytduyet number(1) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add bhyttra number(15,4);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add idtonghop number(30) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add idkhoaphongthuchien number(3) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add gia_bh number(15,4) default 0 not null;\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_Evn + " add mien number(15,4) DEFAULT 0 not null;\n";
            //Thuy 22/12/14
            s_Table = DanhMucTable.p_xuatvien.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay timestamp default sysdate not null, evn_mmyy varchar2(4) "+
            "default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null, evn_event varchar2(50),"+
            "maql numeric(30,0) default 0 not null,idkhoaphong numeric(3,0) default 0,ngay date,idketqua numeric(1,0),idtinhtrangrakhoa numeric(2,0),"+
            "benhchinh nvarchar2(1000),maicd character varying(9),mabs character varying(4), soluutru character varying(50),traba numeric(1,0) default 0 not null,idkhoaphongnhapvien number(3,0) default 0,"+
            "username varchar2(20),ngayud timestamp default sysdate not null,computer character varying(50),mabenhvienchuyendi character varying(10),lamsang character varying(500),xetnghiem character varying(500)"+
            ",chandoan character varying(500), thuoc character varying(500), tinhtrangchuyenvien character varying(500),vanchuyen character varying(500),nguoidua character varying(500),"+
            "lydochuyenvien character varying(500),idbenhtiensu numeric(30,0) default 0 not null,mmyy character varying(4),idtanghoso numeric(3,0) default 0 not null,"+
            "ghichuhoso character varying(200),chuyenvientheoyeucau numeric(1,0) default 0 not null,tenbacsi character varying(100),tenketqua character varying(100),tentinhtrangrakhoa character varying(100)," +
            "tenbenhvienchuyendi character varying(500))partition by range (evn_ngay) INTERVAL (NUMTOYMINTERVAL(1,'MONTH')) STORE IN (" + TABLESPACETRACKING + ")"+
            "(partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            //Thuy 23/12/14
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay date default sysdate not null, evn_mmyy varchar2(4) "+
                "default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null, evn_event varchar2(50), "+
                "idnhapkhoa numeric(30,0) default 0 not null,maql numeric(30,0) default 0 not null,idkhoaphong numeric(3,0) default 0, tenkhoaphong character varying(100), "+
                "idbenhan numeric(3,0) default 0,tenbenhan character varying(100),ngay date,tuoivao character varying(4),giuong character varying(60), "+
                "tengiuong character varying(100),idkhoachuyen numeric(3,0),tenkhoachuyen character varying(100),chandoan character varying(500),maicd character varying(9), "+
                "mabs character varying(4), tenbacsy character varying(100),lan numeric(3,0) default 0,ngayud timestamp default sysdate not null,machuyenden numeric(30,0), "+
                "computer varchar2(50),username varchar2(20), mmyy varchar2(4) not null) "+
                "partition by range (evn_ngay) INTERVAL (NUMTOYMINTERVAL(1,'MONTH')) STORE IN (" + TABLESPACETRACKING + ") "+
                "(partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            //ThanhCuong - 24/09/2015
            s_Table = DanhMucTable.m_phatthuoc.ToString();
            s_Table_Evn = s_Pre + s_Table;
            s_Sql += "create table " + sSchemaTracking + "." + s_Table_Evn + "(evn_id number(30), evn_username varchar2(20),evn_ngay date default sysdate not null," +
               " evn_mmyy varchar2(4)  default to_char(sysdate,'mmyy') not null,evn_computer varchar2(50), evn_nguoithaotac varchar2(150),evn_stt number(5) default 0 not null," +
               " evn_event varchar2(50),idduyetchiphi number(30) default 0,idkho number(3) default 0 not null,tenkho nvarchar2(254)" +
               ",ngayphat date default sysdate not null,mmyy varchar2(4) not null,COMPUTER varchar2(50),USERNAME varchar2(20))"+
                "partition by range (evn_ngay) INTERVAL (NUMTOYMINTERVAL(1,'MONTH')) STORE IN (" + TABLESPACETRACKING + ") "+
                "(partition " + s_Table_Evn + "_" + DateTime.Today.ToString("MMyy") + " values less than (to_date('" + DateTime.Today.ToString("dd/MM/yyyy") + "','DD/MM/YYYY')));\n";
            s_Sql += "\nexit;\n";
            string s_Path = "tao.sql";
            if (File.Exists(s_Path))
            {
                File.Delete(s_Path);
            }
            FileStream stream = new FileStream(s_Path, FileMode.CreateNew, FileAccess.Write);
            StreamWriter writer = new StreamWriter(stream);
            writer.Write(s_Sql);
            writer.Close();
            stream.Dispose();
            writer.Dispose();
            string s_FileName = "sqlplus.exe";
            string s_Argument = sSchema + "/" + sPassword + "@" + sHost + " @" + System.Environment.CurrentDirectory + "\\" + s_Path;
            new Run(s_FileName, s_Argument, true).Launch();
            if (File.Exists(s_Path))
            {
                File.Delete(s_Path);
            }
#endif
        }

        void CreatePartitionTracking(MDBConnection mdbCon, string s_MMYY)
        {
#if POSTGRESQL
            if (s_MMYY == "") { return; }
            string s_Table_P = "";
            string s_Table = "";
            string s_Sql = "";
            string s_Pre = "evn_";
            #region b_tamung
            s_Table = s_Pre + DanhMucTable.b_tamung.ToString();
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_id on " + sSchemaTracking + "." + s_Table_P + "(evn_id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_eve_ngay on " + sSchemaTracking + "." + s_Table_P + "(evn_ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_username on " + sSchemaTracking + "." + s_Table_P + "(evn_username);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_id on " + sSchemaTracking + "." + s_Table_P + "(id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchemaTracking + "." + s_Table_P + "(ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchemaTracking + "." + s_Table_P + "(idkhoaphong);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchemaTracking + "." + s_Table_P + "(maql);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idquyenso on " + sSchemaTracking + "." + s_Table_P + "(idquyenso);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchemaTracking + "." + s_Table_P + "(madoituong);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            MDBCommand cmd = null;
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { cmd.Dispose(); }
            #endregion
            #region b_vienphi
            s_Table = s_Pre + DanhMucTable.b_vienphi.ToString();
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_id on " + sSchemaTracking + "." + s_Table_P + "(evn_id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_eve_ngay on " + sSchemaTracking + "." + s_Table_P + "(evn_ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_username on " + sSchemaTracking + "." + s_Table_P + "(evn_username);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_mmyy on " + sSchemaTracking + "." + s_Table_P + "(mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idvienphi on " + sSchemaTracking + "." + s_Table_P + "(idvienphi);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchemaTracking + "." + s_Table_P + "(ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchemaTracking + "." + s_Table_P + "(idkhoaphong);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchemaTracking + "." + s_Table_P + "(maql);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id,evn_stt);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { cmd.Dispose(); }
            #endregion
            #region b_hoantra
            s_Table = s_Pre + DanhMucTable.b_hoantra.ToString();
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_id on " + sSchemaTracking + "." + s_Table_P + "(evn_id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_eve_ngay on " + sSchemaTracking + "." + s_Table_P + "(evn_ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_username on " + sSchemaTracking + "." + s_Table_P + "(evn_username);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_mmyy on " + sSchemaTracking + "." + s_Table_P + "(mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_id on " + sSchemaTracking + "." + s_Table_P + "(id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchemaTracking + "." + s_Table_P + "(ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchemaTracking + "." + s_Table_P + "(idkhoaphong);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchemaTracking + "." + s_Table_P + "(maql);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idquyenso on " + sSchemaTracking + "." + s_Table_P + "(idquyenso);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { cmd.Dispose(); }
            #endregion
            #region p_benhandt
            s_Table = s_Pre + DanhMucTable.p_benhandt.ToString();
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "create index ind_" + s_Table_P + "_maql on " + sSchemaTracking + "." + s_Table_P + "(maql);\n";
            s_Sql += "create index ind_" + s_Table_P + "_mavv on " + sSchemaTracking + "." + s_Table_P + "(mavaovien);\n";
            s_Sql += "create index ind_" + s_Table_P + "_mabn on " + sSchemaTracking + "." + s_Table_P + "(mabn);\n";
            s_Sql += "create index ind_" + s_Table_P + "_ngay on " + sSchemaTracking + "." + s_Table_P + "(ngay);\n";
            s_Sql += "create index ind_" + s_Table_P + "_idkhoaphong on " + sSchemaTracking + "." + s_Table_P + "(idkhoaphong);\n";
            s_Sql += "create index ind_" + s_Table_P + "_mmyy on " + sSchemaTracking + "." + s_Table_P + "(mmyy);\n";
            s_Sql += "alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
               " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            #endregion
            #region b_chidinh
            s_Table = s_Pre + DanhMucTable.b_chidinh.ToString();
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_id on " + sSchemaTracking + "." + s_Table_P + "(id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchemaTracking + "." + s_Table_P + "(ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchemaTracking + "." + s_Table_P + "(idkhoaphong);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchemaTracking + "." + s_Table_P + "(maql);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchemaTracking + "." + s_Table_P + "(madoituong);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { cmd.Dispose(); }
            #endregion
            #region m_nhap
            s_Table = s_Pre + "m_nhap";
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_id on " + sSchemaTracking + "." + s_Table_P + "(evn_id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_eve_ngay on " + sSchemaTracking + "." + s_Table_P + "(evn_ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_username on " + sSchemaTracking + "." + s_Table_P + "(evn_username);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_mmyy on " + sSchemaTracking + "." + s_Table_P + "(mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idnhap on " + sSchemaTracking + "." + s_Table_P + "(idnhap);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_ngaynhap on " + sSchemaTracking + "." + s_Table_P + "(ngaynhap);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchemaTracking + "." + s_Table_P + "(sophieu);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_ngayhoadon on " + sSchemaTracking + "." + s_Table_P + "(ngayhoadon);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_sohoadon on " + sSchemaTracking + "." + s_Table_P + "(sohoadon);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id,evn_stt);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { cmd.Dispose(); }
            #endregion
            #region m_thau
            s_Table = s_Pre + "m_thau";
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_id on " + sSchemaTracking + "." + s_Table_P + "(evn_id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_eve_ngay on " + sSchemaTracking + "." + s_Table_P + "(evn_ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_username on " + sSchemaTracking + "." + s_Table_P + "(evn_username);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_mmyy on " + sSchemaTracking + "." + s_Table_P + "(mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idthau on " + sSchemaTracking + "." + s_Table_P + "(idthau);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_dotthau on " + sSchemaTracking + "." + s_Table_P + "(dotthau);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_nam on " + sSchemaTracking + "." + s_Table_P + "(nam);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id,evn_stt);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { cmd.Dispose(); }
            #endregion
            #region m_thuhoi
            s_Table = s_Pre + "m_thuhoi";
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_id on " + sSchemaTracking + "." + s_Table_P + "(evn_id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_eve_ngay on " + sSchemaTracking + "." + s_Table_P + "(evn_ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_username on " + sSchemaTracking + "." + s_Table_P + "(evn_username);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_mmyy on " + sSchemaTracking + "." + s_Table_P + "(mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idphieuduyet on " + sSchemaTracking + "." + s_Table_P + "(idphieuduyet);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_ngayduyet on " + sSchemaTracking + "." + s_Table_P + "(ngayduyet);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id,evn_stt);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { cmd.Dispose(); }
            #endregion
            #region m_duyetchiphi
            s_Table = s_Pre + DanhMucTable.m_duyetchiphi.ToString();
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_id on " + sSchemaTracking + "." + s_Table_P + "(evn_id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_eve_ngay on " + sSchemaTracking + "." + s_Table_P + "(evn_ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_username on " + sSchemaTracking + "." + s_Table_P + "(evn_username);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_mmyy on " + sSchemaTracking + "." + s_Table_P + "(mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idduyetchiphi on " + sSchemaTracking + "." + s_Table_P + "(idduyetchiphi);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_ngayduyet on " + sSchemaTracking + "." + s_Table_P + "(ngayduyet);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchemaTracking + "." + s_Table_P + "(maql);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idtonghop on " + sSchemaTracking + "." + s_Table_P + "(idtonghop);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id,evn_stt);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { cmd.Dispose(); }
            #endregion
            //Thuy 16/12/14
            #region p_xuatkhoa
            s_Table = s_Pre + "p_xuatkhoa";
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_id on " + sSchemaTracking + "." + s_Table_P + "(evn_id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_eve_ngay on " + sSchemaTracking + "." + s_Table_P + "(evn_ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_username on " + sSchemaTracking + "." + s_Table_P + "(evn_username);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_mmyy on " + sSchemaTracking + "." + s_Table_P + "(mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idxuatkhoa on " + sSchemaTracking + "." + s_Table_P + "(idxuatkhoa);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id,evn_stt);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            //Thuy 22/12/14
            #endregion
            #region p_xuatvien
            s_Table = s_Pre + "p_xuatvien";
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_id on " + sSchemaTracking + "." + s_Table_P + "(evn_id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_eve_ngay on " + sSchemaTracking + "." + s_Table_P + "(evn_ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_username on " + sSchemaTracking + "." + s_Table_P + "(evn_username);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_mmyy on " + sSchemaTracking + "." + s_Table_P + "(mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchemaTracking + "." + s_Table_P + "(maql);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id,evn_stt);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { cmd.Dispose(); }
            #endregion
            //Thuy 23/12/14
            #region p_nhapkhoa
            s_Table = s_Pre + "p_nhapkhoa";
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_id on " + sSchemaTracking + "." + s_Table_P + "(evn_id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_eve_ngay on " + sSchemaTracking + "." + s_Table_P + "(evn_ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_username on " + sSchemaTracking + "." + s_Table_P + "(evn_username);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_mmyy on " + sSchemaTracking + "." + s_Table_P + "(mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idnhapkhoa on " + sSchemaTracking + "." + s_Table_P + "(idnhapkhoa);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id,evn_stt);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            #endregion
            #region m_phatthuoc
            s_Table = s_Pre + DanhMucTable.m_phatthuoc.ToString();
            s_Table_P = s_Table + "_" + s_MMYY;
            s_Sql = "Begin \n";
            s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchemaTracking + "') then \n";
            s_Sql += "      CREATE TABLE " + sSchemaTracking + "." + s_Table_P + " (CHECK (evn_mmyy='" + s_MMYY + "' )) INHERITS (" + sSchemaTracking + "." + s_Table + ");\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_mmyy on " + sSchemaTracking + "." + s_Table_P + "(evn_mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_id on " + sSchemaTracking + "." + s_Table_P + "(evn_id);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_eve_ngay on " + sSchemaTracking + "." + s_Table_P + "(evn_ngay);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_evn_username on " + sSchemaTracking + "." + s_Table_P + "(evn_username);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_mmyy on " + sSchemaTracking + "." + s_Table_P + "(mmyy);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idduyetchiphi on " + sSchemaTracking + "." + s_Table_P + "(idduyetchiphi);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_ngayphat on " + sSchemaTracking + "." + s_Table_P + "(ngayphat);\n";
            s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchemaTracking + "." + s_Table_P + "(idkho);\n";
            s_Sql += "      alter table " + sSchemaTracking + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(evn_id,evn_stt);\n";
            s_Sql += "  end if;\n";
            s_Sql += "end";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { }
            s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchemaTracking + "." + s_Table + " where evn_mmyy='" + s_MMYY + "'" +
                " do instead INSERT INTO " + sSchemaTracking + "." + s_Table_P + " VALUES (NEW.*);\n";
            cmd.Dispose();
            try
            {
                cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
            catch { cmd.Dispose(); }
            #endregion
#endif
        }

        /// <summary>
        /// Tao partiotion cho các table có field MMYY
        /// </summary>
        /// <param name="mdbCon"></param>
        /// <param name="s_MMYY"></param>
        void CreatePartition(MDBConnection mdbCon, string s_MMYY)
        {
            if (s_MMYY == "") { return; }
            string s_Table_P = "";
            string s_Table = "";
            string s_Sql = "";
            try
            {
#if POSTGRESQL
                #region p_benhandt
                s_Table = DanhMucTable.p_benhandt.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table + "_" + s_MMYY + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "create index ind_" + s_Table_P + "_mavv on " + sSchema + "." + s_Table_P + "(mavaovien);\n";
                s_Sql += "create index ind_" + s_Table_P + "_mabn on " + sSchema + "." + s_Table_P + "(mabn);\n";
                s_Sql += "create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(maql);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY (username) REFERENCES " + sSchema + ".p_dmuser(username) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmdt FOREIGN KEY (madoituong) REFERENCES " + sSchema + ".p_dmdoituong(madoituong) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmbn FOREIGN KEY (mabn) REFERENCES " + sSchema + ".p_dmbenhnhan(mabn) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmnv FOREIGN KEY (mabs) REFERENCES " + sSchema + ".p_dmnhanvien(manhanvien) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                MDBCommand cmd = null;
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                   " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                #endregion
                #region lienhe
                s_Table = DanhMucTable.p_lienhe.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_mavaovien on " + sSchema + "." + s_Table_P + "(mavaovien);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mavaovien);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY (username) REFERENCES " + sSchema + ".p_dmuser(username) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmtt FOREIGN KEY (matinhthanh) REFERENCES " + sSchema + ".p_dmtinhthanh(matinhthanh) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmqh FOREIGN KEY (maquanhuyen) REFERENCES " + sSchema + ".p_dmquanhuyen(maquanhuyen) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmpx FOREIGN KEY (maphuongxa) REFERENCES " + sSchema + ".p_dmphuongxa(maphuongxa) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmnuoc FOREIGN KEY (idnuoc) REFERENCES " + sSchema + ".m_dmnuoc(idnuoc) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnvgt foreign key(mabsgioithieu) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bhyt
                s_Table = DanhMucTable.p_bhyt.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "create index ind_" + s_Table_P + "_id on " + sSchema + "." + s_Table_P + "(id);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(id);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint uk_" + s_Table_P + " unique (maql,sothe);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region nhapkhoa
                s_Table = DanhMucTable.p_nhapkhoa.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(id);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY (username) REFERENCES " + sSchema + ".p_dmuser(username) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkc FOREIGN KEY (idkhoachuyen) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmnv FOREIGN KEY (mabs) REFERENCES " + sSchema + ".p_dmnhanvien(manhanvien) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmicd foreign key(maicd) references " + sSchema + ".p_dmicd(maicd) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region xuatkhoa
                s_Table = DanhMucTable.p_xuatkhoa.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_id on " + sSchema + "." + s_Table_P + "(id);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(id);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkqdt FOREIGN KEY (idketqua) REFERENCES " + sSchema + ".p_dmketquadieutri(idketqua) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmttrk FOREIGN KEY (idtinhtrangrakhoa) REFERENCES " + sSchema + ".p_dmtinhtrangrakhoa(idtinhtrangrakhoa) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkpbv FOREIGN KEY (idkhoaphongchuyendi) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmnv FOREIGN KEY (mabs) REFERENCES " + sSchema + ".p_dmnhanvien(manhanvien) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY (username) REFERENCES " + sSchema + ".p_dmuser(username) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                //s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmicd foreign key (maicd) references " + sSchema + ".p_dmicd(maicd) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region xuatvien
                s_Table = DanhMucTable.p_xuatvien.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(maql);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY (username) REFERENCES " + sSchema + ".p_dmuser(username) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmnv FOREIGN KEY (mabs) REFERENCES " + sSchema + ".p_dmnhanvien(manhanvien) MATCH SIMPLE ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmicd foreign key(maicd) references " + sSchema + ".p_dmicd(maicd) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                //s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_tttrk foreign key(idtinhtrangrakhoa) references " + sSchema + ".p_dmtinhtrangrakhoa(idtinhtrangrakhoa) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                //s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkpnv foreign key(idkhoaphongnhapvien) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region dausinton
                s_Table = DanhMucTable.p_dausinhton.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_id on " + sSchema + "." + s_Table_P + "(id);\n";
                s_Sql += "create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(id);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region benhkemtheo
                s_Table = DanhMucTable.p_benhkemtheo.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_id on " + sSchema + "." + s_Table_P + "(id);\n";
                s_Sql += "create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(id);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmicd FOREIGN KEY (maicd) REFERENCES " + sSchema + ".p_dmicd(maicd) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region benhmantinh
                s_Table = DanhMucTable.p_benhmantinh.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_mabn on " + sSchema + "." + s_Table_P + "(mabn);\n";
                s_Sql += "create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mabn,maicd);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmbn FOREIGN KEY(mabn) REFERENCES " + sSchema + ".p_dmbenhnhan(mabn) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region benhtiensu
                s_Table = DanhMucTable.p_benhtiensu.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_id on " + sSchema + "." + s_Table_P + "(id);\n";
                s_Sql += "create index ind_" + s_Table_P + "_mabn on " + sSchema + "." + s_Table_P + "(mabn);\n";
                s_Sql += "create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(id);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmbn FOREIGN KEY(mabn) REFERENCES " + sSchema + ".P_dmbenhnhan(mabn) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region giaychuyenvien
                s_Table = DanhMucTable.p_giaychuyenvien.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(maql);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + "  add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region giayravien
                s_Table = DanhMucTable.p_giayravien.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(maql);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv1 foreign key (manvkyravien) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnm foreign key (manhommau) references " + sSchema + ".p_dmnhommau(manhommau) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv2 foreign key (mabacsitaikham) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnvn3 foreign key (manvkyrakhoa) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region lichhen
                s_Table = DanhMucTable.p_lichhen.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_idlichhen on " + sSchema + "." + s_Table_P + "(idlichhen);\n";
                s_Sql += "create index ind_" + s_Table_P + "_macuochen on " + sSchema + "." + s_Table_P + "(macuochen);\n";
                s_Sql += "create index ind_" + s_Table_P + "_mabenhnhan on " + sSchema + "." + s_Table_P + "(mabn);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idlichhen);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                s_Sql = "";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand("alter table " + sSchema + "." + s_Table_P + " drop constraint un_" + s_Table_P, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                try
                {
                    cmd = new MDBCommand("alter table " + sSchema + "." + s_Table_P + " add constraint un_p" + s_Table_P + " unique(ngay,ngaykham,mabs,giobatdau)", mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region lichlamviecbacsi
                s_Table = DanhMucTable.p_lichlamviecbacsi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "create index ind_" + s_Table_P + "_idlichlamviec on " + sSchema + "." + s_Table_P + "(idlichlamviec);\n";
                s_Sql += "create index ind_" + s_Table_P + "_mabs on " + sSchema + "." + s_Table_P + "(mabs);\n";
                s_Sql += "create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idlichlamviec);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint un_" + s_Table_P + " unique(ngay,mabs,giobatdau);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region tainanthuongtich
                s_Table = DanhMucTable.p_tainanthuongtich.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(maql);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_p_tntt_" + s_MMYY + "_dmdd foreign key(iddiadiem) references " + sSchema + ".p_dmdiadiem(iddiadiem) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_p_tntt_" + s_MMYY + "_dmbp foreign key(idbophan) references " + sSchema + ".p_dmbophan(idbophan) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_p_tntt_" + s_MMYY + "_dmnntn foreign key(idnguyennhan) references " + sSchema + ".p_dmnguyennhantainan(idnguyennhan) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_p_tntt_" + s_MMYY + "_dmnd foreign key(idngodoc) references " + sSchema + ".p_dmngodoc(idngodoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_p_tntt_" + s_MMYY + "_dmdb foreign key(iddienbien) references " + sSchema + ".p_dmdienbien(iddienbien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_p_tntt_" + s_MMYY + "_dmxttn foreign key(idxutritainan) references " + sSchema + ".p_dmxutritainan(idxutritainan) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region pttt
                s_Table = DanhMucTable.p_pttt.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idpttt on " + sSchema + "." + s_Table_P + "(idpttt);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idpttt);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_kpbv foreign key (idkhoaphong) references " + sSchema + ".P_DMKHOAPHONGBENHVIEN(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmgmgt foreign key (idgaymegayte) references  " + sSchema + ".P_DMGAYMEGAYTE(idgaymegayte) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table + " add constraint fk_" + s_Table_P + "_dmthpt foreign key (idtinhhinhpt) references " + sSchema + ".P_DMTINHHINHPT(idtinhhinhpt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmtbpt foreign key (idtaibienpt) references " + sSchema + ".P_DMTAIBIENPT(idtaibienpt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmtvpt foreign key (idtuvongpt) references " + sSchema + ".P_DMTUVONGPT(idtuvongpt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmpm foreign key (idphongmo) references " + sSchema + ".p_dmphongmo(idphongmo) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmgiavp foreign key (idgiavienphi) references " + sSchema + ".B_DMGIAVIENPHI(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmloaipttt foreign key (idloaipttt) references " + sSchema + ".p_dmloaipttt(idloaipttt) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv1 foreign key (maphauthuatvien) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv2 foreign key (manvphu1) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv3 foreign key (manvphu2) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv4 foreign key (manvgayme1) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv5 foreign key (manvgayme2) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv6 foreign key (manvhoisuc) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv7 foreign key (manvdungcu) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";

                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region theodoigiuong
                s_Table = DanhMucTable.p_theodoigiuong.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoigiuong on " + sSchema + "." + s_Table_P + "(idtheodoigiuong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_tungay on " + sSchema + "." + s_Table_P + "(tungay);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtheodoigiuong);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmgiuong foreign key(idgiuong) references " + sSchema + ".p_dmgiuong(idgiuong);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region toathuocll
                s_Table = DanhMucTable.p_toathuocll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtoathuoc on " + sSchema + "." + s_Table_P + "(idtoathuoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtoathuoc);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_kpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnp foreign key(idnhomphieu) references " + sSchema + ".m_dmnhomphieu(idnhomphieu);\n";
                s_Sql += "alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region toathuocct
                s_Table = DanhMucTable.p_toathuocct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtoathuoc on " + sSchema + "." + s_Table_P + "(idtoathuoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtoathuoc,stt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose(); 
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtoathuoc,stt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                cmd.Dispose();
                try
                {
                    foreach (string s in s_Sql.Split(';'))
                    {
                        string s_Temp = s.Trim('\n');
                        cmd = new MDBCommand(s_Temp, mdbCon);
                        cmd.CommandType = CommandType.Text;
                        cmd.ExecuteNonQuery();
                    }
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region xutridieutri
                s_Table = DanhMucTable.p_xutridieutri.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maxutri on " + sSchema + "." + s_Table_P + "(maxutri);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(maql,maxutri);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmxutri foreign key(maxutri) references " + sSchema + ".p_dmxutri(maxutri) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region r_ketquall
                s_Table = DanhMucTable.r_ketquall.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idketqua on " + sSchema + "." + s_Table_P + "(idketqua);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idketqua);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region r_ketquact
                s_Table = DanhMucTable.r_ketquact.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idketqua on " + sSchema + "." + s_Table_P + "(idketqua);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_makt on " + sSchema + "." + s_Table_P + "(makt);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_makp on " + sSchema + "." + s_Table_P + "(makp);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idketqua,makt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkpbv foreign key(makp) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmmay foreign key(idmay) references " + sSchema + ".r_dmmay(idmay) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region dutrumua
                s_Table = DanhMucTable.m_dutrumuall.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_iddutrumua on " + sSchema + "." + s_Table_P + "(iddutrumua);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(iddutrumua);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region dutrumuact
                s_Table = DanhMucTable.m_dutrumuact.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_iddutrumua on " + sSchema + "." + s_Table_P + "(iddutrumua);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(iddutrumua,idbietduoc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region duyetchiphi
                s_Table = DanhMucTable.m_duyetchiphi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idduyetchiphi on " + sSchema + "." + s_Table_P + "(idduyetchiphi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idttrv on " + sSchema + "." + s_Table_P + "(idttrv);\n";//Tú:16/09/2015
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idduyetchiphi);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnp foreign key(idnhomphieu) references " + sSchema + ".m_dmnhomphieu(idnhomphieu) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region duyetchiphicls
                s_Table = DanhMucTable.m_duyetchiphicls.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idduyetchiphi on " + sSchema + "." + s_Table_P + "(idduyetchiphi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idgiavienphi on " + sSchema + "." + s_Table_P + "(idgiavienphi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idchidinh on " + sSchema + "." + s_Table_P + "(idchidinh);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idduyetchiphi,stt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmgiavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region duyetchiphithuoc
                s_Table = DanhMucTable.m_duyetchiphithuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idduyetchiphi on " + sSchema + "." + s_Table_P + "(idduyetchiphi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtoathuoc on " + sSchema + "." + s_Table_P + "(idtoathuoc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idduyetchiphi,stt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region duyetdutrumua
                s_Table = DanhMucTable.m_duyetdutrumuall.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idduyetdutrumua on " + sSchema + "." + s_Table_P + "(idduyetdutrumua);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idduyetdutrumua);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region duyetdutrumuact
                s_Table = DanhMucTable.m_duyetdutrumuact.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idduyetdutrumua on " + sSchema + "." + s_Table_P + "(idduyetdutrumua);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idduyetdutrumua,stt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_nhapll
                s_Table = DanhMucTable.m_nhapll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnhap on " + sSchema + "." + s_Table_P + "(idnhap);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngaynhap on " + sSchema + "." + s_Table_P + "(ngaynhap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idnhap);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmncc foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_kho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_nguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region nhapct
                s_Table = DanhMucTable.m_nhapct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnhap on " + sSchema + "." + s_Table_P + "(idnhap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idnhap,stt);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region phieuduyet
                s_Table = DanhMucTable.m_phieuduyet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idphieuduyet on " + sSchema + "." + s_Table_P + "(idphieuduyet);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtutruc on " + sSchema + "." + s_Table_P + "(idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idphieuduyet);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkp foreign key(idkhoaphong) references " + sSchema + ".m_dmkhoaphong (idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmphieu foreign key(idphieu) references " + sSchema + ".m_dmphieu (idphieu) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region sophieuduyet
                s_Table = DanhMucTable.m_sophieuduyet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idphieuduyet on " + sSchema + "." + s_Table_P + "(idphieuduyet);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnhom on " + sSchema + "." + s_Table_P + "(idnhom);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idphieuduyet,idnhom);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnhom foreign key(idnhom) references " + sSchema + ".m_dmnhombietduoc(idnhombietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region sophieumau38
                s_Table = DanhMucTable.m_sophieumau38.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_mabn on " + sSchema + "." + s_Table_P + "(mabn);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_mavaovien on " + sSchema + "." + s_Table_P + "(mavaovien);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_loaibenhan on " + sSchema + "." + s_Table_P + "(loaibenhan);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mavaovien,ngay,loaibenhan);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key (username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_theodoi //linh 29/8/14
                s_Table = DanhMucTable.m_theodoi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnuoc on " + sSchema + "." + s_Table_P + "(idnuoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idhang on " + sSchema + "." + s_Table_P + "(idhang);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnguon on " + sSchema + "." + s_Table_P + "(idnguon);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnhacc on " + sSchema + "." + s_Table_P + "(idnhacungcap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtheodoi);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmhang foreign key(idhang) references " + sSchema + ".m_dmhang(idhang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnuoc foreign key(idnuoc) references " + sSchema + ".m_dmnuoc(idnuoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnhacc foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_dongia check (dongia>=0);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_giaban check (giaban>=0);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_giagoc check (giagoc>=0);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_vat check (vat>=0);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtheodoi);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmhang foreign key(idhang) references " + sSchema + ".m_dmhang(idhang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnuoc foreign key(idnuoc) references " + sSchema + ".m_dmnuoc(idnuoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnhacc foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_dongia check (dongia>=0);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_giaban check (giaban>=0);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_giagoc check (giagoc>=0);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_vat check (vat>=0);\n"; 
                cmd.Dispose();
                try
                {
                    foreach (string s in s_Sql.Split(';'))
                    {
                        string s_Temp = s.Trim('\n');
                        cmd = new MDBCommand(s_Temp, mdbCon);
                        cmd.CommandType = CommandType.Text;
                        cmd.ExecuteNonQuery();
                    }
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_xuatnoiviends
                s_Table = DanhMucTable.m_xuatnoiviends.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxuatnoiviends on " + sSchema + "." + s_Table_P + "(idxuatnoiviends);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idphieuduyet on " + sSchema + "." + s_Table_P + "(idphieuduyet);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idylenhthuocds on " + sSchema + "." + s_Table_P + "(idylenhthuocds);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuatnoiviends);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_xuatnoivienct
                s_Table = DanhMucTable.m_xuatnoivienct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxuatnvds on " + sSchema + "." + s_Table_P + "(idxuatnoiviends);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuatnoiviends,stt);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_soluong check (soluong>0);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_thucxuattutruc
                s_Table = DanhMucTable.m_thucxuattutruc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idylenhthuocds on " + sSchema + "." + s_Table_P + "(idylenhthuocds);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idylenhthuocds,stt);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add  constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_sl check (soluong>0);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_tienthuoc
                s_Table = DanhMucTable.m_tienthuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxuatnoiviends on " + sSchema + "." + s_Table_P + "(idxuatnoiviends);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idttrv on " + sSchema + "." + s_Table_P + "(idttrv);\n";//Tú:16/09/2015
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuatnoiviends,stt);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuatnoiviends,stt);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                cmd.Dispose();
                try
                {
                    foreach (string s in s_Sql.Split(';'))
                    {
                        string s_Temp = s.Trim('\n');
                        cmd = new MDBCommand(s_Temp, mdbCon);
                        cmd.CommandType = CommandType.Text;
                        cmd.ExecuteNonQuery();
                    }
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_tondau
                s_Table = DanhMucTable.m_tondau.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtutruc on " + sSchema + "." + s_Table_P + "(idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,idtheodoi,idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_tonkhochitiet
                s_Table = DanhMucTable.m_tonkhochitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,idtheodoi);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_tonkhotonghop
                s_Table = DanhMucTable.m_tonkhotonghop.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnguon on " + sSchema + "." + s_Table_P + "(idnguon);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,idbietduoc,idnguon);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_tontutrucchitiet
                s_Table = DanhMucTable.m_tontutrucchitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtutruc on " + sSchema + "." + s_Table_P + "(idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,idtheodoi,idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_sln check (soluongnhap>=0);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slx check (soluongxuat>=0);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slkk check (soluongkiemke>=0);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_tontutructonghop
                s_Table = DanhMucTable.m_tontutructonghop.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtutruc on " + sSchema + "." + s_Table_P + "(idtutruc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnguon on " + sSchema + "." + s_Table_P + "(idnguon);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,idtutruc,idbietduoc,idnguon);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_sln check (soluongnhap>=0) ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slx check (soluongxuat>=0) ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slkk check (soluongkiemke>=0);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_xuat
                s_Table = DanhMucTable.m_xuatll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxuat on " + sSchema + "." + s_Table_P + "(idxuat);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_loai on " + sSchema + "." + s_Table_P + "(loai);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoxuat on " + sSchema + "." + s_Table_P + "(idkhoxuat);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhonhap on " + sSchema + "." + s_Table_P + "(idkhonhap);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtutruc on " + sSchema + "." + s_Table_P + "(idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuat);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_xuatct
                s_Table = DanhMucTable.m_xuatct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxuat on " + sSchema + "." + s_Table_P + "(idxuat);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuat,stt);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_ylenhthuoc
                s_Table = DanhMucTable.m_ylenhthuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idylenhthuoc on " + sSchema + "." + s_Table_P + "(idylenhthuoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtutruc on " + sSchema + "." + s_Table_P + "(idtutruc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idphieu on " + sSchema + "." + s_Table_P + "(idphieu);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idylenhthuoc);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkp foreign key(idkhoaphong) references " + sSchema + ".m_dmkhoaphong (idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmphieu foreign key(idphieu) references " + sSchema + ".m_dmphieu (idphieu) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_ylenhthuocds
                s_Table = DanhMucTable.m_ylenhthuocds.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idylenhthuoc on " + sSchema + "." + s_Table_P + "(idylenhthuoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idylenhthuocds on " + sSchema + "." + s_Table_P + "(idylenhthuocds);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idylenhthuocds);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_ylenhthuocct
                s_Table = DanhMucTable.m_ylenhthuocct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idylenhthuocds on " + sSchema + "." + s_Table_P + "(idylenhthuocds);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnguon on " + sSchema + "." + s_Table_P + "(idnguon);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idylenhthuocds,stt);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add  constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".m_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slyc check (soluongyeucau>0);\n";
                //s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slpslyc check (soluongphat<=soluongyeucau);\n";
                //s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slp check (soluongphat>=0);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_hoantra
                s_Table = DanhMucTable.b_hoantra.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_id on " + sSchema + "." + s_Table_P + "(id);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idquyenso on " + sSchema + "." + s_Table_P + "(idquyenso);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(id);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_quyenso FOREIGN KEY(idquyenso) REFERENCES " + sSchema + ".b_dmquyenso(idquyenso) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_tamung
                s_Table = DanhMucTable.b_tamung.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_id on " + sSchema + "." + s_Table_P + "(id);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idquyenso on " + sSchema + "." + s_Table_P + "(idquyenso);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idttrv on " + sSchema + "." + s_Table_P + "(idttrv);\n";//Tú:16/09/2015
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(id);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmqs FOREIGN KEY(idquyenso) REFERENCES " + sSchema + ".b_dmquyenso(idquyenso) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_tamungcd
                s_Table = DanhMucTable.b_tamungcd.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_id on " + sSchema + "." + s_Table_P + "(id);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(id);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmdt FOREIGN KEY(madoituong) REFERENCES " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_chidinh
                s_Table = DanhMucTable.b_chidinh.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_id on " + sSchema + "." + s_Table_P + "(id);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idttrv on " + sSchema + "." + s_Table_P + "(idttrv);\n";//Tú:16/09/2015
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(id);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkp foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_kpth foreign key(idkpnoithuchien) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_giavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv foreign key(mabs) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_thuocchuavuottran
                s_Table = DanhMucTable.b_thuocchuavuottran.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idvienphi on " + sSchema + "." + s_Table_P + "(idvienphi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idgiavp on " + sSchema + "." + s_Table_P + "(idgiavienphi);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idvienphi,stt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_thuoccvt" + s_MMYY + "_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_thuoccvt" + s_MMYY + "_dmdt foreign key (madoituong) references " + sSchema + ".P_DMDOITUONG(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_thuoccvt" + s_MMYY + "_dmbd foreign key(idgiavienphi) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_vienphichuavuottran
                s_Table = DanhMucTable.b_vienphichuavuottran.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idvienphi on " + sSchema + "." + s_Table_P + "(idvienphi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idvienphi,stt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_vienphicvt" + s_MMYY + "_dmkpsbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_vienphicvt" + s_MMYY + "_dmdt foreign key (madoituong) references " + sSchema + ".P_DMDOITUONG(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_vienphicvt" + s_MMYY + "_dmgiavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_vienphi
                s_Table = DanhMucTable.b_vienphi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idvienphi on " + sSchema + "." + s_Table_P + "(idvienphi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idvienphi);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmqs foreign key(idquyenso) references " + sSchema + ".B_DMQUYENSO(idquyenso) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmuser FOREIGN KEY(username) REFERENCES " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_vienphict
                s_Table = DanhMucTable.b_vienphict.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idvienphi on " + sSchema + "." + s_Table_P + "(idvienphi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idvienphi,stt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key (madoituong) references " + sSchema + ".P_DMDOITUONG(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                //s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmgvp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi(idgiavienphi) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                s_Sql = "alter table " + sSchema + "." + s_Table_P + " drop constraint fk_" + s_Table_P + "_dmgvp;\n";//ThanhCuong - 02/10/2015
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_vienphictthuoc
                s_Table = DanhMucTable.b_vienphictthuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idvienphi on " + sSchema + "." + s_Table_P + "(idvienphi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idvienphi,stt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add CONSTRAINT fk_" + s_Table_P + "_dmkpbv FOREIGN KEY (idkhoaphong) REFERENCES " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key (madoituong) references " + sSchema + ".P_DMDOITUONG(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idgiavienphi) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region l_ketqua
                s_Table = DanhMucTable.l_ketqua.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idketqua on " + sSchema + "." + s_Table_P + "(idketqua);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_loaibn on " + sSchema + "." + s_Table_P + "(loaibn);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idketqua  );\n";
                //s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbn foreign key(mabn) references " + sSchema + ".p_dmbenhnhan(mabn) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                //s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv foreign key(mabschidinh) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";//ThanhCuong - 02/04/2015
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                s_Sql = "alter table " + Schema + "." + s_Table_P + " drop constraint fk_" + s_Table_P + "_dmbn;\n";
                s_Sql = "alter table " + Schema + "." + s_Table_P + " drop constraint fk_" + s_Table_P + "_dmnv;\n";//ThanhCuong - 04/04/2015
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region l_ketquachitiet
                s_Table = DanhMucTable.l_ketquachitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idketqua on " + sSchema + "." + s_Table_P + "(idketqua);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxetnghiem on " + sSchema + "." + s_Table_P + "(idxetnghiem);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idvienphi on " + sSchema + "." + s_Table_P + "(idvienphi);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + "_new primary key(idketqua ,idxetnghiem,idvienphi,idchidinh);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_l_dmxn foreign key(idxetnghiem) references " + sSchema + ".l_dmxetnghiem(idxetnghiem) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnv foreign key(mabschidinh) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";//ThanhCuong - 02/04/2015
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region p_thanhvienekipmo
                s_Table = DanhMucTable.p_thanhvienekipmo.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idpttt on " + sSchema + "." + s_Table_P + "(idpttt);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idchucnang on " + sSchema + "." + s_Table_P + "(idchucnang);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_manhanvien on " + sSchema + "." + s_Table_P + "(manhanvien);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idpttt ,idchucnang,manhanvien);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_chucnang foreign key(idchucnang) references " + sSchema + ".p_dmchucnangekipmo(idchucnang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_nhanvien foreign key(manhanvien) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_chuyensolieu(Tú:08/07/2014)
                s_Table = DanhMucTable.b_chuyensolieu.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      create table " + sSchema + "." + s_Table_P + " (check (mmyy='" + s_MMYY + "' )) inherits (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idchuyensolieu on " + sSchema + "." + s_Table_P + "(idchuyensolieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idttrv on " + sSchema + "." + s_Table_P + "(idttrv);\n";//Tú:16/09/2015
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idchuyensolieu);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong) on update restrict on delete restrict;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) on update restrict on delete restrict;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "create or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead insert into " + sSchema + "." + s_Table_P + " values (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_dutrucapll //linh 10/7/14
                s_Table = DanhMucTable.m_dutrucapll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      create table " + sSchema + "." + s_Table_P + " (check (mmyy='" + s_MMYY + "' )) inherits (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_iddutrucap on " + sSchema + "." + s_Table_P + "(iddutrucap);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoxuat on " + sSchema + "." + s_Table_P + "(idkhoxuat);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhonhap on " + sSchema + "." + s_Table_P + "(idkhonhap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(iddutrucap);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_khoxuat foreign key(idkhoxuat) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_khonhap foreign key(idkhonhap) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "create or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead insert into " + sSchema + "." + s_Table_P + " values (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_dutrucapct
                s_Table = DanhMucTable.m_dutrucapct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      create table " + sSchema + "." + s_Table_P + " (check (mmyy='" + s_MMYY + "' )) inherits (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_iddutrucap on " + sSchema + "." + s_Table_P + "(iddutrucap);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(iddutrucap,idbietduoc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "create or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead insert into " + sSchema + "." + s_Table_P + " values (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_phatthuoc
                s_Table = DanhMucTable.m_phatthuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      create table " + sSchema + "." + s_Table_P + " (check (mmyy='" + s_MMYY + "' )) inherits (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idduyet on " + sSchema + "." + s_Table_P + "(idduyet);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idduyet,idkho);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_idkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "create or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead insert into " + sSchema + "." + s_Table_P + " values (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region denghi
                s_Table = DanhMucTable.m_denghi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_iddenghi on " + sSchema + "." + s_Table_P + "(iddenghi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngaydenghi on " + sSchema + "." + s_Table_P + "(ngaydenghi);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(iddenghi);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region m_denghichitiet
                s_Table = DanhMucTable.m_denghichitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_iddenghi on " + sSchema + "." + s_Table_P + "(iddenghi);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(iddenghi,idnhap);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region l_labketqua
                s_Table = DanhMucTable.l_labketqua.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtraketqua on " + sSchema + "." + s_Table_P + "(idtraketqua);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxetnghiem on " + sSchema + "." + s_Table_P + "(idxetnghiem);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idmay on " + sSchema + "." + s_Table_P + "(idmay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtraketqua,ngay,idxetnghiem);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmmay foreign key(idmay) references " + sSchema + ".r_dmmay(idmay) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmxetnghiem foreign key(idxetnghiem) references " + sSchema + ".l_dmxetnghiem(idxetnghiem) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Thuy 15/12/14
                #region m_thauds
                s_Table = DanhMucTable.m_thauds.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idthau on " + sSchema + "." + s_Table_P + "(idthau);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnhacungcap on " + sSchema + "." + s_Table_P + "(idnhacungcap);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngayquyetdinh on " + sSchema + "." + s_Table_P + "(ngayquyetdinh);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idthau);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmncc foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_nhomkho foreign key(idnhomkho) references " + sSchema + ".m_dmnhomkho(idnhomkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region thauct
                s_Table = DanhMucTable.m_thauct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idthau on " + sSchema + "." + s_Table_P + "(idthau);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idthau,stt);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //ThanhCuong - 23/12/2014
                #region phieuduyetkho
                s_Table = DanhMucTable.m_phieuduyetkho.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idphieuduyet on " + sSchema + "." + s_Table_P + "(idphieuduyet);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idphieuduyet,idkho);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho (idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Thuy 6/1/15
                #region p_hoichan
                s_Table = DanhMucTable.p_hoichan.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_id on " + sSchema + "." + s_Table_P + "(idhoichan);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idhoichan);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //linh 7/1/15
                #region m_theodoidulieu
                s_Table = DanhMucTable.m_theodoidulieu.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngaylamviec on " + sSchema + "." + s_Table_P + "(ngaylamviec);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtheodoidulieu);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Thuy 8/1/15
                #region p_hoichan_thanhvien
                s_Table = DanhMucTable.p_hoichan_thanhvien.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idhoichan on " + sSchema + "." + s_Table_P + "(idhoichan);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_manhanvien on " + sSchema + "." + s_Table_P + "(manhanvien);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idhoichan,manhanvien);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_nhanvien foreign key(manhanvien) references " + sSchema + ".p_dmnhanvien(manhanvien) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //ThanhCuong - 12/01/2015
                #region TrangThietBi
                #region e_theodoi
                s_Table = DanhMucTable.e_theodoi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idttb on " + sSchema + "." + s_Table_P + "(idttb);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnuoc on " + sSchema + "." + s_Table_P + "(idnuoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idhang on " + sSchema + "." + s_Table_P + "(idhang);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnguon on " + sSchema + "." + s_Table_P + "(idnguon);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnhacc on " + sSchema + "." + s_Table_P + "(idnhacungcap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtheodoi);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idttb) references " + sSchema + ".e_dmttb(idttb) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmhang foreign key(idhang) references " + sSchema + ".e_dmhang(idhang) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnuoc foreign key(idnuoc) references " + sSchema + ".m_dmnuoc(idnuoc) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnhacc foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_giamua check (giamua>=0);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_nguyengia check (nguyengia>=0);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_vat check (vat>=0);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region e_nhapll
                s_Table = DanhMucTable.e_nhapll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnhap on " + sSchema + "." + s_Table_P + "(idnhap);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngaynhap on " + sSchema + "." + s_Table_P + "(ngaynhap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idnhap);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmncc foreign key(idnhacungcap) references " + sSchema + ".m_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_kho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_nguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region e_nhapct
                s_Table = DanhMucTable.e_nhapct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnhap on " + sSchema + "." + s_Table_P + "(idnhap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idnhap,stt);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region e_tondau
                s_Table = DanhMucTable.e_tondau.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtutruc on " + sSchema + "." + s_Table_P + "(idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,idtheodoi,idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region e_tonkhochitiet
                s_Table = DanhMucTable.e_tonkhochitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,idtheodoi);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region e_tonkhotonghop
                s_Table = DanhMucTable.e_tonkhotonghop.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idttb on " + sSchema + "." + s_Table_P + "(idttb);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnguon on " + sSchema + "." + s_Table_P + "(idnguon);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,idttb,idnguon);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmttb foreign key(idttb) references " + sSchema + ".e_dmttb(idttb) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region e_tontutrucchitiet
                s_Table = DanhMucTable.e_tontutrucchitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtutruc on " + sSchema + "." + s_Table_P + "(idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,idtheodoi,idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_sln check (soluongnhap>=0);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slx check (soluongxuat>=0);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region e_tontutructonghop
                s_Table = DanhMucTable.e_tontutructonghop.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idttb on " + sSchema + "." + s_Table_P + "(idttb);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtutruc on " + sSchema + "." + s_Table_P + "(idtutruc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnguon on " + sSchema + "." + s_Table_P + "(idnguon);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,idtutruc,idttb,idnguon);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".e_dmkho(idkho)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".e_dmnguon(idnguon)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmttb foreign key(idttb) references " + sSchema + ".e_dmttb(idttb)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong (idkhoaphong)  ON UPDATE RESTRICT ON DELETE RESTRICT ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_sln check (soluongnhap>=0) ;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slx check (soluongxuat>=0) ;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region e_xuat
                s_Table = DanhMucTable.e_xuatll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxuat on " + sSchema + "." + s_Table_P + "(idxuat);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_loai on " + sSchema + "." + s_Table_P + "(loai);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoxuat on " + sSchema + "." + s_Table_P + "(idkhoxuat);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhonhap on " + sSchema + "." + s_Table_P + "(idkhonhap);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtutruc on " + sSchema + "." + s_Table_P + "(idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuat);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region e_xuatct
                s_Table = DanhMucTable.e_xuatct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxuat on " + sSchema + "." + s_Table_P + "(idxuat);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuat,stt);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #endregion TTB
                //
                //linh 7/1/15
                #region p_phatstttiepdon
                s_Table = DanhMucTable.p_phatstttiepdon.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_loaibn on " + sSchema + "." + s_Table_P + "(loaibn);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_stt on " + sSchema + "." + s_Table_P + "(stt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(ngay,loaibn,stt);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Tú:09/02/2015
                #region l_xetnghiemchuyenmau
                s_Table = DanhMucTable.l_xetnghiemchuyenmau.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(idketqua);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_loaibn on " + sSchema + "." + s_Table_P + "(idchidinh);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idketqua,idchidinh);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Thuy 28/3/15
                #region p_vudieutri
                s_Table = DanhMucTable.p_vudieutri.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idvudieutri);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region p_vudieutrichitiet
                s_Table = DanhMucTable.p_vudieutrichitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idvudieutri,key);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region p_phieusoket15
                s_Table = DanhMucTable.p_phieusoket15.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphongbenhvien);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idphieusoket);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //ThanhCuong - 03/04/2015
                #region m_denghitra
                s_Table = DanhMucTable.m_denghitra.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_iddenghitra on " + sSchema + "." + s_Table_P + "(iddenghitra);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoxuat on " + sSchema + "." + s_Table_P + "(idkhoxuat);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhonhap on " + sSchema + "." + s_Table_P + "(idkhonhap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(iddenghitra);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //ThanhCuong - 03/04/2015
                #region m_denghitract
                s_Table = DanhMucTable.m_denghitract.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_iddenghitra on " + sSchema + "." + s_Table_P + "(iddenghitra);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(iddenghitra,stt);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //ThanhCuong - 16/05/2015
                #region m_cosotutruc
                s_Table = DanhMucTable.m_cosotutruc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtutruc on " + sSchema + "." + s_Table_P + "(idtutruc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtutruc,idbietduoc,mmyy);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmtutruc foreign key(idtutruc) references " + sSchema + ".m_dmkhoaphong(idkhoaphong);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Tú:26/06/2015
                #region m_trukhotam
                s_Table = DanhMucTable.m_trukhotam.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idduyetchiphi on " + sSchema + "." + s_Table_P + "(idduyetchiphi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoitam on " + sSchema + "." + s_Table_P + "(idtheodoitam);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtrukhotam);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmbd foreign key(idbietduoc) references " + sSchema + ".m_dmbd(idbietduoc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Tú:29/07/2015
                #region p_lichchaythan
                s_Table = DanhMucTable.p_lichchaythan.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idlichchaythan);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkpbv foreign key(idkhoaphong) references " + sSchema + ".p_dmkhoaphongbenhvien(idkhoaphong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmmay foreign key(idmay) references " + sSchema + ".r_dmmay(idmay);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_nhapll - ThanhCuong - 30/07/2015
                s_Table = DanhMucTable.bl_nhapll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnhap on " + sSchema + "." + s_Table_P + "(idnhap);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngaynhap on " + sSchema + "." + s_Table_P + "(ngaynhap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idnhap);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmncc foreign key(idnhacungcap) references " + sSchema + ".bl_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_kho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username)  ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_nhapct - ThanhCuong - 30/07/2015
                s_Table = DanhMucTable.bl_nhapct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnhap on " + sSchema + "." + s_Table_P + "(idnhap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idnhap,stt);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_theodoi - ThanhCuong - 30/07/2015
                s_Table = DanhMucTable.bl_theodoi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_mabichmau on " + sSchema + "." + s_Table_P + "(mabichmau);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idmau on " + sSchema + "." + s_Table_P + "(idmau);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnguon on " + sSchema + "." + s_Table_P + "(idnguon);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnhacc on " + sSchema + "." + s_Table_P + "(idnhacungcap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mabichmau);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmmau foreign key(idmau) references " + sSchema + ".bl_dmmau(idmau) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".bl_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnhacc foreign key(idnhacungcap) references " + sSchema + ".bl_dmnhacungcap(idnhacungcap) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_dongia check (dongia>=0);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_giaban check (giaban>=0);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_tondau - ThanhCuong - 30/07/2015
                s_Table = DanhMucTable.bl_tondau.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_mabichmau on " + sSchema + "." + s_Table_P + "(mabichmau);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,mabichmau);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_tonkhochitiet - ThanhCuong - 30/07/2015
                s_Table = DanhMucTable.bl_tonkhochitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_mabichmau on " + sSchema + "." + s_Table_P + "(mabichmau);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,mabichmau);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_tonkhotonghop - ThanhCuong - 30/07/2015
                s_Table = DanhMucTable.bl_tonkhotonghop.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idmau on " + sSchema + "." + s_Table_P + "(idmau);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnguon on " + sSchema + "." + s_Table_P + "(idnguon);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(mmyy,idkho,idmau,idnguon);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmmau foreign key(idmau) references " + sSchema + ".bl_dmmau(idmau) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".bl_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_thuchitiente - Linh - 3/8/2015
                s_Table = DanhMucTable.b_thuchitiente.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idvienphi on " + sSchema + "." + s_Table_P + "(idvienphi);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idvienphi,idloaitiente,loaigiaodich,menhgia);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_loaitiente foreign key(idloaitiente) references " + sSchema + ".b_dmloaitiente(idloaitiente) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser(username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_xuat
                s_Table = DanhMucTable.bl_xuatll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxuat on " + sSchema + "." + s_Table_P + "(idxuat);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_sophieu on " + sSchema + "." + s_Table_P + "(sophieu);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_loai on " + sSchema + "." + s_Table_P + "(loai);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoxuat on " + sSchema + "." + s_Table_P + "(idkhoxuat);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhonhap on " + sSchema + "." + s_Table_P + "(idkhonhap);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuat);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_xuatct
                s_Table = DanhMucTable.bl_xuatct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxuat on " + sSchema + "." + s_Table_P + "(idxuat);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_mabichmau on " + sSchema + "." + s_Table_P + "(mabichmau);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuat,stt);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Thuy 11/08/15
                #region h_chamcong
                s_Table = DanhMucTable.h_chamcong.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_manhanvien on " + sSchema + "." + s_Table_P + "(manhanvien);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(manhanvien,idkhoaphong,mmyy);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Tú:12/08/2015
                #region b_quyettoanbhyt
                s_Table = DanhMucTable.b_quyettoanbhyt.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idvienphi);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_quyettoanbhytct
                s_Table = DanhMucTable.b_quyettoanbhytct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idvienphi,stt);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region b_quyettoanbhytctthuoc
                s_Table = DanhMucTable.b_quyettoanbhytctthuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idvienphi,stt);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_ylenhmau
                s_Table = DanhMucTable.bl_ylenhmau.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idylenhmau on " + sSchema + "." + s_Table_P + "(idylenhmau);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idphieu on " + sSchema + "." + s_Table_P + "(idphieu);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idylenhmau);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkp foreign key(idkhoaphong) references " + sSchema + ".m_dmkhoaphong (idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmphieu foreign key(idphieu) references " + sSchema + ".m_dmphieu (idphieu) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_ylenhmauds
                s_Table = DanhMucTable.bl_ylenhmauds.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idylenhmau on " + sSchema + "." + s_Table_P + "(idylenhmau);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idylenhmauds on " + sSchema + "." + s_Table_P + "(idylenhmauds);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idylenhmauds);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_ylenhmauct
                s_Table = DanhMucTable.bl_ylenhmauct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idylenhmauds on " + sSchema + "." + s_Table_P + "(idylenhmauds);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idmau on " + sSchema + "." + s_Table_P + "(idmau);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idnguon on " + sSchema + "." + s_Table_P + "(idnguon);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idylenhmauds,stt);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add  constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmnguon foreign key(idnguon) references " + sSchema + ".bl_dmnguon(idnguon) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmmau foreign key(idmau) references " + sSchema + ".bl_dmmau(idmau) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slyc check (soluongyeucau>0);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slpslyc check (soluongphat<=soluongyeucau);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_slp check (soluongphat>=0);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_phieuduyet
                s_Table = DanhMucTable.bl_phieuduyet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idphieuduyet on " + sSchema + "." + s_Table_P + "(idphieuduyet);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idphieuduyet);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkp foreign key(idkhoaphong) references " + sSchema + ".m_dmkhoaphong (idkhoaphong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_xuatnoiviends
                s_Table = DanhMucTable.bl_xuatnoiviends.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxuatnoiviends on " + sSchema + "." + s_Table_P + "(idxuatnoiviends);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idphieuduyet on " + sSchema + "." + s_Table_P + "(idphieuduyet);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idylenhmauds on " + sSchema + "." + s_Table_P + "(idylenhmauds);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuatnoiviends);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_xuatnoivienct
                s_Table = DanhMucTable.bl_xuatnoivienct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_mabichmau on " + sSchema + "." + s_Table_P + "(mabichmau);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idxuatnvds on " + sSchema + "." + s_Table_P + "(idxuatnoiviends);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idxuatnoiviends,stt);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho(idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmdt foreign key(madoituong) references " + sSchema + ".p_dmdoituong(madoituong) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint ck_" + s_Table_P + "_soluong check (soluong>0);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region bl_phieuduyetkho
                s_Table = DanhMucTable.bl_phieuduyetkho.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idphieuduyet on " + sSchema + "." + s_Table_P + "(idphieuduyet);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkho on " + sSchema + "." + s_Table_P + "(idkho);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idphieuduyet,idkho);\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmuser foreign key(username) references " + sSchema + ".p_dmuser (username) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "      alter TABLE " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_dmkho foreign key(idkho) references " + sSchema + ".m_dmkho (idkho) ON UPDATE RESTRICT ON DELETE RESTRICT;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Thuy 31/08/15
                #region h_chamcongngoaigio
                s_Table = DanhMucTable.h_chamcongngoaigio.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_manhanvien on " + sSchema + "." + s_Table_P + "(manhanvien);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_id on " + sSchema + "." + s_Table_P + "(id);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(manhanvien,id,mmyy);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Tú:04/09/2015
                #region m_theodoidoituong
                s_Table = DanhMucTable.m_theodoidoituong.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idtheodoi on " + sSchema + "." + s_Table_P + "(idtheodoi);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_madoituong on " + sSchema + "." + s_Table_P + "(madoituong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idtheodoi,madoituong);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion

                //Thuy 17/09/15
                #region h_heso_nv
                s_Table = DanhMucTable.h_heso_nv.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_manhanvien on " + sSchema + "." + s_Table_P + "(manhanvien);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idkhoaphong on " + sSchema + "." + s_Table_P + "(idkhoaphong);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(manhanvien,idkhoaphong,mmyy);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Tú:21/09/2015
                #region l_ketquagiaiphaubenh
                s_Table = DanhMucTable.l_ketquagiaiphaubenh.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idchidinh on " + sSchema + "." + s_Table_P + "(idchidinh);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idketquagiaiphaubenh);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region l_ketquavitrisinhthiet
                s_Table = DanhMucTable.l_ketquavitrisinhthiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idchidinh on " + sSchema + "." + s_Table_P + "(idchidinh);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idchidinh,idvitrisinhthiet);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region l_ketquahoamomiendich
                s_Table = DanhMucTable.l_ketquahoamomiendich.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idchidinh on " + sSchema + "." + s_Table_P + "(idchidinh);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idketquagiaiphaubenh,idvitrisinhthiet,idphuongphapnhuom);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region l_ketquachandoansinhthiet
                s_Table = DanhMucTable.l_ketquachandoansinhthiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idchidinh on " + sSchema + "." + s_Table_P + "(idchidinh);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idketquagiaiphaubenh,idvitrisinhthiet);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                #endregion
                #region p_lichhen_chidinh
                s_Table = DanhMucTable.p_lichhen_chidinh.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idlichhen on " + sSchema + "." + s_Table_P + "(idlichhen);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idgiavienphi on " + sSchema + "." + s_Table_P + "(idgiavienphi);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idlichhen,stt);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint fk_" + s_Table_P + "_giavp foreign key(idgiavienphi) references " + sSchema + ".b_dmgiavienphi;\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                    Application.DoEvents();
                }
                catch { }
                s_Sql = "";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand("alter table " + sSchema + "." + s_Table_P + " drop constraint un_" + s_Table_P, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                try
                {
                    cmd = new MDBCommand("alter table " + sSchema + "." + s_Table_P + " add constraint un_p" + s_Table_P + " unique(ngay,ngaykham,mabs,giobatdau)", mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                }
                catch { cmd.Dispose(); }
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                    Application.DoEvents();
                }
                catch { cmd.Dispose(); }
                #endregion
                //Tú:22/10/2015
                #region p_phieutruyendich
                s_Table = DanhMucTable.p_phieutruyendich.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql = "Begin \n";
                s_Sql += "  if not exists(select * from pg_tables where tablename='" + s_Table_P + "' and schemaname='" + sSchema + "') then \n";
                s_Sql += "      CREATE TABLE " + sSchema + "." + s_Table_P + " (CHECK (mmyy='" + s_MMYY + "' )) INHERITS (" + sSchema + "." + s_Table + ");\n";
                s_Sql += "      create index ind_" + s_Table_P + " on " + sSchema + "." + s_Table_P + "(mmyy);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idphieutruyendich on " + sSchema + "." + s_Table_P + "(idphieutruyendich);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_maql on " + sSchema + "." + s_Table_P + "(maql);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_ngay on " + sSchema + "." + s_Table_P + "(ngay);\n";
                s_Sql += "      create index ind_" + s_Table_P + "_idbietduoc on " + sSchema + "." + s_Table_P + "(idbietduoc);\n";
                s_Sql += "      alter table " + sSchema + "." + s_Table_P + " add constraint pk_" + s_Table_P + " primary key(idphieutruyendich);\n";
                s_Sql += "  end if;\n";
                s_Sql += "end";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                    Application.DoEvents();
                }
                catch { }
                s_Sql = "";
                cmd.Dispose();
                s_Sql = "CREATE or replace rule rul_" + s_Table_P + " as on insert to " + sSchema + "." + s_Table + " where mmyy='" + s_MMYY + "'" +
                    " do instead INSERT INTO " + sSchema + "." + s_Table_P + " VALUES (NEW.*);\n";
                cmd.Dispose();
                try
                {
                    cmd = new MDBCommand(s_Sql, mdbCon);
                    cmd.CommandType = CommandType.Text;
                    cmd.ExecuteNonQuery();
                    Application.DoEvents();
                }
                catch { cmd.Dispose(); }
                #endregion
                //phaỉ để làm sau cùng
                s_Sql = "ALTER TABLE " + sSchema + ".p_benhandt_" + s_MMYY + " ADD CONSTRAINT ck_p_benhandt_" + s_MMYY + "_mabn CHECK (mabn<>'');\n";
                s_Sql += "ALTER TABLE " + sSchema + ".p_benhandt_" + s_MMYY + " ADD CONSTRAINT ck_p_benhandt_" + s_MMYY + "_maql CHECK (maql<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".p_nhapkhoa_" + s_MMYY + " ADD CONSTRAINT ck_p_nhapkhoa_" + s_MMYY + "_maql CHECK (maql<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".p_nhapkhoa_" + s_MMYY + " ADD CONSTRAINT ck_p_nhapkhoa_" + s_MMYY + "_id CHECK (id<>0);\n";

                s_Sql += "ALTER TABLE " + sSchema + ".m_ylenhthuoc_" + s_MMYY + "  ADD CONSTRAINT ck_m_ylenhthuoc_" + s_MMYY + "_idylenhthuoc CHECK (idylenhthuoc<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_ylenhthuocds_" + s_MMYY + "  ADD CONSTRAINT ck_m_ylenhthuocds_" + s_MMYY + "_idylenhthuoc CHECK (idylenhthuoc<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_ylenhthuocds_" + s_MMYY + "  ADD CONSTRAINT ck_m_ylenhthuocds_" + s_MMYY + "_idylenhthuocds CHECK (idylenhthuocds<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_ylenhthuocct_" + s_MMYY + "  ADD CONSTRAINT ck_m_ylenhthuocct_" + s_MMYY + "_idylenhthuocds CHECK (idylenhthuocds<>0);\n";
                s_Sql += "alter table " + sSchema + ".m_ylenhthuocds_" + s_MMYY + " add constraint fk_ylenhthuocds_ylenhthuoc_" + s_MMYY + " foreign key(idylenhthuoc) references " + sSchema + ".m_ylenhthuoc_" + s_MMYY + "(idylenhthuoc);\n";
                s_Sql += "alter table " + sSchema + ".m_ylenhthuocct_" + s_MMYY + " add constraint fk_ylenhthuocct_ylenhthuocds_" + s_MMYY + " foreign key(idylenhthuocds) references " + sSchema + ".m_ylenhthuocds_" + s_MMYY + "(idylenhthuocds);\n";
                s_Sql += "alter table " + sSchema + ".m_thucxuattutruc_" + s_MMYY + " add constraint fk_thucxuattutruc_ylenhthuocds_" + s_MMYY + " foreign key(idylenhthuocds) references " + sSchema + ".m_ylenhthuocds_" + s_MMYY + "(idylenhthuocds);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_phieuduyet_" + s_MMYY + "  ADD CONSTRAINT ck_phieuduyet_" + s_MMYY + "_idphieuduyet CHECK (idphieuduyet<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_phieuduyet_" + s_MMYY + "  ADD CONSTRAINT ck_phieuduyet_" + s_MMYY + "_idphieu CHECK (idphieu<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_phieuduyet_" + s_MMYY + "  ADD CONSTRAINT ck_phieuduyet_" + s_MMYY + "_idkp CHECK (idkhoaphong<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_xuatnoiviends_" + s_MMYY + "  ADD CONSTRAINT ck_xuatnoiviends_" + s_MMYY + "_idphieuduyet CHECK (idphieuduyet<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_xuatnoiviends_" + s_MMYY + "  ADD CONSTRAINT ck_xuatnoiviends_" + s_MMYY + "_idylenhthuocds CHECK (idylenhthuocds<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_xuatnoiviends_" + s_MMYY + "  ADD CONSTRAINT ck_xuatnoiviends_" + s_MMYY + "_xuatnoiviendsds CHECK (idxuatnoiviends<>0);\n";
                s_Sql += "alter table " + sSchema + ".m_xuatnoiviends_" + s_MMYY + " add constraint fk_xuatnoiviends_phieuduyet_" + s_MMYY + " foreign key(idphieuduyet) references " + sSchema + ".m_phieuduyet_" + s_MMYY + "(idphieuduyet);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_xuatnoivienct_" + s_MMYY + "  ADD CONSTRAINT ck_xuatnoivienct_" + s_MMYY + "_xuatnoiviendsds CHECK (idxuatnoiviends<>0);\n";
                s_Sql += "alter table " + sSchema + ".m_xuatnoivienct_" + s_MMYY + " add constraint fk_xuatnoivienct_xuatnoiviends_" + s_MMYY + " foreign key(idxuatnoiviends) references " + sSchema + ".m_xuatnoiviends_" + s_MMYY + "(idxuatnoiviends);\n";
                s_Sql += "alter table " + sSchema + ".m_tienthuoc_" + s_MMYY + " add constraint fk_tienthuoc_xuatnoiviends_" + s_MMYY + " foreign key(idxuatnoiviends) references " + sSchema + ".m_xuatnoiviends_" + s_MMYY + "(idxuatnoiviends);\n";
                s_Sql += "alter table " + sSchema + ".m_xuatct_" + s_MMYY + " add constraint fk_xuatct_xuatll_" + s_MMYY + " foreign key(idxuat) references " + sSchema + ".m_xuatll_" + s_MMYY + "(idxuat);\n";
                s_Sql += "alter table " + sSchema + ".m_nhapct_" + s_MMYY + " add constraint fk_nhapct_nhapll_" + s_MMYY + " foreign key(idnhap) references " + sSchema + ".m_nhapll_" + s_MMYY + "(idnhap);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_nhapct_" + s_MMYY + "  ADD CONSTRAINT ck_m_nhapct_" + s_MMYY + "_soluong CHECK (soluong>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_nhapct_" + s_MMYY + "  ADD CONSTRAINT ck_m_nhapct_" + s_MMYY + "_idnhap CHECK (idnhap<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".m_nhapll_" + s_MMYY + "  ADD CONSTRAINT ck_m_nhapll_" + s_MMYY + "_idnhap CHECK (idnhap<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".b_chidinh_" + s_MMYY + "  ADD CONSTRAINT ck_b_chidinh_" + s_MMYY + "_id CHECK (id<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".b_chidinh_" + s_MMYY + "  ADD CONSTRAINT ck_b_chidinh_" + s_MMYY + "_maql CHECK (maql<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".b_chidinh_" + s_MMYY + "  ADD CONSTRAINT ck_b_chidinh_" + s_MMYY + "_soluong CHECK (soluong>0);\n";

                s_Sql += "ALTER TABLE " + sSchema + ".b_vienphi_" + s_MMYY + "  ADD CONSTRAINT ck_b_vienphi_" + s_MMYY + "_idvienphi CHECK (idvienphi<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".b_vienphi_" + s_MMYY + "  ADD CONSTRAINT ck_b_vienphi_" + s_MMYY + "_maql CHECK (maql<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".b_vienphict_" + s_MMYY + "  ADD CONSTRAINT ck_b_vienphict_" + s_MMYY + "_idvienphi CHECK (idvienphi<>0);\n";
                s_Sql += "ALTER TABLE " + sSchema + ".b_vienphictthuoc_" + s_MMYY + "  ADD CONSTRAINT ck_b_vienphictthuoc_" + s_MMYY + "_idvienphi CHECK (idvienphi<>0);\n";
                s_Sql += "alter table " + sSchema + ".b_vienphict_" + s_MMYY + " add constraint fk_vienphict_vienphi_" + s_MMYY + " foreign key(idvienphi) references " + sSchema + ".b_vienphi_" + s_MMYY + "(idvienphi);\n";
                s_Sql += "alter table " + sSchema + ".b_vienphictthuoc_" + s_MMYY + " add constraint fk_vienphictthuoc_vienphi_" + s_MMYY + " foreign key(idvienphi) references " + sSchema + ".b_vienphi_" + s_MMYY + "(idvienphi);\n";
                //Tú:24/12/2014
                s_Sql += "alter table " + sSchema + ".b_hoantra_" + s_MMYY + " add constraint ck_b_hoantra_" + s_MMYY + "_id check (id<>0);\n";
                s_Sql += "alter table " + sSchema + ".b_hoantra_" + s_MMYY + " add constraint ck_b_hoantra_" + s_MMYY + "_maql check (maql<>0);\n";
                s_Sql += "alter table " + sSchema + ".b_tamung_" + s_MMYY + " add constraint ck_b_tamung_" + s_MMYY + "_id check (id<>0);\n";
                s_Sql += "alter table " + sSchema + ".b_tamung_" + s_MMYY + " add constraint ck_b_tamung_" + s_MMYY + "_maql check (maql<>0);\n";
                s_Sql += "alter table " + sSchema + ".l_ketquachitiet_" + s_MMYY + " drop constraint pk_l_ketquachitiet_" + s_MMYY + ";\n";
                s_Sql += "ALTER TABLE " + sSchema + ".p_xuatvien_" + s_MMYY + " ADD CONSTRAINT ck_p_xuatvien_" + s_MMYY + "_maql CHECK (maql<>0);\n";
                //linh 26/02/15
                s_Sql += "alter table " + sSchema + ".m_sophieuduyet_" + s_MMYY + " drop constraint fk_m_sophieuduyet_" + s_MMYY + "_dmnhom;\n";
                //linh 6/3/15
                s_Sql += "alter table " + sSchema + ".b_chidinh_" + s_MMYY + " add constraint ck_b_chidinh_" + s_MMYY + "_idkp check (idkhoaphong<>0);\n";
                s_Sql += "alter table " + sSchema + ".b_tamung_" + s_MMYY + " add constraint ck_b_tamung_" + s_MMYY + "_idkp check (idkhoaphong<>0);\n";
                //linh 1/4/15
                s_Sql += "CREATE INDEX ind_chidinh_" + s_MMYY + "_iddotchidinh ON " + sSchema + ".b_chidinh_" + s_MMYY + " USING btree (iddotchidinh desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_chidinh_" + s_MMYY + "_idchidinh ON " + sSchema + ".b_chidinh_" + s_MMYY + " USING btree (idchidinh desc NULLS LAST);\n";
                s_Sql += "CREATE INDEX ind_ketqua_" + s_MMYY + "_iddotchidinh ON " + sSchema + ".l_ketqua_" + s_MMYY + " USING btree (iddotchidinh desc NULLS LAST);\n";
                s_Sql += "alter table " + sSchema + ".p_benhandt_" + s_MMYY + " alter column ngay set not null;\n";
                s_Sql += "alter table " + sSchema + ".p_nhapkhoa_" + s_MMYY + " alter column ngay set not null;\n";
                s_Sql += "alter table " + sSchema + ".p_xuatkhoa_" + s_MMYY + " alter column ngay set not null;\n";
                s_Sql += "alter table " + sSchema + ".p_xuatvien_" + s_MMYY + " alter column ngay set not null;\n";
                s_Sql += "CREATE INDEX ind_chidinh_" + s_MMYY + "_stt ON " + sSchema + ".b_chidinh_" + s_MMYY + " USING btree (stt desc NULLS LAST);\n";
                s_Sql += "alter table " + sSchema + ".p_bhyt_" + s_MMYY + " add constraint ck_p_bhyt_" + s_MMYY + "_id check (id<>0);\n";
                s_Sql += "alter table " + sSchema + ".p_bhyt_" + s_MMYY + " add constraint ck_p_bhyt_" + s_MMYY + "_maql check (maql<>0);\n";
                foreach (string s in s_Sql.Trim(';').Split(';'))
                {
                    if (s.Trim() != "")
                    {
                        try
                        {
                            cmd = new MDBCommand(s, mdbCon);
                            cmd.ExecuteNonQuery();
                            Application.DoEvents();
                        }
                        catch
                        {
                            cmd.Dispose();
                            continue;
                        }
                    }
                }
#else
                s_Table = DanhMucTable.p_benhandt.ToString();
                s_Table_P=s_Table+"_"+s_MMYY;
                s_Sql = "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_lienhe.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_bhyt.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_nhapkhoa.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_xuatkhoa.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_xuatvien.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_dausinhton.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_benhkemtheo.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_benhmantinh.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_benhtiensu.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_giaychuyenvien.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_giayravien.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_lichhen.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_lichlamviecbacsi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_tainanthuongtich.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_pttt.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_theodoigiuong.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_toathuocll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_toathuocct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_xutridieutri.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.r_ketquall.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.r_ketquact.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
               
                s_Table = DanhMucTable.m_dutrumuall.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_dutrumuact.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_duyetchiphi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_duyetchiphicls.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_duyetchiphithuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_duyetdutrumuall.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_duyetdutrumuact.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_nhapll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_nhapct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_phieuduyet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_sophieuduyet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_sophieumau38.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_theodoi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_xuatnoiviends.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_xuatnoivienct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_thucxuattutruc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_tienthuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_tondau.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_tonkhochitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_tonkhotonghop.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_tontutrucchitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_tontutructonghop.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_xuatll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_xuatct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_ylenhthuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_ylenhthuocds.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_ylenhthuocct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.b_hoantra.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.b_tamung.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.b_tamungcd.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.b_chidinh.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.b_thuocchuavuottran.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.b_vienphichuavuottran.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.b_vienphi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.b_vienphict.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.b_vienphictthuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.l_ketqua.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.l_ketquachitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_theodoi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_tonkhochitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_tonkhotonghop.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_tondau.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.e_theodoi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.e_tonkhochitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.e_tonkhotonghop.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.e_tondau.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.e_tontutrucchitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.e_tontutructonghop.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table =DanhMucTable.e_nhapll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.e_nhapct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //Thuy 3/7/14
                s_Table = DanhMucTable.p_thanhvienekipmo.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //Tú:08/07/2014
                s_Table = DanhMucTable.b_chuyensolieu.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_dutrucapll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_dutrucapct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //linh 1/8/14
                s_Table = DanhMucTable.m_phatthuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_denghi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_denghichitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //linh 7/9/14
                s_Table = DanhMucTable.l_labketqua.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //ThanhCuong - 03/04/2015
                s_Table = DanhMucTable.m_denghitra.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_denghitract.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //ThanhCuong - 18/05/2015
                s_Table = DanhMucTable.m_cosotutruc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_vudieutri.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_vudieutrichitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_theodoidulieu.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.p_phatstttiepdon.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;//ThanhCuong - 24/06/2015
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //Tú:26/06/2015
                s_Table = DanhMucTable.m_trukhotam.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //Tú:29/07/2015
                s_Table = DanhMucTable.p_lichchaythan.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //ThanhCuong - 30/07/2015
                s_Table = DanhMucTable.bl_tondau.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_tonkhochitiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_tonkhotonghop.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_nhapll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_nhapct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_theodoi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //linh 3/8/15
                s_Table = DanhMucTable.b_thuchitiente.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                 s_Table = DanhMucTable.bl_theodoi.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_xuatll.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_xuatct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //Thuy 11/8/15
                s_Table = DanhMucTable.h_chamcong.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //Tú:12/08/2015
                s_Table = DanhMucTable.b_quyettoanbhyt.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.b_quyettoanbhytct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.b_quyettoanbhytctthuoc.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //ThanhCuong - 13/08/2015
                s_Table = DanhMucTable.bl_ylenhmau.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_ylenhmauds.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_ylenhmauct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_phieuduyet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_xuatnoiviends.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_xuatnoivienct.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.bl_phieuduyetkho.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.m_phieuduyetkho.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //Thuy 31/08/2015
                s_Table = DanhMucTable.h_chamcongngoaigio.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //Tú:04/09/2015
                s_Table = DanhMucTable.m_theodoidoituong.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //Thuy 17/09/2015
                s_Table = DanhMucTable.h_heso_nv.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //Tú:21/09/2015
                s_Table = DanhMucTable.l_ketquagiaiphaubenh.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.l_ketquavitrisinhthiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.l_ketquahoamomiendich.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                s_Table = DanhMucTable.l_ketquachandoansinhthiet.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";

                //linh 22/09/2015
                s_Table = DanhMucTable.p_lichhen_chidinh.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";
                //Tú:22/10/2015
                s_Table = DanhMucTable.p_phieutruyendich.ToString();
                s_Table_P = s_Table + "_" + s_MMYY;
                s_Sql += "alter table " + sSchema + "." + s_Table + " add partition " + s_Table_P + " values('" + s_MMYY + "');\n";

                s_Sql += "\nexit;\n";
                string s_Path = "tao.sql";
                if (File.Exists(s_Path))
                {
                    File.Delete(s_Path);
                }
                FileStream stream = new FileStream(s_Path, FileMode.CreateNew, FileAccess.Write);
                StreamWriter writer = new StreamWriter(stream);
                writer.Write(s_Sql);
                writer.Close();
                stream.Dispose();
                writer.Dispose();
                string s_FileName = "sqlplus.exe";
                string s_Argument = sSchema + "/" + sPassword + "@" + sHost + " @" + System.Environment.CurrentDirectory + "\\" + s_Path;
                new Run(s_FileName, s_Argument, true).Launch();
                if (File.Exists(s_Path))
                {
                    File.Delete(s_Path);
                }
#endif
            }
            catch { }
        }

        //ThanhCuong - 23/12/2014 - Merge phieuduyetkho
        public void MergePhieuDuyetKho(MDBConnection mdbCon, string s_MMYY, string s_ListIDKho)
        {
            string s_SQL = "";
            try
            {
                if (s_MMYY.Trim() == "")
                {
                    DateTime dti_NgayHienTai = Convert.ToDateTime(Database.NgayGioHeThong.Substring(0, 10));
                    s_MMYY = dti_NgayHienTai.Month.ToString().PadLeft(2, '0') + dti_NgayHienTai.Year.ToString().Substring(2, 2).PadLeft(2, '0');
                }
                s_MMYY = s_MMYY.Trim('\'');
                s_ListIDKho = s_ListIDKho.Trim().Trim(',').Trim();
                if (Database.PhanHe == (int)PhanHePhanMem.PostgreSQL)
                {
                    s_SQL = "with upsert as (update " + Database.Schema + ".m_phieuduyetkho_" + s_MMYY + " a set a.ngayud=b.ngayud " +
                        " from (select x.idphieuduyet,z.idkho,x.ngayud from " + Database.Schema + ".m_phieuduyet_" + s_MMYY + " x," + Database.Schema + ".m_xuatnoiviends y," + Database.Schema + ".m_xuatnoivienct z where x.idphieuduyet=y.idphieuduyet " +
                            "and y.idxuatnoiviends=z.idxuatnoiviends and x.mmyy='" + s_MMYY + "' and y.mmyy='" + s_MMYY + "' and z.mmyy='" + s_MMYY + "'";
                    if (s_ListIDKho != "") { s_SQL += " and z.idkho in(" + s_ListIDKho + ")"; }
                    s_SQL += " ) b where a.idphieuduyet=b.idphieuduyet and a.idkho=b.idkho returning a.*) ";

                    s_SQL += " insert into " + Schema + ".m_phieuduyetkho_" + s_MMYY + "(idphieuduyet,idkho,trangthai,mmyy,computer,username)" +
                        " select b.idphieuduyet,b.idkho,b.trangthai,b.mmyy,b.computer,b.username " +
                        " from (select distinct x.idphieuduyet,z.idkho,x.trangthai,x.mmyy,x.computer,x.username from " + Database.Schema + ".m_phieuduyet_" + s_MMYY + " x," + Database.Schema + ".m_xuatnoiviends y," + Database.Schema + ".m_xuatnoivienct z where x.idphieuduyet=y.idphieuduyet " +
                            "and y.idxuatnoiviends=z.idxuatnoiviends and x.mmyy='" + s_MMYY + "' and y.mmyy='" + s_MMYY + "' and z.mmyy='" + s_MMYY + "'";
                    if (s_ListIDKho != "") { s_SQL += " and z.idkho in(" + s_ListIDKho + ")"; }
                    s_SQL += " ) b where not exists(select 1 from upsert bb where b.idphieuduyet=bb.idphieuduyet and b.idkho=bb.idkho) ";
                }
                else
                {
                    s_SQL = "merge into " + Database.Schema + ".m_phieuduyetkho a using (select distinct x.idphieuduyet,z.idkho,x.trangthai,x.mmyy,x.computer,x.username from " + Database.Schema +
                        ".m_phieuduyet_" + s_MMYY + " x," + Database.Schema + ".m_xuatnoiviends y," + Database.Schema + ".m_xuatnoivienct z where x.idphieuduyet=y.idphieuduyet " +
                            "and y.idxuatnoiviends=z.idxuatnoiviends and x.mmyy='" + s_MMYY + "' and y.mmyy='" + s_MMYY + "' and z.mmyy='" + s_MMYY + "'";
                    if (s_ListIDKho != "") { s_SQL += " and z.idkho in(" + s_ListIDKho + ")"; }
                    s_SQL += ") b on (a.idphieuduyet=b.idphieuduyet and a.idkho=b.idkho) " +
                        " when matched then update set a.ngayud=b.ngayud " +
                        " when not matched then insert (a.idphieuduyet,a.idkho,a.trangthai,a.mmyy,a.computer,a.username) values(b.idphieuduyet,b.idkho,b.trangthai,b.mmyy,b.computer,b.username)";
                }
                MDBCommand mdbCmd = new MDBCommand(s_SQL, mdbCon);
                mdbCmd.CommandType = CommandType.Text;
                mdbCmd.ExecuteNonQuery();
            }
            catch (MDBException exc)
            {
                exc.LogError(s_SQL, "Database->MergePhieuDuyetKho(mdbCon, s_MMYY, s_ListIDKho)");
            }
        }
        //Thuy 16/09/15 từ từ làm sau, chưa có xong
        public void TaoDuLieuTable_HeSoNhanVien(MDBConnection mdbCon, string s_MMYY)
        {
            string s_SQL = "";
            try
            {
                if (s_MMYY.Trim() == "")
                {
                    DateTime dti_NgayHienTai = Convert.ToDateTime(Database.NgayGioHeThong.Substring(0, 10));
                    s_MMYY = dti_NgayHienTai.Month.ToString().PadLeft(2, '0') + dti_NgayHienTai.Year.ToString().Substring(2, 2).PadLeft(2, '0');
                }
                //s_MMYY = s_MMYY.Trim('\'');
                //s_SQL = "insert into " + Schema + ".heso_nv_" + s_MMYY + "";
                //s_SQL += "(manhanvien,idkhoaphong,mmyy,bhxh,bhyt,bhtn,h_hsbdhv,h_hslc,h_hscv,h_hsvk,h_hstn,h_hskv,h_hsdh,h_hsdb,h_hsld,";
                //s_SQL += " h_hsth,h_hsud,h_pcta,h_pctx,h_pctdt,h_pckh,h_sotienhd,h_lhdbantg,h_stbantg,h_luongsp,h_tongluong,thuviec,dihoc,luutruhs)";

                //s_SQL += " select l.manv,l.madv,'" + s_mmyy + "',h.bhxh,h.bhyt,h.bhtn";
                //s_SQL += " ,case when (h.cdoanphi is not null and to_timestamp(to_char(h.cdoanphi,'yyyy/mm/dd'),'yyyy/mm/dd') <= to_timestamp('" + d1.ToString("yyyy/MM/dd", null) + "','yyyy/mm/dd')) then 1 else 0 end as kpcd";
                //s_SQL += " ,case when h.heso<>'' then h.heso else '0' end as heso,h.hs_lc,h.hs_cv,h.hs_vk,h.hs_tn,h.hs_kv,h.hs_dh,h.hs_db,h.hs_ld,h.hs_th,h.hs_ud,h.pc_ta,h.pc_tx,pc_tdt,h.pc_khac";
                //s_SQL += " ,case when (h.ngaygiulhd is not null and to_timestamp(to_char(h.ngaygiulhd,'yyyy/mm/dd'),'yyyy/mm/dd') <= to_timestamp('" + d1.ToString("yyyy/MM/dd", null) + "','yyyy/mm/dd')) then h.sotien_hd else 0 end as sotien_hd";
                //s_SQL += " ,case when h.lhd_bantg <> '' then h.lhd_bantg else '' end as lhd_bantg,h.st_bantg,h.luong_sp,h.tongluong";
                //s_SQL += " ,case when h.loaihd='TV' then 1 else 0 end as thuviec,case when h.magc ='02' then 1 else 0 end as dihoc,case when h.magc ='01' then 1 else 0 end as luutruhs ";
                //s_SQL += " from " + user + ".hopdong h inner join " + user + ".llnv l on h.manv=l.manv ";
                //s_SQL += " inner join " + user + ".max_lan ml on h.manv=ml.manv";
                //s_SQL += " left join " + user + ".mahd mh on h.loaihd=mh.mahd";
                //s_SQL += " where h.lan =ml.lan and " + m_dk;
                MDBCommand mdbCmd = new MDBCommand(s_SQL, mdbCon);
                mdbCmd.CommandType = CommandType.Text;
                mdbCmd.ExecuteNonQuery();
            }
            catch (MDBException exc)
            {
                exc.LogError(s_SQL, "Database->MergePhieuDuyetKho(mdbCon, s_MMYY, s_ListIDKho)");
            }
        }
        public void CreateTable(MDBConnection mdbCon, string s_MMYY)
        {
            this.CreatePartition(mdbCon, s_MMYY);
            this.CreatePartitionTracking(mdbCon, s_MMYY);
        }

        /// <summary>
        /// Do PostgreSQl, muốn sửa field của các table đã được partition thì không được, nên phải drop rule trước rồi mới alter table được
        /// </summary>
        /// <param name="mdbCon"></param>
        /// <param name="s_TableName"></param>
        int DropRule(MDBConnection mdbCon, string s_TableName)//ThanhCuong - 07/08/2014
        {
#if POSTGRESQL
            try
            {
                WriteRuleToXML(mdbCon);
                string s_Sql = "select tablename,rulename,definition as rule from pg_rules where lower(schemaname)='" + sSchema.ToLower() + "'";
                if (s_TableName != "") { s_Sql += " and lower(tablename)='" + s_TableName.ToLower() + "'"; }
                s_Sql += " order by tablename,rulename";
                DataTable dt = new DataTable();
                MDBDataAdapter mdbAdt = new MDBDataAdapter(s_Sql, mdbCon);
                mdbAdt.Fill(dt);
                dt.TableName = "rule";
                foreach (DataRow r in dt.Rows)
                {
                    s_TableName = r["tablename"].ToString();
                    string s_RuleName = r["rulename"].ToString();
                    s_Sql = "drop rule " + s_RuleName + " on " + sSchema.ToLower() + "." + s_TableName;
                    MDBCommand mdbCmd = new MDBCommand(s_Sql, mdbCon);
                    mdbCmd.CommandType = CommandType.Text;
                    mdbCmd.ExecuteNonQuery();
                }
                return 0;
            }
            catch
            {
                return 1;
            }
#else
            return 0;
#endif
        }

        //ThanhCuong - 07/08/2014
        public int DropRule(string s_TableName)
        {
            int i_Val = 0;
            try
            {
                MDBConnection mdbCon = null;
                if (Open(ref mdbCon))
                {
                    i_Val = this.DropRule(mdbCon, s_TableName);
                    Close(ref mdbCon);
                }
                return 0;
            }
            catch
            {
                return 1;
            }
        }

        void WriteRuleToXML(MDBConnection mdbCon)
        {
#if POSTGRESQL
            try
            {
                string s_Sql = "select tablename,rulename,definition as rule from pg_rules where lower(schemaname)='" + sSchema.ToLower() + "'" +
                    " order by tablename,rulename";
                DataTable dt = new DataTable();
                MDBDataAdapter mdbAdt = new MDBDataAdapter(s_Sql, mdbCon);
                mdbAdt.Fill(dt);
                dt.TableName = "rule";
                DataSet ds = new DataSet();
                ds.Tables.Add(dt);
                ds.WriteXml(PATHRULE, XmlWriteMode.WriteSchema);
            }
            catch (MDBException ex)
            { string s = ex.MDBMessage; }
#else
            ;
#endif
        }

        /// <summary>
        /// Thay thế tạo ID tự động cho table BHYT
        /// </summary>
        /// <param name="mdbCon"></param>
        void CreateTrigger(MDBConnection mdbCon)
        {
            string s_sql = "create or replace trigger " + sSchema + ".tri_bhyt \n";
            s_sql += "before insert on " + sSchema + ".bhyt for each row ";
            s_sql += "begin\n";
            s_sql += "select to_char(sysdate,'yymmddhhmmss')||" + sSchema + ".seq_bhyt.nextval into :new.id from dual;\n";
            s_sql += "end tri_bhyt;\n";
            s_sql += "/\n";

            s_sql += "exit;\n";
            string s_Path = "tao.sql";
            if (File.Exists(s_Path))
            {
                File.Delete(s_Path);
            }
            FileStream stream = new FileStream(s_Path, FileMode.CreateNew, FileAccess.Write);
            StreamWriter writer = new StreamWriter(stream);
            writer.Write(s_sql);
            writer.Close();
            stream.Dispose();
            writer.Dispose();
            string s_FileName = "sqlplus.exe";
            string s_Argument = sSchema + "/" + sPassword + "@" + sHost + " @" + System.Environment.CurrentDirectory + "\\" + s_Path;
            new Run(s_FileName, s_Argument, true).Launch();
            if (File.Exists(s_Path))
            {
                File.Delete(s_Path);
            }
        }
        //Tú:19/12/2014
        void CreateTrigerPG(MDBConnection mdbCon)
        {
            string s_Sql = "create or replace trigger tri_p_benhandt \n";
            s_Sql += "before delete on " + sSchema + ".p_benhandt for each statement \n";
            s_Sql += "begin \n";
            s_Sql += " rollback;\n";
            s_Sql += "end tri_p_benhandt;\n";

            try
            {
                MDBCommand cmd = new MDBCommand(s_Sql, mdbCon);
                cmd.ExecuteNonQuery();
                Application.DoEvents();
            }
            catch
            {
            }
        }

        /// <summary>
        /// Mở kết nối đến cơ sở dữ liệu
        /// </summary>
        /// <param name="mdbCon"></param>
        /// <returns></returns>
        public static bool Open(ref MDBConnection mdbCon)
        {
            try
            {
                ReadConfig();
                if (mdbCon != null && mdbCon.State == ConnectionState.Open) { return true; }//Tú:12/10/2015
                mdbCon = new MDBConnection(sConStr);
                mdbCon.Open();
            }
            catch
            {
#if POSTGRESQL
                sConStr = "Server=" + sHost + ";Port=" + sPort + ";User Id=" + sUserID + ";Password=" + sPassword + ";Database=" + sDatabase + ";Encoding=UNICODE;Pooling=false;Protocol=3;Timeout=30";
                sDuocConStr = "Server=" + sDuocHost + ";Port=" + sDuocPort + ";User Id=" + sDuocUserID + ";Password=" + sDuocPassword + ";Database=" + sDuocDatabase + ";Encoding=UNICODE;Pooling=false;;Protocol=3;Timeout=30";
                sVPConStr = "Server=" + sVPHost + ";Port=" + sVPPort + ";User Id=" + sVPUserID + ";Password=" + sVPPassword + ";Database=" + sVPDatabase + ";Encoding=UNICODE;Pooling=false;;Protocol=3;Timeout=30";
                sCDHAConStr = "Server=" + sCDHAHost + ";Port=" + sCDHAPort + ";User Id=" + sCDHAUserID + ";Password=" + sCDHAPassword + ";Database=" + sCDHADatabase + ";Encoding=UNICODE;Pooling=false;;Protocol=3;Timeout=30";
                sXNConStr = "Server=" + sXNHost + ";Port=" + sXNPort + ";User Id=" + sXNUserID + ";Password=" + sXNPassword + ";Database=" + sXNDatabase + ";Encoding=UNICODE;Pooling=false;;Protocol=3;Timeout=30";
#else
                sConStr = "data source=" + sHost + ";User Id=" + sSchema + ";Password=" + sPassword;
                sDuocConStr = "data source=" + sDuocHost + ";User Id=" + sDuocSchema + ";Password=" + sDuocPassword;
                sVPConStr = "data source=" + sVPHost + ";User Id=" + sVPSchema + ";Password=" + sVPPassword;
                sCDHAConStr = "data source=" + sCDHAHost + ";User Id=" + sCDHASchema + ";Password=" + sCDHAPassword;
                sXNConStr = "data source=" + sXNHost + ";User Id=" + sXNSchema + ";Password=" + sXNPassword;
#endif
                try
                {
                    if (mdbCon != null && mdbCon.State != ConnectionState.Closed) mdbCon.Close();
                    mdbCon.connstring = sConStr;
                    mdbCon.Open();
                }
                catch (MDBException ex)
                {
                    ex.LogError();
                    return false;
                }
            }
            return true;
        }

        /// <summary>
        /// Đóng kết nối cơ sở dữ liệu
        /// </summary>
        /// <param name="mdbCon"></param>
        public static void Close(ref MDBConnection mdbCon)
        {
            try
            {
                mdbCon.Close();
            }
            catch
            { }
        }

        /// <summary>
        /// Mã hoá chuỗi
        /// </summary>
        /// <param name="values">Chuỗi cần được mã hoá</param>
        /// <returns></returns>
        public static string EnCode(string sValues)
        {
            string sVal = "";
            sVal = EnCrypt(sValues);
            return sVal;
        }

        /// <summary>
        /// Mã hoá chuỗi
        /// </summary>
        /// <param name="values">Chuỗi cần được mã hoá</param>
        /// <returns></returns>
        static string EnCrypt(string sValues)
        {
            if (sValues != "")
            {
                byte[] keyArray;
                byte[] toEncryptArray = UTF8Encoding.UTF8.GetBytes(sValues);
                MD5CryptoServiceProvider hashmd5 = new MD5CryptoServiceProvider();
                keyArray = hashmd5.ComputeHash(UTF8Encoding.UTF8.GetBytes(sKey));
                TripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();
                tdes.Key = keyArray;
                tdes.Mode = CipherMode.ECB;
                tdes.Padding = PaddingMode.PKCS7;
                ICryptoTransform cTransform = tdes.CreateEncryptor();
                byte[] resultArray = cTransform.TransformFinalBlock(toEncryptArray, 0, toEncryptArray.Length);
                return Convert.ToBase64String(resultArray, 0, resultArray.Length);
            }
            else
            {
                return "";
            }
        }

        /// <summary>
        /// Dịch ngược chuỗi đã bị mã hóa
        /// </summary>
        /// <param name="sValues">Chuỗi đã bị mã hoá</param>
        /// <param name="sKey">Key: công thức mã hóa</param>
        /// <returns></returns>
        public static string DeCode(string sValues, string sKeys)
        {
            string sVal = "";
            sVal = DeCrypt(sValues, sKeys);
            return sVal;
        }

        /// <summary>
        /// Dịch ngược chuỗi đã bị mã hóa
        /// </summary>
        /// <param name="sValues">Chuỗi đã bị mã hoá</param>
        /// <param name="sKey">Key: công thức mã hóa</param>
        /// <returns></returns>
        static string DeCrypt(string sValues, string sKeys)
        {
            if (sValues != "")
            {
                try
                {
                    byte[] keyArray;
                    byte[] toEncryptArray = Convert.FromBase64String(sValues);
                    MD5CryptoServiceProvider hashmd5 = new MD5CryptoServiceProvider();
                    keyArray = hashmd5.ComputeHash(UTF8Encoding.UTF8.GetBytes(sKeys));
                    TripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();
                    tdes.Key = keyArray;
                    tdes.Mode = CipherMode.ECB;
                    tdes.Padding = PaddingMode.PKCS7;
                    ICryptoTransform cTransform = tdes.CreateDecryptor();
                    byte[] resultArray = cTransform.TransformFinalBlock(toEncryptArray, 0, toEncryptArray.Length);
                    return UTF8Encoding.UTF8.GetString(resultArray);
                }
                catch { return ""; }
            }
            else { return ""; }
        }

        public void WriteXmlConfig(string s_Tag, string s_Val)
        {
            DataSet dsConfig = new DataSet();
            if (System.IO.File.Exists(sFileConfig))
            {
                dsConfig.ReadXml(sFileConfig, XmlReadMode.ReadSchema);
                try
                {
                    dsConfig.Tables[0].Rows[0][s_Tag] = s_Val;
                }
                catch
                {
                    dsConfig.Tables[0].Columns.Add(s_Tag, typeof(string)).DefaultValue = s_Val;
                    dsConfig.Tables[0].Rows[0][s_Tag] = s_Val;
                }
            }
            else
            {
                DataTable dtConfig = new DataTable();
                dtConfig.Columns.Add(HOSTTAG, typeof(string)).DefaultValue = sHost;
                dtConfig.Columns.Add(PORTTAG, typeof(string)).DefaultValue = sPort;
                dtConfig.Columns.Add(USERTAG, typeof(string)).DefaultValue = sUserID;
                dtConfig.Columns.Add(DATABASETAG, typeof(string)).DefaultValue = sDatabase;
                string sVal = EnCode(sPassword);
                dtConfig.Columns.Add(PASSWORDTAG, typeof(string)).DefaultValue = sVal;
                sVal = EnCode(sSchema);
                dtConfig.Columns.Add(SCHEMATAG, typeof(string)).DefaultValue = sVal;
                dtConfig.Columns.Add(s_Tag, typeof(string)).DefaultValue = s_Val;
                DataRow r = dtConfig.NewRow();
                dtConfig.Rows.Add(r);
                dsConfig.Tables.Add(dtConfig);
            }
            dsConfig.AcceptChanges();
            dsConfig.WriteXml(sFileConfig, XmlWriteMode.WriteSchema);
        }

        public static void ReadConfig()
        {
            sFileConfig = Application.ExecutablePath;
            int i_Index = sFileConfig.LastIndexOf('\\');
            sFileConfig = sFileConfig.Substring(0, i_Index).Trim('\\');
            sFileConfig = sFileConfig + "\\PMS.exe";
            try
            {
                Configuration config = ConfigurationManager.OpenExeConfiguration(sFileConfig);
                string tmpHost = config.AppSettings.Settings[HOSTTAG].Value.ToString();
                string tmpPort = config.AppSettings.Settings[PORTTAG].Value.ToString();
                string tmpUserID = config.AppSettings.Settings[USERTAG].Value.ToString();
                string tmpDatabase = config.AppSettings.Settings[DATABASETAG].Value.ToString();
                string tmpSchema = config.AppSettings.Settings[SCHEMATAG].Value.ToString();
                string tmpPassword = config.AppSettings.Settings[PASSWORDTAG].Value.ToString();
                string tmpPasswordSystem = config.AppSettings.Settings[PASSWORDSYSTEMTAG].Value.ToString();
                string tmpUsernameLogin = config.AppSettings.Settings[USERLOGINTAG].Value.ToString();
                string tmpPasswordLogin = config.AppSettings.Settings[PASSWORDLOGINTAG].Value.ToString();

                sHost = DeCode(tmpHost, sKey);
                sPort = DeCode(tmpPort, sKey);
                sUserID = DeCode(tmpUserID, sKey);
                sDatabase = DeCode(tmpDatabase, sKey);
                sSchema = DeCode(tmpSchema, sKey);
                sPassword = DeCode(tmpPassword, sKey);
                sPasswordSystem = DeCode(tmpPasswordSystem, sKey);
                sUsernameLogin = DeCode(tmpUsernameLogin, sKey);
                sPasswordLogin = DeCode(tmpPasswordLogin, sKey);

                tmpHost = config.AppSettings.Settings[DUOCHOSTTAG].Value.ToString();
                tmpPort = config.AppSettings.Settings[DUOCPORTTAG].Value.ToString();
                tmpUserID = config.AppSettings.Settings[DUOCUSERTAG].Value.ToString();
                tmpDatabase = config.AppSettings.Settings[DUOCDATABASETAG].Value.ToString();
                tmpSchema = config.AppSettings.Settings[DUOCSCHEMATAG].Value.ToString();
                tmpPassword = config.AppSettings.Settings[DUOCPASSWORDTAG].Value.ToString();
                tmpPasswordSystem = config.AppSettings.Settings[DUOCPASSWORDSYSTEMTAG].Value.ToString();
                tmpUsernameLogin = config.AppSettings.Settings[DUOCUSERLOGINTAG].Value.ToString();
                tmpPasswordLogin = config.AppSettings.Settings[DUOCPASSWORDLOGINTAG].Value.ToString();

                sDuocHost = DeCode(tmpHost, sKey);
                sDuocPort = DeCode(tmpPort, sKey);
                sDuocUserID = DeCode(tmpUserID, sKey);
                sDuocDatabase = DeCode(tmpDatabase, sKey);
                sDuocSchema = DeCode(tmpSchema, sKey);
                sDuocPassword = DeCode(tmpPassword, sKey);
                sDuocPasswordSystem = DeCode(tmpPasswordSystem, sKey);
                sDuocUsernameLogin = DeCode(tmpUsernameLogin, sKey);
                sDuocPasswordLogin = DeCode(tmpPasswordLogin, sKey);

                tmpHost = config.AppSettings.Settings[VPHOSTTAG].Value.ToString();
                tmpPort = config.AppSettings.Settings[VPPORTTAG].Value.ToString();
                tmpUserID = config.AppSettings.Settings[VPUSERTAG].Value.ToString();
                tmpDatabase = config.AppSettings.Settings[VPDATABASETAG].Value.ToString();
                tmpSchema = config.AppSettings.Settings[VPSCHEMATAG].Value.ToString();
                tmpPassword = config.AppSettings.Settings[VPPASSWORDTAG].Value.ToString();
                tmpPasswordSystem = config.AppSettings.Settings[VPPASSWORDSYSTEMTAG].Value.ToString();
                tmpUsernameLogin = config.AppSettings.Settings[VPUSERLOGINTAG].Value.ToString();
                tmpPasswordLogin = config.AppSettings.Settings[VPPASSWORDLOGINTAG].Value.ToString();

                sVPHost = DeCode(tmpHost, sKey);
                sVPPort = DeCode(tmpPort, sKey);
                sVPUserID = DeCode(tmpUserID, sKey);
                sVPDatabase = DeCode(tmpDatabase, sKey);
                sVPSchema = DeCode(tmpSchema, sKey);
                sVPPassword = DeCode(tmpPassword, sKey);
                sVPPasswordSystem = DeCode(tmpPasswordSystem, sKey);
                sVPUsernameLogin = DeCode(tmpUsernameLogin, sKey);
                sVPPasswordLogin = DeCode(tmpPasswordLogin, sKey);

                tmpHost = config.AppSettings.Settings[CDHAHOSTTAG].Value.ToString();
                tmpPort = config.AppSettings.Settings[CDHAPORTTAG].Value.ToString();
                tmpUserID = config.AppSettings.Settings[CDHAUSERTAG].Value.ToString();
                tmpDatabase = config.AppSettings.Settings[CDHADATABASETAG].Value.ToString();
                tmpSchema = config.AppSettings.Settings[CDHASCHEMATAG].Value.ToString();
                tmpPassword = config.AppSettings.Settings[CDHAPASSWORDTAG].Value.ToString();
                tmpPasswordSystem = config.AppSettings.Settings[CDHAPASSWORDSYSTEMTAG].Value.ToString();
                tmpUsernameLogin = config.AppSettings.Settings[CDHAUSERLOGINTAG].Value.ToString();
                tmpPasswordLogin = config.AppSettings.Settings[CDHAPASSWORDLOGINTAG].Value.ToString();

                sCDHAHost = DeCode(tmpHost, sKey);
                sCDHAPort = DeCode(tmpPort, sKey);
                sCDHAUserID = DeCode(tmpUserID, sKey);
                sCDHADatabase = DeCode(tmpDatabase, sKey);
                sCDHASchema = DeCode(tmpSchema, sKey);
                sCDHAPassword = DeCode(tmpPassword, sKey);
                sCDHAPasswordSystem = DeCode(tmpPasswordSystem, sKey);
                sCDHAUsernameLogin = DeCode(tmpUsernameLogin, sKey);
                sCDHAPasswordLogin = DeCode(tmpPasswordLogin, sKey);

                tmpHost = config.AppSettings.Settings[XNHOSTTAG].Value.ToString();
                tmpPort = config.AppSettings.Settings[XNPORTTAG].Value.ToString();
                tmpUserID = config.AppSettings.Settings[XNUSERTAG].Value.ToString();
                tmpDatabase = config.AppSettings.Settings[XNDATABASETAG].Value.ToString();
                tmpSchema = config.AppSettings.Settings[XNSCHEMATAG].Value.ToString();
                tmpPassword = config.AppSettings.Settings[XNPASSWORDTAG].Value.ToString();
                tmpPasswordSystem = config.AppSettings.Settings[XNPASSWORDSYSTEMTAG].Value.ToString();
                tmpUsernameLogin = config.AppSettings.Settings[XNUSERLOGINTAG].Value.ToString();
                tmpPasswordLogin = config.AppSettings.Settings[XNPASSWORDLOGINTAG].Value.ToString();

                sXNHost = DeCode(tmpHost, sKey);
                sXNPort = DeCode(tmpPort, sKey);
                sXNUserID = DeCode(tmpUserID, sKey);
                sXNDatabase = DeCode(tmpDatabase, sKey);
                sXNSchema = DeCode(tmpSchema, sKey);
                sXNPassword = DeCode(tmpPassword, sKey);
                sXNPasswordSystem = DeCode(tmpPasswordSystem, sKey);
                sXNUsernameLogin = DeCode(tmpUsernameLogin, sKey);
                sXNPasswordLogin = DeCode(tmpPasswordLogin, sKey);
#if POSTGRESQL
                sConStr = "Server=" + sHost + ";Port=" + sPort + ";User Id=" + sUserID + ";Password=" + sPassword + ";Database=" + sDatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2;MinPoolSize=0";
                //TIMEOUT=15;SEARCHPATH=;
                //POOLING=true;CONNECTIONLIFETIME=15;SYNCNOTIFICATION=False;COMMANDTIMEOUT=20;ENLIST=False;PRELOADREADER=False;;MinPoolSize=0;
                //USEEXTENDEDTYPES=False;INTEGRATED SECURITY=False;COMPATIBLE=2.0.12.0;APPLICATIONNAME=;ENCODING=UNICODE
                sDuocConStr = "Server=" + sDuocHost + ";Port=" + sDuocPort + ";User Id=" + sDuocUserID + ";Password=" + sDuocPassword + ";Database=" + sDuocDatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2;MinPoolSize=0";
                sVPConStr = "Server=" + sVPHost + ";Port=" + sVPPort + ";User Id=" + sVPUserID + ";Password=" + sVPPassword + ";Database=" + sVPDatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2;MinPoolSize=0";
                sCDHAConStr = "Server=" + sCDHAHost + ";Port=" + sCDHAPort + ";User Id=" + sCDHAUserID + ";Password=" + sCDHAPassword + ";Database=" + sCDHADatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2;MinPoolSize=0";
                sXNConStr = "Server=" + sXNHost + ";Port=" + sXNPort + ";User Id=" + sXNUserID + ";Password=" + sXNPassword + ";Database=" + sXNDatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2;MinPoolSize=0";
#else
                sConStr = "data source=" + sHost + ";User Id=" + sSchema + ";Password=" + sPassword;
                sDuocConStr = "data source=" + sDuocHost + ";User Id=" + sDuocSchema + ";Password=" + sDuocPassword;
                sVPConStr = "data source=" + sVPHost + ";User Id=" + sVPSchema + ";Password=" + sVPPassword;
                sCDHAConStr = "data source=" + sCDHAHost + ";User Id=" + sCDHASchema + ";Password=" + sCDHAPassword;
                sXNConStr = "data source=" + sXNHost + ";User Id=" + sXNSchema + ";Password=" + sXNPassword;
#endif
            }
            catch//(Exception ex)
            {
            }
            sSchemaImage = Schema + "_image";
            sSchemaTracking = Schema + "_tracking";
        }

        static void InnitConfig()
        {
            sFileConfig = Application.ExecutablePath;
            int i_Index = sFileConfig.LastIndexOf('\\');
            sFileConfig = sFileConfig.Substring(0, i_Index).Trim('\\');
            sFileConfig = sFileConfig + "\\PMS.exe";
            Configuration config = ConfigurationManager.OpenExeConfiguration(sFileConfig);
            try
            {
                config.AppSettings.Settings.Remove(HOSTTAG);
                config.AppSettings.Settings.Remove(PORTTAG);
                config.AppSettings.Settings.Remove(USERTAG);
                config.AppSettings.Settings.Remove(DATABASETAG);
                config.AppSettings.Settings.Remove(SCHEMATAG);
                config.AppSettings.Settings.Remove(PASSWORDTAG);
                config.AppSettings.Settings.Remove(PASSWORDSYSTEMTAG);
                config.AppSettings.Settings.Remove(USERLOGINTAG);
                config.AppSettings.Settings.Remove(PASSWORDLOGINTAG);
                #region Dược
                config.AppSettings.Settings.Remove(DUOCHOSTTAG);
                config.AppSettings.Settings.Remove(DUOCPORTTAG);
                config.AppSettings.Settings.Remove(DUOCUSERTAG);
                config.AppSettings.Settings.Remove(DUOCDATABASETAG);
                config.AppSettings.Settings.Remove(DUOCSCHEMATAG);
                config.AppSettings.Settings.Remove(DUOCPASSWORDTAG);
                config.AppSettings.Settings.Remove(DUOCPASSWORDSYSTEMTAG);
                config.AppSettings.Settings.Remove(DUOCUSERLOGINTAG);
                config.AppSettings.Settings.Remove(DUOCPASSWORDLOGINTAG);
                #endregion
                #region Viện phí
                config.AppSettings.Settings.Remove(VPHOSTTAG);
                config.AppSettings.Settings.Remove(VPPORTTAG);
                config.AppSettings.Settings.Remove(VPUSERTAG);
                config.AppSettings.Settings.Remove(VPDATABASETAG);
                config.AppSettings.Settings.Remove(VPSCHEMATAG);
                config.AppSettings.Settings.Remove(VPPASSWORDTAG);
                config.AppSettings.Settings.Remove(VPPASSWORDSYSTEMTAG);
                config.AppSettings.Settings.Remove(VPUSERLOGINTAG);
                config.AppSettings.Settings.Remove(VPPASSWORDLOGINTAG);
                #endregion
                #region CDHA
                config.AppSettings.Settings.Remove(CDHAHOSTTAG);
                config.AppSettings.Settings.Remove(CDHAPORTTAG);
                config.AppSettings.Settings.Remove(CDHAUSERTAG);
                config.AppSettings.Settings.Remove(CDHADATABASETAG);
                config.AppSettings.Settings.Remove(CDHASCHEMATAG);
                config.AppSettings.Settings.Remove(CDHAPASSWORDTAG);
                config.AppSettings.Settings.Remove(CDHAPASSWORDSYSTEMTAG);
                config.AppSettings.Settings.Remove(CDHAUSERLOGINTAG);
                config.AppSettings.Settings.Remove(CDHAPASSWORDLOGINTAG);
                #endregion
                #region Xét nghiệm
                config.AppSettings.Settings.Remove(XNHOSTTAG);
                config.AppSettings.Settings.Remove(XNPORTTAG);
                config.AppSettings.Settings.Remove(XNUSERTAG);
                config.AppSettings.Settings.Remove(XNDATABASETAG);
                config.AppSettings.Settings.Remove(XNSCHEMATAG);
                config.AppSettings.Settings.Remove(XNPASSWORDTAG);
                config.AppSettings.Settings.Remove(XNPASSWORDSYSTEMTAG);
                config.AppSettings.Settings.Remove(XNUSERLOGINTAG);
                config.AppSettings.Settings.Remove(XNPASSWORDLOGINTAG);
                #endregion
            }
            catch { }
            string s_Host = EnCode(sHost);
            string s_Port = EnCode(sPort);
            string s_Userid = EnCode(sUserID);
            string s_Database = EnCode(sDatabase);
            string s_Schema = EnCode(sSchema);
            string s_Password = EnCode(sPassword);
            string s_PasswordSystem = EnCode(sPasswordSystem);
            string s_UsernameLogin = EnCode(sUsernameLogin);
            string s_PasswordLogin = EnCode(sPasswordLogin);
            config.AppSettings.Settings.Add(HOSTTAG, s_Host);
            config.AppSettings.Settings.Add(PORTTAG, s_Port);
            config.AppSettings.Settings.Add(USERTAG, s_Userid);
            config.AppSettings.Settings.Add(DATABASETAG, s_Database);
            config.AppSettings.Settings.Add(SCHEMATAG, s_Schema);
            config.AppSettings.Settings.Add(PASSWORDTAG, s_Password);
            config.AppSettings.Settings.Add(PASSWORDSYSTEMTAG, s_PasswordSystem);
            config.AppSettings.Settings.Add(USERLOGINTAG, s_UsernameLogin);
            config.AppSettings.Settings.Add(PASSWORDLOGINTAG, s_PasswordLogin);
            #region Dược
            s_Host = EnCode(sDuocHost);
            s_Port = EnCode(sDuocPort);
            s_Userid = EnCode(sDuocUserID);
            s_Database = EnCode(sDuocDatabase);
            s_Schema = EnCode(sDuocSchema);
            s_Password = EnCode(sDuocPassword);
            s_PasswordSystem = EnCode(sDuocPasswordSystem);
            s_UsernameLogin = EnCode(sDuocUsernameLogin);
            s_PasswordLogin = EnCode(sDuocPasswordLogin);
            config.AppSettings.Settings.Add(DUOCHOSTTAG, s_Host);
            config.AppSettings.Settings.Add(DUOCPORTTAG, s_Port);
            config.AppSettings.Settings.Add(DUOCUSERTAG, s_Userid);
            config.AppSettings.Settings.Add(DUOCDATABASETAG, s_Database);
            config.AppSettings.Settings.Add(DUOCSCHEMATAG, s_Schema);
            config.AppSettings.Settings.Add(DUOCPASSWORDTAG, s_Password);
            config.AppSettings.Settings.Add(DUOCPASSWORDSYSTEMTAG, s_PasswordSystem);
            config.AppSettings.Settings.Add(DUOCUSERLOGINTAG, s_UsernameLogin);
            config.AppSettings.Settings.Add(DUOCPASSWORDLOGINTAG, s_PasswordLogin);
            #endregion
            #region Viện phí
            s_Host = EnCode(sVPHost);
            s_Port = EnCode(sVPPort);
            s_Userid = EnCode(sVPUserID);
            s_Database = EnCode(sVPDatabase);
            s_Schema = EnCode(sVPSchema);
            s_Password = EnCode(sVPPassword);
            s_PasswordSystem = EnCode(sVPPasswordSystem);
            s_UsernameLogin = EnCode(sVPUsernameLogin);
            s_PasswordLogin = EnCode(sVPPasswordLogin);
            config.AppSettings.Settings.Add(VPHOSTTAG, s_Host);
            config.AppSettings.Settings.Add(VPPORTTAG, s_Port);
            config.AppSettings.Settings.Add(VPUSERTAG, s_Userid);
            config.AppSettings.Settings.Add(VPDATABASETAG, s_Database);
            config.AppSettings.Settings.Add(VPSCHEMATAG, s_Schema);
            config.AppSettings.Settings.Add(VPPASSWORDTAG, s_Password);
            config.AppSettings.Settings.Add(VPPASSWORDSYSTEMTAG, s_PasswordSystem);
            config.AppSettings.Settings.Add(VPUSERLOGINTAG, s_UsernameLogin);
            config.AppSettings.Settings.Add(VPPASSWORDLOGINTAG, s_PasswordLogin);
            #endregion
            #region CDHA
            s_Host = EnCode(sCDHAHost);
            s_Port = EnCode(sCDHAPort);
            s_Userid = EnCode(sCDHAUserID);
            s_Database = EnCode(sCDHADatabase);
            s_Schema = EnCode(sCDHASchema);
            s_Password = EnCode(sCDHAPassword);
            s_PasswordSystem = EnCode(sCDHAPasswordSystem);
            s_UsernameLogin = EnCode(sCDHAUsernameLogin);
            s_PasswordLogin = EnCode(sCDHAPasswordLogin);
            config.AppSettings.Settings.Add(CDHAHOSTTAG, s_Host);
            config.AppSettings.Settings.Add(CDHAPORTTAG, s_Port);
            config.AppSettings.Settings.Add(CDHAUSERTAG, s_Userid);
            config.AppSettings.Settings.Add(CDHADATABASETAG, s_Database);
            config.AppSettings.Settings.Add(CDHASCHEMATAG, s_Schema);
            config.AppSettings.Settings.Add(CDHAPASSWORDTAG, s_Password);
            config.AppSettings.Settings.Add(CDHAPASSWORDSYSTEMTAG, s_PasswordSystem);
            config.AppSettings.Settings.Add(CDHAUSERLOGINTAG, s_UsernameLogin);
            config.AppSettings.Settings.Add(CDHAPASSWORDLOGINTAG, s_PasswordLogin);
            #endregion
            #region Xét nghiệm
            s_Host = EnCode(sXNHost);
            s_Port = EnCode(sXNPort);
            s_Userid = EnCode(sXNUserID);
            s_Database = EnCode(sXNDatabase);
            s_Schema = EnCode(sXNSchema);
            s_Password = EnCode(sXNPassword);
            s_PasswordSystem = EnCode(sXNPasswordSystem);
            s_UsernameLogin = EnCode(sXNUsernameLogin);
            s_PasswordLogin = EnCode(sXNPasswordLogin);
            config.AppSettings.Settings.Add(XNHOSTTAG, s_Host);
            config.AppSettings.Settings.Add(XNPORTTAG, s_Port);
            config.AppSettings.Settings.Add(XNUSERTAG, s_Userid);
            config.AppSettings.Settings.Add(XNDATABASETAG, s_Database);
            config.AppSettings.Settings.Add(XNSCHEMATAG, s_Schema);
            config.AppSettings.Settings.Add(XNPASSWORDTAG, s_Password);
            config.AppSettings.Settings.Add(XNPASSWORDSYSTEMTAG, s_PasswordSystem);
            config.AppSettings.Settings.Add(XNUSERLOGINTAG, s_UsernameLogin);
            config.AppSettings.Settings.Add(XNPASSWORDLOGINTAG, s_PasswordLogin);
            #endregion
            config.Save(ConfigurationSaveMode.Modified);
            ConfigurationManager.RefreshSection("appSettings");
        }

        static public void SaveConfig()
        {
            InnitConfig();
        }

        public static string RefreshConfig()
        {
#if POSTGRESQL
            sConStr = "Server=" + sHost + ";Port=" + sPort + ";User Id=" + sUserID + ";Password=" + sPassword + ";Database=" + sDatabase + ";Encoding=UNICODE;Pooling=true;Protocol=3;Timeout=2";//linh 20/8/15
#else
            sConStr = "data source=" + sHost + ";User Id=" + sSchema + ";Password=" + sPassword;
#endif
            return sConStr;
        }

        public static bool TestConnection()
        {
            MDBConnection mdbCon = new MDBConnection(sConStr);
            try
            {
                mdbCon.Open();
                string s_SQL = "select sysdate from dual";
#if POSTGRESQL
                s_SQL = "select sysdate from pg_database";
#endif
                MDBDataAdapter adt = new MDBDataAdapter(s_SQL, mdbCon);
                DataSet ds = new DataSet();
                adt.Fill(ds, "test");
                adt.Dispose();
                ds.Dispose();
            }
            catch { return false; }
            finally
            {
                mdbCon.Close();
                mdbCon.Dispose();
            }
            return true;
        }

        /// <summary>
        /// Đường dẫn đến file config
        /// </summary>
        public string FileConfig
        {
            get { return sFileConfig; }
        }

        public static int PhanHe
        {
#if POSTGRESQL
            get
            {
                iPhanHe = (int)PhanHePhanMem.PostgreSQL;
                return iPhanHe;
            }
#elif MYSQL
            get
            {
                iPhanHe = (int) PhanHePhanMem.MySQL;
                return iPhanHe;
            }
#elif SQLSERVER
            get
            {
                iPhanHe = (int) PhanHePhanMem.SQLServer;
                return iPhanHe;
            }
#else
            get
            {
                iPhanHe = (int)PhanHePhanMem.Oracle;
                return iPhanHe;
            }
#endif
        }

        /// <summary>
        /// Ngày giờ của server
        /// </summary>
        public static string NgayGioHeThong
        {
            get
            {
                string s_Ngay = DateTime.Now.ToString("dd/MM/yyyy HH:mm");
                MDBConnection mdbCon = null;
                if (Open(ref mdbCon))
                {
                    s_Ngay = GetNgayGioHeThong(mdbCon);
                    Close(ref mdbCon);
                }
                return s_Ngay;
            }
        }

        /// <summary>
        /// Ngày giờ của server
        /// </summary>
        /// <param name="mdbCon">Connection phải được open trước khi gọi hàm, kết thúc hàm phải có chổ close connection</param>
        /// <returns></returns>
        public static string GetNgayGioHeThong(MDBConnection mdbCon)
        {
            string s_Ngay = DateTime.Now.ToString("dd/MM/yyyy HH:mm");
            string s_SQL = "select to_char(sysdate,'dd/MM/yyyy hh24:mi') as ngay from dual";
#if POSTGRESQL
            s_SQL = "select to_char(sysdate,'dd/MM/yyyy hh24:mi') as ngay ";
#endif
            try
            {
                MDBCommand mdbCmd = new MDBCommand(s_SQL, mdbCon);
                s_Ngay = mdbCmd.ExecuteScalar().ToString();
                mdbCmd.Dispose();
            }
            catch { s_Ngay = DateTime.Now.ToString("dd/MM/yyyy HH:mm"); }
            return s_Ngay;
        }

        /// <summary>
        /// Lấy 3 kí tự đầu trong field table , cắt tất cả khoảng trắng và các kí tự đặc biệt
        /// </summary>
        /// <param name="mdbCon"></param>
        /// <param name="s_Table"></param>
        /// <param name="s_Field"></param>
        /// <param name="s_Ten"></param>
        /// <returns></returns>
        public string CapMaDanhMuc(MDBConnection mdbCon, string s_Table, string s_Field, string s_Ten)
        {
            string s_DacBiet = " `~!@#$%^&*()_+-={}|[]\\;':,./<>?";
            string s_Temp = s_Ten.Trim().PadRight(3, '0').ToUpper();
            foreach (char s in s_DacBiet)
            {
                s_Temp = s_Temp.Replace(s.ToString(), "");
            }
            int i_STT = 0;
            string s_Val = "";
            s_Temp = KhongDau(s_Temp);
            s_Temp = s_Temp.Substring(0, 3).PadRight(3, '0');
            string s_Sql = "select coalesce(max(to_number(substr(" + s_Field + ",4,3))),0) as stt from " + sSchema + "." + s_Table + " where substr(upper(" + s_Field + "),1,3)='" + s_Temp + "'";
            DataTable dttmp = new DataTable();
            try
            {
                try
                {
                    MDBCommand MDBCmd = new MDBCommand(s_Sql, mdbCon);
                    MDBCmd.CommandType = CommandType.Text;
                    string s_STT = MDBCmd.ExecuteScalar().ToString();
                    i_STT = int.Parse(s_STT) + 1;
                }
                catch { i_STT = 1; }
            }
            catch { i_STT = 1; }
            s_Val = s_Temp + i_STT.ToString().PadLeft(3, '0');
            return s_Val;
        }

        /// <summary>
        /// Trả về tên nhóm kho theo id
        /// </summary>
        /// <param name="mdbCon">Connection phải được open khi gọi hàm</param>
        /// <returns>Tên nhóm kho</returns>
        public static string gettenNhomKho(int i_ID)
        {
            MDBConnection mdbCon = null;
            if (Open(ref mdbCon))
            {
                string s_Sql = "select tennhomkho from " + Database.Schema + ".m_dmnhomkho where idnhomkho=" + i_ID;
                MDBDataAdapter MDBAdt = new MDBDataAdapter(s_Sql, mdbCon);
                Close(ref mdbCon);
                DataTable dt = new DataTable();
                MDBAdt.Fill(dt);
                if (dt == null || dt.Rows.Count <= 0) { return ""; }
                else
                {
                    return dt.Rows[0][0].ToString();
                }
            }
            else
            {
                return "Lỗi không hiển thị nhóm kho!";
            }

        }

        /// <summary>
        /// Chuyển chuỗi có dấu thành chuỗi không dấu, bảo toàn khoảng trắng
        /// </summary>
        /// <param name="s_Text">Chuỗi cần lấy không dấu</param>
        /// <returns></returns>
        public static string KhongDau(string s_Text)
        {
            string s_Val = "";
            DataTable dtTmp = CreateChuKhongDau();
            string s_Temp = s_Text.Trim();
            for (int i = 0; i < s_Temp.Length; i++)
            {
                string s_KiTu = s_Temp[i].ToString();
                if (s_KiTu != "")
                {
                    string s_temp = "";
                    DataRow r = dtTmp.Rows.Find(s_KiTu);
                    if (r != null)
                    {
                        s_temp = r["val"].ToString();
                    }
                    if (s_temp != "")
                    {
                        s_Val = s_Val + s_temp;
                    }
                    else
                    {
                        s_Val = s_Val + s_KiTu;
                    }
                }
            }
            return s_Val;
        }

        /// <summary>
        /// Chuyển chuỗi có dấu thành chuỗi không dấu, Cắt tất cả các khoảng trắng, chuyển thành chữ hoa.
        /// </summary>
        /// <param name="s_Text">Chuỗi cần lấy không dấu</param>
        /// <returns></returns>
        public static string TenKhongDau(string s_Text)
        {
            string s_Temp = s_Text.Trim().ToUpper();
            string s_Val = KhongDau(s_Temp);
            string s_Replace = "-*/+=-_)(&^%$#@!~`:;.,><?'|}{[]";
            s_Val = s_Val.Replace(" ", "");
            foreach (char s in s_Replace)
            {
                s_Val = s_Val.Replace(s, new char());
            }
            s_Val = s_Val.Replace("\0", "");
            return s_Val;
        }

        static DataTable CreateChuKhongDau()
        {
            DataTable dt = new DataTable("chukhongdau");
            dt.Columns.Add("name", typeof(string));
            dt.Columns.Add("val", typeof(string));
            dt.PrimaryKey = new DataColumn[1] { dt.Columns["name"] };
            dt.CaseSensitive = true;
            dt.Rows.Add(new string[2] { "Á", "A" });
            dt.Rows.Add(new string[2] { "À", "A" });
            dt.Rows.Add(new string[2] { "Â", "A" });
            dt.Rows.Add(new string[2] { "Ă", "A" });
            dt.Rows.Add(new string[2] { "Ã", "A" });
            dt.Rows.Add(new string[2] { "Ấ", "A" });
            dt.Rows.Add(new string[2] { "Ầ", "A" });
            dt.Rows.Add(new string[2] { "Ắ", "A" });
            dt.Rows.Add(new string[2] { "Ằ", "A" });
            dt.Rows.Add(new string[2] { "Ẫ", "A" });
            dt.Rows.Add(new string[2] { "Ẵ", "A" });
            dt.Rows.Add(new string[2] { "Ả", "A" });
            dt.Rows.Add(new string[2] { "Ẩ", "A" });
            dt.Rows.Add(new string[2] { "Ẳ", "A" });
            dt.Rows.Add(new string[2] { "Ạ", "A" });
            dt.Rows.Add(new string[2] { "Ậ", "A" });
            dt.Rows.Add(new string[2] { "Ặ", "A" });
            dt.Rows.Add(new string[2] { "Đ", "D" });
            dt.Rows.Add(new string[2] { "É", "E" });
            dt.Rows.Add(new string[2] { "È", "E" });
            dt.Rows.Add(new string[2] { "Ê", "E" });
            dt.Rows.Add(new string[2] { "Ẽ", "E" });
            dt.Rows.Add(new string[2] { "Ề", "E" });
            dt.Rows.Add(new string[2] { "Ễ", "E" });
            dt.Rows.Add(new string[2] { "Ẻ", "E" });
            dt.Rows.Add(new string[2] { "Ể", "E" });
            dt.Rows.Add(new string[2] { "Ế", "E" });
            dt.Rows.Add(new string[2] { "Ẹ", "E" });
            dt.Rows.Add(new string[2] { "Ệ", "E" });
            dt.Rows.Add(new string[2] { "Í", "I" });
            dt.Rows.Add(new string[2] { "Ì", "I" });
            dt.Rows.Add(new string[2] { "Ĩ", "I" });
            dt.Rows.Add(new string[2] { "Ỉ", "I" });
            dt.Rows.Add(new string[2] { "Ị", "I" });
            dt.Rows.Add(new string[2] { "Ó", "O" });
            dt.Rows.Add(new string[2] { "Ò", "O" });
            dt.Rows.Add(new string[2] { "Ô", "O" });
            dt.Rows.Add(new string[2] { "Õ", "O" });
            dt.Rows.Add(new string[2] { "Ố", "O" });
            dt.Rows.Add(new string[2] { "Ồ", "O" });
            dt.Rows.Add(new string[2] { "Ỗ", "O" });
            dt.Rows.Add(new string[2] { "Ỏ", "O" });
            dt.Rows.Add(new string[2] { "Ơ", "O" });
            dt.Rows.Add(new string[2] { "Ổ", "O" });
            dt.Rows.Add(new string[2] { "Ọ", "O" });
            dt.Rows.Add(new string[2] { "Ớ", "O" });
            dt.Rows.Add(new string[2] { "Ờ", "O" });
            dt.Rows.Add(new string[2] { "Ỡ", "O" });
            dt.Rows.Add(new string[2] { "Ộ", "O" });
            dt.Rows.Add(new string[2] { "Ở", "O" });
            dt.Rows.Add(new string[2] { "Ợ", "O" });
            dt.Rows.Add(new string[2] { "Ú", "U" });
            dt.Rows.Add(new string[2] { "Ù", "U" });
            dt.Rows.Add(new string[2] { "Ũ", "U" });
            dt.Rows.Add(new string[2] { "Ủ", "U" });
            dt.Rows.Add(new string[2] { "Ư", "U" });
            dt.Rows.Add(new string[2] { "Ụ", "U" });
            dt.Rows.Add(new string[2] { "Ứ", "U" });
            dt.Rows.Add(new string[2] { "Ừ", "U" });
            dt.Rows.Add(new string[2] { "Ữ", "U" });
            dt.Rows.Add(new string[2] { "Ử", "U" });
            dt.Rows.Add(new string[2] { "Ự", "U" });
            dt.Rows.Add(new string[2] { "Ý", "Y" });
            dt.Rows.Add(new string[2] { "Ỳ", "Y" });
            dt.Rows.Add(new string[2] { "Ỹ", "Y" });
            dt.Rows.Add(new string[2] { "Ỷ", "Y" });
            dt.Rows.Add(new string[2] { "Ỵ", "Y" });
            dt.Rows.Add(new string[2] { "á", "a" });
            dt.Rows.Add(new string[2] { "à", "a" });
            dt.Rows.Add(new string[2] { "â", "a" });
            dt.Rows.Add(new string[2] { "ă", "a" });
            dt.Rows.Add(new string[2] { "ã", "a" });
            dt.Rows.Add(new string[2] { "ấ", "a" });
            dt.Rows.Add(new string[2] { "ầ", "a" });
            dt.Rows.Add(new string[2] { "ắ", "a" });
            dt.Rows.Add(new string[2] { "ằ", "a" });
            dt.Rows.Add(new string[2] { "ẫ", "a" });
            dt.Rows.Add(new string[2] { "ẵ", "a" });
            dt.Rows.Add(new string[2] { "ả", "a" });
            dt.Rows.Add(new string[2] { "ẩ", "a" });
            dt.Rows.Add(new string[2] { "ẳ", "a" });
            dt.Rows.Add(new string[2] { "ạ", "a" });
            dt.Rows.Add(new string[2] { "ậ", "a" });
            dt.Rows.Add(new string[2] { "ặ", "a" });
            dt.Rows.Add(new string[2] { "đ", "d" });
            dt.Rows.Add(new string[2] { "é", "e" });
            dt.Rows.Add(new string[2] { "è", "e" });
            dt.Rows.Add(new string[2] { "ê", "e" });
            dt.Rows.Add(new string[2] { "ẽ", "e" });
            dt.Rows.Add(new string[2] { "ế", "e" });
            dt.Rows.Add(new string[2] { "ề", "e" });
            dt.Rows.Add(new string[2] { "ễ", "e" });
            dt.Rows.Add(new string[2] { "ẻ", "e" });
            dt.Rows.Add(new string[2] { "ể", "e" });
            dt.Rows.Add(new string[2] { "ẹ", "e" });
            dt.Rows.Add(new string[2] { "ệ", "e" });
            dt.Rows.Add(new string[2] { "í", "i" });
            dt.Rows.Add(new string[2] { "ì", "i" });
            dt.Rows.Add(new string[2] { "ĩ", "i" });
            dt.Rows.Add(new string[2] { "ỉ", "i" });
            dt.Rows.Add(new string[2] { "ị", "i" });
            dt.Rows.Add(new string[2] { "ó", "o" });
            dt.Rows.Add(new string[2] { "ò", "o" });
            dt.Rows.Add(new string[2] { "ô", "o" });
            dt.Rows.Add(new string[2] { "õ", "o" });
            dt.Rows.Add(new string[2] { "ố", "o" });
            dt.Rows.Add(new string[2] { "ồ", "o" });
            dt.Rows.Add(new string[2] { "ỗ", "o" });
            dt.Rows.Add(new string[2] { "ỏ", "o" });
            dt.Rows.Add(new string[2] { "ổ", "o" });
            dt.Rows.Add(new string[2] { "ọ", "o" });
            dt.Rows.Add(new string[2] { "ộ", "o" });
            dt.Rows.Add(new string[2] { "ơ", "o" });
            dt.Rows.Add(new string[2] { "ớ", "o" });
            dt.Rows.Add(new string[2] { "ờ", "o" });
            dt.Rows.Add(new string[2] { "ở", "o" });
            dt.Rows.Add(new string[2] { "ỡ", "o" });
            dt.Rows.Add(new string[2] { "ợ", "o" });
            dt.Rows.Add(new string[2] { "ú", "u" });
            dt.Rows.Add(new string[2] { "ù", "u" });
            dt.Rows.Add(new string[2] { "ũ", "u" });
            dt.Rows.Add(new string[2] { "ủ", "u" });
            dt.Rows.Add(new string[2] { "ụ", "u" });
            dt.Rows.Add(new string[2] { "ư", "u" });
            dt.Rows.Add(new string[2] { "ứ", "u" });
            dt.Rows.Add(new string[2] { "ừ", "u" });
            dt.Rows.Add(new string[2] { "ữ", "u" });
            dt.Rows.Add(new string[2] { "ử", "u" });
            dt.Rows.Add(new string[2] { "ự", "u" });
            dt.Rows.Add(new string[2] { "ý", "y" });
            dt.Rows.Add(new string[2] { "ỳ", "y" });
            dt.Rows.Add(new string[2] { "ỹ", "y" });
            dt.Rows.Add(new string[2] { "ỷ", "y" });
            dt.Rows.Add(new string[2] { "ỵ", "y" });
            return dt;
        }

        public static void CreateFunction(MDBConnection mdbCon)
        {
            string s_SQL = " ";
            s_SQL += "CREATE OR REPLACE FUNCTION " + Schema + ".loaddschodongtien( s_MMYY varchar2, s_MMYY_s varchar2, s_TuNgay varchar2,  s_DenNgay varchar2)\n";
            s_SQL += "RETURNS refcursor  AS $$\n";
            s_SQL += "declare\n";
            s_SQL += "ref refcursor;\n";
            s_SQL += "begin\n";
            s_SQL += "open ref for\n";
            s_SQL += "select  d.mabn,to_date(to_char(b.ngay,'dd/MM/yyyy'),'dd/MM/yyyy') as ngay,b.idkhoaphong,g.tenkhoaphong,(a.hobenhnhan||' '||a.chulotbenhnhan||' '||a.tenbenhnhan) as hoten," +
                " b.maql,b.madoituong,c.tendoituong,case when a.phai=1 then 'Nam' else 'Nữ' end as tenphai," +
                " case when a.ngaysinh is null then to_char(a.namsinh) else to_char(a.ngaysinh,'dd/MM/yyyy') end as ngaysinh,a.sonha,a.thon,a.cholam," +
                " e.tentinhthanh,f.tenquanhuyen,h.tenphuongxa,sum(b.dongia*b.soluong) as sotien,cast(0 as decimal) as idchuyensolieu " +
                " from " + Schema + ".b_chidinh b," + Schema + ".p_benhandt d," + Schema + ".p_dmkhoaphongbenhvien g," + Schema + ".p_dmbenhnhan a," + Schema + ".p_dmdoituong c," +
                " " + Schema + ".p_dmtinhthanh e," + Schema + ".p_dmquanhuyen f, " + Schema + ".p_dmphuongxa h " +
                " where b.maql=d.maql and b.idkhoaphong=g.idkhoaphong and d.mabn=a.mabn and b.madoituong=c.madoituong and a.matinhthanh=e.matinhthanh" +
                " and f.maquanhuyen=a.maquanhuyen and h.maphuongxa=a.maphuongxa and b.paid=0 and b.idttrv=0 " +
                " and to_date(to_char(b.ngay,'dd/MM/yyyy'),'dd/MM/yyyy') between to_date(s_TuNgay,'dd/MM/yyyy') and to_date(s_DenNgay,'dd/MM/yyyy')" +
                " and d.loaiba in(0,3)" + //Tú:09/07/2014 những loaiba=1,4,2 sẽ lấy từ b_chuyensolieu
                " and b.mmyy in(s_MMYY) and d.mmyy in(s_MMYY_s) " +
                " group by d.mabn,to_char(b.ngay,'dd/MM/yyyy'),b.idkhoaphong,g.tenkhoaphong,(a.hobenhnhan||' '||a.chulotbenhnhan||' '||a.tenbenhnhan)," +
                " b.maql,b.madoituong,c.tendoituong,case when a.phai=1 then 'Nam' else 'Nữ' end," +
                " case when a.ngaysinh is null then to_char(a.namsinh) else to_char(a.ngaysinh,'dd/MM/yyyy') end,a.sonha,a.thon,a.cholam," +
                " e.tentinhthanh,f.tenquanhuyen,h.tenphuongxa " +
                " union all " +
                " select d.mabn,to_date(to_char(b.ngayylenh,'dd/mm/yyyy'),'dd/MM/yyyy') as ngay, nvl(f.idkhoaphongbenhvien,c.idkhoaphong) as idkhoaphong,g.tenkhoaphong," +
                " (e.hobenhnhan||' '||e.chulotbenhnhan||' '||e.tenbenhnhan) as hoten,a.maql,b.madoituong,h.tendoituong,case when e.phai=1 then 'Nam' else 'Nữ' end as tenphai," +
                " case when e.ngaysinh is null then to_char(e.namsinh) else to_char(e.ngaysinh,'dd/MM/yyyy') end as ngaysinh,e.sonha,e.thon,e.cholam," +
                " i.tentinhthanh,j.tenquanhuyen,k.tenphuongxa,sum(b.giaban*b.soluong) as sotien,cast(0 as decimal) as idchuyensolieu " +
                " from " + Schema + ".m_xuatnoiviends a," + Schema + ".m_tienthuoc b," + Schema + ".m_phieuduyet c," + Schema + ".p_benhandt d," + Schema + ".m_dmkhoaphong f," +
                " " + Schema + ".p_dmkhoaphongbenhvien g," + Schema + ".p_dmbenhnhan e," + Schema + ".p_dmdoituong h," + Schema + ".p_dmtinhthanh i," + Schema + ".p_dmquanhuyen j, " + Schema + ".p_dmphuongxa k  " +
                " where a.maql=d.maql and d.mabn=e.mabn and c.idkhoaphong=f.idkhoaphong and f.idkhoaphongbenhvien=g.idkhoaphong(+) and b.madoituong=h.madoituong" +
                " and  a.idxuatnoiviends=b.idxuatnoiviends and a.idphieuduyet=c.idphieuduyet " +
                " and to_date(to_char(b.ngayylenh,'dd/MM/yyyy'),'dd/MM/yyyy') between to_date(s_TuNgay,'dd/MM/yyyy') and to_date(s_DenNgay,'dd/MM/yyyy')" +
                " and j.maquanhuyen=e.maquanhuyen and k.maphuongxa=e.maphuongxa and i.matinhthanh=e.matinhthanh" +
                " and b.idttrv=0" +
                " and d.loaiba in(0,3)" +
                " and a.mmyy in(s_MMYY) and b.mmyy in(s_MMYY_s) and c.mmyy in(s_MMYY) and d.mmyy in(s_MMYY) " +
                " group by d.mabn,to_char(b.ngayylenh,'dd/mm/yyyy'), nvl(f.idkhoaphongbenhvien,c.idkhoaphong),g.tenkhoaphong," +
                " (e.hobenhnhan||' '||e.chulotbenhnhan||' '||e.tenbenhnhan),a.maql,b.madoituong,h.tendoituong,case when e.phai=1 then 'Nam' else 'Nữ' end," +
                " case when e.ngaysinh is null then to_char(e.namsinh) else to_char(e.ngaysinh,'dd/MM/yyyy') end,e.sonha,e.thon,e.cholam," +
                " i.tentinhthanh,j.tenquanhuyen,k.tenphuongxa " +
                " union all " +
                " select d.mabn,to_date(to_char(a.ngay,'dd/mm/yyyy'),'dd/MM/yyyy') as ngay,a.idkhoaphong,g.tenkhoaphong,(e.hobenhnhan||' '||e.chulotbenhnhan||' '||e.tenbenhnhan) as hoten," +
                " a.maql,b.madoituong,f.tendoituong,case when e.phai=1 then 'Nam' else 'Nữ' end as tenphai," +
                " case when e.ngaysinh is null then to_char(e.namsinh) else to_char(e.ngaysinh,'dd/MM/yyyy') end as ngaysinh,e.sonha,e.thon,e.cholam," +
                " i.tentinhthanh,j.tenquanhuyen,k.tenphuongxa,sum(b.dongia*b.soluong) as sotien,cast(0 as decimal) as idchuyensolieu " + //Tú:09/07/2014 thêm idchuyensolieu
                " from " + Schema + ".m_duyetchiphi a," + Schema + ".m_duyetchiphithuoc b," + Schema + ".p_benhandt d," + Schema + ".p_dmkhoaphongbenhvien g,  " +
                " " + Schema + ".p_dmbenhnhan e," + Schema + ".p_dmdoituong f," + Schema + ".p_dmtinhthanh i," + Schema + ".p_dmquanhuyen j, " + Schema + ".p_dmphuongxa k" +
                " where a.maql=d.maql and a.idkhoaphong=g.idkhoaphong and  a.idduyetchiphi=b.idduyetchiphi " +
                " and d.mabn=e.mabn and b.madoituong=f.madoituong and a.idttrv=0 and j.maquanhuyen=e.maquanhuyen " +
                " and k.maphuongxa=e.maphuongxa and i.matinhthanh=e.matinhthanh " +
                " and to_date(to_char(a.ngay,'dd/MM/yyyy'),'dd/MM/yyyy') between to_date(s_TuNgay,'dd/MM/yyyy') and to_date(s_DenNgay,'dd/MM/yyyy')" +
                " and d.loaiba in(0,3)" +
                " and a.mmyy in( s_MMYY ) and b.mmyy in(s_MMYY_s ) and d.mmyy in( s_MMYY ) " +
                " group by d.mabn,to_char(a.ngay,'dd/mm/yyyy'),a.idkhoaphong,g.tenkhoaphong,(e.hobenhnhan||' '||e.chulotbenhnhan||' '||e.tenbenhnhan)," +
                " a.maql,b.madoituong,f.tendoituong,case when e.phai=1 then 'Nam' else 'Nữ' end," +
                " case when e.ngaysinh is null then to_char(e.namsinh) else to_char(e.ngaysinh,'dd/MM/yyyy') end,e.sonha,e.thon,e.cholam," +
                " i.tentinhthanh,j.tenquanhuyen,k.tenphuongxa" +
                " union all " +
                " select d.mabn,to_date(to_char(a.ngay,'dd/mm/yyyy'),'dd/MM/yyyy') as ngay,a.idkhoaphong,g.tenkhoaphong,(e.hobenhnhan||' '||e.chulotbenhnhan||' '||e.tenbenhnhan) as hoten," +
                " a.maql,b.madoituong,c.tendoituong,case when e.phai=1 then 'Nam' else 'Nữ' end as tenphai," +
                " case when e.ngaysinh is null then to_char(e.namsinh) else to_char(e.ngaysinh,'dd/MM/yyyy') end as ngaysinh,e.sonha,e.thon,e.cholam," +
                " i.tentinhthanh,j.tenquanhuyen,k.tenphuongxa,sum(b.dongia*b.soluong) as sotien,cast(0 as decimal) as idchuyensolieu " +
                " from " + Schema + ".m_duyetchiphi a," + Schema + ".m_duyetchiphicls b," + Schema + ".p_dmdoituong c," + Schema + ".p_benhandt d ," + Schema + ".p_dmkhoaphongbenhvien g," +
                " " + Schema + ".p_dmbenhnhan e," + Schema + ".p_dmtinhthanh i," + Schema + ".p_dmquanhuyen j, " + Schema + ".p_dmphuongxa k" +
                " where a.maql=d.maql  and a.idkhoaphong=g.idkhoaphong and a.idduyetchiphi=b.idduyetchiphi and d.mabn=e.mabn and c.madoituong=b.madoituong " +
                " and j.maquanhuyen=e.maquanhuyen and k.maphuongxa=e.maphuongxa and i.matinhthanh=e.matinhthanh and a.idttrv=0 " +
                " and to_date(to_char(a.ngay,'dd/MM/yyyy'),'dd/MM/yyyy') between to_date(s_TuNgay,'dd/MM/yyyy') and to_date(s_DenNgay,'dd/MM/yyyy')" +
                " and d.loaiba in(0,3) " +
                " and a.mmyy in( s_MMYY ) and b.mmyy in( s_MMYY ) and d.mmyy in( s_MMYY_s ) " +
                " group by d.mabn,to_char(a.ngay,'dd/mm/yyyy'),a.idkhoaphong,g.tenkhoaphong,(e.hobenhnhan||' '||e.chulotbenhnhan||' '||e.tenbenhnhan)," +
                " a.maql,b.madoituong,c.tendoituong,case when e.phai=1 then 'Nam' else 'Nữ' end," +
                " case when e.ngaysinh is null then to_char(e.namsinh) else to_char(e.ngaysinh,'dd/MM/yyyy') end,e.sonha,e.thon,e.cholam," +
                " i.tentinhthanh,j.tenquanhuyen,k.tenphuongxa;\n";
            s_SQL += "return ref;\n" +
                " END;\n" +
                " $$ \n" +
                " LANGUAGE plpgsql;\n";
            MDBCommand mdbCmd = new MDBCommand(s_SQL, mdbCon);
            mdbCmd.CommandType = CommandType.Text;
            mdbCmd.ExecuteNonQuery();
        }

        //Tú:01/12/2014 kiểm tra xem table đã được tạo hay chưa
        public bool CheckExistsTable(MDBConnection mdbCon, string s_MMYY)
        {
            string s_Table1 = DanhMucTable.p_benhandt + "_" + s_MMYY;
            s_Table1 = s_Table1.ToLower();
            string s_Table2 = DanhMucTable.b_chuyensolieu + "_" + s_MMYY;
            s_Table2 = s_Table2.ToLower();
#if POSTGRESQL
            string s_SQL = "select * from pg_tables where lower(tablename) in('" + s_Table1 + "','" + s_Table2 + "') and lower(schemaname)='" + sSchema.ToLower() + "'";
            MDBDataAdapter mdbAdt = new MDBDataAdapter(s_SQL, mdbCon);
            DataTable dt = new DataTable("Exists");
            mdbAdt.Fill(dt);
            if (dt == null || dt.Rows.Count < 2)
                return false;
            else
                return true;
#else
            string s_SQL = "select * from sys.ALL_TAB_PARTITIONS where lower(partition_name) in('" + s_Table1 + "','" + s_Table2 + "') and lower(TABLE_OWNER)='" + sSchema.ToLower() + "'";
            MDBDataAdapter mdbAdt = new MDBDataAdapter(s_SQL, mdbCon);
            DataTable dt = new DataTable("Exists");
            mdbAdt.Fill(dt);
            if (dt == null || dt.Rows.Count < 2)
                return false;
            else
                return true;
#endif
        }

        public void CreateTable(string s_MMYY)
        {
            MDBConnection mdbCon = null;
            if (Open(ref mdbCon))
            {
                try
                {
                    CreateTable(mdbCon, s_MMYY);
                }
                finally
                {
                    Close(ref mdbCon);
                }
            }
        }

    }
    /// <summary>
    /// Phân hệ dựa vào database: Oracle, PostgreSQL
    /// </summary>
    public enum PhanHePhanMem
    {
        Oracle = 1,
        PostgreSQL = 2,
        SQLServer = 3,
        MySQL = 4,
    }

    public enum LoiTaoDatabase
    {
        DatabaseChuaTao = 1013,
        DatabaseTaoThanhCong = 1014,
        DatabaseKhongTaoDuocCauTruc = 1015,
        SchemaKhongTaoDuoc = 1016,
        SchemaTaoThanhCong = 1017,
        TableKhongTaoDuoc = 1018,
        TableTaoThanhCong = 1019,
    }

    /// <summary>
    /// This class allows you to launch an external program passing to it:
    /// the file name, some args, and if it should wait until finished
    /// </summary>
    public class Run
    {
        private string fileName = string.Empty;
        private string arguments = string.Empty;
        private bool waitUntilFinished = false;
        private int waitMillisecs = -1;

        public Run(string fileName)
        {
            this.fileName = fileName;
        }

        /// <summary>
        /// </summary>
        /// <param name="fileName"></param>
        /// <param name="arguments"></param>
        /// <param name="waitUntilFinished"></param>
        public Run(string fileName, string arguments, bool waitUntilFinished)
        {
            this.fileName = fileName;
            this.arguments = arguments;
            this.waitUntilFinished = waitUntilFinished;
        }

        /// <summary>
        /// </summary>
        /// <param name="fileName"></param>
        /// <param name="arguments"></param>
        /// <param name="waitMillisecs"></param>
        public Run(string fileName, string arguments, int waitMillisecs)
        {
            this.fileName = fileName;
            this.arguments = arguments;
            this.waitMillisecs = waitMillisecs;
        }

        public void Launch()
        {
            try
            {
                ProcessStartInfo proc = new ProcessStartInfo();//linh 6/6/14
                proc.UseShellExecute = false;
                proc.WorkingDirectory = Environment.CurrentDirectory;
                proc.FileName = this.fileName;
                proc.Verb = "runas";
                if (this.arguments.Length > 0)
                {
                    proc.Arguments = this.arguments;
                }
                using (Process p = new Process())
                {
                    p.StartInfo = proc;
                    try
                    {
                        p.Start();
                    }
                    catch// (Exception ex) 
                    { 
                        //MessageBox.Show(ex.ToString()); 
                    }
                    if (this.waitMillisecs != -1)
                    {
                        p.WaitForExit(waitMillisecs);
                    }
                    else
                    {
                        if (this.waitUntilFinished == true)
                        {
                            p.WaitForExit();
                        }
                    }
                    p.Close();
                }
            }
            catch (Exception ex) { MessageBox.Show(ex.ToString()); }
        }
    }

    //linh 27/6/14
    public enum DanhMucTable
    {
        p_dmtinhthanh = 1,
        p_dmquanhuyen = 2,
        p_dmphuongxa = 3,
        p_dmicd = 4,
        p_dmbenhvien = 5,
        p_dmdantoc = 6,
        p_dmnghenghiep = 7,
        p_dmnghenghiepbenhvien = 8,
        p_dmkhoaphong = 9,
        p_dmkhoaphongbenhvien = 10,
        p_dmdoituong = 11,
        p_benhandt = 12,
        p_dmkhoalamsang = 13,
        p_dmphongkham = 14,
        p_dmnhomkhoaphong = 15,
        p_dmbenhnhan = 16,//linh 25/6
        p_xuatvien = 17,
        p_xuatkhoa = 18,
        p_nhapkhoa = 19,
        p_lienhe = 20,
        p_bhyt = 21,
        p_dausinhton = 22,
        p_benhkemtheo = 23,
        p_benhmantinh = 24,
        p_benhtiensu = 25,
        p_giaychuyenvien = 26,
        p_giayravien = 27,
        p_lichhen = 28,
        p_lichlamviecbacsi = 29,
        p_pttt = 30,
        p_tainanthuongtich = 31,
        p_theodoigiuong = 32,
        p_toathuocll = 33,
        p_toathuocct = 34,
        p_tuvong = 35,
        p_xutridieutri = 36,
        p_thanhvienekipmo = 37,
        p_dmnhomnhanvien = 38,
        p_dmnhanvien = 39,
        p_dmuser = 40,
        p_dmkhoaphongbo = 41,
        p_dmvungbenhvien = 42,
        p_dmloaibenhvien = 43,
        p_dmtuyenbenhvien = 44,
        p_dmbenhan = 45,
        p_dmchucnangekipmo = 46,
        p_dmlydovaovien = 47,
        p_dmchuongicd = 48,
        p_dmnhomicd = 49,
        p_dmxutri = 50,
        p_dmtinhtrangrakhoa = 51,
        p_dmketquadieutri = 52,
        p_dmgaymegayte = 53,
        p_dmloainhompttt = 54,
        p_dmloaipttt = 55,
        p_dmnhompttt = 56,
        p_dmphuongphappttt = 57,
        p_dmtinhhinhpt = 58,
        p_dmtaibienpt = 59,
        p_dmtuvongpt = 60,
        bl_dmnhomin = 61,
        bl_dmloaimau = 62,
        bl_dmthetich = 63,
        m_dmkho = 64,
        bl_dmnguon = 65,
        bl_theodoi = 66,
        bl_tonkhochitiet = 67,
        bl_tonkhotonghop = 68,
        bl_tondau = 69,
        bl_dmnhomrhd = 70,
        b_dmnhomvienphi = 71,
        b_dmloaivienphi = 72,
        b_dmgiavienphi = 73,
        b_hoantra = 74,
        b_tamung = 75,
        b_tamungcd = 76,
        b_thuocchuavuottran = 77,
        b_vienphi = 78,
        b_vienphichuavuottran = 79,
        b_vienphict = 80,
        b_vienphictthuoc = 81,
        b_chidinh = 82,
        b_chuyensolieu = 83,//Tú:08/07/2014
        b_dmnhomvienphibhyt = 84,
        m_dmnuoc = 85,
        m_dmnhombietduoc = 86,//linh 26/6
        m_dmloai = 87,
        m_dmhang = 88,
        m_dmhoatchat = 89,
        m_dmdang = 90,
        m_dmbd = 91,
        m_dutrumuall = 93,
        m_dutrumuact = 94,
        m_duyetchiphi = 95,
        m_duyetchiphicls = 96,
        m_duyetchiphithuoc = 97,
        m_duyetdutrumuall = 98,
        m_duyetdutrumuact = 99,
        m_nhapll = 100,
        m_nhapct = 101,
        m_phieuduyet = 102,
        m_sophieuduyet = 103,
        m_sophieumau38 = 104,
        m_theodoi = 105,
        m_thucxuattutruc = 106,
        m_tienthuoc = 107,
        m_tondau = 108,
        m_tonkhochitiet = 109,
        m_tonkhotonghop = 110,
        m_xuatct = 111,
        m_xuatll = 112,
        m_xuatnoiviends = 113,
        m_xuatnoivienct = 114,
        m_ylenhthuoc = 115,
        m_ylenhthuocct = 116,
        m_ylenhthuocds = 117,
        m_tontutrucchitiet = 118,
        m_tontutructonghop = 119,
        m_dmnhacungcap = 120,//linh 6/7/13
        m_dutrucapll = 121,
        m_dutrucapct = 122,
        m_dmnhomkho = 123,
        m_dmkhoaphong = 124,
        m_dmnhomhang = 125,
        m_dmloaithuocbyt = 126,
        m_dmnhomphieu = 127,
        m_dmphieu = 128,
        m_dmlydoxuat = 129,
        m_dmnganhang = 130,
        m_dmnhomin = 131,
        m_dmnhomketoan = 132,
        m_dmduongdung = 133,
        m_phatthuoc = 134,//linh 1/8/14
        r_ketquall = 135,
        r_ketquact = 136,
        r_dmloaicdha = 137,
        l_ketqua = 138,
        l_ketquachitiet = 139,
        l_dmnhomxetnghiem = 140,
        l_dmloaixetnghiem = 141,
        l_dmxetnghiem = 142,

        e_theodoi = 143,
        e_tonkhochitiet = 144,
        e_tonkhotonghop = 145,
        e_tondau = 146,
        e_tontutrucchitiet = 147,
        e_tontutructonghop = 148,
        e_nhapll = 149,
        e_nhapct = 150,
        e_xuatll = 151,
        e_xuatct = 152,
        e_dmhang = 153,
        e_dmkho = 154,
        e_dmnguon = 155,
        m_dmnguon = 156,
        p_dmdiadiem = 157,
        p_dmbophan = 158,
        p_dmnguyennhantainan = 159,
        p_dmngodoc = 160,
        p_dmdienbien = 161,
        p_dmxutritainan = 162,
        p_dmtinhtranggpb = 163,
        p_dmnguyennhanchet = 164,
        p_dmphai = 165,
        p_dmnhommau = 166,
        p_dmnhomuser = 167,
        b_dmloaikythuatvienphi = 168,
        p_dmtinhtrangthuchiencls = 169,
        p_dmloaibn = 170,
        p_dmnhantu = 171,
        p_dmdentu = 172,
        b_dmfieldgia = 173,
        b_dmloaiquyenso = 174,//Tú:15/07/2014
        b_dmquyenso = 175,//Tú:15/07/2014 
        h_dmtongiao = 176,//Thuy 6/8/14
        h_dmtrinhdovitinh = 177,//Thuy 6/8/14
        h_dmhocvan = 178,//Thuy 6/8/14
        m_denghi = 179,//ThanhCuong - 15/08/2014
        m_denghichitiet = 180,//ThanhCuong - 15/08/2014
        p_dmchucvu = 181,//Thuy 20/8/14
        p_dmchucdanh = 182,//Thuy 20/8/14
        p_dmchuyenmon = 183,//Thuy 20/8/14
        l_labketqua = 184,//Linh 7/9/14
        h_dmnhomchamcong = 185,//Thuy 01/12/14
        h_dmhinhthuclamviec = 186,
        m_thauds = 187,//Thuy 15/12/14
        m_thauct = 188,//Thuy 15/12/14
        m_phieuduyetkho = 189, //ThanhCuong - 23/12/2014
        p_hoichan = 190,
        m_theodoidulieu = 191,//linh 7/1/15
        m_dmnhombaocao = 192,//linh 7/1/15
        p_hoichan_thanhvien = 193,//Thuy 8/1/15
        p_phatstttiepdon = 194,//linh 19/1/15
        l_xetnghiemchuyenmau = 195,//Tú:09/02/2015
        l_dmongxetnghiem = 196,//linh 02/03/15
        p_vudieutri = 197,//Thuy 28/3/15
        p_vudieutrichitiet = 198,//Thuy 28/3/15
        l_dmsoxetnghiem = 199,
        d_luutruhoso = 200,//Linh 7/9/14
        p_phieusoket15 = 201,//Linh 2/4/15
        m_denghitra = 202,//ThanhCuong - 03/04/2015
        m_denghitract = 203,//ThanhCuong - 03/04/2015
        l_dmvienphi = 204,//linh 24/4/15
        p_dmmucdodiung = 205,
        m_cosotutruc = 206,//ThanhCuong 16/05/2015
        m_trukhotam = 207,//Tú:26/06/2015
        bl_dmnhacungcap = 208,//ThanhCuong - 29/07/2015
        p_lichchaythan = 209,//Tú:29/07/2015
        bl_nhapll = 210,//ThanhCuong - 30/07/2015
        bl_nhapct = 211,//ThanhCuong - 30/07/2015
        b_thuchitiente = 212,//linh 3/8/15
        bl_xuatll = 213,//ThanhCuong - 30/07/2015
        bl_xuatct = 214,//ThanhCuong - 30/07/2015
        h_chamcong = 215,//Thuy 11/08/15
        b_quyettoanbhyt = 216,//Tú:12/08/2015
        b_quyettoanbhytct = 217,//Tú:12/08/2015
        b_quyettoanbhytctthuoc = 218,//Tú:12/08/2015
        bl_dmngoaivien = 219,//ThanhCuong - 12/08/2015
        bl_ylenhmau = 220,//ThanhCuong - 13/08/2015
        bl_ylenhmauds = 221,//ThanhCuong - 13/08/2015
        bl_ylenhmauct = 222,//ThanhCuong - 13/08/2015
        h_dmhopdong = 223,
        bl_phieuduyet = 224,//ThanhCuong - 20/08/2015
        bl_xuatnoiviends = 225,//ThanhCuong - 20/08/2015
        bl_xuatnoivienct = 226,//ThanhCuong - 20/08/2015
        bl_phieuduyetkho = 227,//ThanhCuong - 21/08/2015
        h_chamcongngoaigio = 228,//Thuy 31/08/2015
        m_theodoidoituong = 229,//Tú:04/09/2015
        h_dmtrangthaichamcong = 230,//Thuy 10/09/2015
        h_heso_nv = 231,//Thuy 17/9/15
        h_dmheso = 232,//Thuy 17/9/15
        l_dmnhomvitrisinhthiet = 233,//Tú:21/09/2015
        l_dmvitrisinhthiet = 234,//Tú:21/09/2015
        l_dmdungdich = 235,//Tú:21/09/2015
        l_dmphuongphapnhuom = 236,//Tú:21/09/2015
        l_ketquagiaiphaubenh = 237,//Tú:21/09/2015
        l_ketquavitrisinhthiet = 238,//Tú:21/09/2015
        l_ketquahoamomiendich = 239,//Tú:21/09/2015
        l_ketquachandoansinhthiet = 240,//Tú:21/09/2015
        p_lichhen_chidinh = 241,//linh 22/9/15
        p_phieutruyendich = 242,//Tú:22/10/2015
        h_dmthanhphanxuatthan = 243,//Thuy 24/10/15
        h_dmnguongoc = 244,//Thuy 24/10/15
        h_dmdaotaochinhtri = 245,//Thuy 24/10/15
    }
}
